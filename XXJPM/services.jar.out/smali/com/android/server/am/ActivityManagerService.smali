.class public final Lcom/android/server/am/ActivityManagerService;
.super Landroid/app/ActivityManagerNative;
.source "ActivityManagerService.java"

# interfaces
.implements Lcom/android/server/Watchdog$Monitor;


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/android/server/am/ActivityManagerService$ServiceRestarter;,
        Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;,
        Lcom/android/server/am/ActivityManagerService$PermissionController;,
        Lcom/android/server/am/ActivityManagerService$CpuBinder;,
        Lcom/android/server/am/ActivityManagerService$MemBinder;,
        Lcom/android/server/am/ActivityManagerService$AThread;,
        Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;,
        Lcom/android/server/am/ActivityManagerService$Identity;,
        Lcom/android/server/am/ActivityManagerService$ForegroundToken;,
        Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;,
        Lcom/android/server/am/ActivityManagerService$ActivityState;
    }
.end annotation


# static fields
.field static final ACTIVITY_INACTIVE_RESET_TIME:J = 0x1b7740L

.field static final APP_SWITCH_DELAY_TIME:J = 0x1388L

#the value of this static final field might be set in the static constructor
.field static final BACKUP_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final BACKUP_APP_MEM:I = 0x0

.field static final BATTERY_STATS_TIME:J = 0x1b7740L

.field static final BROADCAST_INTENT_MSG:I = 0x7

.field static final BROADCAST_TIMEOUT:I = 0x4e20

.field static final BROADCAST_TIMEOUT_MSG:I = 0x8

.field static final CONTENT_APP_IDLE_OFFSET:J = 0x3a98L

.field static final CORE_SERVER_ADJ:I = -0xc

.field static final DEBUG:Z = false

.field static final DEBUG_BACKUP:Z = false

.field static final DEBUG_BROADCAST:Z = false

.field static final DEBUG_BROADCAST_LIGHT:Z = false

.field static final DEBUG_CONFIGURATION:Z = false

.field static final DEBUG_OOM_ADJ:Z = false

.field static final DEBUG_PAUSE:Z = false

.field static final DEBUG_PROCESSES:Z = false

.field static final DEBUG_PROVIDER:Z = false

.field static final DEBUG_RESULTS:Z = false

.field static final DEBUG_SERVICE:Z = false

.field static final DEBUG_SWITCH:Z = false

.field static final DEBUG_TASKS:Z = false

.field static final DEBUG_TRANSITION:Z = false

.field static final DEBUG_URI_PERMISSION:Z = false

.field static final DEBUG_USER_LEAVING:Z = false

.field static final DEBUG_VISBILITY:Z = false

.field static final DESTROY_TIMEOUT:I = 0x2710

.field static final DESTROY_TIMEOUT_MSG:I = 0x11

.field static final DO_PENDING_ACTIVITY_LAUNCHES_MSG:I = 0x15

#the value of this static final field might be set in the static constructor
.field static final EMPTY_APP_ADJ:I = 0x0

.field static final EMPTY_APP_IDLE_OFFSET:J = 0x1d4c0L

#the value of this static final field might be set in the static constructor
.field static final EMPTY_APP_MEM:I = 0x0

.field static final EMPTY_STRING_ARRAY:[Ljava/lang/String; = null

.field static final ENFORCE_PROCESS_LIMIT:Z = false

.field static final FINALIZE_PENDING_INTENT_MSG:I = 0x17

.field private static final FINISH_AFTER_PAUSE:I = 0x1

.field private static final FINISH_AFTER_VISIBLE:I = 0x2

.field private static final FINISH_IMMEDIATELY:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final FOREGROUND_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final FOREGROUND_APP_MEM:I = 0x0

.field static final GC_BACKGROUND_PROCESSES_MSG:I = 0x5

.field static final GC_MIN_INTERVAL:I = 0xea60

.field static final GC_TIMEOUT:I = 0x1388

#the value of this static final field might be set in the static constructor
.field static final HIDDEN_APP_MAX_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final HIDDEN_APP_MEM:I = 0x0

.field static HIDDEN_APP_MIN_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final HOME_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final HOME_APP_MEM:I = 0x0

.field static final IDLE_NOW_MSG:I = 0xb

.field static final IDLE_TIMEOUT:I = 0x2710

.field static final IDLE_TIMEOUT_MSG:I = 0xa

.field static final IM_FEELING_LUCKY_MSG:I = 0xf

.field static final INSTRUMENTATION_KEY_DISPATCHING_TIMEOUT:I = 0xea60

.field static final KEY_DISPATCHING_TIMEOUT:I = 0x4e20

.field static final KILL_APPLICATION_MSG:I = 0x16

.field static final LAUNCH_TIMEOUT:I = 0x2710

.field static final LAUNCH_TIMEOUT_MSG:I = 0x10

.field static final MAX_ACTIVITIES:I = 0x14

.field static final MAX_BROADCAST_HISTORY:I = 0x64

.field static final MAX_HIDDEN_APPS:I = 0xf

.field static final MAX_PROCESSES:I = 0x2

.field static final MAX_RECENT_TASKS:I = 0x14

.field static final MAX_SERVICE_INACTIVITY:I = 0x1b7740

.field static final MIN_CRASH_INTERVAL:I = 0xea60

.field static final MIN_HIDDEN_APPS:I = 0x2

.field static final MONITOR_CPU_MAX_TIME:J = 0xfffffffL

.field static final MONITOR_CPU_MIN_TIME:J = 0x1388L

.field static final MONITOR_CPU_USAGE:Z = true

.field static final MONITOR_THREAD_CPU_USAGE:Z = false

#the value of this static final field might be set in the static constructor
.field static final MY_PID:I = 0x0

.field static final PAGE_SIZE:I = 0x1000

.field static final PAUSE_TIMEOUT:I = 0x1f4

.field static final PAUSE_TIMEOUT_MSG:I = 0x9

.field static final PROC_START_TIMEOUT:I = 0x2710

.field static final PROC_START_TIMEOUT_MSG:I = 0x14

.field static final RESUME_TOP_ACTIVITY_MSG:I = 0x13

#the value of this static final field might be set in the static constructor
.field static final SECONDARY_SERVER_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final SECONDARY_SERVER_MEM:I = 0x0

.field static final SERVICE_MIN_RESTART_TIME_BETWEEN:I = 0x2710

.field static final SERVICE_RESET_RUN_DURATION:I = 0xea60

.field static final SERVICE_RESTART_DURATION:I = 0x1388

.field static final SERVICE_RESTART_DURATION_FACTOR:I = 0x4

.field static final SERVICE_TIMEOUT:I = 0x7530

.field static final SERVICE_TIMEOUT_MSG:I = 0xc

.field static final SHOW_ACTIVITY_START_TIME:Z = true

.field static final SHOW_APP_STARTING_ICON:Z = true

.field static final SHOW_ERROR_MSG:I = 0x1

.field static final SHOW_FACTORY_ERROR_MSG:I = 0x3

.field static final SHOW_NOT_RESPONDING_MSG:I = 0x2

.field static final SHOW_UID_ERROR_MSG:I = 0xe

.field static final STOCK_PM_FLAGS:I = 0x400

.field static final SYSTEM_ADJ:I = -0x10

.field private static final SYSTEM_SECURE:Ljava/lang/String; = "ro.secure"

.field static final TAG:Ljava/lang/String; = "ActivityManager"

.field static final UPDATE_CONFIGURATION_MSG:I = 0x4

.field static final UPDATE_TIME_ZONE:I = 0xd

.field static final VALIDATE_TOKENS:Z = false

#the value of this static final field might be set in the static constructor
.field static final VISIBLE_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final VISIBLE_APP_MEM:I = 0x0

.field static final WAIT_FOR_DEBUGGER_MSG:I = 0x6

.field static final localLOGV:Z

.field static mSelf:Lcom/android/server/am/ActivityManagerService;

.field static mSystemThread:Landroid/app/ActivityThread;

.field private static sCallerIdentity:Ljava/lang/ThreadLocal;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/lang/ThreadLocal",
            "<",
            "Lcom/android/server/am/ActivityManagerService$Identity;",
            ">;"
        }
    .end annotation
.end field


# instance fields
.field final GL_ES_VERSION:I

.field mAdjSeq:I

.field mAlwaysFinishActivities:Z

.field mAppBindArgs:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Landroid/os/IBinder;",
            ">;"
        }
    .end annotation
.end field

.field mAppSwitchesAllowedTime:J

.field mBackupAppName:Ljava/lang/String;

.field mBackupTarget:Lcom/android/server/am/BackupRecord;

.field final mBadProcesses:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Ljava/lang/Long;",
            ">;"
        }
    .end annotation
.end field

.field final mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

.field mBooted:Z

.field mBooting:Z

.field final mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

.field mBroadcastsScheduled:Z

.field final mCancelledThumbnails:Ljava/util/ArrayList;

.field mCheckedForSetup:Z

.field mConfigWillChange:Z

.field mConfiguration:Landroid/content/res/Configuration;

.field mConfigurationSeq:I

.field mContext:Landroid/content/Context;

.field mController:Landroid/app/IActivityController;

.field mCurTask:I

.field mDebugApp:Ljava/lang/String;

.field mDebugTransient:Z

.field mDidAppSwitch:Z

.field mDidDexOpt:Z

.field mDidUpdate:Z

.field mFactoryTest:I

.field final mFinishingActivities:Ljava/util/ArrayList;

.field mFocusedActivity:Lcom/android/server/am/HistoryRecord;

.field final mForegroundProcesses:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Lcom/android/server/am/ActivityManagerService$ForegroundToken;",
            ">;"
        }
    .end annotation
.end field

.field mGoingToSleep:Landroid/os/PowerManager$WakeLock;

.field private final mGrantedUriPermissions:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Ljava/util/HashMap",
            "<",
            "Landroid/net/Uri;",
            "Lcom/android/server/am/UriPermission;",
            ">;>;"
        }
    .end annotation
.end field

.field final mHandler:Landroid/os/Handler;

.field final mHistory:Ljava/util/ArrayList;

.field private mHomeProcess:Lcom/android/server/am/ProcessRecord;

.field mInitialStartTime:J

.field final mIntentSenderRecords:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Lcom/android/server/am/PendingIntentRecord$Key;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Lcom/android/server/am/PendingIntentRecord;",
            ">;>;"
        }
    .end annotation
.end field

.field private final mLRUActivities:Ljava/util/ArrayList;

.field final mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

.field mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

.field mLastWriteTime:J

.field mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

.field final mLaunchingProviders:Ljava/util/ArrayList;

.field final mLruProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mLruSeq:I

.field final mNoAnimActivities:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mOrderedBroadcasts:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/BroadcastRecord;",
            ">;"
        }
    .end annotation
.end field

.field mOrigDebugApp:Ljava/lang/String;

.field mOrigWaitForDebugger:Z

.field final mParallelBroadcasts:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/BroadcastRecord;",
            ">;"
        }
    .end annotation
.end field

.field mPausingActivity:Lcom/android/server/am/HistoryRecord;

.field final mPendingActivityLaunches:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;",
            ">;"
        }
    .end annotation
.end field

.field mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

.field final mPendingResultRecords:Ljava/util/HashSet;

.field final mPendingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mPendingThumbnails:Ljava/util/ArrayList;

.field final mPersistentStartingProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mPidsSelfLocked:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mProcDeaths:[I

.field final mProcessCrashTimes:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Ljava/lang/Long;",
            ">;"
        }
    .end annotation
.end field

.field mProcessLimit:I

.field final mProcessNames:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProcessStats:Lcom/android/server/ProcessStats;

.field final mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

.field final mProcessStatsThread:Ljava/lang/Thread;

.field final mProcessesOnHold:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProcessesToGc:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProvidersByClass:Ljava/util/HashMap;

.field final mProvidersByName:Ljava/util/HashMap;

.field final mReceiverResolver:Lcom/android/server/IntentResolver;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/IntentResolver",
            "<",
            "Lcom/android/server/am/BroadcastFilter;",
            "Lcom/android/server/am/BroadcastFilter;",
            ">;"
        }
    .end annotation
.end field

.field final mRecentTasks:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/TaskRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mRegisteredReceivers:Ljava/util/HashMap;

.field final mRemovedProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mRequestPssCallback:Ljava/lang/Runnable;

.field final mRequestPssList:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mRestartingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field mResumedActivity:Lcom/android/server/am/HistoryRecord;

.field final mServiceConnections:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/os/IBinder;",
            "Lcom/android/server/am/ConnectionRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mServices:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/content/ComponentName;",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mServicesByIntent:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/content/Intent$FilterComparison;",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field mShuttingDown:Z

.field mSimpleProcessManagement:Z

.field mSleeping:Z

.field mStartRunning:Z

.field final mStartingProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStickyBroadcasts:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/Intent;",
            ">;>;"
        }
    .end annotation
.end field

.field final mStoppingActivities:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStoppingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStringBuilder:Ljava/lang/StringBuilder;

.field mSystemReady:Z

.field mSystemReadySeq:Ljava/lang/String;

.field mTopAction:Ljava/lang/String;

.field mTopComponent:Landroid/content/ComponentName;

.field mTopData:Ljava/lang/String;

.field mUidAlert:Landroid/app/AlertDialog;

.field final mUsageStatsService:Lcom/android/server/am/UsageStatsService;

.field mUserLeaving:Z

.field mWaitForDebugger:Z

.field final mWaitingActivityLaunched:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Landroid/app/IActivityManager$WaitResult;",
            ">;"
        }
    .end annotation
.end field

.field final mWaitingActivityVisible:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Landroid/app/IActivityManager$WaitResult;",
            ">;"
        }
    .end annotation
.end field

.field mWaitingUpdate:Z

.field final mWaitingVisibleActivities:Ljava/util/ArrayList;

.field final mWatchers:Landroid/os/RemoteCallbackList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/os/RemoteCallbackList",
            "<",
            "Landroid/app/IActivityWatcher;",
            ">;"
        }
    .end annotation
.end field

.field mWindowManager:Lcom/android/server/WindowManagerService;


# direct methods
.method static constructor <clinit>()V
    .locals 2

    .prologue
    .line 333
    const-string v0, "ro.FOREGROUND_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 335
    const-string v0, "ro.VISIBLE_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 337
    const-string v0, "ro.SECONDARY_SERVER_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    .line 339
    const-string v0, "ro.BACKUP_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    .line 341
    const-string v0, "ro.HOME_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    .line 343
    const-string v0, "ro.HIDDEN_APP_MIN_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 345
    const-string v0, "ro.EMPTY_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    .line 347
    sget v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    sput v0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    .line 348
    const-string v0, "ro.FOREGROUND_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_MEM:I

    .line 350
    const-string v0, "ro.VISIBLE_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_MEM:I

    .line 352
    const-string v0, "ro.SECONDARY_SERVER_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_MEM:I

    .line 354
    const-string v0, "ro.BACKUP_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_MEM:I

    .line 356
    const-string v0, "ro.HOME_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    .line 358
    const-string v0, "ro.HIDDEN_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MEM:I

    .line 360
    const-string v0, "ro.EMPTY_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_MEM:I

    .line 364
    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    .line 366
    const/4 v0, 0x0

    new-array v0, v0, [Ljava/lang/String;

    sput-object v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_STRING_ARRAY:[Ljava/lang/String;

    .line 765
    new-instance v0, Ljava/lang/ThreadLocal;

    invoke-direct {v0}, Ljava/lang/ThreadLocal;-><init>()V

    sput-object v0, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    return-void
.end method

.method private constructor <init>()V
    .locals 10

    .prologue
    const-wide/16 v8, 0x0

    const/4 v7, 0x1

    const/4 v5, 0x0

    const/4 v6, 0x0

    .line 1414
    invoke-direct {p0}, Landroid/app/ActivityManagerNative;-><init>()V

    .line 384
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    .line 398
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    .line 404
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    .line 410
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    .line 419
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    .line 427
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    .line 434
    const/16 v3, 0x64

    new-array v3, v3, [Lcom/android/server/am/BroadcastRecord;

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    .line 440
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    .line 446
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 452
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 457
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 462
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 469
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 476
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    .line 483
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    .line 490
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    .line 496
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    .line 504
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    .line 512
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    .line 518
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    .line 528
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    .line 537
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    .line 549
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    .line 557
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    .line 566
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    .line 573
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    .line 579
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    .line 588
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    .line 594
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    .line 608
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    .line 613
    new-instance v3, Ljava/util/HashSet;

    invoke-direct {v3}, Ljava/util/HashSet;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingResultRecords:Ljava/util/HashSet;

    .line 618
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    .line 628
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 635
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    .line 641
    new-instance v3, Lcom/android/server/am/ActivityManagerService$1;

    invoke-direct {v3, p0}, Lcom/android/server/am/ActivityManagerService$1;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    .line 661
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    .line 667
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    .line 673
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    .line 680
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    .line 689
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    .line 695
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    .line 701
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    .line 707
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 708
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 714
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    .line 720
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    .line 729
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    .line 736
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    .line 743
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    .line 748
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    .line 783
    new-instance v3, Landroid/content/res/Configuration;

    invoke-direct {v3}, Landroid/content/res/Configuration;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 789
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 811
    new-instance v3, Ljava/lang/StringBuilder;

    const/16 v4, 0x100

    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(I)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    .line 816
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 820
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    .line 821
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 822
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    .line 823
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    .line 825
    const-string v3, "SystemReadySeq = "

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 849
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 854
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    .line 877
    iput v7, p0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 882
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 887
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    .line 895
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 901
    const/16 v3, 0x14

    new-array v3, v3, [I

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    .line 909
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 910
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 911
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    .line 912
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    .line 913
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    .line 914
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 915
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 917
    new-instance v3, Landroid/os/RemoteCallbackList;

    invoke-direct {v3}, Landroid/os/RemoteCallbackList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    .line 929
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    .line 942
    new-instance v3, Lcom/android/server/ProcessStats;

    invoke-direct {v3, v6}, Lcom/android/server/ProcessStats;-><init>(Z)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    .line 944
    new-instance v3, Ljava/util/concurrent/atomic/AtomicLong;

    invoke-direct {v3, v8, v9}, Ljava/util/concurrent/atomic/AtomicLong;-><init>(J)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    .line 945
    new-instance v3, Ljava/util/concurrent/atomic/AtomicBoolean;

    invoke-direct {v3, v7}, Ljava/util/concurrent/atomic/AtomicBoolean;-><init>(Z)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

    .line 947
    iput-wide v8, p0, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    .line 949
    iput-wide v8, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    .line 954
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 956
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 1014
    new-instance v3, Lcom/android/server/am/ActivityManagerService$2;

    invoke-direct {v3, p0}, Lcom/android/server/am/ActivityManagerService$2;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    .line 1415
    const-string v3, "ANDROID_SIMPLE_PROCESS_MANAGEMENT"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 1416
    .local v2, v:Ljava/lang/String;
    if-eqz v2, :cond_0

    invoke-static {v2}, Ljava/lang/Integer;->getInteger(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    if-eqz v3, :cond_0

    .line 1417
    iput-boolean v7, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 1419
    :cond_0
    const-string v3, "ANDROID_DEBUG_APP"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 1420
    if-eqz v2, :cond_1

    .line 1421
    iput-boolean v7, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 1424
    :cond_1
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Memory class: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/app/ActivityManager;->staticGetMemoryClass()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 1426
    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;

    move-result-object v0

    .line 1427
    .local v0, dataDir:Ljava/io/File;
    new-instance v1, Ljava/io/File;

    const-string v3, "system"

    invoke-direct {v1, v0, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 1428
    .local v1, systemDir:Ljava/io/File;
    invoke-virtual {v1}, Ljava/io/File;->mkdirs()Z

    .line 1429
    new-instance v3, Lcom/android/server/am/BatteryStatsService;

    new-instance v4, Ljava/io/File;

    const-string v5, "batterystats.bin"

    invoke-direct {v4, v1, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/android/server/am/BatteryStatsService;-><init>(Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    .line 1431
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl;->readLocked()V

    .line 1432
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl;->writeLocked()V

    .line 1434
    new-instance v3, Lcom/android/server/am/UsageStatsService;

    new-instance v4, Ljava/io/File;

    const-string v5, "usagestats"

    invoke-direct {v4, v1, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/android/server/am/UsageStatsService;-><init>(Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    .line 1437
    const-string v3, "ro.opengles.version"

    invoke-static {v3, v6}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->GL_ES_VERSION:I

    .line 1440
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {v3}, Landroid/content/res/Configuration;->setToDefaults()V

    .line 1441
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-static {}, Ljava/util/Locale;->getDefault()Ljava/util/Locale;

    move-result-object v4

    iput-object v4, v3, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    .line 1442
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    invoke-virtual {v3}, Lcom/android/server/ProcessStats;->init()V

    .line 1445
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v3

    invoke-virtual {v3, p0}, Lcom/android/server/Watchdog;->addMonitor(Lcom/android/server/Watchdog$Monitor;)V

    .line 1447
    new-instance v3, Lcom/android/server/am/ActivityManagerService$3;

    const-string v4, "ProcessStats"

    invoke-direct {v3, p0, v4}, Lcom/android/server/am/ActivityManagerService$3;-><init>(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    .line 1475
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    invoke-virtual {v3}, Ljava/lang/Thread;->start()V

    .line 1476
    return-void
.end method

.method synthetic constructor <init>(Lcom/android/server/am/ActivityManagerService$1;)V
    .locals 0
    .parameter "x0"

    .prologue
    .line 129
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;-><init>()V

    return-void
.end method

.method static synthetic access$000(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V
    .locals 0
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"

    .prologue
    .line 129
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/am/ActivityManagerService;->appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    return-void
.end method

.method static synthetic access$100(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I
    .locals 1
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"
    .parameter "x4"
    .parameter "x5"
    .parameter "x6"
    .parameter "x7"
    .parameter "x8"
    .parameter "x9"
    .parameter "x10"
    .parameter "x11"
    .parameter "x12"
    .parameter "x13"

    .prologue
    .line 129
    invoke-direct/range {p0 .. p13}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v0

    return v0
.end method

.method static synthetic access$200(Lcom/android/server/am/ActivityManagerService;Z)V
    .locals 0
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    return-void
.end method

.method static synthetic access$300(Lcom/android/server/am/ActivityManagerService;)V
    .locals 0
    .parameter "x0"

    .prologue
    .line 129
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->broadcastTimeout()V

    return-void
.end method

.method static synthetic access$400(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/HistoryRecord;)Z
    .locals 1
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v0

    return v0
.end method

.method static synthetic access$500(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;)V
    .locals 0
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->processStartTimedOutLocked(Lcom/android/server/am/ProcessRecord;)V

    return-void
.end method

.method static synthetic access$600(Lcom/android/server/am/ActivityManagerService;Z)V
    .locals 0
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->doPendingActivityLaunchesLocked(Z)V

    return-void
.end method

.method static synthetic access$700(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;IZZZ)Z
    .locals 1
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"
    .parameter "x4"
    .parameter "x5"

    .prologue
    .line 129
    invoke-direct/range {p0 .. p5}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    move-result v0

    return v0
.end method

.method private final addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
    .locals 5
    .parameter "r"

    .prologue
    const/4 v4, 0x0

    .line 13081
    iget v0, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    if-gez v0, :cond_0

    .line 13089
    :goto_0
    return-void

    .line 13085
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    const/4 v2, 0x1

    const/16 v3, 0x63

    invoke-static {v0, v4, v1, v2, v3}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    .line 13087
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/BroadcastRecord;->finishTime:J

    .line 13088
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    aput-object p1, v0, v4

    goto :goto_0
.end method

.method private final addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V
    .locals 5
    .parameter "task"

    .prologue
    .line 3990
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 3991
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_3

    .line 3992
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/TaskRecord;

    .line 3993
    .local v2, tr:Lcom/android/server/am/TaskRecord;
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    if-eqz v3, :cond_0

    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    iget-object v4, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_1

    :cond_0
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v3, :cond_2

    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    iget-object v4, v2, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3, v4}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v3

    if-eqz v3, :cond_2

    .line 3995
    :cond_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 3996
    add-int/lit8 v1, v1, -0x1

    .line 3997
    add-int/lit8 v0, v0, -0x1

    .line 3998
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-nez v3, :cond_2

    .line 4001
    move-object p1, v2

    .line 3991
    :cond_2
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .line 4005
    .end local v2           #tr:Lcom/android/server/am/TaskRecord;
    :cond_3
    const/16 v3, 0x14

    if-lt v0, v3, :cond_4

    .line 4006
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    const/4 v4, 0x1

    sub-int v4, v0, v4

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4008
    :cond_4
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    const/4 v4, 0x0

    invoke-virtual {v3, v4, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 4009
    return-void
.end method

.method private final appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V
    .locals 10
    .parameter "app"
    .parameter "pid"
    .parameter "thread"

    .prologue
    .line 4721
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    const/4 v7, 0x0

    aget v8, v6, v7

    add-int/lit8 v8, v8, 0x1

    aput v8, v6, v7

    .line 4724
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v6, p2, :cond_8

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_8

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v6}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v6

    invoke-interface {p3}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    if-ne v6, v7, :cond_8

    .line 4726
    iget-boolean v6, p1, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    if-nez v6, :cond_0

    .line 4727
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Process "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ") has died."

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4730
    :cond_0
    const/16 v6, 0x753b

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    iget v9, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4734
    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-nez v6, :cond_3

    const/4 v6, 0x1

    move v0, v6

    .line 4735
    .local v0, doLowMem:Z
    :goto_0
    const/4 v6, 0x0

    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 4737
    if-eqz v0, :cond_7

    .line 4741
    const/4 v1, 0x0

    .line 4742
    .local v1, haveBg:Z
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v2, v6, v7

    .local v2, i:I
    :goto_1
    if-ltz v2, :cond_1

    .line 4743
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 4744
    .local v5, rec:Lcom/android/server/am/ProcessRecord;
    iget-object v6, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_4

    iget v6, v5, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_4

    .line 4745
    const/4 v1, 0x1

    .line 4750
    .end local v5           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_1
    if-nez v1, :cond_7

    .line 4751
    const-string v6, "ActivityManager"

    const-string v7, "Low Memory: No more background processes."

    invoke-static {v6, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4752
    const/16 v6, 0x7541

    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v7

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(II)I

    .line 4753
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    .line 4754
    .local v3, now:J
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v2, v6, v7

    :goto_2
    if-ltz v2, :cond_6

    .line 4755
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 4756
    .restart local v5       #rec:Lcom/android/server/am/ProcessRecord;
    if-eq v5, p1, :cond_2

    iget-object v6, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_2

    iget-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    const-wide/32 v8, 0xea60

    add-long/2addr v6, v8

    cmp-long v6, v6, v3

    if-gtz v6, :cond_2

    .line 4761
    iget v6, v5, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-gt v6, v7, :cond_5

    .line 4762
    const-wide/16 v6, 0x0

    iput-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    .line 4766
    :goto_3
    const/4 v6, 0x1

    iput-boolean v6, v5, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    .line 4767
    iput-wide v3, v5, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    .line 4768
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4769
    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 4754
    :cond_2
    add-int/lit8 v2, v2, -0x1

    goto :goto_2

    .line 4734
    .end local v0           #doLowMem:Z
    .end local v1           #haveBg:Z
    .end local v2           #i:I
    .end local v3           #now:J
    .end local v5           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_3
    const/4 v6, 0x0

    move v0, v6

    goto :goto_0

    .line 4742
    .restart local v0       #doLowMem:Z
    .restart local v1       #haveBg:Z
    .restart local v2       #i:I
    .restart local v5       #rec:Lcom/android/server/am/ProcessRecord;
    :cond_4
    add-int/lit8 v2, v2, -0x1

    goto :goto_1

    .line 4764
    .restart local v3       #now:J
    :cond_5
    iget-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    iput-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    goto :goto_3

    .line 4772
    .end local v5           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_6
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 4784
    .end local v0           #doLowMem:Z
    .end local v1           #haveBg:Z
    .end local v2           #i:I
    .end local v3           #now:J
    :cond_7
    :goto_4
    return-void

    .line 4775
    :cond_8
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eq v6, p2, :cond_7

    .line 4777
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Process "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ") has died and restarted (pid "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget v8, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ")."

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4779
    const/16 v6, 0x753b

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    iget v9, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_4
.end method

.method private final attachApplicationLocked(Landroid/app/IApplicationThread;I)Z
    .locals 32
    .parameter "thread"
    .parameter "pid"

    .prologue
    .line 5466
    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, p2

    move v1, v5

    if-eq v0, v1, :cond_0

    if-ltz p2, :cond_0

    .line 5467
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5

    .line 5468
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    move-object v0, v6

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Lcom/android/server/am/ProcessRecord;

    .line 5469
    .local v21, app:Lcom/android/server/am/ProcessRecord;
    monitor-exit v5
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5477
    :goto_0
    if-nez v21, :cond_3

    .line 5478
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "No pending application record for pid "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (IApplicationThread "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "); dropping process"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5480
    const/16 v5, 0x7551

    move v0, v5

    move/from16 v1, p2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(II)I

    .line 5481
    if-lez p2, :cond_2

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, p2

    move v1, v5

    if-eq v0, v1, :cond_2

    .line 5482
    invoke-static/range {p2 .. p2}, Landroid/os/Process;->killProcess(I)V

    .line 5490
    :goto_1
    const/4 v5, 0x0

    .line 5675
    :goto_2
    return v5

    .line 5469
    .end local v21           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v6

    :try_start_1
    monitor-exit v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v6

    .line 5470
    :cond_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_1

    .line 5471
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Lcom/android/server/am/ProcessRecord;

    .line 5472
    .restart local v21       #app:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v21

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Lcom/android/server/am/ProcessRecord;->setPid(I)V

    goto :goto_0

    .line 5474
    .end local v21           #app:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/16 v21, 0x0

    .restart local v21       #app:Lcom/android/server/am/ProcessRecord;
    goto :goto_0

    .line 5485
    :cond_2
    :try_start_2
    invoke-interface/range {p1 .. p1}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_2
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    goto :goto_1

    .line 5486
    :catch_0
    move-exception v5

    goto :goto_1

    .line 5495
    :cond_3
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v5, v0

    if-eqz v5, :cond_4

    .line 5496
    const/4 v5, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5504
    :cond_4
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    .line 5506
    .local v6, processName:Ljava/lang/String;
    :try_start_3
    invoke-interface/range {p1 .. p1}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    new-instance v7, Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;

    move-object v0, v7

    move-object/from16 v1, p0

    move-object/from16 v2, v21

    move/from16 v3, p2

    move-object/from16 v4, p1

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    const/4 v8, 0x0

    invoke-interface {v5, v7, v8}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_1

    .line 5514
    const/16 v5, 0x753a

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    move-object/from16 v0, v21

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v9, v0

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v9, v0

    aput-object v9, v7, v8

    invoke-static {v5, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 5516
    move-object/from16 v0, p1

    move-object/from16 v1, v21

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 5517
    const/16 v5, -0x64

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 5518
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 5519
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    .line 5520
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v21

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 5521
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v21

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 5522
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v21

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->debugging:Z

    .line 5524
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v7, 0x14

    move-object v0, v5

    move v1, v7

    move-object/from16 v2, v21

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5526
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v5, v0

    if-nez v5, :cond_5

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z

    move-result v5

    if-eqz v5, :cond_e

    :cond_5
    const/4 v5, 0x1

    move/from16 v29, v5

    .line 5527
    .local v29, normalMode:Z
    :goto_3
    if-eqz v29, :cond_f

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;

    move-result-object v5

    move-object v8, v5

    .line 5529
    .local v8, providers:Ljava/util/List;
    :goto_4
    if-nez v29, :cond_6

    .line 5530
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Launching preboot mode app: "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v5, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5537
    :cond_6
    const/4 v13, 0x0

    .line 5538
    .local v13, testMode:I
    :try_start_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_7

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_7

    .line 5539
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    move v5, v0

    if-eqz v5, :cond_10

    const/4 v5, 0x2

    move v13, v5

    .line 5542
    :goto_5
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v21

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->debugging:Z

    .line 5543
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v5, v0

    if-eqz v5, :cond_7

    .line 5544
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 5545
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v5, v0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 5550
    :cond_7
    const/16 v28, 0x0

    .line 5551
    .local v28, isRestrictedBackupMode:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    if-eqz v5, :cond_9

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_9

    .line 5552
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/BackupRecord;->backupMode:I

    const/4 v7, 0x2

    if-eq v5, v7, :cond_8

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/BackupRecord;->backupMode:I

    const/4 v7, 0x1

    if-ne v5, v7, :cond_11

    :cond_8
    const/4 v5, 0x1

    move/from16 v28, v5

    .line 5556
    :cond_9
    :goto_6
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    if-eqz v5, :cond_12

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    :goto_7
    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5559
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    if-eqz v5, :cond_a

    .line 5560
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5564
    :cond_a
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    if-eqz v5, :cond_13

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object v7, v5

    :goto_8
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v9, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    move-object v11, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    move-object v12, v0

    if-nez v28, :cond_b

    if-nez v29, :cond_14

    :cond_b
    const/4 v5, 0x1

    move v14, v5

    :goto_9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v15, v0

    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->getCommonServicesLocked()Ljava/util/HashMap;

    move-result-object v16

    move-object/from16 v5, p1

    invoke-interface/range {v5 .. v16}, Landroid/app/IApplicationThread;->bindApplication(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;Ljava/util/List;Landroid/content/ComponentName;Ljava/lang/String;Landroid/os/Bundle;Landroid/app/IInstrumentationWatcher;IZLandroid/content/res/Configuration;Ljava/util/Map;)V

    .line 5570
    const/4 v5, 0x0

    const/4 v7, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 5571
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v9

    move-wide v0, v9

    move-object/from16 v2, v21

    iput-wide v0, v2, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    move-wide v0, v9

    move-object/from16 v2, v21

    iput-wide v0, v2, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J
    :try_end_4
    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_2

    .line 5584
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5585
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5587
    const/16 v22, 0x0

    .line 5588
    .local v22, badApp:Z
    const/16 v24, 0x0

    .line 5591
    .local v24, didSomething:Z
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 5592
    .local v26, hr:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_c

    if-eqz v29, :cond_c

    .line 5593
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-nez v5, :cond_15

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v7, :cond_15

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v6, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_15

    .line 5596
    const/4 v5, 0x1

    const/4 v7, 0x1

    :try_start_5
    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object/from16 v2, v21

    move v3, v5

    move v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    :try_end_5
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_3

    move-result v5

    if-eqz v5, :cond_c

    .line 5597
    const/16 v24, 0x1

    .line 5610
    .end local v8           #providers:Ljava/util/List;
    :cond_c
    :goto_a
    if-nez v22, :cond_17

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_17

    .line 5611
    const/16 v30, 0x0

    .line 5613
    .local v30, sr:Lcom/android/server/am/ServiceRecord;
    const/16 v27, 0x0

    .local v27, i:I
    :goto_b
    :try_start_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    move/from16 v0, v27

    move v1, v5

    if-ge v0, v1, :cond_17

    .line 5614
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v31

    move-object/from16 v0, v31

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object/from16 v30, v0

    .line 5615
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v30

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object v7, v0

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v7, :cond_d

    move-object/from16 v0, v30

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v6, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
    :try_end_6
    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_4

    move-result v5

    if-nez v5, :cond_16

    .line 5613
    :cond_d
    :goto_c
    add-int/lit8 v27, v27, 0x1

    goto :goto_b

    .line 5508
    .end local v13           #testMode:I
    .end local v22           #badApp:Z
    .end local v24           #didSomething:Z
    .end local v26           #hr:Lcom/android/server/am/HistoryRecord;
    .end local v27           #i:I
    .end local v28           #isRestrictedBackupMode:Z
    .end local v29           #normalMode:Z
    .end local v30           #sr:Lcom/android/server/am/ServiceRecord;
    :catch_1
    move-exception v5

    move-object/from16 v25, v5

    .line 5509
    .local v25, e:Landroid/os/RemoteException;
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 5510
    const-string v5, "link fail"

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5511
    const/4 v5, 0x0

    goto/16 :goto_2

    .line 5526
    .end local v25           #e:Landroid/os/RemoteException;
    :cond_e
    const/4 v5, 0x0

    move/from16 v29, v5

    goto/16 :goto_3

    .line 5527
    .restart local v29       #normalMode:Z
    :cond_f
    const/4 v5, 0x0

    move-object v8, v5

    goto/16 :goto_4

    .line 5539
    .restart local v8       #providers:Ljava/util/List;
    .restart local v13       #testMode:I
    :cond_10
    const/4 v5, 0x1

    move v13, v5

    goto/16 :goto_5

    .line 5552
    .restart local v28       #isRestrictedBackupMode:Z
    :cond_11
    const/4 v5, 0x0

    move/from16 v28, v5

    goto/16 :goto_6

    .line 5556
    :cond_12
    :try_start_7
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    goto/16 :goto_7

    .line 5564
    :cond_13
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0
    :try_end_7
    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_7} :catch_2

    move-object v7, v5

    goto/16 :goto_8

    :cond_14
    const/4 v5, 0x0

    move v14, v5

    goto/16 :goto_9

    .line 5572
    .end local v28           #isRestrictedBackupMode:Z
    :catch_2
    move-exception v5

    move-object/from16 v25, v5

    .line 5576
    .local v25, e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v7, "Exception thrown during bind!"

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5578
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 5579
    const-string v5, "bind fail"

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5580
    const/4 v5, 0x0

    goto/16 :goto_2

    .line 5599
    .end local v25           #e:Ljava/lang/Exception;
    .restart local v22       #badApp:Z
    .restart local v24       #didSomething:Z
    .restart local v26       #hr:Lcom/android/server/am/HistoryRecord;
    .restart local v28       #isRestrictedBackupMode:Z
    :catch_3
    move-exception v25

    .line 5600
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception in new application when starting activity "

    .end local v8           #providers:Ljava/util/List;
    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v8, v0

    invoke-virtual {v8}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    invoke-virtual {v8}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5602
    const/16 v22, 0x1

    .line 5603
    goto/16 :goto_a

    .line 5605
    .end local v25           #e:Ljava/lang/Exception;
    .restart local v8       #providers:Ljava/util/List;
    :cond_15
    const/4 v5, 0x0

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    move-object v3, v6

    move v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    goto/16 :goto_a

    .line 5620
    .end local v8           #providers:Ljava/util/List;
    .restart local v27       #i:I
    .restart local v30       #sr:Lcom/android/server/am/ServiceRecord;
    :cond_16
    :try_start_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5621
    add-int/lit8 v27, v27, -0x1

    .line 5622
    move-object/from16 v0, p0

    move-object/from16 v1, v30

    move-object/from16 v2, v21

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_8
    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_8} :catch_4

    .line 5623
    const/16 v24, 0x1

    goto/16 :goto_c

    .line 5625
    :catch_4
    move-exception v5

    move-object/from16 v25, v5

    .line 5626
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #processName:Ljava/lang/String;
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception in new application when starting service "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v30

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5628
    const/16 v22, 0x1

    .line 5633
    .end local v25           #e:Ljava/lang/Exception;
    .end local v27           #i:I
    .end local v30           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_17
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v23, v0

    .line 5634
    .local v23, br:Lcom/android/server/am/BroadcastRecord;
    if-nez v22, :cond_18

    if-eqz v23, :cond_18

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v21

    if-ne v0, v1, :cond_18

    .line 5636
    const/4 v5, 0x0

    :try_start_9
    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 5637
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    move-object/from16 v2, v21

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_9
    .catch Ljava/lang/Exception; {:try_start_9 .. :try_end_9} :catch_5

    .line 5638
    const/16 v24, 0x1

    .line 5653
    :cond_18
    :goto_d
    if-nez v22, :cond_19

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    if-eqz v5, :cond_19

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v6, :cond_19

    .line 5655
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5657
    :try_start_a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v6, v0

    iget v6, v6, Lcom/android/server/am/BackupRecord;->backupMode:I

    move-object/from16 v0, p1

    move-object v1, v5

    move v2, v6

    invoke-interface {v0, v1, v2}, Landroid/app/IApplicationThread;->scheduleCreateBackupAgent(Landroid/content/pm/ApplicationInfo;I)V
    :try_end_a
    .catch Ljava/lang/Exception; {:try_start_a .. :try_end_a} :catch_6

    .line 5664
    :cond_19
    :goto_e
    if-eqz v22, :cond_1a

    .line 5667
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5668
    const/4 v5, 0x0

    goto/16 :goto_2

    .line 5639
    :catch_5
    move-exception v5

    move-object/from16 v25, v5

    .line 5640
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception in new application when starting receiver "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v7}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5642
    const/16 v22, 0x1

    .line 5643
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 5644
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v15, v0

    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move/from16 v16, v0

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object/from16 v17, v0

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object/from16 v18, v0

    move-object/from16 v0, v23

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move/from16 v19, v0

    const/16 v20, 0x1

    move-object/from16 v14, p0

    invoke-direct/range {v14 .. v20}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 5646
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 5648
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v23

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    goto/16 :goto_d

    .line 5658
    .end local v25           #e:Ljava/lang/Exception;
    :catch_6
    move-exception v5

    move-object/from16 v25, v5

    .line 5659
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v6, "Exception scheduling backup agent creation: "

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5660
    invoke-virtual/range {v25 .. v25}, Ljava/lang/Exception;->printStackTrace()V

    goto :goto_e

    .line 5671
    .end local v25           #e:Ljava/lang/Exception;
    :cond_1a
    if-nez v24, :cond_1b

    .line 5672
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 5675
    :cond_1b
    const/4 v5, 0x1

    goto/16 :goto_2
.end method

.method private final bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .locals 12
    .parameter "r"
    .parameter "force"

    .prologue
    .line 11289
    if-nez p2, :cond_1

    iget-boolean v8, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v8, :cond_1

    .line 11404
    :cond_0
    :goto_0
    return-void

    .line 11292
    :cond_1
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    if-lez v8, :cond_4

    .line 11293
    if-nez p2, :cond_3

    .line 11296
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 11297
    .local v6, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_2
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_3

    .line 11298
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ConnectionRecord;

    .line 11299
    .local v2, cr:Lcom/android/server/am/ConnectionRecord;
    iget v8, v2, Lcom/android/server/am/ConnectionRecord;->flags:I

    and-int/lit8 v8, v8, 0x1

    if-eqz v8, :cond_2

    goto :goto_0

    .line 11307
    .end local v2           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_3
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 11308
    .restart local v6       #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_1
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_4

    .line 11309
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ConnectionRecord;

    .line 11312
    .local v1, c:Lcom/android/server/am/ConnectionRecord;
    :try_start_0
    iget-object v8, v1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    const/4 v10, 0x0

    invoke-interface {v8, v9, v10}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_1

    .line 11313
    :catch_0
    move-exception v8

    move-object v3, v8

    .line 11314
    .local v3, e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failure disconnecting service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " to connection "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v10}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (in "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v10, v10, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ")"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1

    .line 11322
    .end local v1           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #e:Ljava/lang/Exception;
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_4
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    if-lez v8, :cond_6

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_6

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_6

    .line 11323
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v7

    .line 11324
    .local v7, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_5
    :goto_2
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_6

    .line 11325
    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/IntentBindRecord;

    .line 11328
    .local v5, ibr:Lcom/android/server/am/IntentBindRecord;
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_5

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_5

    iget-boolean v8, v5, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    if-eqz v8, :cond_5

    .line 11330
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11331
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11332
    const/4 v8, 0x0

    iput-boolean v8, v5, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 11333
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v9, v5, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v9}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v9

    invoke-interface {v8, p1, v9}, Landroid/app/IApplicationThread;->scheduleUnbindService(Landroid/os/IBinder;Landroid/content/Intent;)V
    :try_end_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1

    goto :goto_2

    .line 11335
    :catch_1
    move-exception v8

    move-object v3, v8

    .line 11336
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Exception when unbinding service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11338
    const/4 v8, 0x1

    invoke-virtual {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_2

    .line 11346
    .end local v3           #e:Ljava/lang/Exception;
    .end local v5           #ibr:Lcom/android/server/am/IntentBindRecord;
    .end local v7           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_6
    const/16 v8, 0x754f

    const/4 v9, 0x3

    new-array v9, v9, [Ljava/lang/Object;

    const/4 v10, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v11

    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    const/4 v10, 0x1

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v11, v9, v10

    const/4 v10, 0x2

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v11, :cond_8

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v11, v11, Lcom/android/server/am/ProcessRecord;->pid:I

    :goto_3
    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    invoke-static {v8, v9}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 11350
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11351
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11353
    const/4 v8, 0x0

    iput v8, p1, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    .line 11354
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    .line 11357
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 11358
    .local v0, N:I
    const/4 v4, 0x0

    .local v4, i:I
    :goto_4
    if-ge v4, v0, :cond_9

    .line 11359
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    if-ne v8, p1, :cond_7

    .line 11360
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 11363
    add-int/lit8 v4, v4, -0x1

    .line 11364
    add-int/lit8 v0, v0, -0x1

    .line 11358
    :cond_7
    add-int/lit8 v4, v4, 0x1

    goto :goto_4

    .line 11346
    .end local v0           #N:I
    .end local v4           #i:I
    :cond_8
    const/4 v11, -0x1

    goto :goto_3

    .line 11368
    .restart local v0       #N:I
    .restart local v4       #i:I
    :cond_9
    invoke-virtual {p1}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11369
    const/4 v8, 0x0

    iput-boolean v8, p1, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    .line 11370
    const/4 v8, 0x0

    iput v8, p1, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    .line 11371
    const/4 v8, 0x0

    iput-object v8, p1, Lcom/android/server/am/ServiceRecord;->foregroundNoti:Landroid/app/Notification;

    .line 11374
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->clear()V

    .line 11375
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->clear()V

    .line 11377
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_0

    .line 11378
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v8}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v8

    monitor-enter v8

    .line 11379
    :try_start_2
    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v9}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopLaunchedLocked()V

    .line 11380
    monitor-exit v8
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 11381
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v8, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11382
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_0

    .line 11386
    :try_start_3
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11387
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11388
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11389
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v8, p1}, Landroid/app/IApplicationThread;->scheduleStopService(Landroid/os/IBinder;)V
    :try_end_3
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_2

    .line 11395
    :goto_5
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v9, 0x0

    invoke-virtual {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    goto/16 :goto_0

    .line 11380
    :catchall_0
    move-exception v9

    :try_start_4
    monitor-exit v8
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v9

    .line 11390
    :catch_2
    move-exception v8

    move-object v3, v8

    .line 11391
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Exception when stopping service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11393
    const/4 v8, 0x1

    invoke-virtual {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_5
.end method

.method private final bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z
    .locals 10
    .parameter "r"
    .parameter "intentFlags"
    .parameter "whileRestarting"

    .prologue
    .line 11234
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_0

    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_0

    .line 11235
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11236
    const/4 v0, 0x1

    .line 11281
    :goto_0
    return v0

    .line 11239
    :cond_0
    if-nez p3, :cond_1

    iget-wide v2, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v4, 0x0

    cmp-long v0, v2, v4

    if-lez v0, :cond_1

    .line 11241
    const/4 v0, 0x1

    goto :goto_0

    .line 11249
    :cond_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 11251
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    .line 11252
    .local v1, appName:Ljava/lang/String;
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v1, v0}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 11253
    .local v8, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v8, :cond_2

    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_2

    .line 11255
    :try_start_0
    invoke-direct {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 11256
    const/4 v0, 0x1

    goto :goto_0

    .line 11257
    :catch_0
    move-exception v9

    .line 11258
    .local v9, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Exception when starting service "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11267
    .end local v9           #e:Landroid/os/RemoteException;
    :cond_2
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v3, 0x1

    const-string v5, "service"

    iget-object v6, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    const/4 v7, 0x0

    move-object v0, p0

    move v4, p2

    invoke-direct/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    if-nez v0, :cond_3

    .line 11269
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    .end local v1           #appName:Ljava/lang/String;
    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to launch app "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, "/"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " for service "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v2}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ": process is bad"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11273
    const/4 v0, 0x1

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11274
    const/4 v0, 0x0

    goto/16 :goto_0

    .line 11277
    .restart local v1       #appName:Ljava/lang/String;
    :cond_3
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_4

    .line 11278
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11281
    :cond_4
    const/4 v0, 0x1

    goto/16 :goto_0
.end method

.method private final broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I
    .locals 61
    .parameter "callerApp"
    .parameter "callerPackage"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "ordered"
    .parameter "sticky"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    .line 12384
    new-instance v44, Landroid/content/Intent;

    move-object/from16 v0, v44

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 12389
    .end local p3
    .local v44, intent:Landroid/content/Intent;
    if-eqz p5, :cond_0

    if-nez p10, :cond_0

    .line 12390
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v44

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " not ordered but result callback requested!"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12396
    :cond_0
    const-string v5, "android.intent.action.UID_REMOVED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v60

    .line 12398
    .local v60, uidRemoved:Z
    const-string v5, "android.intent.action.PACKAGE_REMOVED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_1

    const-string v5, "android.intent.action.PACKAGE_CHANGED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_1

    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_UNAVAILABLE"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_1

    if-eqz v60, :cond_2

    .line 12402
    :cond_1
    const-string v5, "android.permission.BROADCAST_PACKAGE_REMOVED"

    const/4 v6, -0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, p12

    move/from16 v3, p13

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v5

    if-nez v5, :cond_a

    .line 12406
    if-eqz v60, :cond_6

    .line 12407
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getExtras()Landroid/os/Bundle;

    move-result-object v45

    .line 12408
    .local v45, intentExtras:Landroid/os/Bundle;
    if-eqz v45, :cond_5

    const-string v5, "android.intent.extra.UID"

    move-object/from16 v0, v45

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I

    move-result v5

    move/from16 v59, v5

    .line 12410
    .local v59, uid:I
    :goto_0
    if-ltz v59, :cond_2

    .line 12411
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v37

    .line 12412
    .local v37, bs:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v37

    .line 12413
    :try_start_0
    move-object/from16 v0, v37

    move/from16 v1, v59

    invoke-virtual {v0, v1}, Lcom/android/internal/os/BatteryStatsImpl;->removeUidStatsLocked(I)V

    .line 12414
    monitor-exit v37
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12459
    .end local v37           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v45           #intentExtras:Landroid/os/Bundle;
    .end local v59           #uid:I
    :cond_2
    :goto_1
    const-string v5, "android.intent.action.TIMEZONE_CHANGED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_3

    .line 12460
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0xd

    invoke-virtual {v5, v6}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 12467
    :cond_3
    const/16 v5, 0x3e8

    move/from16 v0, p13

    move v1, v5

    if-eq v0, v1, :cond_4

    const/16 v5, 0x3e9

    move/from16 v0, p13

    move v1, v5

    if-eq v0, v1, :cond_4

    const/16 v5, 0x7d0

    move/from16 v0, p13

    move v1, v5

    if-eq v0, v1, :cond_4

    if-nez p13, :cond_b

    .line 12487
    :cond_4
    if-eqz p11, :cond_12

    .line 12488
    const-string v5, "android.permission.BROADCAST_STICKY"

    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, p12

    move/from16 v3, p13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkPermission(Ljava/lang/String;II)I

    move-result v5

    if-eqz v5, :cond_d

    .line 12491
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: broadcastIntent() requesting a sticky broadcast from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.BROADCAST_STICKY"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v51

    .line 12494
    .local v51, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12495
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12408
    .end local v51           #msg:Ljava/lang/String;
    .restart local v45       #intentExtras:Landroid/os/Bundle;
    :cond_5
    const/4 v5, -0x1

    move/from16 v59, v5

    goto/16 :goto_0

    .line 12414
    .restart local v37       #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v59       #uid:I
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit v37
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5

    .line 12419
    .end local v37           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v45           #intentExtras:Landroid/os/Bundle;
    .end local v59           #uid:I
    :cond_6
    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_UNAVAILABLE"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_8

    .line 12420
    const-string v5, "android.intent.extra.changed_package_list"

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->getStringArrayExtra(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v49

    .line 12421
    .local v49, list:[Ljava/lang/String;
    if-eqz v49, :cond_2

    move-object/from16 v0, v49

    array-length v0, v0

    move v5, v0

    if-lez v5, :cond_2

    .line 12422
    move-object/from16 v36, v49

    .local v36, arr$:[Ljava/lang/String;
    move-object/from16 v0, v36

    array-length v0, v0

    move/from16 v48, v0

    .local v48, len$:I
    const/16 v43, 0x0

    .local v43, i$:I
    :goto_2
    move/from16 v0, v43

    move/from16 v1, v48

    if-ge v0, v1, :cond_7

    aget-object v6, v36, v43

    .line 12423
    .local v6, pkg:Ljava/lang/String;
    const/4 v7, -0x1

    const/4 v8, 0x0

    const/4 v9, 0x1

    const/4 v10, 0x1

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 12422
    add-int/lit8 v43, v43, 0x1

    goto :goto_2

    .line 12425
    .end local v6           #pkg:Ljava/lang/String;
    :cond_7
    const/4 v5, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, v49

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->sendPackageBroadcastLocked(I[Ljava/lang/String;)V

    goto/16 :goto_1

    .line 12429
    .end local v36           #arr$:[Ljava/lang/String;
    .end local v43           #i$:I
    .end local v48           #len$:I
    .end local v49           #list:[Ljava/lang/String;
    :cond_8
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v40

    .line 12431
    .local v40, data:Landroid/net/Uri;
    if-eqz v40, :cond_2

    invoke-virtual/range {v40 .. v40}, Landroid/net/Uri;->getSchemeSpecificPart()Ljava/lang/String;

    move-result-object v8

    .local v8, ssp:Ljava/lang/String;
    if-eqz v8, :cond_2

    .line 12432
    const-string v5, "android.intent.extra.DONT_KILL_APP"

    const/4 v6, 0x0

    move-object/from16 v0, v44

    move-object v1, v5

    move v2, v6

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->getBooleanExtra(Ljava/lang/String;Z)Z

    move-result v5

    if-nez v5, :cond_9

    .line 12433
    const-string v5, "android.intent.extra.UID"

    const/4 v6, -0x1

    move-object/from16 v0, v44

    move-object v1, v5

    move v2, v6

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I

    move-result v9

    const/4 v10, 0x0

    const/4 v11, 0x1

    const/4 v12, 0x1

    move-object/from16 v7, p0

    invoke-direct/range {v7 .. v12}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 12436
    :cond_9
    const-string v5, "android.intent.action.PACKAGE_REMOVED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2

    .line 12437
    const/4 v5, 0x0

    const/4 v6, 0x1

    new-array v6, v6, [Ljava/lang/String;

    const/4 v7, 0x0

    aput-object v8, v6, v7

    move-object/from16 v0, p0

    move v1, v5

    move-object v2, v6

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->sendPackageBroadcastLocked(I[Ljava/lang/String;)V

    goto/16 :goto_1

    .line 12444
    .end local v8           #ssp:Ljava/lang/String;
    .end local v40           #data:Landroid/net/Uri;
    :cond_a
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " broadcast from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.BROADCAST_PACKAGE_REMOVED"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v51

    .line 12449
    .restart local v51       #msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12450
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12470
    .end local v51           #msg:Ljava/lang/String;
    :cond_b
    if-eqz p1, :cond_c

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v5, v0

    if-nez v5, :cond_4

    .line 12472
    :cond_c
    :try_start_2
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-interface {v5, v6}, Landroid/content/pm/IPackageManager;->isProtectedBroadcast(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_4

    .line 12474
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: not allowed to send broadcast "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v51

    .line 12477
    .restart local v51       #msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12478
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 12480
    .end local v51           #msg:Ljava/lang/String;
    :catch_0
    move-exception v5

    move-object/from16 v41, v5

    .line 12481
    .local v41, e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    const-string v6, "Remote exception"

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v41

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 12482
    const/4 v5, 0x0

    .line 12694
    .end local v41           #e:Landroid/os/RemoteException;
    .end local p1
    :goto_3
    return v5

    .line 12497
    .restart local p1
    :cond_d
    if-eqz p9, :cond_e

    .line 12498
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Can\'t broadcast sticky intent "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v44

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " and enforce permission "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p9

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12500
    const/4 v5, -0x1

    goto :goto_3

    .line 12502
    :cond_e
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    if-eqz v5, :cond_f

    .line 12503
    new-instance v5, Ljava/lang/SecurityException;

    const-string v6, "Sticky broadcasts can\'t target a specific component"

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12506
    :cond_f
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v50

    check-cast v50, Ljava/util/ArrayList;

    .line 12507
    .local v50, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-nez v50, :cond_10

    .line 12508
    new-instance v50, Ljava/util/ArrayList;

    .end local v50           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    invoke-direct/range {v50 .. v50}, Ljava/util/ArrayList;-><init>()V

    .line 12509
    .restart local v50       #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v50

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12511
    :cond_10
    invoke-virtual/range {v50 .. v50}, Ljava/util/ArrayList;->size()I

    move-result v32

    .line 12513
    .local v32, N:I
    const/16 v42, 0x0

    .local v42, i:I
    :goto_4
    move/from16 v0, v42

    move/from16 v1, v32

    if-ge v0, v1, :cond_11

    .line 12514
    move-object/from16 v0, v50

    move/from16 v1, v42

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    check-cast p3, Landroid/content/Intent;

    move-object/from16 v0, v44

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-eqz v5, :cond_1a

    .line 12516
    new-instance v5, Landroid/content/Intent;

    move-object v0, v5

    move-object/from16 v1, v44

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v50

    move/from16 v1, v42

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 12520
    :cond_11
    move/from16 v0, v42

    move/from16 v1, v32

    if-lt v0, v1, :cond_12

    .line 12521
    new-instance v5, Landroid/content/Intent;

    move-object v0, v5

    move-object/from16 v1, v44

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v50

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12526
    .end local v32           #N:I
    .end local v42           #i:I
    .end local v50           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_12
    const/16 v24, 0x0

    .line 12527
    .local v24, receivers:Ljava/util/List;
    const/16 v16, 0x0

    .line 12529
    .local v16, registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    :try_start_3
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    if-eqz v5, :cond_1b

    .line 12531
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v6

    const/16 v7, 0x400

    invoke-interface {v5, v6, v7}, Landroid/content/pm/IPackageManager;->getReceiverInfo(Landroid/content/ComponentName;I)Landroid/content/pm/ActivityInfo;

    move-result-object v35

    .line 12533
    .local v35, ai:Landroid/content/pm/ActivityInfo;
    if-eqz v35, :cond_13

    .line 12534
    new-instance v53, Ljava/util/ArrayList;

    invoke-direct/range {v53 .. v53}, Ljava/util/ArrayList;-><init>()V
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_1

    .line 12535
    .end local v24           #receivers:Ljava/util/List;
    .local v53, receivers:Ljava/util/List;
    :try_start_4
    new-instance v56, Landroid/content/pm/ResolveInfo;

    invoke-direct/range {v56 .. v56}, Landroid/content/pm/ResolveInfo;-><init>()V

    .line 12536
    .local v56, ri:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v35

    move-object/from16 v1, v56

    iput-object v0, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 12537
    move-object/from16 v0, v53

    move-object/from16 v1, v56

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_4
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_2

    move-object/from16 v24, v53

    .line 12553
    .end local v35           #ai:Landroid/content/pm/ActivityInfo;
    .end local v53           #receivers:Ljava/util/List;
    .end local v56           #ri:Landroid/content/pm/ResolveInfo;
    .restart local v24       #receivers:Ljava/util/List;
    :cond_13
    :goto_5
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v6, 0x2000

    and-int/2addr v5, v6

    if-eqz v5, :cond_1d

    const/4 v5, 0x1

    move/from16 v54, v5

    .line 12559
    .local v54, replacePending:Z
    :goto_6
    if-eqz v16, :cond_1e

    invoke-interface/range {v16 .. v16}, Ljava/util/List;->size()I

    move-result v5

    move/from16 v33, v5

    .line 12560
    .local v33, NR:I
    :goto_7
    if-nez p10, :cond_16

    if-lez v33, :cond_16

    .line 12564
    new-instance v9, Lcom/android/server/am/BroadcastRecord;

    const/16 v23, 0x0

    move-object/from16 v10, v44

    move-object/from16 v11, p1

    move-object/from16 v12, p2

    move/from16 v13, p12

    move/from16 v14, p13

    move-object/from16 v15, p9

    move-object/from16 v17, p5

    move/from16 v18, p6

    move-object/from16 v19, p7

    move-object/from16 v20, p8

    move/from16 v21, p10

    move/from16 v22, p11

    invoke-direct/range {v9 .. v23}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;ZZZ)V

    .line 12571
    .local v9, r:Lcom/android/server/am/BroadcastRecord;
    const/16 v55, 0x0

    .line 12572
    .local v55, replaced:Z
    if-eqz v54, :cond_14

    .line 12573
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v42, v5, v6

    .restart local v42       #i:I
    :goto_8
    if-ltz v42, :cond_14

    .line 12574
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    check-cast p3, Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-eqz v5, :cond_1f

    .line 12577
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 12578
    const/16 v55, 0x1

    .line 12583
    .end local v42           #i:I
    :cond_14
    if-nez v55, :cond_15

    .line 12584
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12585
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12587
    :cond_15
    const/16 v16, 0x0

    .line 12588
    const/16 v33, 0x0

    .line 12592
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v55           #replaced:Z
    :cond_16
    const/16 v46, 0x0

    .line 12593
    .local v46, ir:I
    if-eqz v24, :cond_27

    .line 12600
    const/16 v58, 0x0

    .line 12601
    .local v58, skipPackages:[Ljava/lang/String;
    const-string v5, "android.intent.action.PACKAGE_ADDED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_17

    const-string v5, "android.intent.action.PACKAGE_RESTARTED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_17

    const-string v5, "android.intent.action.PACKAGE_DATA_CLEARED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_20

    .line 12604
    :cond_17
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v40

    .line 12605
    .restart local v40       #data:Landroid/net/Uri;
    if-eqz v40, :cond_18

    .line 12606
    invoke-virtual/range {v40 .. v40}, Landroid/net/Uri;->getSchemeSpecificPart()Ljava/lang/String;

    move-result-object v52

    .line 12607
    .local v52, pkgName:Ljava/lang/String;
    if-eqz v52, :cond_18

    .line 12608
    const/4 v5, 0x1

    move v0, v5

    new-array v0, v0, [Ljava/lang/String;

    move-object/from16 v58, v0

    .end local v58           #skipPackages:[Ljava/lang/String;
    const/4 v5, 0x0

    aput-object v52, v58, v5

    .line 12614
    .end local v40           #data:Landroid/net/Uri;
    .end local v52           #pkgName:Ljava/lang/String;
    .restart local v58       #skipPackages:[Ljava/lang/String;
    :cond_18
    :goto_9
    if-eqz v58, :cond_22

    move-object/from16 v0, v58

    array-length v0, v0

    move v5, v0

    if-lez v5, :cond_22

    .line 12615
    move-object/from16 v36, v58

    .restart local v36       #arr$:[Ljava/lang/String;
    move-object/from16 v0, v36

    array-length v0, v0

    move/from16 v48, v0

    .restart local v48       #len$:I
    const/16 v43, 0x0

    .restart local v43       #i$:I
    :goto_a
    move/from16 v0, v43

    move/from16 v1, v48

    if-ge v0, v1, :cond_22

    aget-object v57, v36, v43

    .line 12616
    .local v57, skipPackage:Ljava/lang/String;
    if-eqz v57, :cond_21

    .line 12617
    invoke-interface/range {v24 .. v24}, Ljava/util/List;->size()I

    move-result v34

    .line 12618
    .local v34, NT:I
    const/16 v47, 0x0

    .local v47, it:I
    :goto_b
    move/from16 v0, v47

    move/from16 v1, v34

    if-ge v0, v1, :cond_21

    .line 12619
    move-object/from16 v0, v24

    move/from16 v1, v47

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v39

    check-cast v39, Landroid/content/pm/ResolveInfo;

    .line 12620
    .local v39, curt:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v39

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object v0, v5

    move-object/from16 v1, v57

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_19

    .line 12621
    move-object/from16 v0, v24

    move/from16 v1, v47

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 12622
    add-int/lit8 v47, v47, -0x1

    .line 12623
    add-int/lit8 v34, v34, -0x1

    .line 12618
    :cond_19
    add-int/lit8 v47, v47, 0x1

    goto :goto_b

    .line 12513
    .end local v16           #registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    .end local v24           #receivers:Ljava/util/List;
    .end local v33           #NR:I
    .end local v34           #NT:I
    .end local v36           #arr$:[Ljava/lang/String;
    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    .end local v43           #i$:I
    .end local v46           #ir:I
    .end local v47           #it:I
    .end local v48           #len$:I
    .end local v54           #replacePending:Z
    .end local v57           #skipPackage:Ljava/lang/String;
    .end local v58           #skipPackages:[Ljava/lang/String;
    .restart local v32       #N:I
    .restart local v42       #i:I
    .restart local v50       #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_1a
    add-int/lit8 v42, v42, 0x1

    goto/16 :goto_4

    .line 12541
    .end local v32           #N:I
    .end local v42           #i:I
    .end local v50           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    .restart local v16       #registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    .restart local v24       #receivers:Ljava/util/List;
    :cond_1b
    :try_start_5
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v6, 0x4000

    and-int/2addr v5, v6

    if-nez v5, :cond_1c

    .line 12543
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    const/16 v6, 0x400

    move-object v0, v5

    move-object/from16 v1, v44

    move-object/from16 v2, p4

    move v3, v6

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->queryIntentReceivers(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v24

    .line 12547
    :cond_1c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v5, v0

    const/4 v6, 0x0

    move-object v0, v5

    move-object/from16 v1, v44

    move-object/from16 v2, p4

    move v3, v6

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/IntentResolver;->queryIntent(Landroid/content/Intent;Ljava/lang/String;Z)Ljava/util/List;
    :try_end_5
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_1

    move-result-object v16

    goto/16 :goto_5

    .line 12553
    :cond_1d
    const/4 v5, 0x0

    move/from16 v54, v5

    goto/16 :goto_6

    .line 12559
    .restart local v54       #replacePending:Z
    :cond_1e
    const/4 v5, 0x0

    move/from16 v33, v5

    goto/16 :goto_7

    .line 12573
    .restart local v9       #r:Lcom/android/server/am/BroadcastRecord;
    .restart local v33       #NR:I
    .restart local v42       #i:I
    .restart local v55       #replaced:Z
    :cond_1f
    add-int/lit8 v42, v42, -0x1

    goto/16 :goto_8

    .line 12611
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v42           #i:I
    .end local v55           #replaced:Z
    .restart local v46       #ir:I
    .restart local v58       #skipPackages:[Ljava/lang/String;
    :cond_20
    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_AVAILABLE"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_18

    .line 12612
    const-string v5, "android.intent.extra.changed_package_list"

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->getStringArrayExtra(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v58

    goto/16 :goto_9

    .line 12615
    .restart local v36       #arr$:[Ljava/lang/String;
    .restart local v43       #i$:I
    .restart local v48       #len$:I
    .restart local v57       #skipPackage:Ljava/lang/String;
    :cond_21
    add-int/lit8 v43, v43, 0x1

    goto/16 :goto_a

    .line 12630
    .end local v36           #arr$:[Ljava/lang/String;
    .end local v43           #i$:I
    .end local v48           #len$:I
    .end local v57           #skipPackage:Ljava/lang/String;
    :cond_22
    if-eqz v24, :cond_25

    invoke-interface/range {v24 .. v24}, Ljava/util/List;->size()I

    move-result v5

    move/from16 v34, v5

    .line 12631
    .restart local v34       #NT:I
    :goto_c
    const/16 v47, 0x0

    .line 12632
    .restart local v47       #it:I
    const/16 v39, 0x0

    .line 12633
    .restart local v39       #curt:Landroid/content/pm/ResolveInfo;
    const/16 v38, 0x0

    .line 12634
    .local v38, curr:Lcom/android/server/am/BroadcastFilter;
    :goto_d
    move/from16 v0, v47

    move/from16 v1, v34

    if-ge v0, v1, :cond_27

    move/from16 v0, v46

    move/from16 v1, v33

    if-ge v0, v1, :cond_27

    .line 12635
    if-nez v39, :cond_23

    .line 12636
    move-object/from16 v0, v24

    move/from16 v1, v47

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v39

    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    check-cast v39, Landroid/content/pm/ResolveInfo;

    .line 12638
    .restart local v39       #curt:Landroid/content/pm/ResolveInfo;
    :cond_23
    if-nez v38, :cond_24

    .line 12639
    move-object/from16 v0, v16

    move/from16 v1, v46

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v38

    .end local v38           #curr:Lcom/android/server/am/BroadcastFilter;
    check-cast v38, Lcom/android/server/am/BroadcastFilter;

    .line 12641
    .restart local v38       #curr:Lcom/android/server/am/BroadcastFilter;
    :cond_24
    invoke-virtual/range {v38 .. v38}, Lcom/android/server/am/BroadcastFilter;->getPriority()I

    move-result v5

    move-object/from16 v0, v39

    iget v0, v0, Landroid/content/pm/ResolveInfo;->priority:I

    move v6, v0

    if-lt v5, v6, :cond_26

    .line 12643
    move-object/from16 v0, v24

    move/from16 v1, v47

    move-object/from16 v2, v38

    invoke-interface {v0, v1, v2}, Ljava/util/List;->add(ILjava/lang/Object;)V

    .line 12644
    add-int/lit8 v46, v46, 0x1

    .line 12645
    const/16 v38, 0x0

    .line 12646
    add-int/lit8 v47, v47, 0x1

    .line 12647
    add-int/lit8 v34, v34, 0x1

    goto :goto_d

    .line 12630
    .end local v34           #NT:I
    .end local v38           #curr:Lcom/android/server/am/BroadcastFilter;
    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    .end local v47           #it:I
    :cond_25
    const/4 v5, 0x0

    move/from16 v34, v5

    goto :goto_c

    .line 12650
    .restart local v34       #NT:I
    .restart local v38       #curr:Lcom/android/server/am/BroadcastFilter;
    .restart local v39       #curt:Landroid/content/pm/ResolveInfo;
    .restart local v47       #it:I
    :cond_26
    add-int/lit8 v47, v47, 0x1

    .line 12651
    const/16 v39, 0x0

    goto :goto_d

    .line 12655
    .end local v34           #NT:I
    .end local v38           #curr:Lcom/android/server/am/BroadcastFilter;
    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    .end local v47           #it:I
    .end local v58           #skipPackages:[Ljava/lang/String;
    :cond_27
    :goto_e
    move/from16 v0, v46

    move/from16 v1, v33

    if-ge v0, v1, :cond_29

    .line 12656
    if-nez v24, :cond_28

    .line 12657
    new-instance v24, Ljava/util/ArrayList;

    .end local v24           #receivers:Ljava/util/List;
    invoke-direct/range {v24 .. v24}, Ljava/util/ArrayList;-><init>()V

    .line 12659
    .restart local v24       #receivers:Ljava/util/List;
    :cond_28
    move-object/from16 v0, v16

    move/from16 v1, v46

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    move-object/from16 v0, v24

    move-object v1, v5

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 12660
    add-int/lit8 v46, v46, 0x1

    goto :goto_e

    .line 12663
    :cond_29
    if-eqz v24, :cond_2a

    invoke-interface/range {v24 .. v24}, Ljava/util/List;->size()I

    move-result v5

    if-gtz v5, :cond_2b

    :cond_2a
    if-eqz p5, :cond_2d

    .line 12665
    :cond_2b
    new-instance v9, Lcom/android/server/am/BroadcastRecord;

    const/16 v31, 0x0

    move-object/from16 v17, v9

    move-object/from16 v18, v44

    move-object/from16 v19, p1

    move-object/from16 v20, p2

    move/from16 v21, p12

    move/from16 v22, p13

    move-object/from16 v23, p9

    move-object/from16 v25, p5

    move/from16 v26, p6

    move-object/from16 v27, p7

    move-object/from16 v28, p8

    move/from16 v29, p10

    move/from16 v30, p11

    invoke-direct/range {v17 .. v31}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;ZZZ)V

    .line 12676
    .restart local v9       #r:Lcom/android/server/am/BroadcastRecord;
    const/16 v55, 0x0

    .line 12677
    .restart local v55       #replaced:Z
    if-eqz v54, :cond_2c

    .line 12678
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v42, v5, v6

    .end local p1
    .restart local v42       #i:I
    :goto_f
    if-ltz v42, :cond_2c

    .line 12679
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-eqz v5, :cond_2e

    .line 12682
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 12683
    const/16 v55, 0x1

    .line 12688
    .end local v42           #i:I
    :cond_2c
    if-nez v55, :cond_2d

    .line 12689
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12690
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12694
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v55           #replaced:Z
    :cond_2d
    const/4 v5, 0x0

    goto/16 :goto_3

    .line 12678
    .restart local v9       #r:Lcom/android/server/am/BroadcastRecord;
    .restart local v42       #i:I
    .restart local v55       #replaced:Z
    :cond_2e
    add-int/lit8 v42, v42, -0x1

    goto :goto_f

    .line 12549
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v33           #NR:I
    .end local v42           #i:I
    .end local v46           #ir:I
    .end local v54           #replacePending:Z
    .end local v55           #replaced:Z
    .restart local p1
    :catch_1
    move-exception v5

    goto/16 :goto_5

    .end local v24           #receivers:Ljava/util/List;
    .restart local v35       #ai:Landroid/content/pm/ActivityInfo;
    .restart local v53       #receivers:Ljava/util/List;
    :catch_2
    move-exception v5

    move-object/from16 v24, v53

    .end local v53           #receivers:Ljava/util/List;
    .restart local v24       #receivers:Ljava/util/List;
    goto/16 :goto_5
.end method

.method private final broadcastTimeout()V
    .locals 20

    .prologue
    .line 12894
    const/4 v13, 0x0

    .line 12895
    .local v13, app:Lcom/android/server/am/ProcessRecord;
    const/4 v12, 0x0

    .line 12897
    .local v12, anrMessage:Ljava/lang/String;
    monitor-enter p0

    .line 12898
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_1

    .line 12899
    monitor-exit p0

    .line 12955
    :cond_0
    :goto_0
    return-void

    .line 12901
    :cond_1
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    .line 12902
    .local v17, now:J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/android/server/am/BroadcastRecord;

    .line 12903
    .local v19, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v5, v0

    const-wide/16 v7, 0x4e20

    add-long/2addr v5, v7

    cmp-long v5, v5, v17

    if-lez v5, :cond_2

    .line 12907
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v16

    .line 12908
    .local v16, msg:Landroid/os/Message;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v6, v0

    const-wide/16 v8, 0x4e20

    add-long/2addr v6, v8

    move-object v0, v5

    move-object/from16 v1, v16

    move-wide v2, v6

    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 12909
    monitor-exit p0

    goto :goto_0

    .line 12950
    .end local v16           #msg:Landroid/os/Message;
    .end local v17           #now:J
    .end local v19           #r:Lcom/android/server/am/BroadcastRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 12912
    .restart local v17       #now:J
    .restart local v19       #r:Lcom/android/server/am/BroadcastRecord;
    :cond_2
    :try_start_1
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Timeout of broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " - receiver="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12913
    move-wide/from16 v0, v17

    move-object/from16 v2, v19

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    .line 12914
    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->anrCount:I

    move v5, v0

    add-int/lit8 v5, v5, 0x1

    move v0, v5

    move-object/from16 v1, v19

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->anrCount:I

    .line 12917
    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v5, v0

    if-gtz v5, :cond_3

    .line 12918
    const-string v5, "ActivityManager"

    const-string v6, "Timeout on receiver with nextReceiver <= 0"

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12919
    monitor-exit p0

    goto/16 :goto_0

    .line 12922
    :cond_3
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v6, v0

    const/4 v7, 0x1

    sub-int/2addr v6, v7

    invoke-interface {v5, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v15

    .line 12923
    .local v15, curReceiver:Ljava/lang/Object;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Receiver during timeout: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12924
    move-object/from16 v0, p0

    move-object/from16 v1, v19

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 12925
    instance-of v5, v15, Lcom/android/server/am/BroadcastFilter;

    if-eqz v5, :cond_7

    .line 12926
    move-object v0, v15

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object v14, v0

    .line 12927
    .local v14, bf:Lcom/android/server/am/BroadcastFilter;
    iget-object v5, v14, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v5, v5, Lcom/android/server/am/ReceiverList;->pid:I

    if-eqz v5, :cond_4

    iget-object v5, v14, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v5, v5, Lcom/android/server/am/ReceiverList;->pid:I

    sget v6, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v5, v6, :cond_4

    .line 12929
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12930
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    iget-object v7, v14, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v7, v7, Lcom/android/server/am/ReceiverList;->pid:I

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v14

    .end local v14           #bf:Lcom/android/server/am/BroadcastFilter;
    move-object v0, v14

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    move-object v13, v0

    .line 12932
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 12938
    :cond_4
    :goto_1
    if-eqz v13, :cond_5

    .line 12939
    :try_start_3
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Broadcast of "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    invoke-virtual {v6}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    .line 12942
    :cond_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v19

    if-ne v0, v1, :cond_6

    .line 12943
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12947
    :cond_6
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v6, v0

    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v7, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v8, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v9, v0

    move-object/from16 v0, v19

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v10, v0

    const/4 v11, 0x1

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 12949
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12950
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 12952
    if-eqz v12, :cond_0

    .line 12953
    const/4 v5, 0x0

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v5

    move-object v3, v6

    move-object v4, v12

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->appNotResponding(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V

    goto/16 :goto_0

    .line 12932
    :catchall_1
    move-exception v6

    :try_start_4
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v6

    .line 12935
    :cond_7
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v13, v0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto :goto_1
.end method

.method private static buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;
    .locals 2
    .parameter "prefix"
    .parameter "space"
    .parameter "val"
    .parameter "base"

    .prologue
    .line 10269
    if-ne p2, p3, :cond_1

    .line 10270
    if-nez p1, :cond_0

    move-object v0, p0

    .line 10273
    :goto_0
    return-object v0

    .line 10271
    :cond_0
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "  "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    goto :goto_0

    .line 10273
    :cond_1
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "+"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    sub-int v1, p2, p3

    invoke-static {v1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    goto :goto_0
.end method

.method private final bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V
    .locals 6
    .parameter "r"

    .prologue
    .line 10967
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    .line 10968
    .local v1, now:J
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    if-nez v3, :cond_1

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_1

    .line 10969
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->size()I

    move-result v3

    if-nez v3, :cond_0

    .line 10970
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0xc

    invoke-virtual {v3, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 10971
    .local v0, msg:Landroid/os/Message;
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iput-object v3, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 10972
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x7530

    add-long/2addr v4, v1

    invoke-virtual {v3, v0, v4, v5}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 10974
    .end local v0           #msg:Landroid/os/Message;
    :cond_0
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v3, p1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 10976
    :cond_1
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    add-int/lit8 v3, v3, 0x1

    iput v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 10977
    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->executingStart:J

    .line 10978
    return-void
.end method

.method private final canGcNowLocked()Z
    .locals 1

    .prologue
    .line 14145
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    if-nez v0, :cond_1

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    if-nez v0, :cond_1

    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v0, :cond_0

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_1

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->idle:Z

    if-eqz v0, :cond_1

    :cond_0
    const/4 v0, 0x1

    :goto_0
    return v0

    :cond_1
    const/4 v0, 0x0

    goto :goto_0
.end method

.method private final checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;
    .locals 11
    .parameter "cpi"
    .parameter "r"
    .parameter "mode"

    .prologue
    const/high16 v10, 0x1000

    const/4 v9, 0x0

    const/4 v8, -0x1

    .line 7778
    if-eqz p2, :cond_2

    iget v6, p2, Lcom/android/server/am/ProcessRecord;->pid:I

    move v0, v6

    .line 7779
    .local v0, callingPid:I
    :goto_0
    if-eqz p2, :cond_3

    iget-object v6, p2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    move v1, v6

    .line 7780
    .local v1, callingUid:I
    :goto_1
    iget-object v6, p1, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_4

    move v7, v8

    :goto_2
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_0

    if-eq p3, v10, :cond_1

    :cond_0
    if-ne p3, v8, :cond_5

    :cond_1
    move-object v6, v9

    .line 7817
    :goto_3
    return-object v6

    .line 7778
    .end local v0           #callingPid:I
    .end local v1           #callingUid:I
    :cond_2
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    move v0, v6

    goto :goto_0

    .line 7779
    .restart local v0       #callingPid:I
    :cond_3
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    move v1, v6

    goto :goto_1

    .line 7780
    .restart local v1       #callingUid:I
    :cond_4
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_2

    .line 7786
    :cond_5
    iget-object v6, p1, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_6

    move v7, v8

    :goto_4
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_7

    move-object v6, v9

    .line 7789
    goto :goto_3

    .line 7786
    :cond_6
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_4

    .line 7792
    :cond_7
    iget-object v5, p1, Landroid/content/pm/ProviderInfo;->pathPermissions:[Landroid/content/pm/PathPermission;

    .line 7793
    .local v5, pps:[Landroid/content/pm/PathPermission;
    if-eqz v5, :cond_e

    .line 7794
    array-length v2, v5

    .line 7795
    .local v2, i:I
    :cond_8
    if-lez v2, :cond_e

    .line 7796
    add-int/lit8 v2, v2, -0x1

    .line 7797
    aget-object v4, v5, v2

    .line 7798
    .local v4, pp:Landroid/content/pm/PathPermission;
    invoke-virtual {v4}, Landroid/content/pm/PathPermission;->getReadPermission()Ljava/lang/String;

    move-result-object v6

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_b

    move v7, v8

    :goto_5
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_9

    if-eq p3, v10, :cond_a

    :cond_9
    if-ne p3, v8, :cond_c

    :cond_a
    move-object v6, v9

    .line 7802
    goto :goto_3

    .line 7798
    :cond_b
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_5

    .line 7804
    :cond_c
    invoke-virtual {v4}, Landroid/content/pm/PathPermission;->getWritePermission()Ljava/lang/String;

    move-result-object v6

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_d

    move v7, v8

    :goto_6
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_8

    move-object v6, v9

    .line 7807
    goto :goto_3

    .line 7804
    :cond_d
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_6

    .line 7812
    .end local v2           #i:I
    .end local v4           #pp:Landroid/content/pm/PathPermission;
    :cond_e
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: opening provider "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    if-eqz p2, :cond_f

    move-object v7, p2

    :goto_7
    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ") requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " or "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 7816
    .local v3, msg:Ljava/lang/String;
    const-string v6, "ActivityManager"

    invoke-static {v6, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    move-object v6, v3

    .line 7817
    goto/16 :goto_3

    .line 7812
    .end local v3           #msg:Ljava/lang/String;
    :cond_f
    const-string v7, "(null)"

    goto :goto_7
.end method

.method private final checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z
    .locals 3
    .parameter "pm"
    .parameter "pi"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v2, 0x0

    .line 6385
    and-int/lit8 v1, p4, 0x1

    if-eqz v1, :cond_0

    .line 6386
    :try_start_0
    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v1, :cond_0

    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    invoke-interface {p1, v1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I

    move-result v1

    if-eqz v1, :cond_0

    move v1, v2

    .line 6401
    :goto_0
    return v1

    .line 6392
    :cond_0
    and-int/lit8 v1, p4, 0x2

    if-eqz v1, :cond_1

    .line 6393
    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    if-eqz v1, :cond_1

    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    invoke-interface {p1, v1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v1

    if-eqz v1, :cond_1

    move v1, v2

    .line 6396
    goto :goto_0

    .line 6399
    :cond_1
    const/4 v1, 0x1

    goto :goto_0

    .line 6400
    :catch_0
    move-exception v1

    move-object v0, v1

    .local v0, e:Landroid/os/RemoteException;
    move v1, v2

    .line 6401
    goto :goto_0
.end method

.method private final checkUriPermissionLocked(Landroid/net/Uri;II)Z
    .locals 5
    .parameter "uri"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 6408
    if-eqz p2, :cond_0

    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v2

    if-nez v2, :cond_1

    :cond_0
    move v2, v4

    .line 6415
    :goto_0
    return v2

    .line 6411
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v2, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/util/HashMap;

    .line 6412
    .local v1, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-nez v1, :cond_2

    move v2, v3

    goto :goto_0

    .line 6413
    :cond_2
    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/UriPermission;

    .line 6414
    .local v0, perm:Lcom/android/server/am/UriPermission;
    if-nez v0, :cond_3

    move v2, v3

    goto :goto_0

    .line 6415
    :cond_3
    iget v2, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/2addr v2, p3

    if-ne v2, p3, :cond_4

    move v2, v4

    goto :goto_0

    :cond_4
    move v2, v3

    goto :goto_0
.end method

.method private final cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V
    .locals 6
    .parameter "r"
    .parameter "cleanServices"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x0

    .line 4438
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, p1, :cond_0

    .line 4439
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4441
    :cond_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, p1, :cond_1

    .line 4442
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4445
    :cond_1
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    .line 4446
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 4451
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4452
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4455
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_4

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    if-eqz v3, :cond_4

    .line 4456
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_2
    :goto_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_3

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/ref/WeakReference;

    .line 4457
    .local v0, apr:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    invoke-virtual {v0}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/PendingIntentRecord;

    .line 4458
    .local v2, rec:Lcom/android/server/am/PendingIntentRecord;
    if-eqz v2, :cond_2

    .line 4459
    invoke-virtual {p0, v2, v4}, Lcom/android/server/am/ActivityManagerService;->cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V

    goto :goto_0

    .line 4462
    .end local v0           #apr:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .end local v2           #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_3
    iput-object v5, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 4465
    .end local v1           #i$:Ljava/util/Iterator;
    :cond_4
    if-eqz p2, :cond_5

    .line 4466
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4469
    :cond_5
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_6

    .line 4473
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4477
    :cond_6
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 4478
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0xa

    invoke-virtual {v3, v4, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 4479
    return-void
.end method

.method private final cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 4
    .parameter "r"

    .prologue
    const/4 v3, 0x0

    .line 4420
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-eqz v2, :cond_1

    .line 4421
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 4422
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 4423
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ConnectionRecord;

    .line 4424
    .local v0, c:Lcom/android/server/am/ConnectionRecord;
    invoke-direct {p0, v0, v3, p1}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    goto :goto_0

    .line 4426
    .end local v0           #c:Lcom/android/server/am/ConnectionRecord;
    :cond_0
    iput-object v3, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    .line 4428
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_1
    return-void
.end method

.method private final cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    .locals 12
    .parameter "app"
    .parameter "restarting"
    .parameter "index"

    .prologue
    const/4 v11, 0x0

    const/4 v10, 0x0

    .line 10556
    if-ltz p3, :cond_0

    .line 10557
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 10560
    :cond_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10563
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_1

    .line 10564
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 10565
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    .line 10567
    :cond_1
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_2

    .line 10568
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 10569
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    .line 10571
    :cond_2
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_3

    .line 10572
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 10573
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    .line 10576
    :cond_3
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 10577
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 10579
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 10580
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 10581
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 10582
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 10584
    const/4 v7, 0x1

    invoke-direct {p0, p1, v7}, Lcom/android/server/am/ActivityManagerService;->killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 10586
    const/4 v6, 0x0

    .line 10588
    .local v6, restart:Z
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10591
    .local v0, NL:I
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->isEmpty()Z

    move-result v7

    if-nez v7, :cond_9

    .line 10592
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 10593
    .local v4, it:Ljava/util/Iterator;
    :cond_4
    :goto_0
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_8

    .line 10594
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 10595
    .local v2, cpr:Lcom/android/server/am/ContentProviderRecord;
    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    .line 10596
    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 10600
    const/4 v3, 0x0

    .line 10601
    .local v3, i:I
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    if-nez v7, :cond_7

    .line 10602
    :goto_1
    if-ge v3, v0, :cond_5

    .line 10603
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    if-ne v7, v2, :cond_6

    .line 10604
    const/4 v6, 0x1

    .line 10612
    :cond_5
    :goto_2
    if-lt v3, v0, :cond_4

    .line 10613
    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V

    .line 10614
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_0

    .line 10602
    :cond_6
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 10609
    :cond_7
    move v3, v0

    goto :goto_2

    .line 10617
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i:I
    :cond_8
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->clear()V

    .line 10621
    .end local v4           #it:Ljava/util/Iterator;
    :cond_9
    invoke-virtual {p0, p1, v11}, Lcom/android/server/am/ActivityManagerService;->checkAppInLaunchingProvidersLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    move-result v7

    if-eqz v7, :cond_a

    .line 10622
    const/4 v6, 0x1

    .line 10626
    :cond_a
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->isEmpty()Z

    move-result v7

    if-nez v7, :cond_c

    .line 10627
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->keySet()Ljava/util/Set;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 10628
    .restart local v4       #it:Ljava/util/Iterator;
    :goto_3
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_b

    .line 10629
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 10630
    .restart local v2       #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v7, v2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v7, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    goto :goto_3

    .line 10632
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_b
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->clear()V

    .line 10653
    .end local v4           #it:Ljava/util/Iterator;
    :cond_c
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 10656
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->size()I

    move-result v7

    if-lez v7, :cond_e

    .line 10657
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 10658
    .local v5, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ReceiverList;>;"
    :goto_4
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_d

    .line 10659
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ReceiverList;

    invoke-virtual {p0, v7}, Lcom/android/server/am/ActivityManagerService;->removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V

    goto :goto_4

    .line 10661
    :cond_d
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->clear()V

    .line 10665
    .end local v5           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ReceiverList;>;"
    :cond_e
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    if-eqz v7, :cond_f

    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v8, v8, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v8, v8, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v7, v8, :cond_f

    .line 10668
    :try_start_0
    const-string v7, "backup"

    invoke-static {v7}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v7

    invoke-static {v7}, Landroid/app/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/backup/IBackupManager;

    move-result-object v1

    .line 10670
    .local v1, bm:Landroid/app/backup/IBackupManager;
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v1, v7}, Landroid/app/backup/IBackupManager;->agentDisconnected(Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 10678
    .end local v1           #bm:Landroid/app/backup/IBackupManager;
    :cond_f
    :goto_5
    if-eqz p2, :cond_11

    .line 10717
    :cond_10
    :goto_6
    return-void

    .line 10682
    :cond_11
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v7, :cond_14

    .line 10685
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v7, v8, v9}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 10698
    :cond_12
    :goto_7
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10700
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    if-ne p1, v7, :cond_13

    .line 10701
    iput-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    .line 10704
    :cond_13
    if-eqz v6, :cond_15

    .line 10707
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v7, v8, v9, p1}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 10708
    const-string v7, "restart"

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-direct {p0, p1, v7, v8}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_6

    .line 10686
    :cond_14
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->removed:Z

    if-nez v7, :cond_12

    .line 10690
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 10691
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 10692
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 10693
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v7

    if-gez v7, :cond_12

    .line 10694
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10695
    const/4 v6, 0x1

    goto :goto_7

    .line 10709
    :cond_15
    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v7, :cond_10

    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v8, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v7, v8, :cond_10

    .line 10711
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v7

    .line 10712
    :try_start_1
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v9, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v8, v9}, Landroid/util/SparseArray;->remove(I)V

    .line 10713
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v9, 0x14

    invoke-virtual {v8, v9, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 10714
    monitor-exit v7
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 10715
    invoke-virtual {p1, v11}, Lcom/android/server/am/ProcessRecord;->setPid(I)V

    goto :goto_6

    .line 10714
    :catchall_0
    move-exception v8

    :try_start_2
    monitor-exit v7
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v8

    .line 10671
    :catch_0
    move-exception v7

    goto :goto_5
.end method

.method private final completePauseLocked()V
    .locals 13

    .prologue
    const-wide/16 v11, 0x0

    .line 2195
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2198
    .local v4, prev:Lcom/android/server/am/HistoryRecord;
    if-eqz v4, :cond_1

    .line 2199
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_6

    .line 2201
    const/4 v6, 0x2

    invoke-direct {p0, v4, v6}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v4

    .line 2234
    :cond_0
    :goto_0
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2237
    :cond_1
    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v6, :cond_a

    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-nez v6, :cond_a

    .line 2238
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2248
    :cond_2
    :goto_1
    if-eqz v4, :cond_3

    .line 2249
    invoke-virtual {v4}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 2252
    :cond_3
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_5

    iget-wide v6, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    cmp-long v6, v6, v11

    if-lez v6, :cond_5

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v6

    if-eqz v6, :cond_5

    .line 2253
    const-wide/16 v1, 0x0

    .line 2254
    .local v1, diff:J
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v6

    .line 2255
    :try_start_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    iget-object v8, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v8, v8, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v7, v8}, Lcom/android/server/ProcessStats;->getCpuTimeForPid(I)J

    move-result-wide v7

    iget-wide v9, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    sub-long v1, v7, v9

    .line 2256
    monitor-exit v6
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 2257
    cmp-long v6, v1, v11

    if-lez v6, :cond_5

    .line 2258
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v0

    .line 2259
    .local v0, bsi:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v0

    .line 2260
    :try_start_1
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v6, v7}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v5

    .line 2263
    .local v5, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    if-eqz v5, :cond_4

    .line 2264
    invoke-virtual {v5, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addForegroundTimeLocked(J)V

    .line 2266
    :cond_4
    monitor-exit v0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 2269
    .end local v0           #bsi:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v1           #diff:J
    .end local v5           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    :cond_5
    iput-wide v11, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    .line 2270
    return-void

    .line 2202
    :cond_6
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_9

    .line 2204
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-eqz v6, :cond_7

    .line 2205
    const/4 v6, 0x0

    iput-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 2206
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2210
    :cond_7
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v6, :cond_8

    .line 2217
    const/4 v6, 0x1

    invoke-direct {p0, v4, v6}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    goto :goto_0

    .line 2219
    :cond_8
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2220
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x3

    if-le v6, v7, :cond_0

    .line 2225
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v3

    .line 2226
    .local v3, msg:Landroid/os/Message;
    const/16 v6, 0xb

    iput v6, v3, Landroid/os/Message;->what:I

    .line 2227
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v3}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    goto/16 :goto_0

    .line 2232
    .end local v3           #msg:Landroid/os/Message;
    :cond_9
    const/4 v4, 0x0

    goto/16 :goto_0

    .line 2240
    :cond_a
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v6}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v6

    if-eqz v6, :cond_b

    .line 2241
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v6}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 2243
    :cond_b
    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-eqz v6, :cond_2

    .line 2244
    invoke-virtual {p0}, Ljava/lang/Object;->notifyAll()V

    goto/16 :goto_1

    .line 2256
    .restart local v1       #diff:J
    :catchall_0
    move-exception v7

    :try_start_2
    monitor-exit v6
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v7

    .line 2266
    .restart local v0       #bsi:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_1
    move-exception v6

    :try_start_3
    monitor-exit v0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    throw v6
.end method

.method private final completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "next"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x0

    .line 2278
    iput-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->idle:Z

    .line 2279
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 2280
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 2283
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0xa

    invoke-virtual {v1, v2}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 2284
    .local v0, msg:Landroid/os/Message;
    iput-object p1, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2285
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v2, 0x2710

    invoke-virtual {v1, v0, v2, v3}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2297
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->reportResumedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 2299
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 2300
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 2301
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 2302
    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 2303
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v1}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2304
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->clear()V

    .line 2309
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    .line 2310
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v1

    .line 2311
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v2, v3}, Lcom/android/server/ProcessStats;->getCpuTimeForPid(I)J

    move-result-wide v2

    iput-wide v2, p1, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    .line 2312
    monitor-exit v1

    .line 2316
    :goto_0
    return-void

    .line 2312
    :catchall_0
    move-exception v2

    monitor-exit v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 2314
    :cond_0
    const-wide/16 v1, 0x0

    iput-wide v1, p1, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    goto :goto_0
.end method

.method private final computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I
    .locals 25
    .parameter "app"
    .parameter "hiddenAdj"
    .parameter "TOP_APP"
    .parameter "recursed"

    .prologue
    .line 13820
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    move/from16 v22, v0

    move/from16 v0, v21

    move/from16 v1, v22

    if-ne v0, v1, :cond_1

    .line 13825
    if-nez p4, :cond_0

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->hidden:Z

    move/from16 v21, v0

    if-eqz v21, :cond_0

    .line 13826
    move/from16 v0, p2

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 13828
    :cond_0
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->curAdj:I

    move/from16 v21, v0

    .line 14119
    .end local p4
    :goto_0
    return v21

    .line 13831
    .restart local p4
    :cond_1
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v21, v0

    if-nez v21, :cond_2

    .line 13832
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 13833
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 13834
    sget v21, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    goto :goto_0

    .line 13837
    :cond_2
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-gt v0, v1, :cond_3

    .line 13840
    const-string v21, "fixed"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13841
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 13842
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 13843
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 13844
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    goto :goto_0

    .line 13847
    :cond_3
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 13848
    const/16 v21, 0x0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 13849
    const/16 v21, 0x0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 13850
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->empty:Z

    .line 13851
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13858
    move-object/from16 v0, p1

    move-object/from16 v1, p3

    if-ne v0, v1, :cond_11

    .line 13860
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13861
    .local v7, adj:I
    const/16 v20, 0x0

    .line 13862
    .local v20, schedGroup:I
    const-string v21, "top-activity"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13936
    .end local p4
    :cond_4
    :goto_1
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 13937
    move v0, v7

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 13939
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object/from16 v21, v0

    if-eqz v21, :cond_5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, p1

    move-object/from16 v1, v21

    if-ne v0, v1, :cond_5

    .line 13941
    sget v21, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_5

    .line 13943
    sget v7, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    .line 13944
    const-string v21, "backup"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13945
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13949
    :cond_5
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->size()I

    move-result v21

    if-eqz v21, :cond_1f

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_6

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_1f

    .line 13951
    :cond_6
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    .line 13954
    .local v17, now:J
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .line 13955
    .local v13, jt:Ljava/util/Iterator;
    :cond_7
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_1e

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_1e

    .line 13956
    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/android/server/am/ServiceRecord;

    .line 13957
    .local v19, s:Lcom/android/server/am/ServiceRecord;
    move-object/from16 v0, v19

    iget-boolean v0, v0, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    move/from16 v21, v0

    if-eqz v21, :cond_9

    .line 13958
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    move-wide/from16 v21, v0

    const-wide/32 v23, 0x1b7740

    add-long v21, v21, v23

    cmp-long v21, v17, v21

    if-gez v21, :cond_8

    .line 13962
    sget v21, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_8

    .line 13963
    sget v7, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    .line 13964
    const-string v21, "started-services"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13965
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13971
    :cond_8
    sget v21, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_9

    .line 13972
    const-string v21, "started-bg-services"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13975
    :cond_9
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->size()I

    move-result v21

    if-lez v21, :cond_7

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_a

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_7

    .line 13977
    :cond_a
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v21

    invoke-interface/range {v21 .. v21}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .line 13979
    .local v14, kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_b
    :goto_2
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_7

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_7

    .line 13982
    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/ConnectionRecord;

    .line 13983
    .local v11, cr:Lcom/android/server/am/ConnectionRecord;
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_b

    .line 13987
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/ConnectionRecord;->flags:I

    move/from16 v21, v0

    and-int/lit8 v21, v21, 0x1

    if-eqz v21, :cond_f

    .line 13988
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    .line 13989
    .local v8, client:Lcom/android/server/am/ProcessRecord;
    move/from16 v16, p2

    .line 13990
    .local v16, myHiddenAdj:I
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    move/from16 v0, v16

    move/from16 v1, v21

    if-le v0, v1, :cond_c

    .line 13991
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-le v0, v1, :cond_1c

    .line 13992
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v16, v0

    .line 13997
    :cond_c
    :goto_3
    const/16 v21, 0x1

    move-object/from16 v0, p0

    move-object v1, v8

    move/from16 v2, v16

    move-object/from16 v3, p3

    move/from16 v4, v21

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I

    move-result v9

    .line 13999
    .local v9, clientAdj:I
    if-le v7, v9, :cond_e

    .line 14000
    sget v21, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move v0, v9

    move/from16 v1, v21

    if-le v0, v1, :cond_1d

    move v7, v9

    .line 14002
    :goto_4
    move-object v0, v8

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->hidden:Z

    move/from16 v21, v0

    if-nez v21, :cond_d

    .line 14003
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14005
    :cond_d
    const-string v21, "service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14006
    const/16 v21, 0x2

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 14008
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 14009
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 14011
    :cond_e
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/ConnectionRecord;->flags:I

    move/from16 v21, v0

    and-int/lit8 v21, v21, 0x4

    if-nez v21, :cond_f

    .line 14012
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    move/from16 v21, v0

    if-nez v21, :cond_f

    .line 14013
    const/16 v20, 0x0

    .line 14017
    .end local v8           #client:Lcom/android/server/am/ProcessRecord;
    .end local v9           #clientAdj:I
    .end local v16           #myHiddenAdj:I
    :cond_f
    iget-object v6, v11, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    .line 14021
    .local v6, a:Lcom/android/server/am/HistoryRecord;
    if-eqz v6, :cond_b

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_b

    move-object v0, v6

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v21, v0

    sget-object v22, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v0, v21

    move-object/from16 v1, v22

    if-eq v0, v1, :cond_10

    move-object v0, v6

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v21, v0

    sget-object v22, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v0, v21

    move-object/from16 v1, v22

    if-ne v0, v1, :cond_b

    .line 14024
    :cond_10
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 14025
    const/16 v20, 0x0

    .line 14026
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14027
    const-string v21, "service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14028
    const/16 v21, 0x2

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 14030
    move-object v0, v6

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 14031
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    goto/16 :goto_2

    .line 13863
    .end local v6           #a:Lcom/android/server/am/HistoryRecord;
    .end local v7           #adj:I
    .end local v11           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v13           #jt:Ljava/util/Iterator;
    .end local v14           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v17           #now:J
    .end local v19           #s:Lcom/android/server/am/ServiceRecord;
    .end local v20           #schedGroup:I
    .restart local p4
    :cond_11
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object/from16 v21, v0

    if-eqz v21, :cond_12

    .line 13865
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13866
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13867
    .restart local v20       #schedGroup:I
    const-string v21, "instrumentation"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13868
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_12
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    move/from16 v21, v0

    if-lez v21, :cond_13

    .line 13870
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13871
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13872
    .restart local v20       #schedGroup:I
    const-string v21, "persistent"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13873
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_13
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v21, v0

    if-nez v21, :cond_14

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v21, v0

    if-eqz v21, :cond_15

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    if-ne v0, v1, :cond_15

    .line 13877
    :cond_14
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13878
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13879
    .restart local v20       #schedGroup:I
    const-string v21, "broadcast"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13880
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_15
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->size()I

    move-result v21

    if-lez v21, :cond_16

    .line 13883
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13884
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13885
    .restart local v20       #schedGroup:I
    const-string v21, "exec-service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13886
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_16
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    move/from16 v21, v0

    if-eqz v21, :cond_17

    .line 13888
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 13889
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13890
    .restart local v20       #schedGroup:I
    const-string v21, "foreground-service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13891
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_17
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    move-object/from16 v21, v0

    if-eqz v21, :cond_18

    .line 13893
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 13894
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13895
    .restart local v20       #schedGroup:I
    const-string v21, "force-foreground"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13896
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    goto/16 :goto_1

    .line 13897
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_18
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, p1

    move-object/from16 v1, v21

    if-ne v0, v1, :cond_19

    .line 13900
    sget v7, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    .line 13901
    .restart local v7       #adj:I
    const/16 v20, 0x1

    .line 13902
    .restart local v20       #schedGroup:I
    const-string v21, "home"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13903
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_19
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/ArrayList;->size()I

    move-result v5

    .local v5, N:I
    if-eqz v5, :cond_1b

    .line 13905
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13906
    move/from16 v7, p2

    .line 13907
    .restart local v7       #adj:I
    const/16 v20, 0x1

    .line 13908
    .restart local v20       #schedGroup:I
    const-string v21, "bg-activities"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13909
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/ArrayList;->size()I

    move-result v5

    .line 13910
    const/4 v12, 0x0

    .end local p4
    .local v12, j:I
    :goto_5
    if-ge v12, v5, :cond_4

    .line 13911
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move v1, v12

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p4

    check-cast p4, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p4

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->visible:Z

    move/from16 v21, v0

    if-eqz v21, :cond_1a

    .line 13913
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13914
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 13915
    const/16 v20, 0x0

    .line 13916
    const-string v21, "visible"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13910
    :cond_1a
    add-int/lit8 v12, v12, 0x1

    goto :goto_5

    .line 13923
    .end local v7           #adj:I
    .end local v12           #j:I
    .end local v20           #schedGroup:I
    .restart local p4
    :cond_1b
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13924
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->empty:Z

    .line 13925
    const/16 v20, 0x1

    .line 13926
    .restart local v20       #schedGroup:I
    move/from16 v7, p2

    .line 13927
    .restart local v7       #adj:I
    const-string v21, "bg-empty"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13994
    .end local v5           #N:I
    .end local p4
    .restart local v8       #client:Lcom/android/server/am/ProcessRecord;
    .restart local v11       #cr:Lcom/android/server/am/ConnectionRecord;
    .restart local v13       #jt:Ljava/util/Iterator;
    .restart local v14       #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .restart local v16       #myHiddenAdj:I
    .restart local v17       #now:J
    .restart local v19       #s:Lcom/android/server/am/ServiceRecord;
    :cond_1c
    sget v16, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    goto/16 :goto_3

    .line 14000
    .restart local v9       #clientAdj:I
    :cond_1d
    sget v21, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v7, v21

    goto/16 :goto_4

    .line 14042
    .end local v8           #client:Lcom/android/server/am/ProcessRecord;
    .end local v9           #clientAdj:I
    .end local v11           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v14           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v16           #myHiddenAdj:I
    .end local v19           #s:Lcom/android/server/am/ServiceRecord;
    :cond_1e
    move v0, v7

    move/from16 v1, p2

    if-le v0, v1, :cond_1f

    .line 14043
    move/from16 v7, p2

    .line 14044
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14045
    const-string v21, "bg-services"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14049
    .end local v13           #jt:Ljava/util/Iterator;
    .end local v17           #now:J
    :cond_1f
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->size()I

    move-result v21

    if-eqz v21, :cond_2a

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_20

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_2a

    .line 14051
    :cond_20
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v21

    invoke-interface/range {v21 .. v21}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .line 14052
    .restart local v13       #jt:Ljava/util/Iterator;
    :cond_21
    :goto_6
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_2a

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_22

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_2a

    .line 14054
    :cond_22
    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/am/ContentProviderRecord;

    .line 14055
    .local v10, cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->size()I

    move-result v21

    if-eqz v21, :cond_29

    .line 14056
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v15

    .line 14057
    .local v15, kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    :cond_23
    :goto_7
    invoke-interface {v15}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_29

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_29

    .line 14058
    invoke-interface {v15}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/ProcessRecord;

    .line 14059
    .restart local v8       #client:Lcom/android/server/am/ProcessRecord;
    move-object v0, v8

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_23

    .line 14063
    move/from16 v16, p2

    .line 14064
    .restart local v16       #myHiddenAdj:I
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    move/from16 v0, v16

    move/from16 v1, v21

    if-le v0, v1, :cond_24

    .line 14065
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-le v0, v1, :cond_27

    .line 14066
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v16, v0

    .line 14071
    :cond_24
    :goto_8
    const/16 v21, 0x1

    move-object/from16 v0, p0

    move-object v1, v8

    move/from16 v2, v16

    move-object/from16 v3, p3

    move/from16 v4, v21

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I

    move-result v9

    .line 14073
    .restart local v9       #clientAdj:I
    if-le v7, v9, :cond_26

    .line 14074
    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v9

    move/from16 v1, v21

    if-le v0, v1, :cond_28

    move v7, v9

    .line 14076
    :goto_9
    move-object v0, v8

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->hidden:Z

    move/from16 v21, v0

    if-nez v21, :cond_25

    .line 14077
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14079
    :cond_25
    const-string v21, "provider"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14080
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 14082
    move-object v0, v8

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 14083
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 14085
    :cond_26
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    move/from16 v21, v0

    if-nez v21, :cond_23

    .line 14086
    const/16 v20, 0x0

    goto/16 :goto_7

    .line 14068
    .end local v9           #clientAdj:I
    :cond_27
    sget v16, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    goto :goto_8

    .line 14074
    .restart local v9       #clientAdj:I
    :cond_28
    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v7, v21

    goto :goto_9

    .line 14093
    .end local v8           #client:Lcom/android/server/am/ProcessRecord;
    .end local v9           #clientAdj:I
    .end local v15           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    .end local v16           #myHiddenAdj:I
    :cond_29
    move-object v0, v10

    iget v0, v0, Lcom/android/server/am/ContentProviderRecord;->externals:I

    move/from16 v21, v0

    if-eqz v21, :cond_21

    .line 14094
    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_21

    .line 14095
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 14096
    const/16 v20, 0x0

    .line 14097
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14098
    const-string v21, "provider"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14099
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    goto/16 :goto_6

    .line 14105
    .end local v10           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v13           #jt:Ljava/util/Iterator;
    :cond_2a
    move v0, v7

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 14109
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_2b

    .line 14110
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move v7, v0

    .line 14111
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-gt v0, v1, :cond_2b

    .line 14112
    const/16 v20, 0x0

    .line 14116
    :cond_2b
    move v0, v7

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 14117
    move/from16 v0, v20

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    move/from16 v21, v7

    .line 14119
    goto/16 :goto_0
.end method

.method private crashApplication(Lcom/android/server/am/ProcessRecord;Landroid/app/ApplicationErrorReport$CrashInfo;)V
    .locals 25
    .parameter "r"
    .parameter "crashInfo"

    .prologue
    .line 9338
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v10

    .line 9339
    .local v10, timeMillis:J
    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionClassName:Ljava/lang/String;

    move-object v8, v0

    .line 9340
    .local v8, shortMsg:Ljava/lang/String;
    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionMessage:Ljava/lang/String;

    move-object v9, v0

    .line 9341
    .local v9, longMsg:Ljava/lang/String;
    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->stackTrace:Ljava/lang/String;

    move-object/from16 v22, v0

    .line 9342
    .local v22, stackTrace:Ljava/lang/String;
    if-eqz v8, :cond_2

    if-eqz v9, :cond_2

    .line 9343
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v5, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    .line 9348
    :cond_0
    :goto_0
    new-instance v21, Lcom/android/server/am/AppErrorResult;

    invoke-direct/range {v21 .. v21}, Lcom/android/server/am/AppErrorResult;-><init>()V

    .line 9349
    .local v21, result:Lcom/android/server/am/AppErrorResult;
    monitor-enter p0

    .line 9350
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    if-eqz v5, :cond_5

    .line 9352
    if-eqz p1, :cond_3

    :try_start_1
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object v6, v5

    .line 9353
    .local v6, name:Ljava/lang/String;
    :goto_1
    if-eqz p1, :cond_4

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    move v7, v5

    .line 9354
    .local v7, pid:I
    :goto_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->stackTrace:Ljava/lang/String;

    move-object v12, v0

    invoke-interface/range {v5 .. v12}, Landroid/app/IActivityController;->appCrashed(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;JLjava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_5

    .line 9356
    const-string v5, "ActivityManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Force-killing crashed app "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v12

    invoke-virtual {v12, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    .end local v6           #name:Ljava/lang/String;
    const-string v12, " at watcher\'s request"

    invoke-virtual {v6, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9358
    invoke-static {v7}, Landroid/os/Process;->killProcess(I)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 9359
    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 9420
    .end local v7           #pid:I
    .end local v8           #shortMsg:Ljava/lang/String;
    :cond_1
    :goto_3
    return-void

    .line 9344
    .end local v21           #result:Lcom/android/server/am/AppErrorResult;
    .restart local v8       #shortMsg:Ljava/lang/String;
    :cond_2
    if-eqz v8, :cond_0

    .line 9345
    move-object v9, v8

    goto :goto_0

    .line 9352
    .restart local v21       #result:Lcom/android/server/am/AppErrorResult;
    :cond_3
    const/4 v5, 0x0

    move-object v6, v5

    goto :goto_1

    .line 9353
    .restart local v6       #name:Ljava/lang/String;
    :cond_4
    :try_start_3
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    move-result v5

    move v7, v5

    goto :goto_2

    .line 9361
    .end local v6           #name:Ljava/lang/String;
    :catch_0
    move-exception v5

    move-object v15, v5

    .line 9362
    .local v15, e:Landroid/os/RemoteException;
    const/4 v5, 0x0

    :try_start_4
    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 9366
    .end local v15           #e:Landroid/os/RemoteException;
    :cond_5
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 9369
    .local v18, origId:J
    if-eqz p1, :cond_8

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    if-eqz v5, :cond_8

    .line 9370
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Error in app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " running instrumentation "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9372
    if-eqz v8, :cond_6

    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9373
    :cond_6
    if-eqz v9, :cond_7

    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9374
    :cond_7
    new-instance v16, Landroid/os/Bundle;

    invoke-direct/range {v16 .. v16}, Landroid/os/Bundle;-><init>()V

    .line 9375
    .local v16, info:Landroid/os/Bundle;
    const-string v5, "shortMsg"

    move-object/from16 v0, v16

    move-object v1, v5

    move-object v2, v8

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 9376
    const-string v5, "longMsg"

    move-object/from16 v0, v16

    move-object v1, v5

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 9377
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move v2, v5

    move-object/from16 v3, v16

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 9378
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 9379
    monitor-exit p0

    goto/16 :goto_3

    .line 9398
    .end local v16           #info:Landroid/os/Bundle;
    .end local v18           #origId:J
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v5

    .line 9384
    .restart local v18       #origId:J
    :cond_8
    if-eqz p1, :cond_9

    :try_start_5
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object v2, v8

    move-object v3, v9

    move-object/from16 v4, v22

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->makeAppCrashingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_a

    .line 9385
    :cond_9
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 9386
    monitor-exit p0

    goto/16 :goto_3

    .line 9389
    :cond_a
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v17

    .line 9390
    .local v17, msg:Landroid/os/Message;
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v17

    iput v0, v1, Landroid/os/Message;->what:I

    .line 9391
    new-instance v14, Ljava/util/HashMap;

    invoke-direct {v14}, Ljava/util/HashMap;-><init>()V

    .line 9392
    .local v14, data:Ljava/util/HashMap;
    const-string v5, "result"

    move-object v0, v14

    move-object v1, v5

    move-object/from16 v2, v21

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 9393
    const-string v5, "app"

    move-object v0, v14

    move-object v1, v5

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 9394
    move-object v0, v14

    move-object/from16 v1, v17

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 9395
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 9397
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 9398
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 9400
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/AppErrorResult;->get()I

    move-result v20

    .line 9402
    .local v20, res:I
    const/4 v13, 0x0

    .line 9403
    .local v13, appErrorIntent:Landroid/content/Intent;
    monitor-enter p0

    .line 9404
    if-eqz p1, :cond_b

    .line 9405
    :try_start_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v7, v0

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v23

    invoke-static/range {v23 .. v24}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v8

    .end local v8           #shortMsg:Ljava/lang/String;
    invoke-virtual {v5, v6, v7, v8}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 9408
    :cond_b
    const/4 v5, 0x1

    move/from16 v0, v20

    move v1, v5

    if-ne v0, v1, :cond_c

    .line 9409
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-wide v2, v10

    move-object/from16 v4, p2

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->createAppErrorIntentLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/content/Intent;

    move-result-object v13

    .line 9411
    :cond_c
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 9413
    if-eqz v13, :cond_1

    .line 9415
    :try_start_7
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v5, v0

    invoke-virtual {v5, v13}, Landroid/content/Context;->startActivity(Landroid/content/Intent;)V
    :try_end_7
    .catch Landroid/content/ActivityNotFoundException; {:try_start_7 .. :try_end_7} :catch_1

    goto/16 :goto_3

    .line 9416
    :catch_1
    move-exception v5

    move-object v15, v5

    .line 9417
    .local v15, e:Landroid/content/ActivityNotFoundException;
    const-string v5, "ActivityManager"

    const-string v6, "bug report receiver dissappeared"

    invoke-static {v5, v6, v15}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_3

    .line 9411
    .end local v15           #e:Landroid/content/ActivityNotFoundException;
    :catchall_1
    move-exception v5

    :try_start_8
    monitor-exit p0
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_1

    throw v5
.end method

.method private createAppErrorReportLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/app/ApplicationErrorReport;
    .locals 4
    .parameter "r"
    .parameter "timeMillis"
    .parameter "crashInfo"

    .prologue
    const/4 v3, 0x0

    const/4 v2, 0x1

    .line 9437
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    if-nez v1, :cond_0

    move-object v1, v3

    .line 9464
    :goto_0
    return-object v1

    .line 9441
    :cond_0
    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v1, :cond_1

    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-nez v1, :cond_1

    move-object v1, v3

    .line 9442
    goto :goto_0

    .line 9445
    :cond_1
    new-instance v0, Landroid/app/ApplicationErrorReport;

    invoke-direct {v0}, Landroid/app/ApplicationErrorReport;-><init>()V

    .line 9446
    .local v0, report:Landroid/app/ApplicationErrorReport;
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->packageName:Ljava/lang/String;

    .line 9447
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    invoke-virtual {v1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v1

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->installerPackageName:Ljava/lang/String;

    .line 9448
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->processName:Ljava/lang/String;

    .line 9449
    iput-wide p2, v0, Landroid/app/ApplicationErrorReport;->time:J

    .line 9450
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v1, v1, 0x1

    if-eqz v1, :cond_3

    move v1, v2

    :goto_1
    iput-boolean v1, v0, Landroid/app/ApplicationErrorReport;->systemApp:Z

    .line 9452
    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v1, :cond_4

    .line 9453
    iput v2, v0, Landroid/app/ApplicationErrorReport;->type:I

    .line 9454
    iput-object p4, v0, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    :cond_2
    :goto_2
    move-object v1, v0

    .line 9464
    goto :goto_0

    .line 9450
    :cond_3
    const/4 v1, 0x0

    goto :goto_1

    .line 9455
    :cond_4
    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v1, :cond_2

    .line 9456
    const/4 v1, 0x2

    iput v1, v0, Landroid/app/ApplicationErrorReport;->type:I

    .line 9457
    new-instance v1, Landroid/app/ApplicationErrorReport$AnrInfo;

    invoke-direct {v1}, Landroid/app/ApplicationErrorReport$AnrInfo;-><init>()V

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    .line 9459
    iget-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v2, v2, Landroid/app/ActivityManager$ProcessErrorStateInfo;->tag:Ljava/lang/String;

    iput-object v2, v1, Landroid/app/ApplicationErrorReport$AnrInfo;->activity:Ljava/lang/String;

    .line 9460
    iget-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v2, v2, Landroid/app/ActivityManager$ProcessErrorStateInfo;->shortMsg:Ljava/lang/String;

    iput-object v2, v1, Landroid/app/ApplicationErrorReport$AnrInfo;->cause:Ljava/lang/String;

    .line 9461
    iget-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v2, v2, Landroid/app/ActivityManager$ProcessErrorStateInfo;->longMsg:Ljava/lang/String;

    iput-object v2, v1, Landroid/app/ApplicationErrorReport$AnrInfo;->info:Ljava/lang/String;

    goto :goto_2
.end method

.method private final decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 2
    .parameter "app"

    .prologue
    .line 4960
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    iput v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    .line 4961
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-lez v0, :cond_1

    .line 4973
    :cond_0
    :goto_0
    return-void

    .line 4965
    :cond_1
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v0, :cond_0

    .line 4972
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    goto :goto_0
.end method

.method private final deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V
    .locals 6
    .parameter "r"
    .parameter "intent"

    .prologue
    .line 3107
    const/4 v2, 0x0

    .line 3108
    .local v2, sent:Z
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_0

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_0

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_0

    .line 3111
    :try_start_0
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 3112
    .local v0, ar:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    new-instance v3, Landroid/content/Intent;

    invoke-direct {v3, p2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3113
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3, v0, p1}, Landroid/app/IApplicationThread;->scheduleNewIntent(Ljava/util/List;Landroid/os/IBinder;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 3114
    const/4 v2, 0x1

    .line 3119
    .end local v0           #ar:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_0
    :goto_0
    if-nez v2, :cond_1

    .line 3120
    new-instance v3, Landroid/content/Intent;

    invoke-direct {v3, p2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-virtual {p1, v3}, Lcom/android/server/am/HistoryRecord;->addNewIntentLocked(Landroid/content/Intent;)V

    .line 3122
    :cond_1
    return-void

    .line 3115
    :catch_0
    move-exception v3

    move-object v1, v3

    .line 3116
    .local v1, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Exception thrown sending new intent to "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0
.end method

.method private final deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
    .locals 11
    .parameter "r"
    .parameter "filter"
    .parameter "ordered"

    .prologue
    .line 13004
    const/4 v10, 0x0

    .line 13005
    .local v10, skip:Z
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    if-eqz v0, :cond_0

    .line 13006
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    iget v1, p1, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    const/4 v3, -0x1

    invoke-virtual {p0, v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v9

    .line 13008
    .local v9, perm:I
    if-eqz v9, :cond_0

    .line 13009
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Permission Denial: broadcasting "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " from "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", uid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ")"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " requires "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " due to registered receiver "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13015
    const/4 v10, 0x1

    .line 13018
    .end local v9           #perm:I
    :cond_0
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    if-eqz v0, :cond_1

    .line 13019
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v1, v1, Lcom/android/server/am/ReceiverList;->pid:I

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v2, v2, Lcom/android/server/am/ReceiverList;->uid:I

    const/4 v3, -0x1

    invoke-virtual {p0, v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v9

    .line 13021
    .restart local v9       #perm:I
    if-eqz v9, :cond_1

    .line 13022
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Permission Denial: receiving "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " to "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v2, v2, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v2, v2, Lcom/android/server/am/ReceiverList;->pid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", uid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v2, v2, Lcom/android/server/am/ReceiverList;->uid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ")"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " requires "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " due to sender "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (uid "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ")"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13030
    const/4 v10, 0x1

    .line 13034
    .end local v9           #perm:I
    :cond_1
    if-nez v10, :cond_3

    .line 13038
    if-eqz p3, :cond_2

    .line 13039
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v0}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 13040
    iput-object p2, p1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 13041
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iput-object p1, v0, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13042
    const/4 v0, 0x2

    iput v0, p1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13043
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_2

    .line 13049
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 13050
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iput-object p1, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 13051
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 13060
    :cond_2
    :try_start_0
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v1, v1, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    new-instance v2, Landroid/content/Intent;

    iget-object v3, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-direct {v2, v3}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v4, p1, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v6, p1, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    iget-boolean v7, p1, Lcom/android/server/am/BroadcastRecord;->initialSticky:Z

    invoke-static/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V

    .line 13063
    if-eqz p3, :cond_3

    .line 13064
    const/4 v0, 0x3

    iput v0, p1, Lcom/android/server/am/BroadcastRecord;->state:I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13078
    :cond_3
    :goto_0
    return-void

    .line 13066
    :catch_0
    move-exception v0

    move-object v8, v0

    .line 13067
    .local v8, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Failure sending broadcast "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v8}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 13068
    if-eqz p3, :cond_3

    .line 13069
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 13070
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 13071
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    const/4 v1, 0x0

    iput-object v1, v0, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13072
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_3

    .line 13073
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v1, 0x0

    iput-object v1, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    goto :goto_0
.end method

.method private final destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z
    .locals 12
    .parameter "r"
    .parameter "removeFromApp"

    .prologue
    const/4 v11, 0x1

    const/4 v10, 0x0

    .line 4506
    const/16 v6, 0x7542

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v8

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v7, v10

    iget-object v8, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v8, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v7, v11

    const/4 v8, 0x2

    iget-object v9, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4510
    const/4 v4, 0x0

    .line 4512
    .local v4, removedFromHistory:Z
    invoke-direct {p0, p1, v10}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V

    .line 4514
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_5

    move v1, v11

    .line 4516
    .local v1, hadApp:Z
    :goto_0
    if-eqz v1, :cond_7

    .line 4517
    if-eqz p2, :cond_2

    .line 4518
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v2

    .line 4519
    .local v2, idx:I
    if-ltz v2, :cond_0

    .line 4520
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4522
    :cond_0
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-eqz v6, :cond_1

    .line 4523
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 4525
    :cond_1
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-nez v6, :cond_2

    .line 4528
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v6, v11, v10}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 4532
    .end local v2           #idx:I
    :cond_2
    const/4 v5, 0x0

    .line 4536
    .local v5, skipDestroy:Z
    :try_start_0
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v7, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    iget v8, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v6, p1, v7, v8}, Landroid/app/IApplicationThread;->scheduleDestroyActivity(Landroid/os/IBinder;ZI)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 4550
    :cond_3
    :goto_1
    const/4 v6, 0x0

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4551
    iput-boolean v10, p1, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    .line 4553
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_6

    if-nez v5, :cond_6

    .line 4554
    sget-object v6, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4555
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v7, 0x11

    invoke-virtual {v6, v7}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v3

    .line 4556
    .local v3, msg:Landroid/os/Message;
    iput-object p1, v3, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 4557
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v7, 0x2710

    invoke-virtual {v6, v3, v7, v8}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 4571
    .end local v3           #msg:Landroid/os/Message;
    .end local v5           #skipDestroy:Z
    :goto_2
    iput v10, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    .line 4573
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_4

    if-eqz v1, :cond_4

    .line 4574
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Activity "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " being finished, but not in LRU list"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4577
    :cond_4
    return v4

    .end local v1           #hadApp:Z
    :cond_5
    move v1, v10

    .line 4514
    goto/16 :goto_0

    .line 4538
    .restart local v1       #hadApp:Z
    .restart local v5       #skipDestroy:Z
    :catch_0
    move-exception v6

    move-object v0, v6

    .line 4543
    .local v0, e:Ljava/lang/Exception;
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_3

    .line 4544
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4545
    const/4 v4, 0x1

    .line 4546
    const/4 v5, 0x1

    goto :goto_1

    .line 4559
    .end local v0           #e:Ljava/lang/Exception;
    :cond_6
    sget-object v6, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    goto :goto_2

    .line 4563
    .end local v5           #skipDestroy:Z
    :cond_7
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_8

    .line 4564
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4565
    const/4 v4, 0x1

    goto :goto_2

    .line 4567
    :cond_8
    sget-object v6, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    goto :goto_2
.end method

.method private final doPendingActivityLaunchesLocked(Z)V
    .locals 11
    .parameter "doResume"

    .prologue
    const/4 v10, 0x1

    .line 3288
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v7

    .line 3289
    .local v7, N:I
    if-gtz v7, :cond_0

    .line 3299
    :goto_0
    return-void

    .line 3292
    :cond_0
    const/4 v8, 0x0

    .local v8, i:I
    :goto_1
    if-ge v8, v7, :cond_2

    .line 3293
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;

    .line 3294
    .local v9, pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    iget-object v1, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->r:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->sourceRecord:Lcom/android/server/am/HistoryRecord;

    iget-object v3, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedUriPermissions:[Landroid/net/Uri;

    iget v4, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedMode:I

    iget-boolean v5, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->onlyIfNeeded:Z

    if-eqz p1, :cond_1

    sub-int v0, v7, v10

    if-ne v8, v0, :cond_1

    move v6, v10

    :goto_2
    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I

    .line 3292
    add-int/lit8 v8, v8, 0x1

    goto :goto_1

    .line 3294
    :cond_1
    const/4 v0, 0x0

    move v6, v0

    goto :goto_2

    .line 3298
    .end local v9           #pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    :cond_2
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->clear()V

    goto :goto_0
.end method

.method static final dumpApplicationMemoryUsage(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;[Ljava/lang/String;)V
    .locals 10
    .parameter "fd"
    .parameter "pw"
    .parameter "list"
    .parameter "prefix"
    .parameter "args"

    .prologue
    .line 10343
    const-string v8, "--checkin"

    invoke-static {p4, v8}, Lcom/android/server/am/ActivityManagerService;->scanArgs([Ljava/lang/String;Ljava/lang/String;)Z

    move-result v2

    .line 10344
    .local v2, isCheckinRequest:Z
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v6

    .line 10345
    .local v6, uptime:J
    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v4

    .line 10347
    .local v4, realtime:J
    if-eqz v2, :cond_2

    .line 10349
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v8, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, ","

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10350
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    .line 10355
    :goto_0
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v8

    const/4 v9, 0x1

    sub-int v1, v8, v9

    .local v1, i:I
    :goto_1
    if-ltz v1, :cond_3

    .line 10356
    invoke-interface {p2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 10357
    .local v3, r:Lcom/android/server/am/ProcessRecord;
    iget-object v8, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_1

    .line 10358
    if-nez v2, :cond_0

    .line 10359
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "\n** MEMINFO in pid "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget v9, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " ["

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget-object v9, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, "] **"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10360
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    .line 10363
    :cond_0
    :try_start_0
    iget-object v8, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v8}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v8

    invoke-interface {v8, p0, p4}, Landroid/os/IBinder;->dump(Ljava/io/FileDescriptor;[Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 10355
    :cond_1
    :goto_2
    add-int/lit8 v1, v1, -0x1

    goto :goto_1

    .line 10352
    .end local v1           #i:I
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :cond_2
    const-string v8, "Applications Memory Usage (kB):"

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10353
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Uptime: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " Realtime: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_0

    .line 10364
    .restart local v1       #i:I
    .restart local v3       #r:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v8

    move-object v0, v8

    .line 10365
    .local v0, e:Landroid/os/RemoteException;
    if-nez v2, :cond_1

    .line 10366
    const-string v8, "Got RemoteException!"

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10367
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    goto :goto_2

    .line 10372
    .end local v0           #e:Landroid/os/RemoteException;
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :cond_3
    return-void
.end method

.method private static final dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V
    .locals 8
    .parameter "pw"
    .parameter "list"
    .parameter "prefix"
    .parameter "label"
    .parameter "complete"

    .prologue
    const/4 v6, 0x1

    const-string v7, "  "

    .line 10246
    const/4 v2, 0x0

    .line 10247
    .local v2, lastTask:Lcom/android/server/am/TaskRecord;
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v4

    sub-int v1, v4, v6

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_6

    .line 10248
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 10249
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    if-nez p4, :cond_0

    iget-boolean v4, v3, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    if-nez v4, :cond_3

    :cond_0
    move v0, v6

    .line 10250
    .local v0, full:Z
    :goto_1
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v4, :cond_1

    .line 10251
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 10252
    invoke-virtual {p0, p2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10253
    if-eqz v0, :cond_4

    const-string v4, "* "

    :goto_2
    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10254
    invoke-virtual {p0, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10255
    if-eqz v0, :cond_1

    .line 10256
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "  "

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v2, p0, v4}, Lcom/android/server/am/TaskRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10259
    :cond_1
    invoke-virtual {p0, p2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    if-eqz v0, :cond_5

    const-string v4, "  * "

    :goto_3
    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p0, p3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10260
    const-string v4, " #"

    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v4, ": "

    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10261
    invoke-virtual {p0, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10262
    if-eqz v0, :cond_2

    .line 10263
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "      "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, p0, v4}, Lcom/android/server/am/HistoryRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10247
    :cond_2
    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    .line 10249
    .end local v0           #full:Z
    :cond_3
    const/4 v4, 0x0

    move v0, v4

    goto :goto_1

    .line 10253
    .restart local v0       #full:Z
    :cond_4
    const-string v4, "  "

    move-object v4, v7

    goto :goto_2

    .line 10259
    :cond_5
    const-string v4, "    "

    goto :goto_3

    .line 10266
    .end local v0           #full:Z
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_6
    return-void
.end method

.method private static final dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I
    .locals 8
    .parameter "pw"
    .parameter "service"
    .parameter "list"
    .parameter "prefix"
    .parameter "normalLabel"
    .parameter "persistentLabel"
    .parameter "inclOomAdj"

    .prologue
    .line 10280
    const/4 v0, 0x0

    .line 10281
    .local v0, numPers:I
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result p1

    .end local p1
    const/4 v1, 0x1

    sub-int/2addr p1, v1

    .local p1, i:I
    :goto_0
    if-ltz p1, :cond_f

    .line 10282
    invoke-interface {p2, p1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 10287
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    if-eqz p6, :cond_d

    .line 10289
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-lt v1, v3, :cond_3

    .line 10290
    const-string v1, "empty"

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .line 10311
    .local v1, oomAdj:Ljava/lang/String;
    :goto_1
    iget v3, v2, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    packed-switch v3, :pswitch_data_0

    .line 10319
    iget v3, v2, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    invoke-static {v3}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object v3

    .line 10322
    .local v3, schedGroup:Ljava/lang/String;
    :goto_2
    const-string v4, "%s%s #%2d: adj=%s/%s %s (%s)"

    const/4 v5, 0x7

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object p3, v5, v6

    const/4 v6, 0x1

    iget-boolean v7, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v7, :cond_c

    move-object v7, p5

    :goto_3
    aput-object v7, v5, v6

    const/4 v6, 0x2

    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x3

    aput-object v1, v5, v6

    const/4 v1, 0x4

    aput-object v3, v5, v1

    .end local v1           #oomAdj:Ljava/lang/String;
    const/4 v1, 0x5

    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->toShortString()Ljava/lang/String;

    move-result-object v3

    .end local v3           #schedGroup:Ljava/lang/String;
    aput-object v3, v5, v1

    const/4 v1, 0x6

    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    aput-object v3, v5, v1

    invoke-static {v4, v5}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10325
    iget-object v1, v2, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    if-nez v1, :cond_0

    iget-object v1, v2, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    if-eqz v1, :cond_1

    .line 10326
    :cond_0
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v3, "          "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v3, "<="

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10334
    :cond_1
    :goto_4
    iget-boolean v1, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v1, :cond_2

    .line 10335
    add-int/lit8 v0, v0, 0x1

    .line 10281
    :cond_2
    add-int/lit8 p1, p1, -0x1

    goto/16 :goto_0

    .line 10291
    :cond_3
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v1, v3, :cond_4

    .line 10292
    const-string v1, "bak"

    const-string v3, "  "

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10293
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_4
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    if-lt v1, v3, :cond_5

    .line 10294
    const-string v1, "home "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10295
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_5
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    if-lt v1, v3, :cond_6

    .line 10296
    const-string v1, "svc"

    const-string v3, "  "

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10297
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_6
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    if-lt v1, v3, :cond_7

    .line 10298
    const-string v1, "bckup"

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10299
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_7
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v1, v3, :cond_8

    .line 10300
    const-string v1, "vis  "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10301
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_8
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-lt v1, v3, :cond_9

    .line 10302
    const-string v1, "fore "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10303
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_9
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v3, -0xc

    if-lt v1, v3, :cond_a

    .line 10304
    const-string v1, "core "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v5, -0xc

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10305
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_a
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v3, -0x10

    if-lt v1, v3, :cond_b

    .line 10306
    const-string v1, "sys  "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v5, -0x10

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10308
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_b
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10313
    :pswitch_0
    const-string v3, "B"

    .line 10314
    .restart local v3       #schedGroup:Ljava/lang/String;
    goto/16 :goto_2

    .line 10316
    .end local v3           #schedGroup:Ljava/lang/String;
    :pswitch_1
    const-string v3, "F"

    .line 10317
    .restart local v3       #schedGroup:Ljava/lang/String;
    goto/16 :goto_2

    :cond_c
    move-object v7, p4

    .line 10322
    goto/16 :goto_3

    .line 10330
    .end local v1           #oomAdj:Ljava/lang/String;
    .end local v3           #schedGroup:Ljava/lang/String;
    :cond_d
    const-string v1, "%s%s #%2d: %s"

    const/4 v3, 0x4

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    aput-object p3, v3, v4

    const/4 v4, 0x1

    iget-boolean v5, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v5, :cond_e

    move-object v5, p5

    :goto_5
    aput-object v5, v3, v4

    const/4 v4, 0x2

    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x3

    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->toString()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_4

    :cond_e
    move-object v5, p4

    goto :goto_5

    .line 10338
    .end local v2           #r:Lcom/android/server/am/ProcessRecord;
    :cond_f
    return v0

    .line 10311
    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_1
        :pswitch_0
    .end packed-switch
.end method

.method private dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V
    .locals 3
    .parameter "fd"
    .parameter "pw"
    .parameter "r"
    .parameter "args"

    .prologue
    .line 9975
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "  Service "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p3, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9976
    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v1, :cond_0

    .line 9980
    :try_start_0
    invoke-virtual {p2}, Ljava/io/PrintWriter;->flush()V

    .line 9981
    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v1, p1, p3, p4}, Landroid/app/IApplicationThread;->dumpService(Ljava/io/FileDescriptor;Landroid/os/IBinder;[Ljava/lang/String;)V

    .line 9982
    const-string v1, "\n"

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 9987
    :cond_0
    :goto_0
    return-void

    .line 9983
    :catch_0
    move-exception v1

    move-object v0, v1

    .line 9984
    .local v0, e:Landroid/os/RemoteException;
    const-string v1, "got a RemoteException while dumping the service"

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_0
.end method

.method public static dumpStackTraces(ZLjava/util/ArrayList;)Ljava/io/File;
    .locals 13
    .parameter "clearTraces"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(Z",
            "Ljava/util/ArrayList",
            "<",
            "Ljava/lang/Integer;",
            ">;)",
            "Ljava/io/File;"
        }
    .end annotation

    .prologue
    .local p1, pids:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/Integer;>;"
    const/4 v11, 0x0

    const-string v12, "ActivityManager"

    .line 4795
    const-string v7, "dalvik.vm.stack-trace-file"

    invoke-static {v7, v11}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    .line 4796
    .local v6, tracesPath:Ljava/lang/String;
    if-eqz v6, :cond_0

    invoke-virtual {v6}, Ljava/lang/String;->length()I

    move-result v7

    if-nez v7, :cond_1

    :cond_0
    move-object v7, v11

    .line 4835
    .end local p0
    :goto_0
    return-object v7

    .line 4800
    .restart local p0
    :cond_1
    new-instance v5, Ljava/io/File;

    invoke-direct {v5, v6}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4802
    .local v5, tracesFile:Ljava/io/File;
    :try_start_0
    invoke-virtual {v5}, Ljava/io/File;->getParentFile()Ljava/io/File;

    move-result-object v4

    .line 4803
    .local v4, tracesDir:Ljava/io/File;
    invoke-virtual {v4}, Ljava/io/File;->exists()Z

    move-result v7

    if-nez v7, :cond_2

    invoke-virtual {v5}, Ljava/io/File;->mkdirs()Z

    .line 4804
    :cond_2
    invoke-virtual {v4}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v7

    const/16 v8, 0x1fd

    const/4 v9, -0x1

    const/4 v10, -0x1

    invoke-static {v7, v8, v9, v10}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I

    .line 4806
    if-eqz p0, :cond_3

    invoke-virtual {v5}, Ljava/io/File;->exists()Z

    move-result v7

    if-eqz v7, :cond_3

    invoke-virtual {v5}, Ljava/io/File;->delete()Z

    .line 4807
    :cond_3
    invoke-virtual {v5}, Ljava/io/File;->createNewFile()Z

    .line 4808
    invoke-virtual {v5}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v7

    const/16 v8, 0x1b6

    const/4 v9, -0x1

    const/4 v10, -0x1

    invoke-static {v7, v8, v9, v10}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    .line 4816
    new-instance v3, Lcom/android/server/am/ActivityManagerService$4;

    const/16 v7, 0x8

    invoke-direct {v3, v6, v7}, Lcom/android/server/am/ActivityManagerService$4;-><init>(Ljava/lang/String;I)V

    .line 4821
    .local v3, observer:Landroid/os/FileObserver;
    :try_start_1
    invoke-virtual {v3}, Landroid/os/FileObserver;->startWatching()V

    .line 4822
    invoke-virtual {p1}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 4823
    .local v2, num:I
    const/4 v1, 0x0

    .end local p0
    .local v1, i:I
    :goto_1
    if-ge v1, v2, :cond_4

    .line 4824
    monitor-enter v3
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1
    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_1

    .line 4825
    :try_start_2
    invoke-virtual {p1, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Ljava/lang/Integer;

    invoke-virtual {p0}, Ljava/lang/Integer;->intValue()I

    move-result v7

    const/4 v8, 0x3

    invoke-static {v7, v8}, Landroid/os/Process;->sendSignal(II)V

    .line 4826
    const-wide/16 v7, 0xc8

    invoke-virtual {v3, v7, v8}, Ljava/lang/Object;->wait(J)V

    .line 4827
    monitor-exit v3
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 4823
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .line 4809
    .end local v1           #i:I
    .end local v2           #num:I
    .end local v3           #observer:Landroid/os/FileObserver;
    .end local v4           #tracesDir:Ljava/io/File;
    .restart local p0
    :catch_0
    move-exception v7

    move-object v0, v7

    .line 4810
    .local v0, e:Ljava/io/IOException;
    const-string v7, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to prepare ANR traces file: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v12, v7, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    move-object v7, v11

    .line 4811
    goto :goto_0

    .line 4827
    .end local v0           #e:Ljava/io/IOException;
    .end local p0
    .restart local v1       #i:I
    .restart local v2       #num:I
    .restart local v3       #observer:Landroid/os/FileObserver;
    .restart local v4       #tracesDir:Ljava/io/File;
    :catchall_0
    move-exception v7

    :try_start_3
    monitor-exit v3
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v7
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1
    .catch Ljava/lang/InterruptedException; {:try_start_4 .. :try_end_4} :catch_1

    .line 4829
    .end local v1           #i:I
    .end local v2           #num:I
    :catch_1
    move-exception v7

    move-object v0, v7

    .line 4830
    .local v0, e:Ljava/lang/InterruptedException;
    :try_start_5
    const-string v7, "ActivityManager"

    invoke-static {v7, v0}, Landroid/util/Log;->wtf(Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 4832
    .end local v0           #e:Ljava/lang/InterruptedException;
    :cond_4
    invoke-virtual {v3}, Landroid/os/FileObserver;->stopWatching()V

    move-object v7, v5

    .line 4835
    goto/16 :goto_0

    .line 4832
    :catchall_1
    move-exception v7

    invoke-virtual {v3}, Landroid/os/FileObserver;->stopWatching()V

    throw v7
.end method

.method private final ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V
    .locals 2
    .parameter "starting"
    .parameter "configChanges"

    .prologue
    const/4 v1, 0x0

    .line 2466
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 2467
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    .line 2468
    invoke-direct {p0, v0, p1, v1, p2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 2470
    :cond_0
    return-void
.end method

.method private final ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V
    .locals 11
    .parameter "top"
    .parameter "starting"
    .parameter "onlyThisProcess"
    .parameter "configChanges"

    .prologue
    const/4 v9, 0x1

    const/4 v8, 0x0

    const-string v10, "ActivityManager"

    .line 2330
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 2331
    .local v1, count:I
    sub-int v4, v1, v9

    .line 2332
    .local v4, i:I
    :goto_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    if-eq v6, p1, :cond_0

    .line 2333
    add-int/lit8 v4, v4, -0x1

    goto :goto_0

    .line 2336
    :cond_0
    const/4 v0, 0x0

    .line 2337
    .local v0, behindFullscreen:Z
    :goto_1
    if-ltz v4, :cond_a

    .line 2338
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 2342
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_2

    .line 2337
    :cond_1
    add-int/lit8 v4, v4, -0x1

    goto :goto_1

    .line 2346
    :cond_2
    if-eqz p3, :cond_3

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    invoke-virtual {p3, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_d

    :cond_3
    move v2, v9

    .line 2351
    .local v2, doThisProcess:Z
    :goto_2
    if-eq v5, p2, :cond_4

    if-eqz v2, :cond_4

    .line 2352
    invoke-direct {p0, v5, v8}, Lcom/android/server/am/ActivityManagerService;->ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z

    .line 2355
    :cond_4
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_5

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v6, :cond_e

    .line 2356
    :cond_5
    if-eqz p3, :cond_6

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    invoke-virtual {p3, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_9

    .line 2363
    :cond_6
    if-eq v5, p2, :cond_7

    .line 2364
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v5, v6, p4}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 2366
    :cond_7
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v6, :cond_8

    .line 2369
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v5, v9}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2371
    :cond_8
    if-eq v5, p2, :cond_9

    .line 2372
    invoke-direct {p0, v5, v8, v8}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 2406
    :cond_9
    :goto_3
    iget v6, v5, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    or-int/2addr p4, v6

    .line 2408
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v6, :cond_1

    .line 2412
    const/4 v0, 0x1

    .line 2413
    add-int/lit8 v4, v4, -0x1

    .line 2420
    .end local v2           #doThisProcess:Z
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_a
    :goto_4
    if-ltz v4, :cond_11

    .line 2421
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 2426
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v6, :cond_c

    .line 2427
    if-eqz v0, :cond_10

    .line 2428
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v6, :cond_c

    .line 2431
    iput-boolean v8, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2433
    :try_start_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v7, 0x0

    invoke-virtual {v6, v5, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2434
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v6, v7, :cond_b

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v6, v7, :cond_c

    :cond_b
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_c

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_c

    .line 2439
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    const/4 v7, 0x0

    invoke-interface {v6, v5, v7}, Landroid/app/IApplicationThread;->scheduleWindowVisibility(Landroid/os/IBinder;Z)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    .line 2457
    :cond_c
    :goto_5
    add-int/lit8 v4, v4, -0x1

    goto :goto_4

    :cond_d
    move v2, v8

    .line 2346
    goto :goto_2

    .line 2376
    .restart local v2       #doThisProcess:Z
    :cond_e
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v6, :cond_f

    .line 2381
    invoke-virtual {v5, v8}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    goto :goto_3

    .line 2383
    :cond_f
    if-nez p3, :cond_9

    .line 2386
    iput-boolean v9, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2387
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v6, v7, :cond_9

    if-eq v5, p2, :cond_9

    .line 2393
    :try_start_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v7, 0x1

    invoke-virtual {v6, v5, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2394
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    const/4 v7, 0x1

    invoke-interface {v6, v5, v7}, Landroid/app/IApplicationThread;->scheduleWindowVisibility(Landroid/os/IBinder;Z)V

    .line 2395
    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V
    :try_end_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_3

    .line 2396
    :catch_0
    move-exception v6

    move-object v3, v6

    .line 2399
    .local v3, e:Ljava/lang/Exception;
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception thrown making visibile: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v5, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_3

    .line 2441
    .end local v2           #doThisProcess:Z
    .end local v3           #e:Ljava/lang/Exception;
    :catch_1
    move-exception v6

    move-object v3, v6

    .line 2444
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception thrown making hidden: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v5, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_5

    .line 2451
    .end local v3           #e:Ljava/lang/Exception;
    :cond_10
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v6, :cond_c

    .line 2454
    const/4 v0, 0x1

    goto :goto_5

    .line 2459
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_11
    return-void
.end method

.method private final ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z
    .locals 7
    .parameter "r"
    .parameter "globalChanges"

    .prologue
    const/4 v6, 0x0

    const/4 v5, 0x1

    .line 13690
    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    if-eqz v3, :cond_0

    move v3, v5

    .line 13795
    :goto_0
    return v3

    .line 13701
    :cond_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 13702
    .local v1, newConfig:Landroid/content/res/Configuration;
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    if-ne v3, v1, :cond_1

    move v3, v5

    .line 13705
    goto :goto_0

    .line 13709
    :cond_1
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_2

    .line 13712
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 13713
    goto :goto_0

    .line 13718
    :cond_2
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 13719
    .local v2, oldConfig:Landroid/content/res/Configuration;
    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 13723
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_3

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v3, :cond_4

    .line 13726
    :cond_3
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 13727
    goto :goto_0

    .line 13732
    :cond_4
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v3, :cond_9

    .line 13735
    invoke-virtual {v2, v1}, Landroid/content/res/Configuration;->diff(Landroid/content/res/Configuration;)I

    move-result v0

    .line 13742
    .local v0, changes:I
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v3, v3, Landroid/content/pm/ActivityInfo;->configChanges:I

    xor-int/lit8 v3, v3, -0x1

    and-int/2addr v3, v0

    if-eqz v3, :cond_9

    .line 13744
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    or-int/2addr v3, v0

    iput v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    .line 13745
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {p1, v3, p2}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 13746
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_5

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v3, :cond_6

    .line 13749
    :cond_5
    invoke-direct {p0, p1, v5}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    :goto_1
    move v3, v6

    .line 13776
    goto :goto_0

    .line 13750
    :cond_6
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_7

    .line 13756
    iput-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    move v3, v5

    .line 13757
    goto :goto_0

    .line 13758
    :cond_7
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_8

    .line 13765
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-direct {p0, p1, v3, v5}, Lcom/android/server/am/ActivityManagerService;->relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z

    .line 13766
    iput v6, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    goto :goto_1

    .line 13770
    :cond_8
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-direct {p0, p1, v3, v6}, Lcom/android/server/am/ActivityManagerService;->relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z

    .line 13771
    iput v6, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    goto :goto_1

    .line 13785
    .end local v0           #changes:I
    :cond_9
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_a

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_a

    .line 13788
    :try_start_0
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3, p1}, Landroid/app/IApplicationThread;->scheduleActivityConfigurationChanged(Landroid/os/IBinder;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13793
    :cond_a
    :goto_2
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 13795
    goto/16 :goto_0

    .line 13789
    :catch_0
    move-exception v3

    goto :goto_2
.end method

.method private ensurePackageDexOpt(Ljava/lang/String;)V
    .locals 2
    .parameter "packageName"

    .prologue
    .line 1754
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v0

    .line 1756
    .local v0, pm:Landroid/content/pm/IPackageManager;
    :try_start_0
    invoke-interface {v0, p1}, Landroid/content/pm/IPackageManager;->performDexOpt(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    .line 1757
    const/4 v1, 0x1

    iput-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mDidDexOpt:Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1761
    :cond_0
    :goto_0
    return-void

    .line 1759
    :catch_0
    move-exception v1

    goto :goto_0
.end method

.method private final findActivityInHistoryLocked(Lcom/android/server/am/HistoryRecord;I)I
    .locals 4
    .parameter "r"
    .parameter "task"

    .prologue
    .line 3073
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 3074
    .local v1, i:I
    :cond_0
    if-lez v1, :cond_1

    .line 3075
    add-int/lit8 v1, v1, -0x1

    .line 3076
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    .line 3077
    .local v0, candidate:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq v2, p2, :cond_2

    .line 3085
    .end local v0           #candidate:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, -0x1

    :goto_0
    return v2

    .line 3080
    .restart local v0       #candidate:Lcom/android/server/am/HistoryRecord;
    :cond_2
    iget-object v2, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v2, v3}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_0

    move v2, v1

    .line 3081
    goto :goto_0
.end method

.method private findActivityLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;
    .locals 6
    .parameter "intent"
    .parameter "info"

    .prologue
    .line 7622
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    .line 7623
    .local v1, cls:Landroid/content/ComponentName;
    iget-object v4, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    if-eqz v4, :cond_0

    .line 7624
    new-instance v1, Landroid/content/ComponentName;

    .end local v1           #cls:Landroid/content/ComponentName;
    iget-object v4, p2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    invoke-direct {v1, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 7627
    .restart local v1       #cls:Landroid/content/ComponentName;
    :cond_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7628
    .local v0, N:I
    const/4 v4, 0x1

    sub-int v2, v0, v4

    .local v2, i:I
    :goto_0
    if-ltz v2, :cond_2

    .line 7629
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7630
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v4, v3, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v4, :cond_1

    .line 7631
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v4}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    invoke-virtual {v4, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_1

    move-object v4, v3

    .line 7640
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v4

    .line 7628
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    add-int/lit8 v2, v2, -0x1

    goto :goto_0

    .line 7640
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    const/4 v4, 0x0

    goto :goto_1
.end method

.method private final findAffinityTaskTopLocked(ILjava/lang/String;)I
    .locals 8
    .parameter "startIndex"
    .parameter "affinity"

    .prologue
    const/4 v7, 0x1

    .line 6989
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    iget-object v4, v5, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6990
    .local v4, startTask:Lcom/android/server/am/TaskRecord;
    move-object v2, v4

    .line 6993
    .local v2, jt:Lcom/android/server/am/TaskRecord;
    sub-int v1, p1, v7

    .local v1, j:I
    :goto_0
    if-ltz v1, :cond_1

    .line 6994
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 6995
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_0

    .line 6996
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6997
    iget-object v5, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_0

    move v5, v1

    .line 7021
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    .end local p0
    :goto_1
    return v5

    .line 6993
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p0
    :cond_0
    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    .line 7004
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7005
    .local v0, N:I
    move-object v2, v4

    .line 7006
    add-int/lit8 v1, p1, 0x1

    :goto_2
    if-ge v1, v0, :cond_4

    .line 7007
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7008
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_3

    .line 7009
    iget-object v5, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2

    move v5, v1

    .line 7010
    goto :goto_1

    .line 7012
    :cond_2
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7006
    :cond_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 7017
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v6, v0, v7

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/HistoryRecord;

    iget-object v5, p0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_5

    .line 7018
    sub-int v5, v0, v7

    goto :goto_1

    .line 7021
    :cond_5
    const/4 v5, -0x1

    goto :goto_1
.end method

.method private findAppProcess(Landroid/os/IBinder;)Lcom/android/server/am/ProcessRecord;
    .locals 9
    .parameter "app"

    .prologue
    const/4 v8, 0x0

    .line 9179
    if-nez p1, :cond_0

    move-object v5, v8

    .line 9195
    :goto_0
    return-object v5

    .line 9183
    :cond_0
    monitor-enter p0

    .line 9184
    :try_start_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v5}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v5

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :cond_1
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_3

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/SparseArray;

    .line 9185
    .local v1, apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v0

    .line 9186
    .local v0, NA:I
    const/4 v3, 0x0

    .local v3, ia:I
    :goto_1
    if-ge v3, v0, :cond_1

    .line 9187
    invoke-virtual {v1, v3}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ProcessRecord;

    .line 9188
    .local v4, p:Lcom/android/server/am/ProcessRecord;
    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_2

    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v5}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    if-ne v5, p1, :cond_2

    .line 9189
    monitor-exit p0

    move-object v5, v4

    goto :goto_0

    .line 9186
    :cond_2
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 9194
    .end local v0           #NA:I
    .end local v1           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v3           #ia:I
    .end local v4           #p:Lcom/android/server/am/ProcessRecord;
    :cond_3
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Can\'t find mystery application: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9195
    monitor-exit p0

    move-object v5, v8

    goto :goto_0

    .line 9196
    .end local v2           #i$:Ljava/util/Iterator;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5
.end method

.method private findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .locals 12
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    const/4 v11, 0x0

    .line 10839
    const/4 v5, 0x0

    .line 10840
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    if-eqz v8, :cond_0

    .line 10841
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10843
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    if-nez v5, :cond_1

    .line 10844
    new-instance v3, Landroid/content/Intent$FilterComparison;

    invoke-direct {v3, p1}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 10845
    .local v3, filter:Landroid/content/Intent$FilterComparison;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    invoke-virtual {v8, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10848
    .end local v3           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_1
    if-nez v5, :cond_4

    .line 10850
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v8

    const/4 v9, 0x0

    invoke-interface {v8, p1, p2, v9}, Landroid/content/pm/IPackageManager;->resolveService(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v6

    .line 10853
    .local v6, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v6, :cond_2

    iget-object v8, v6, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object v7, v8

    .line 10855
    .local v7, sInfo:Landroid/content/pm/ServiceInfo;
    :goto_0
    if-nez v7, :cond_3

    move-object v8, v11

    .line 10880
    .end local v6           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v7           #sInfo:Landroid/content/pm/ServiceInfo;
    :goto_1
    return-object v8

    .restart local v6       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_2
    move-object v7, v11

    .line 10853
    goto :goto_0

    .line 10859
    .restart local v7       #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_3
    new-instance v4, Landroid/content/ComponentName;

    iget-object v8, v7, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v9, v7, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v8, v9}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 10861
    .local v4, name:Landroid/content/ComponentName;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v8, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    move-object v0, v8

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v5, v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 10866
    .end local v4           #name:Landroid/content/ComponentName;
    .end local v6           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v7           #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_4
    :goto_2
    if-eqz v5, :cond_7

    .line 10867
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    .line 10868
    .local v1, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    .line 10869
    .local v2, callingUid:I
    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    iget-boolean v9, v5, Lcom/android/server/am/ServiceRecord;->exported:Z

    if-eqz v9, :cond_5

    const/4 v9, -0x1

    :goto_3
    invoke-virtual {p0, v8, v1, v2, v9}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v8

    if-eqz v8, :cond_6

    .line 10872
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Permission Denial: Accessing service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " from pid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ", uid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " requires "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10876
    new-instance v8, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    iget-object v9, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-direct {v8, p0, v11, v9}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto :goto_1

    .line 10869
    :cond_5
    iget-object v9, v5, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_3

    .line 10878
    :cond_6
    new-instance v8, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    invoke-direct {v8, p0, v5, v11}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto :goto_1

    .end local v1           #callingPid:I
    .end local v2           #callingUid:I
    :cond_7
    move-object v8, v11

    .line 10880
    goto :goto_1

    .line 10862
    :catch_0
    move-exception v8

    goto :goto_2
.end method

.method private final findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;
    .locals 2
    .parameter "name"
    .parameter "token"

    .prologue
    .line 10823
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    .line 10824
    .local v0, r:Lcom/android/server/am/ServiceRecord;
    if-ne v0, p2, :cond_0

    move-object v1, v0

    :goto_0
    return-object v1

    :cond_0
    const/4 v1, 0x0

    goto :goto_0
.end method

.method private findTaskLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;
    .locals 7
    .parameter "intent"
    .parameter "info"

    .prologue
    .line 7576
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    .line 7577
    .local v1, cls:Landroid/content/ComponentName;
    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    if-eqz v5, :cond_0

    .line 7578
    new-instance v1, Landroid/content/ComponentName;

    .end local v1           #cls:Landroid/content/ComponentName;
    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v6, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    invoke-direct {v1, v5, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 7581
    .restart local v1       #cls:Landroid/content/ComponentName;
    :cond_0
    const/4 v2, 0x0

    .line 7583
    .local v2, cp:Lcom/android/server/am/TaskRecord;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7584
    .local v0, N:I
    const/4 v5, 0x1

    sub-int v3, v0, v5

    .local v3, i:I
    :goto_0
    if-ltz v3, :cond_4

    .line 7585
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7586
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v5, :cond_3

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_3

    iget v5, v4, Lcom/android/server/am/HistoryRecord;->launchMode:I

    const/4 v6, 0x3

    if-eq v5, v6, :cond_3

    .line 7588
    iget-object v2, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7592
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    if-eqz v5, :cond_1

    .line 7593
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    iget-object v6, p2, Landroid/content/pm/ActivityInfo;->taskAffinity:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_3

    move-object v5, v4

    .line 7613
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v5

    .line 7597
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v5, :cond_2

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v5, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2

    move-object v5, v4

    .line 7602
    goto :goto_1

    .line 7603
    :cond_2
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    if-eqz v5, :cond_3

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v5, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_3

    move-object v5, v4

    .line 7608
    goto :goto_1

    .line 7584
    :cond_3
    add-int/lit8 v3, v3, -0x1

    goto :goto_0

    .line 7613
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    const/4 v5, 0x0

    goto :goto_1
.end method

.method private final finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z
    .locals 8
    .parameter "r"
    .parameter "index"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "reason"

    .prologue
    .line 4130
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v1, :cond_0

    .line 4131
    const-string v1, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Duplicate finish request for "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4132
    const/4 v1, 0x0

    .line 4220
    .end local p2
    :goto_0
    return v1

    .line 4135
    .restart local p2
    :cond_0
    const/4 v1, 0x1

    iput-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 4136
    const/16 v1, 0x7531

    const/4 v2, 0x4

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v3, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x1

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x2

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v4, v2, v3

    const/4 v3, 0x3

    aput-object p5, v2, v3

    invoke-static {v1, v2}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4139
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    const/4 v3, 0x1

    sub-int/2addr v2, v3

    iput v2, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 4140
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    const/4 v2, 0x1

    sub-int/2addr v1, v2

    if-ge p2, v1, :cond_2

    .line 4141
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    add-int/lit8 v2, p2, 0x1

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 4142
    .local v7, next:Lcom/android/server/am/HistoryRecord;
    iget-object v1, v7, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v1, v2, :cond_2

    .line 4143
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    if-eqz v1, :cond_1

    .line 4145
    const/4 v1, 0x1

    iput-boolean v1, v7, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 4147
    :cond_1
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getFlags()I

    move-result v1

    const/high16 v2, 0x8

    and-int/2addr v1, v2

    if-eqz v1, :cond_2

    .line 4151
    iget-object v1, v7, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    const/high16 v2, 0x8

    invoke-virtual {v1, v2}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 4156
    .end local v7           #next:Lcom/android/server/am/HistoryRecord;
    :cond_2
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->pauseKeyDispatchingLocked()V

    .line 4157
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_3

    .line 4158
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4162
    :cond_3
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 4163
    .local v0, resultTo:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_5

    .line 4167
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    if-lez v1, :cond_4

    .line 4168
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-direct {p0, v1, v2, p4, p1}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 4171
    :cond_4
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    iget v3, p1, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move-object v1, p1

    move v4, p3

    move-object v5, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/HistoryRecord;->addResultLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 4173
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 4180
    :cond_5
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 4181
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 4182
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 4183
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 4185
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_6

    .line 4189
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4192
    :cond_6
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_b

    .line 4193
    if-lez p2, :cond_7

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    const/4 v2, 0x1

    sub-int v2, p2, v2

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/HistoryRecord;

    iget-object v1, p2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v1, v2, :cond_9

    :cond_7
    const/4 v1, 0x1

    move v6, v1

    .line 4197
    .local v6, endTask:Z
    :goto_1
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    if-eqz v6, :cond_a

    const/16 v2, 0x2009

    :goto_2
    invoke-virtual {v1, v2}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 4202
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v2, 0x0

    invoke-virtual {v1, p1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 4204
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v1, :cond_8

    .line 4207
    const/4 v1, 0x0

    const/4 v2, 0x0

    invoke-direct {p0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 4220
    .end local v6           #endTask:Z
    :cond_8
    const/4 v1, 0x0

    goto/16 :goto_0

    .line 4193
    :cond_9
    const/4 v1, 0x0

    move v6, v1

    goto :goto_1

    .line 4197
    .restart local v6       #endTask:Z
    :cond_a
    const/16 v2, 0x2007

    goto :goto_2

    .line 4210
    .end local v6           #endTask:Z
    .restart local p2
    :cond_b
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v1, v2, :cond_8

    .line 4214
    const/4 v1, 0x1

    invoke-direct {p0, p1, p2, v1}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    if-nez v1, :cond_c

    const/4 v1, 0x1

    goto/16 :goto_0

    :cond_c
    const/4 v1, 0x0

    goto/16 :goto_0
.end method

.method private final finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;
    .locals 2
    .parameter "r"
    .parameter "mode"

    .prologue
    .line 4229
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 4230
    .local v0, index:I
    if-gez v0, :cond_0

    .line 4231
    const/4 v1, 0x0

    .line 4234
    :goto_0
    return-object v1

    :cond_0
    invoke-direct {p0, p1, v0, p2}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    goto :goto_0
.end method

.method private final finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "r"
    .parameter "index"
    .parameter "mode"

    .prologue
    const/4 v3, 0x0

    .line 4242
    const/4 v2, 0x2

    if-ne p3, v2, :cond_1

    iget-boolean v2, p1, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v2, :cond_1

    .line 4243
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 4244
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4245
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x3

    if-le v2, v3, :cond_0

    .line 4249
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v0

    .line 4250
    .local v0, msg:Landroid/os/Message;
    const/16 v2, 0xb

    iput v2, v0, Landroid/os/Message;->what:I

    .line 4251
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v0}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 4254
    .end local v0           #msg:Landroid/os/Message;
    :cond_0
    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v2, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4255
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    move-object v2, p1

    .line 4281
    :goto_0
    return-object v2

    .line 4260
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4261
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4262
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v2, p1, :cond_2

    .line 4263
    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4265
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4266
    .local v1, prevState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->FINISHING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v2, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4268
    if-eqz p3, :cond_3

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v1, v2, :cond_3

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->INITIALIZING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v1, v2, :cond_5

    .line 4273
    :cond_3
    const/4 v2, 0x1

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    move-result v2

    if-eqz v2, :cond_4

    move-object v2, v3

    goto :goto_0

    :cond_4
    move-object v2, p1

    goto :goto_0

    .line 4278
    :cond_5
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4279
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-object v2, p1

    .line 4281
    goto :goto_0
.end method

.method private final finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
    .locals 7
    .parameter "receiver"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "resultExtras"
    .parameter "resultAbort"
    .parameter "explicit"

    .prologue
    const/4 v6, 0x1

    const/4 v4, 0x0

    const/4 v3, 0x0

    const-string v5, "ActivityManager"

    .line 12789
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-nez v2, :cond_1

    .line 12790
    if-eqz p6, :cond_0

    .line 12791
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but no pending broadcasts"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_0
    move v2, v4

    .line 12835
    :goto_0
    return v2

    .line 12795
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v2, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/BroadcastRecord;

    .line 12796
    .local v0, r:Lcom/android/server/am/BroadcastRecord;
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    if-nez v2, :cond_3

    .line 12797
    if-eqz p6, :cond_2

    .line 12798
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but none active"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_2
    move v2, v4

    .line 12800
    goto :goto_0

    .line 12802
    :cond_3
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    if-eq v2, p1, :cond_4

    .line 12803
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but active receiver is different"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    move v2, v4

    .line 12804
    goto :goto_0

    .line 12806
    :cond_4
    iget v1, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 12807
    .local v1, state:I
    iput v4, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 12808
    if-nez v1, :cond_5

    .line 12809
    if-eqz p6, :cond_5

    .line 12810
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but state is IDLE"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12813
    :cond_5
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12814
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 12815
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-eqz v2, :cond_6

    .line 12816
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iput-object v3, v2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 12818
    :cond_6
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    if-eqz v2, :cond_7

    .line 12819
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    iget-object v2, v2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iput-object v3, v2, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12821
    :cond_7
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 12822
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12823
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    .line 12824
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    .line 12825
    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12827
    iput p2, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    .line 12828
    iput-object p3, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    .line 12829
    iput-object p4, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    .line 12830
    iput-boolean p5, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    .line 12835
    if-eq v1, v6, :cond_8

    const/4 v2, 0x3

    if-ne v1, v2, :cond_9

    :cond_8
    move v2, v6

    goto :goto_0

    :cond_9
    move v2, v4

    goto :goto_0
.end method

.method private final finishTaskMoveLocked(I)V
    .locals 1
    .parameter "task"

    .prologue
    .line 7408
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 7409
    return-void
.end method

.method private forceStopPackageLocked(Ljava/lang/String;I)V
    .locals 17
    .parameter "packageName"
    .parameter "uid"

    .prologue
    .line 5254
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x1

    move-object/from16 v3, p0

    move-object/from16 v4, p1

    move/from16 v5, p2

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 5255
    new-instance v6, Landroid/content/Intent;

    const-string v3, "android.intent.action.PACKAGE_RESTARTED"

    const-string v4, "package"

    const/4 v5, 0x0

    move-object v0, v4

    move-object/from16 v1, p1

    move-object v2, v5

    invoke-static {v0, v1, v2}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v4

    invoke-direct {v6, v3, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 5257
    .local v6, intent:Landroid/content/Intent;
    const-string v3, "android.intent.extra.UID"

    move-object v0, v6

    move-object v1, v3

    move/from16 v2, p2

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 5258
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    sget v15, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v16, 0x3e8

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5261
    return-void
.end method

.method private final forceStopPackageLocked(Ljava/lang/String;IZZZ)Z
    .locals 17
    .parameter "name"
    .parameter "uid"
    .parameter "callerWillRestart"
    .parameter "purgeCache"
    .parameter "doit"

    .prologue
    .line 5304
    if-gez p2, :cond_0

    .line 5306
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result p2

    .line 5311
    :cond_0
    :goto_0
    if-eqz p5, :cond_2

    .line 5312
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Force stopping package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5314
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v12

    .line 5315
    .local v12, badApps:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    :cond_1
    :goto_1
    invoke-interface {v12}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_2

    .line 5316
    invoke-interface {v12}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/util/SparseArray;

    .line 5317
    .local v11, ba:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    move-object v0, v11

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    if-eqz v3, :cond_1

    .line 5318
    invoke-interface {v12}, Ljava/util/Iterator;->remove()V

    goto :goto_1

    .line 5323
    .end local v11           #ba:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    .end local v12           #badApps:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    :cond_2
    const/16 v6, -0x64

    move-object/from16 v3, p0

    move-object/from16 v4, p1

    move/from16 v5, p2

    move/from16 v7, p3

    move/from16 v8, p5

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->killPackageProcessesLocked(Ljava/lang/String;IIZZ)Z

    move-result v13

    .line 5326
    .local v13, didSomething:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v5, v3, v4

    .local v5, i:I
    :goto_2
    if-ltz v5, :cond_6

    .line 5327
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 5328
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_5

    .line 5329
    if-nez p5, :cond_3

    .line 5330
    const/4 v3, 0x1

    .line 5373
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    .end local p2
    :goto_3
    return v3

    .line 5332
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p2
    :cond_3
    const/4 v13, 0x1

    .line 5333
    const-string v3, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  Force finishing activity "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5334
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    .line 5335
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v6, 0x1

    iput-boolean v6, v3, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5337
    :cond_4
    const/4 v3, 0x0

    iput-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 5338
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "uninstall"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 5326
    :cond_5
    add-int/lit8 v5, v5, -0x1

    goto :goto_2

    .line 5342
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_6
    new-instance v16, Ljava/util/ArrayList;

    invoke-direct/range {v16 .. v16}, Ljava/util/ArrayList;-><init>()V

    .line 5343
    .local v16, services:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ServiceRecord;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .local v14, i$:Ljava/util/Iterator;
    :cond_7
    :goto_4
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_a

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/android/server/am/ServiceRecord;

    .line 5344
    .local v15, service:Lcom/android/server/am/ServiceRecord;
    iget-object v3, v15, Lcom/android/server/am/ServiceRecord;->packageName:Ljava/lang/String;

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_7

    .line 5345
    if-nez p5, :cond_8

    .line 5346
    const/4 v3, 0x1

    goto :goto_3

    .line 5348
    :cond_8
    const/4 v13, 0x1

    .line 5349
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  Force stopping service "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5350
    iget-object v3, v15, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_9

    .line 5351
    iget-object v3, v15, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x1

    iput-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5353
    :cond_9
    const/4 v3, 0x0

    iput-object v3, v15, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 5354
    move-object/from16 v0, v16

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_4

    .line 5358
    .end local v15           #service:Lcom/android/server/am/ServiceRecord;
    :cond_a
    invoke-virtual/range {v16 .. v16}, Ljava/util/ArrayList;->size()I

    move-result v9

    .line 5359
    .local v9, N:I
    const/4 v5, 0x0

    .end local p2
    :goto_5
    if-ge v5, v9, :cond_b

    .line 5360
    move-object/from16 v0, v16

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/ServiceRecord;

    const/4 v3, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 5359
    add-int/lit8 v5, v5, 0x1

    goto :goto_5

    .line 5363
    :cond_b
    if-eqz p5, :cond_d

    .line 5364
    if-eqz p4, :cond_c

    .line 5365
    invoke-static {}, Lcom/android/server/AttributeCache;->instance()Lcom/android/server/AttributeCache;

    move-result-object v10

    .line 5366
    .local v10, ac:Lcom/android/server/AttributeCache;
    if-eqz v10, :cond_c

    .line 5367
    move-object v0, v10

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Lcom/android/server/AttributeCache;->removePackage(Ljava/lang/String;)V

    .line 5370
    .end local v10           #ac:Lcom/android/server/AttributeCache;
    :cond_c
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    :cond_d
    move v3, v13

    .line 5373
    goto/16 :goto_3

    .line 5307
    .end local v5           #i:I
    .end local v9           #N:I
    .end local v13           #didSomething:Z
    .end local v14           #i$:Ljava/util/Iterator;
    .end local v16           #services:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ServiceRecord;>;"
    .restart local p2
    :catch_0
    move-exception v3

    goto/16 :goto_0
.end method

.method private final generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;
    .locals 9
    .parameter "app"

    .prologue
    .line 7750
    const/4 v4, 0x0

    .line 7752
    .local v4, providers:Ljava/util/List;
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    const/16 v8, 0xc00

    invoke-interface {v5, v6, v7, v8}, Landroid/content/pm/IPackageManager;->queryContentProviders(Ljava/lang/String;II)Ljava/util/List;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v4

    .line 7757
    :goto_0
    if-eqz v4, :cond_1

    .line 7758
    invoke-interface {v4}, Ljava/util/List;->size()I

    move-result v0

    .line 7759
    .local v0, N:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_1
    if-ge v3, v0, :cond_1

    .line 7760
    invoke-interface {v4, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ProviderInfo;

    .line 7762
    .local v1, cpi:Landroid/content/pm/ProviderInfo;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 7764
    .local v2, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v2, :cond_0

    .line 7765
    new-instance v2, Lcom/android/server/am/ContentProviderRecord;

    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-direct {v2, v1, v5}, Lcom/android/server/am/ContentProviderRecord;-><init>(Landroid/content/pm/ProviderInfo;Landroid/content/pm/ApplicationInfo;)V

    .line 7766
    .restart local v2       #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7768
    :cond_0
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7769
    iget-object v5, v1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p1, v5}, Lcom/android/server/am/ProcessRecord;->addPackage(Ljava/lang/String;)Z

    .line 7770
    iget-object v5, v1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 7759
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 7773
    .end local v0           #N:I
    .end local v1           #cpi:Landroid/content/pm/ProviderInfo;
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i:I
    :cond_1
    return-object v4

    .line 7755
    :catch_0
    move-exception v5

    goto :goto_0
.end method

.method private generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/app/ActivityManager$ProcessErrorStateInfo;
    .locals 2
    .parameter "app"
    .parameter "condition"
    .parameter "activity"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "stackTrace"

    .prologue
    .line 8977
    new-instance v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;

    invoke-direct {v0}, Landroid/app/ActivityManager$ProcessErrorStateInfo;-><init>()V

    .line 8979
    .local v0, report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    iput p2, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->condition:I

    .line 8980
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->processName:Ljava/lang/String;

    .line 8981
    iget v1, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->pid:I

    .line 8982
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->uid:I

    .line 8983
    iput-object p3, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->tag:Ljava/lang/String;

    .line 8984
    iput-object p4, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->shortMsg:Ljava/lang/String;

    .line 8985
    iput-object p5, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->longMsg:Ljava/lang/String;

    .line 8986
    iput-object p6, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->stackTrace:Ljava/lang/String;

    .line 8988
    return-object v0
.end method

.method private getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;
    .locals 3
    .parameter "token"

    .prologue
    .line 6047
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6048
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6049
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 6050
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v1, :cond_0

    .line 6051
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 6054
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v2

    :cond_0
    const/4 v2, 0x0

    goto :goto_0
.end method

.method private getCommonServicesLocked()Ljava/util/HashMap;
    .locals 5
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Landroid/os/IBinder;",
            ">;"
        }
    .end annotation

    .prologue
    const-string v4, "window"

    const-string v3, "package"

    const-string v2, "alarm"

    .line 1584
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    if-nez v0, :cond_0

    .line 1585
    new-instance v0, Ljava/util/HashMap;

    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    .line 1588
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "package"

    const-string v1, "package"

    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v3, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1589
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "window"

    const-string v1, "window"

    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v4, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1590
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "alarm"

    const-string v1, "alarm"

    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v2, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1593
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    return-object v0
.end method

.method private getContentProviderExternal(Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .locals 1
    .parameter "name"

    .prologue
    .line 8044
    const/4 v0, 0x0

    invoke-direct {p0, v0, p1}, Lcom/android/server/am/ActivityManagerService;->getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v0

    return-object v0
.end method

.method private final getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .locals 24
    .parameter "caller"
    .parameter "name"

    .prologue
    .line 7823
    const/4 v15, 0x0

    .line 7825
    .local v15, cpi:Landroid/content/pm/ProviderInfo;
    monitor-enter p0

    .line 7826
    const/16 v23, 0x0

    .line 7827
    .local v23, r:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_0

    .line 7828
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v23

    .line 7829
    if-nez v23, :cond_0

    .line 7830
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ") when getting content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 8007
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 7838
    :cond_0
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/android/server/am/ContentProviderRecord;

    .line 7839
    .local v16, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v16, :cond_9

    .line 7840
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object v15, v0

    .line 7841
    const/4 v4, -0x1

    move-object/from16 v0, p0

    move-object v1, v15

    move-object/from16 v2, v23

    move v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_2

    .line 7842
    new-instance v4, Landroid/app/IActivityManager$ContentProviderHolder;

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v5, :cond_1

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    :goto_0
    invoke-direct {v4, v15, v5}, Landroid/app/IActivityManager$ContentProviderHolder;-><init>(Landroid/content/pm/ProviderInfo;Ljava/lang/String;)V

    monitor-exit p0

    .line 8028
    :goto_1
    return-object v4

    .line 7842
    :cond_1
    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    goto :goto_0

    .line 7847
    :cond_2
    if-eqz v23, :cond_4

    move-object/from16 v0, v16

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Lcom/android/server/am/ContentProviderRecord;->canRunHere(Lcom/android/server/am/ProcessRecord;)Z

    move-result v4

    if-eqz v4, :cond_4

    .line 7852
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    move-object v4, v0

    if-eqz v4, :cond_3

    .line 7855
    new-instance v17, Lcom/android/server/am/ContentProviderRecord;

    move-object/from16 v0, v17

    move-object/from16 v1, v16

    invoke-direct {v0, v1}, Lcom/android/server/am/ContentProviderRecord;-><init>(Lcom/android/server/am/ContentProviderRecord;)V

    .end local v16           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .local v17, cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object/from16 v16, v17

    .line 7857
    .end local v17           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v16       #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_3
    monitor-exit p0

    move-object/from16 v4, v16

    goto :goto_1

    .line 7860
    :cond_4
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v20

    .line 7864
    .local v20, origId:J
    if-eqz v23, :cond_8

    .line 7869
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/lang/Integer;

    .line 7870
    .local v14, cnt:Ljava/lang/Integer;
    if-nez v14, :cond_7

    .line 7871
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    const/4 v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7875
    :goto_2
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 7876
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_5

    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->setAdj:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v4, v5, :cond_5

    .line 7881
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    const/4 v5, 0x0

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 7887
    .end local v14           #cnt:Ljava/lang/Integer;
    :cond_5
    :goto_3
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_6

    .line 7888
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 7891
    :cond_6
    invoke-static/range {v20 .. v21}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8007
    .end local v20           #origId:J
    :goto_4
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8010
    monitor-enter v16

    .line 8011
    :goto_5
    :try_start_2
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    move-object v4, v0

    if-nez v4, :cond_1a

    .line 8012
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-nez v4, :cond_19

    .line 8013
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to launch app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " for provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": launching app became null"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8017
    const/16 v4, 0x7554

    const/4 v5, 0x3

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    iget-object v7, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    aput-object v7, v5, v6

    const/4 v6, 0x1

    iget-object v7, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x2

    aput-object p2, v5, v6

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8020
    const/4 v4, 0x0

    monitor-exit v16

    goto/16 :goto_1

    .line 8027
    :catchall_1
    move-exception v4

    monitor-exit v16
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    throw v4

    .line 7873
    .restart local v14       #cnt:Ljava/lang/Integer;
    .restart local v20       #origId:J
    :cond_7
    :try_start_3
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    invoke-virtual {v14}, Ljava/lang/Integer;->intValue()I

    move-result v6

    add-int/lit8 v6, v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto/16 :goto_2

    .line 7884
    .end local v14           #cnt:Ljava/lang/Integer;
    :cond_8
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ContentProviderRecord;->externals:I

    move v4, v0

    add-int/lit8 v4, v4, 0x1

    move v0, v4

    move-object/from16 v1, v16

    iput v0, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto/16 :goto_3

    .line 7895
    .end local v20           #origId:J
    :cond_9
    :try_start_4
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const/16 v5, 0xc00

    move-object v0, v4

    move-object/from16 v1, p2

    move v2, v5

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_2

    move-result-object v15

    .line 7900
    :goto_6
    if-nez v15, :cond_a

    .line 7901
    const/4 v4, 0x0

    :try_start_5
    monitor-exit p0

    goto/16 :goto_1

    .line 7904
    :cond_a
    const/4 v4, -0x1

    move-object/from16 v0, p0

    move-object v1, v15

    move-object/from16 v2, v23

    move v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_c

    .line 7905
    new-instance v4, Landroid/app/IActivityManager$ContentProviderHolder;

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v5, :cond_b

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    :goto_7
    invoke-direct {v4, v15, v5}, Landroid/app/IActivityManager$ContentProviderHolder;-><init>(Landroid/content/pm/ProviderInfo;Ljava/lang/String;)V

    monitor-exit p0

    goto/16 :goto_1

    :cond_b
    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    goto :goto_7

    .line 7910
    :cond_c
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v4, v0

    if-nez v4, :cond_d

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    move v4, v0

    if-nez v4, :cond_d

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    move v4, v0

    if-nez v4, :cond_d

    iget-object v4, v15, Landroid/content/pm/ProviderInfo;->processName:Ljava/lang/String;

    const-string v5, "system"

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_d

    .line 7915
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "Attempt to launch content provider before system ready"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 7919
    :cond_d
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    move-object v4, v0

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v16

    .end local v16           #cpr:Lcom/android/server/am/ContentProviderRecord;
    check-cast v16, Lcom/android/server/am/ContentProviderRecord;
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 7920
    .restart local v16       #cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v16, :cond_e

    const/4 v4, 0x1

    move/from16 v18, v4

    .line 7921
    .local v18, firstClass:Z
    :goto_8
    if-eqz v18, :cond_10

    .line 7923
    :try_start_6
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    const/16 v6, 0x400

    invoke-interface {v4, v5, v6}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v13

    .line 7928
    .local v13, ai:Landroid/content/pm/ApplicationInfo;
    if-nez v13, :cond_f

    .line 7929
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "No package info for content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_1

    .line 7931
    const/4 v4, 0x0

    :try_start_7
    monitor-exit p0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_0

    goto/16 :goto_1

    .line 7920
    .end local v13           #ai:Landroid/content/pm/ApplicationInfo;
    .end local v18           #firstClass:Z
    :cond_e
    const/4 v4, 0x0

    move/from16 v18, v4

    goto :goto_8

    .line 7933
    .restart local v13       #ai:Landroid/content/pm/ApplicationInfo;
    .restart local v18       #firstClass:Z
    :cond_f
    :try_start_8
    new-instance v17, Lcom/android/server/am/ContentProviderRecord;

    move-object/from16 v0, v17

    move-object v1, v15

    move-object v2, v13

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ContentProviderRecord;-><init>(Landroid/content/pm/ProviderInfo;Landroid/content/pm/ApplicationInfo;)V
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_8 .. :try_end_8} :catch_1

    .end local v16           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v17       #cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object/from16 v16, v17

    .line 7939
    .end local v13           #ai:Landroid/content/pm/ApplicationInfo;
    .end local v17           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v16       #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_10
    :goto_9
    if-eqz v23, :cond_11

    :try_start_9
    move-object/from16 v0, v16

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Lcom/android/server/am/ContentProviderRecord;->canRunHere(Lcom/android/server/am/ProcessRecord;)Z

    move-result v4

    if-eqz v4, :cond_11

    .line 7944
    monitor-exit p0

    move-object/from16 v4, v16

    goto/16 :goto_1

    .line 7956
    :cond_11
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v12

    .line 7958
    .local v12, N:I
    const/16 v19, 0x0

    .local v19, i:I
    :goto_a
    move/from16 v0, v19

    move v1, v12

    if-ge v0, v1, :cond_12

    .line 7959
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, v16

    if-ne v0, v1, :cond_13

    .line 7966
    :cond_12
    move/from16 v0, v19

    move v1, v12

    if-lt v0, v1, :cond_15

    .line 7967
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v20

    .line 7968
    .restart local v20       #origId:J
    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->processName:Ljava/lang/String;

    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const-string v9, "content provider"

    new-instance v10, Landroid/content/ComponentName;

    iget-object v4, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v11, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-direct {v10, v4, v11}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    const/4 v11, 0x0

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v11}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v22

    .line 7972
    .local v22, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v22, :cond_14

    .line 7973
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to launch app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " for provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": process is bad"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7977
    const/4 v4, 0x0

    monitor-exit p0

    goto/16 :goto_1

    .line 7958
    .end local v20           #origId:J
    .end local v22           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_13
    add-int/lit8 v19, v19, 0x1

    goto/16 :goto_a

    .line 7979
    .restart local v20       #origId:J
    .restart local v22       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_14
    move-object/from16 v0, v22

    move-object/from16 v1, v16

    iput-object v0, v1, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    .line 7980
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7981
    invoke-static/range {v20 .. v21}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7986
    .end local v20           #origId:J
    .end local v22           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_15
    if-eqz v18, :cond_16

    .line 7987
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    move-object v4, v0

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object v0, v4

    move-object v1, v5

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7989
    :cond_16
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p2

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7991
    if-eqz v23, :cond_18

    .line 7996
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/lang/Integer;

    .line 7997
    .restart local v14       #cnt:Ljava/lang/Integer;
    if-nez v14, :cond_17

    .line 7998
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    const/4 v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8002
    :goto_b
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_4

    .line 8000
    :cond_17
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    invoke-virtual {v14}, Ljava/lang/Integer;->intValue()I

    move-result v6

    add-int/lit8 v6, v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_b

    .line 8004
    .end local v14           #cnt:Ljava/lang/Integer;
    :cond_18
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ContentProviderRecord;->externals:I

    move v4, v0

    add-int/lit8 v4, v4, 0x1

    move v0, v4

    move-object/from16 v1, v16

    iput v0, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_0

    goto/16 :goto_4

    .line 8023
    .end local v12           #N:I
    .end local v18           #firstClass:Z
    .end local v19           #i:I
    :cond_19
    :try_start_a
    invoke-virtual/range {v16 .. v16}, Ljava/lang/Object;->wait()V
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_1
    .catch Ljava/lang/InterruptedException; {:try_start_a .. :try_end_a} :catch_0

    goto/16 :goto_5

    .line 8024
    :catch_0
    move-exception v4

    goto/16 :goto_5

    .line 8027
    :cond_1a
    :try_start_b
    monitor-exit v16
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_1

    move-object/from16 v4, v16

    .line 8028
    goto/16 :goto_1

    .line 7934
    .restart local v18       #firstClass:Z
    :catch_1
    move-exception v4

    goto/16 :goto_9

    .line 7898
    .end local v18           #firstClass:Z
    :catch_2
    move-exception v4

    goto/16 :goto_6
.end method

.method private final getLRURecordIndexForAppLocked(Landroid/app/IApplicationThread;)I
    .locals 5
    .parameter "thread"

    .prologue
    .line 4696
    invoke-interface {p1}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v2

    .line 4699
    .local v2, threadBinder:Landroid/os/IBinder;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v0, v3, v4

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 4700
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 4701
    .local v1, rec:Lcom/android/server/am/ProcessRecord;
    iget-object v3, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_0

    iget-object v3, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v3

    if-ne v3, v2, :cond_0

    move v3, v0

    .line 4705
    .end local v1           #rec:Lcom/android/server/am/ProcessRecord;
    :goto_1
    return v3

    .line 4699
    .restart local v1       #rec:Lcom/android/server/am/ProcessRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 4705
    .end local v1           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/4 v3, -0x1

    goto :goto_1
.end method

.method private final getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;
    .locals 3
    .parameter "processName"
    .parameter "uid"

    .prologue
    .line 1741
    const/16 v2, 0x3e8

    if-ne p2, v2, :cond_1

    .line 1745
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v2}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/SparseArray;

    .line 1747
    .local v1, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    if-eqz v1, :cond_0

    const/4 v2, 0x0

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/ProcessRecord;

    move-object v2, p0

    .line 1750
    .end local v1           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    :goto_0
    return-object v2

    .line 1747
    .restart local v1       #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local p0
    :cond_0
    const/4 v2, 0x0

    goto :goto_0

    .line 1749
    .end local v1           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v2, p1, p2}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .local v0, proc:Lcom/android/server/am/ProcessRecord;
    move-object v2, v0

    .line 1750
    goto :goto_0
.end method

.method private final getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;
    .locals 2
    .parameter "thread"

    .prologue
    const/4 v1, 0x0

    .line 4710
    if-nez p1, :cond_1

    .line 4715
    .end local p0
    :cond_0
    :goto_0
    return-object v1

    .line 4714
    .restart local p0
    :cond_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getLRURecordIndexForAppLocked(Landroid/app/IApplicationThread;)I

    move-result v0

    .line 4715
    .local v0, appIndex:I
    if-ltz v0, :cond_0

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/ProcessRecord;

    move-object v1, p0

    goto :goto_0
.end method

.method private final getStickiesLocked(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;
    .locals 8
    .parameter "action"
    .parameter "filter"
    .parameter "cur"

    .prologue
    .line 12207
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v6}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v5

    .line 12208
    .local v5, resolver:Landroid/content/ContentResolver;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    invoke-virtual {v6, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/util/ArrayList;

    .line 12209
    .local v4, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-nez v4, :cond_0

    move-object v1, p3

    .line 12222
    .end local p3
    .local v1, cur:Ljava/util/List;
    :goto_0
    return-object v1

    .line 12212
    .end local v1           #cur:Ljava/util/List;
    .restart local p3
    :cond_0
    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 12213
    .local v0, N:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_1
    if-ge v2, v0, :cond_3

    .line 12214
    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/Intent;

    .line 12215
    .local v3, intent:Landroid/content/Intent;
    const/4 v6, 0x1

    const-string v7, "ActivityManager"

    invoke-virtual {p2, v5, v3, v6, v7}, Landroid/content/IntentFilter;->match(Landroid/content/ContentResolver;Landroid/content/Intent;ZLjava/lang/String;)I

    move-result v6

    if-ltz v6, :cond_2

    .line 12216
    if-nez p3, :cond_1

    .line 12217
    new-instance p3, Ljava/util/ArrayList;

    .end local p3
    invoke-direct {p3}, Ljava/util/ArrayList;-><init>()V

    .line 12219
    .restart local p3
    :cond_1
    invoke-interface {p3, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 12213
    :cond_2
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    .end local v3           #intent:Landroid/content/Intent;
    :cond_3
    move-object v1, p3

    .line 12222
    .end local p3
    .restart local v1       #cur:Ljava/util/List;
    goto :goto_0
.end method

.method private grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "callingUid"
    .parameter "targetPkg"
    .parameter "intent"
    .parameter "activity"

    .prologue
    .line 6570
    if-nez p3, :cond_1

    .line 6579
    :cond_0
    :goto_0
    return-void

    .line 6573
    :cond_1
    invoke-virtual {p3}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v3

    .line 6574
    .local v3, data:Landroid/net/Uri;
    if-eqz v3, :cond_0

    .line 6577
    invoke-virtual {p3}, Landroid/content/Intent;->getFlags()I

    move-result v4

    move-object v0, p0

    move v1, p1

    move-object v2, p2

    move-object v5, p4

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    goto :goto_0
.end method

.method private grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V
    .locals 19
    .parameter "callingUid"
    .parameter "targetPkg"
    .parameter "uri"
    .parameter "modeFlags"
    .parameter "activity"

    .prologue
    .line 6440
    and-int/lit8 p4, p4, 0x3

    .line 6442
    if-nez p4, :cond_1

    .line 6566
    :cond_0
    :goto_0
    return-void

    .line 6449
    :cond_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v13

    .line 6452
    .local v13, pm:Landroid/content/pm/IPackageManager;
    const-string v16, "content"

    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getScheme()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v16

    if-eqz v16, :cond_0

    .line 6458
    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v10

    .line 6459
    .local v10, name:Ljava/lang/String;
    const/4 v12, 0x0

    .line 6460
    .local v12, pi:Landroid/content/pm/ProviderInfo;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v10

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 6462
    .local v7, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v7, :cond_2

    .line 6463
    iget-object v12, v7, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6471
    :goto_1
    if-nez v12, :cond_3

    .line 6472
    const-string v16, "ActivityManager"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "No content provider found for: "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object v1, v10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v16 .. v17}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 6466
    :cond_2
    const/16 v16, 0x800

    :try_start_0
    move-object v0, v13

    move-object v1, v10

    move/from16 v2, v16

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1

    move-result-object v12

    goto :goto_1

    .line 6478
    :cond_3
    :try_start_1
    move-object v0, v13

    move-object/from16 v1, p2

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v14

    .line 6479
    .local v14, targetUid:I
    if-ltz v14, :cond_0

    .line 6489
    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v12

    move v3, v14

    move/from16 v4, p4

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v16

    if-nez v16, :cond_0

    .line 6497
    move-object v0, v12

    iget-boolean v0, v0, Landroid/content/pm/ProviderInfo;->grantUriPermissions:Z

    move/from16 v16, v0

    if-nez v16, :cond_4

    .line 6498
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Provider "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, "/"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not allow granting of Uri permissions (uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, ")"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6484
    .end local v14           #targetUid:I
    :catch_0
    move-exception v8

    .line 6485
    .local v8, ex:Landroid/os/RemoteException;
    goto/16 :goto_0

    .line 6503
    .end local v8           #ex:Landroid/os/RemoteException;
    .restart local v14       #targetUid:I
    :cond_4
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    if-eqz v16, :cond_7

    .line 6504
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    array-length v0, v0

    move v5, v0

    .line 6505
    .local v5, N:I
    const/4 v6, 0x0

    .line 6506
    .local v6, allowed:Z
    const/4 v9, 0x0

    .local v9, i:I
    :goto_2
    if-ge v9, v5, :cond_5

    .line 6507
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    aget-object v16, v16, v9

    if-eqz v16, :cond_6

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    aget-object v16, v16, v9

    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getPath()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Landroid/os/PatternMatcher;->match(Ljava/lang/String;)Z

    move-result v16

    if-eqz v16, :cond_6

    .line 6509
    const/4 v6, 0x1

    .line 6513
    :cond_5
    if-nez v6, :cond_7

    .line 6514
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Provider "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, "/"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not allow granting of permission to path of Uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6506
    :cond_6
    add-int/lit8 v9, v9, 0x1

    goto :goto_2

    .line 6523
    .end local v5           #N:I
    .end local v6           #allowed:Z
    .end local v9           #i:I
    :cond_7
    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v12

    move/from16 v3, p1

    move/from16 v4, p4

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v16

    if-nez v16, :cond_8

    .line 6524
    move-object/from16 v0, p0

    move-object/from16 v1, p3

    move/from16 v2, p1

    move/from16 v3, p4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkUriPermissionLocked(Landroid/net/Uri;II)Z

    move-result v16

    if-nez v16, :cond_8

    .line 6525
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Uid "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not have permission to uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6537
    :cond_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move v1, v14

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Ljava/util/HashMap;

    .line 6539
    .local v15, targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-nez v15, :cond_9

    .line 6540
    new-instance v15, Ljava/util/HashMap;

    .end local v15           #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    invoke-direct {v15}, Ljava/util/HashMap;-><init>()V

    .line 6541
    .restart local v15       #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move v1, v14

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 6544
    :cond_9
    move-object v0, v15

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/UriPermission;

    .line 6545
    .local v11, perm:Lcom/android/server/am/UriPermission;
    if-nez v11, :cond_a

    .line 6546
    new-instance v11, Lcom/android/server/am/UriPermission;

    .end local v11           #perm:Lcom/android/server/am/UriPermission;
    move-object v0, v11

    move v1, v14

    move-object/from16 v2, p3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/UriPermission;-><init>(ILandroid/net/Uri;)V

    .line 6547
    .restart local v11       #perm:Lcom/android/server/am/UriPermission;
    move-object v0, v15

    move-object/from16 v1, p3

    move-object v2, v11

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 6550
    :cond_a
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    move/from16 v16, v0

    or-int v16, v16, p4

    move/from16 v0, v16

    move-object v1, v11

    iput v0, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6551
    if-nez p5, :cond_b

    .line 6552
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    move/from16 v16, v0

    or-int v16, v16, p4

    move/from16 v0, v16

    move-object v1, v11

    iput v0, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    goto/16 :goto_0

    .line 6553
    :cond_b
    and-int/lit8 v16, p4, 0x1

    if-eqz v16, :cond_d

    .line 6554
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6555
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    if-nez v16, :cond_c

    .line 6556
    new-instance v16, Ljava/util/HashSet;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashSet;-><init>()V

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    .line 6558
    :cond_c
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_0

    .line 6559
    :cond_d
    and-int/lit8 v16, p4, 0x2

    if-eqz v16, :cond_0

    .line 6560
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6561
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    if-nez v16, :cond_e

    .line 6562
    new-instance v16, Ljava/util/HashSet;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashSet;-><init>()V

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    .line 6564
    :cond_e
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_0

    .line 6468
    .end local v11           #perm:Lcom/android/server/am/UriPermission;
    .end local v14           #targetUid:I
    .end local v15           #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    :catch_1
    move-exception v16

    goto/16 :goto_1
.end method

.method private handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z
    .locals 14
    .parameter "app"

    .prologue
    .line 9015
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    .line 9017
    .local v11, now:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v0, v1, v2}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/Long;

    .line 9019
    .local v9, crashTime:Ljava/lang/Long;
    if-eqz v9, :cond_2

    invoke-virtual {v9}, Ljava/lang/Long;->longValue()J

    move-result-wide v3

    const-wide/32 v5, 0xea60

    add-long/2addr v3, v5

    cmp-long v0, v11, v3

    if-gez v0, :cond_2

    .line 9021
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Process "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " has crashed too many times: killing!"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9023
    const/16 v0, 0x7550

    const/4 v1, 0x2

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9025
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 9026
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v1, 0x1

    sub-int v2, v0, v1

    .local v2, i:I
    :goto_0
    if-ltz v2, :cond_1

    .line 9027
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 9028
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_0

    .line 9029
    const-string v0, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  Force finishing activity "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v4}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    invoke-virtual {v4}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v0, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9031
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "crashed"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 9026
    :cond_0
    add-int/lit8 v2, v2, -0x1

    goto :goto_0

    .line 9034
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v0, :cond_4

    .line 9039
    const/16 v0, 0x753f

    const/4 v1, 0x2

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    .end local v2           #i:I
    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9041
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 9042
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    .line 9043
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v0, v1, v2}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 9044
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 9045
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 9046
    const/4 v0, 0x0

    .line 9090
    :goto_1
    return v0

    .line 9049
    :cond_2
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    .line 9050
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_4

    .line 9053
    const-string v0, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "  Force finishing activity "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v3, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v3

    invoke-virtual {v3}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9055
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v5

    .line 9056
    .local v5, index:I
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "crashed"

    move-object v3, p0

    move-object v4, v1

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 9061
    add-int/lit8 v5, v5, -0x1

    .line 9062
    if-ltz v5, :cond_4

    .line 9063
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 9064
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v0, v2, :cond_3

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v0, v2, :cond_3

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v0, v2, :cond_4

    .line 9067
    :cond_3
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->isHomeActivity:Z

    if-nez v0, :cond_4

    .line 9068
    const-string v0, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "  Force finishing activity "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v3, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v3

    invoke-virtual {v3}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9070
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "crashed"

    move-object v3, p0

    move-object v4, v1

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 9079
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    .end local v5           #index:I
    :cond_4
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->size()I

    move-result v0

    if-eqz v0, :cond_5

    .line 9082
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v10

    .line 9083
    .local v10, it:Ljava/util/Iterator;
    :goto_2
    invoke-interface {v10}, Ljava/util/Iterator;->hasNext()Z

    move-result v0

    if-eqz v0, :cond_5

    .line 9084
    invoke-interface {v10}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/ServiceRecord;

    .line 9085
    .local v13, sr:Lcom/android/server/am/ServiceRecord;
    iget v0, v13, Lcom/android/server/am/ServiceRecord;->crashCount:I

    add-int/lit8 v0, v0, 0x1

    iput v0, v13, Lcom/android/server/am/ServiceRecord;->crashCount:I

    goto :goto_2

    .line 9089
    .end local v10           #it:Ljava/util/Iterator;
    .end local v13           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_5
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 9090
    const/4 v0, 0x1

    goto/16 :goto_1
.end method

.method private final handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .locals 10
    .parameter "app"
    .parameter "restarting"

    .prologue
    const/4 v9, 0x0

    const/4 v8, 0x0

    .line 4604
    const/4 v5, -0x1

    invoke-direct {p0, p1, p2, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V

    .line 4605
    if-nez p2, :cond_0

    .line 4606
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4610
    :cond_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_1

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_1

    .line 4612
    iput-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 4614
    :cond_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_2

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_2

    .line 4615
    iput-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4619
    :cond_2
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4620
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4621
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4622
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4624
    const/4 v0, 0x1

    .line 4625
    .local v0, atTop:Z
    const/4 v1, 0x0

    .line 4628
    .local v1, hasVisibleActivities:Z
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 4631
    .local v2, i:I
    :goto_0
    if-lez v2, :cond_9

    .line 4632
    add-int/lit8 v2, v2, -0x1

    .line 4633
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 4636
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_6

    .line 4637
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v5, :cond_3

    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-eqz v5, :cond_4

    :cond_3
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_7

    .line 4641
    :cond_4
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4643
    iput-boolean v9, v4, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 4644
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v4}, Lcom/android/server/WindowManagerService;->removeAppToken(Landroid/os/IBinder;)V

    .line 4648
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4665
    :cond_5
    :goto_1
    const/4 v5, 0x1

    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V

    .line 4666
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, v4, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4668
    :cond_6
    const/4 v0, 0x0

    .line 4669
    goto :goto_0

    .line 4655
    :cond_7
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v5, :cond_8

    .line 4656
    const/4 v1, 0x1

    .line 4658
    :cond_8
    iput-object v8, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4659
    iput-boolean v9, v4, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    .line 4660
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v5, :cond_5

    .line 4661
    iput-object v8, v4, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    goto :goto_1

    .line 4671
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_9
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 4673
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-eqz v5, :cond_a

    .line 4674
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Crash of app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " running instrumentation "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4676
    new-instance v3, Landroid/os/Bundle;

    invoke-direct {v3}, Landroid/os/Bundle;-><init>()V

    .line 4677
    .local v3, info:Landroid/os/Bundle;
    const-string v5, "shortMsg"

    const-string v6, "Process crashed."

    invoke-virtual {v3, v5, v6}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 4678
    invoke-virtual {p0, p1, v9, v3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 4681
    .end local v3           #info:Landroid/os/Bundle;
    :cond_a
    if-nez p2, :cond_b

    .line 4682
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v5

    if-nez v5, :cond_b

    .line 4688
    if-eqz v1, :cond_b

    .line 4689
    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 4693
    :cond_b
    return-void
.end method

.method private final indexOfTokenLocked(Landroid/os/IBinder;)I
    .locals 5
    .parameter "token"

    .prologue
    .line 10392
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10395
    .local v0, count:I
    const/4 v2, -0x1

    .line 10396
    .local v2, index:I
    const/4 v4, 0x1

    sub-int v1, v0, v4

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_0

    .line 10397
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    .line 10398
    .local v3, o:Ljava/lang/Object;
    if-ne v3, p1, :cond_1

    .line 10399
    move v2, v1

    .line 10404
    .end local v3           #o:Ljava/lang/Object;
    :cond_0
    return v2

    .line 10396
    .restart local v3       #o:Ljava/lang/Object;
    :cond_1
    add-int/lit8 v1, v1, -0x1

    goto :goto_0
.end method

.method public static final installSystemProviders()V
    .locals 8

    .prologue
    .line 8165
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    monitor-enter v4

    .line 8166
    :try_start_0
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    const-string v6, "system"

    const/16 v7, 0x3e8

    invoke-virtual {v5, v6, v7}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 8167
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    invoke-direct {v5, v0}, Lcom/android/server/am/ActivityManagerService;->generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;

    move-result-object v3

    .line 8168
    .local v3, providers:Ljava/util/List;
    if-eqz v3, :cond_1

    .line 8169
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v1, v5, v6

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_1

    .line 8170
    invoke-interface {v3, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ProviderInfo;

    .line 8171
    .local v2, pi:Landroid/content/pm/ProviderInfo;
    iget-object v5, v2, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v5, v5, 0x1

    if-nez v5, :cond_0

    .line 8172
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Not installing system proc provider "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v2, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ": not system .apk"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8174
    invoke-interface {v3, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8169
    :cond_0
    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    .line 8178
    .end local v1           #i:I
    .end local v2           #pi:Landroid/content/pm/ProviderInfo;
    :cond_1
    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8179
    if-eqz v3, :cond_2

    .line 8180
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v4, v3}, Landroid/app/ActivityThread;->installSystemProviders(Ljava/util/List;)V

    .line 8182
    :cond_2
    return-void

    .line 8178
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #providers:Ljava/util/List;
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5
.end method

.method private isNextTransitionForward()Z
    .locals 2

    .prologue
    .line 1764
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v1}, Lcom/android/server/WindowManagerService;->getPendingAppTransition()I

    move-result v0

    .line 1765
    .local v0, transit:I
    const/16 v1, 0x1006

    if-eq v0, v1, :cond_0

    const/16 v1, 0x1008

    if-eq v0, v1, :cond_0

    const/16 v1, 0x100a

    if-ne v0, v1, :cond_1

    :cond_0
    const/4 v1, 0x1

    :goto_0
    return v1

    :cond_1
    const/4 v1, 0x0

    goto :goto_0
.end method

.method private final killPackageProcessesLocked(Ljava/lang/String;IIZZ)Z
    .locals 11
    .parameter "packageName"
    .parameter "uid"
    .parameter "minOomAdj"
    .parameter "callerWillRestart"
    .parameter "doit"

    .prologue
    .line 5265
    new-instance v8, Ljava/util/ArrayList;

    invoke-direct {v8}, Ljava/util/ArrayList;-><init>()V

    .line 5270
    .local v8, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v9, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ":"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    .line 5271
    .local v7, procNamePrefix:Ljava/lang/String;
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v9}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v9

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .local v5, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_6

    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/util/SparseArray;

    .line 5272
    .local v3, apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual {v3}, Landroid/util/SparseArray;->size()I

    move-result v1

    .line 5273
    .local v1, NA:I
    const/4 v6, 0x0

    .local v6, ia:I
    :goto_0
    if-ge v6, v1, :cond_0

    .line 5274
    invoke-virtual {v3, v6}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 5275
    .local v2, app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v9, v2, Lcom/android/server/am/ProcessRecord;->removed:Z

    if-eqz v9, :cond_2

    .line 5276
    if-eqz p5, :cond_1

    .line 5277
    invoke-virtual {v8, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 5273
    :cond_1
    :goto_1
    add-int/lit8 v6, v6, 0x1

    goto :goto_0

    .line 5279
    :cond_2
    if-lez p2, :cond_3

    const/16 v9, 0x3e8

    if-eq p2, v9, :cond_3

    iget-object v9, v2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    if-eq v9, p2, :cond_4

    :cond_3
    iget-object v9, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    if-nez v9, :cond_4

    iget-object v9, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, v7}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v9

    if-eqz v9, :cond_1

    .line 5282
    :cond_4
    iget v9, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    if-lt v9, p3, :cond_1

    .line 5283
    if-nez p5, :cond_5

    .line 5284
    const/4 v9, 0x1

    .line 5297
    .end local v1           #NA:I
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v6           #ia:I
    .end local p1
    :goto_2
    return v9

    .line 5286
    .restart local v1       #NA:I
    .restart local v2       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v6       #ia:I
    .restart local p1
    :cond_5
    const/4 v9, 0x1

    iput-boolean v9, v2, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5287
    invoke-virtual {v8, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_1

    .line 5293
    .end local v1           #NA:I
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v6           #ia:I
    :cond_6
    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 5294
    .local v0, N:I
    const/4 v4, 0x0

    .end local p1
    .local v4, i:I
    :goto_3
    if-ge v4, v0, :cond_7

    .line 5295
    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, p1, p4}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 5294
    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    .line 5297
    :cond_7
    if-lez v0, :cond_8

    const/4 v9, 0x1

    goto :goto_2

    :cond_8
    const/4 v9, 0x0

    goto :goto_2
.end method

.method private final killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .locals 13
    .parameter "app"
    .parameter "allowRestart"

    .prologue
    .line 10439
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-lez v9, :cond_0

    .line 10440
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 10441
    .local v6, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_0
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_0

    .line 10442
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ConnectionRecord;

    .line 10443
    .local v7, r:Lcom/android/server/am/ConnectionRecord;
    const/4 v9, 0x0

    invoke-direct {p0, v7, p1, v9}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    goto :goto_0

    .line 10446
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v7           #r:Lcom/android/server/am/ConnectionRecord;
    :cond_0
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->clear()V

    .line 10448
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-eqz v9, :cond_8

    .line 10451
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 10452
    .local v5, it:Ljava/util/Iterator;
    :cond_1
    :goto_1
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_7

    .line 10453
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/ServiceRecord;

    .line 10454
    .local v8, sr:Lcom/android/server/am/ServiceRecord;
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v9}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v9

    monitor-enter v9

    .line 10455
    :try_start_0
    iget-object v10, v8, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v10}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopLaunchedLocked()V

    .line 10456
    monitor-exit v9
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 10457
    const/4 v9, 0x0

    iput-object v9, v8, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 10458
    const/4 v9, 0x0

    iput v9, v8, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 10459
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v8}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10461
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_2

    const/4 v9, 0x1

    move v3, v9

    .line 10462
    .local v3, hasClients:Z
    :goto_2
    if-eqz v3, :cond_3

    .line 10463
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 10465
    .local v1, bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :goto_3
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_3

    .line 10466
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/IntentBindRecord;

    .line 10469
    .local v0, b:Lcom/android/server/am/IntentBindRecord;
    const/4 v9, 0x0

    iput-object v9, v0, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 10470
    const/4 v9, 0x0

    iput-boolean v9, v0, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    iput-boolean v9, v0, Lcom/android/server/am/IntentBindRecord;->received:Z

    iput-boolean v9, v0, Lcom/android/server/am/IntentBindRecord;->requested:Z

    goto :goto_3

    .line 10456
    .end local v0           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v1           #bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    .end local v3           #hasClients:Z
    :catchall_0
    move-exception v10

    :try_start_1
    monitor-exit v9
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v10

    .line 10461
    :cond_2
    const/4 v9, 0x0

    move v3, v9

    goto :goto_2

    .line 10474
    .restart local v3       #hasClients:Z
    :cond_3
    iget v9, v8, Lcom/android/server/am/ServiceRecord;->crashCount:I

    const/4 v10, 0x2

    if-lt v9, v10, :cond_4

    .line 10475
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Service crashed "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget v11, v8, Lcom/android/server/am/ServiceRecord;->crashCount:I

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " times, stopping: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10477
    const/16 v9, 0x7552

    const/4 v10, 0x3

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    iget v12, v8, Lcom/android/server/am/ServiceRecord;->crashCount:I

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    const/4 v11, 0x1

    iget-object v12, v8, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v12, v10, v11

    const/4 v11, 0x2

    iget v12, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    invoke-static {v9, v10}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 10479
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_1

    .line 10480
    :cond_4
    if-nez p2, :cond_5

    .line 10481
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_1

    .line 10483
    :cond_5
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z

    move-result v2

    .line 10488
    .local v2, canceled:Z
    iget-boolean v9, v8, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v9, :cond_1

    iget-boolean v9, v8, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    if-nez v9, :cond_6

    if-eqz v2, :cond_1

    .line 10489
    :cond_6
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-nez v9, :cond_1

    .line 10490
    const/4 v9, 0x0

    iput-boolean v9, v8, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 10491
    if-nez v3, :cond_1

    .line 10493
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_1

    .line 10500
    .end local v2           #canceled:Z
    .end local v3           #hasClients:Z
    .end local v8           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_7
    if-nez p2, :cond_8

    .line 10501
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->clear()V

    .line 10506
    .end local v5           #it:Ljava/util/Iterator;
    :cond_8
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v4

    .line 10507
    .local v4, i:I
    :cond_9
    :goto_4
    if-lez v4, :cond_a

    .line 10508
    add-int/lit8 v4, v4, -0x1

    .line 10509
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/ServiceRecord;

    .line 10510
    .restart local v8       #sr:Lcom/android/server/am/ServiceRecord;
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v9, p1, :cond_9

    .line 10511
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_4

    .line 10515
    .end local v8           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_a
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->clear()V

    .line 10516
    return-void
.end method

.method private final logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V
    .locals 11
    .parameter "r"

    .prologue
    const/4 v10, 0x4

    const/4 v9, 0x3

    const/4 v8, 0x2

    const/4 v7, 0x0

    const/4 v6, 0x1

    .line 12866
    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    if-lez v3, :cond_1

    .line 12867
    iget-object v3, p1, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    iget v4, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v4, v6

    invoke-interface {v3, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    .line 12868
    .local v2, curReceiver:Ljava/lang/Object;
    instance-of v3, v2, Lcom/android/server/am/BroadcastFilter;

    if-eqz v3, :cond_0

    .line 12869
    move-object v0, v2

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object v1, v0

    .line 12870
    .local v1, bf:Lcom/android/server/am/BroadcastFilter;
    const/16 v3, 0x7548

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v5, v6

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    invoke-static {v1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 12891
    .end local v1           #bf:Lcom/android/server/am/BroadcastFilter;
    .end local v2           #curReceiver:Ljava/lang/Object;
    :goto_0
    return-void

    .line 12876
    .restart local v2       #curReceiver:Ljava/lang/Object;
    :cond_0
    const/16 v3, 0x7549

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v5, v6

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    check-cast v2, Landroid/content/pm/ResolveInfo;

    .end local v2           #curReceiver:Ljava/lang/Object;
    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->toString()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_0

    .line 12883
    :cond_1
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Discarding broadcast before first receiver is invoked: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12885
    const/16 v3, 0x7549

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    const-string v5, "NONE"

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_0
.end method

.method private final logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V
    .locals 3
    .parameter "tag"
    .parameter "r"
    .parameter "task"

    .prologue
    .line 3126
    const/4 v0, 0x7

    new-array v0, v0, [Ljava/lang/Object;

    const/4 v1, 0x0

    invoke-static {p2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v2

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x1

    iget v2, p3, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x2

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v2, v0, v1

    const/4 v1, 0x3

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x4

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getType()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x5

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getDataString()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x6

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getFlags()I

    move-result v2

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    invoke-static {p1, v0}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 3131
    return-void
.end method

.method public static final main(I)Landroid/content/Context;
    .locals 8
    .parameter "factoryTest"

    .prologue
    const/4 v6, 0x1

    const/4 v7, 0x0

    .line 1284
    new-instance v4, Lcom/android/server/am/ActivityManagerService$AThread;

    invoke-direct {v4}, Lcom/android/server/am/ActivityManagerService$AThread;-><init>()V

    .line 1285
    .local v4, thr:Lcom/android/server/am/ActivityManagerService$AThread;
    invoke-virtual {v4}, Lcom/android/server/am/ActivityManagerService$AThread;->start()V

    .line 1287
    monitor-enter v4

    .line 1288
    :goto_0
    :try_start_0
    iget-object v5, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mService:Lcom/android/server/am/ActivityManagerService;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    if-nez v5, :cond_0

    .line 1290
    :try_start_1
    invoke-virtual {v4}, Ljava/lang/Object;->wait()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_0

    .line 1291
    :catch_0
    move-exception v5

    goto :goto_0

    .line 1294
    :cond_0
    :try_start_2
    monitor-exit v4
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 1296
    iget-object v2, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mService:Lcom/android/server/am/ActivityManagerService;

    .line 1297
    .local v2, m:Lcom/android/server/am/ActivityManagerService;
    sput-object v2, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    .line 1298
    invoke-static {}, Landroid/app/ActivityThread;->systemMain()Landroid/app/ActivityThread;

    move-result-object v0

    .line 1299
    .local v0, at:Landroid/app/ActivityThread;
    sput-object v0, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    .line 1300
    invoke-virtual {v0}, Landroid/app/ActivityThread;->getSystemContext()Landroid/app/ContextImpl;

    move-result-object v1

    .line 1301
    .local v1, context:Landroid/content/Context;
    iput-object v1, v2, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    .line 1302
    iput p0, v2, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    .line 1303
    const-string v5, "power"

    invoke-virtual {v1, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/os/PowerManager;

    .line 1305
    .local v3, pm:Landroid/os/PowerManager;
    const-string v5, "ActivityManager-Sleep"

    invoke-virtual {v3, v6, v5}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;

    move-result-object v5

    iput-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    .line 1306
    const-string v5, "ActivityManager-Launch"

    invoke-virtual {v3, v6, v5}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;

    move-result-object v5

    iput-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    .line 1307
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Landroid/os/PowerManager$WakeLock;->setReferenceCounted(Z)V

    .line 1309
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v5, v1}, Lcom/android/server/am/BatteryStatsService;->publish(Landroid/content/Context;)V

    .line 1310
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    invoke-virtual {v5, v1}, Lcom/android/server/am/UsageStatsService;->publish(Landroid/content/Context;)V

    .line 1312
    monitor-enter v4

    .line 1313
    const/4 v5, 0x1

    :try_start_3
    iput-boolean v5, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mReady:Z

    .line 1314
    invoke-virtual {v4}, Ljava/lang/Object;->notifyAll()V

    .line 1315
    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 1317
    invoke-virtual {v2, v7, v7, v7, v7}, Lcom/android/server/am/ActivityManagerService;->startRunning(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    .line 1319
    return-object v1

    .line 1294
    .end local v0           #at:Landroid/app/ActivityThread;
    .end local v1           #context:Landroid/content/Context;
    .end local v2           #m:Lcom/android/server/am/ActivityManagerService;
    .end local v3           #pm:Landroid/os/PowerManager;
    :catchall_0
    move-exception v5

    :try_start_4
    monitor-exit v4
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v5

    .line 1315
    .restart local v0       #at:Landroid/app/ActivityThread;
    .restart local v1       #context:Landroid/content/Context;
    .restart local v2       #m:Lcom/android/server/am/ActivityManagerService;
    .restart local v3       #pm:Landroid/os/PowerManager;
    :catchall_1
    move-exception v5

    :try_start_5
    monitor-exit v4
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    throw v5
.end method

.method private makeAppCrashingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z
    .locals 7
    .parameter "app"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "stackTrace"

    .prologue
    const/4 v2, 0x1

    .line 8944
    iput-boolean v2, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 8945
    const/4 v3, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v4, p2

    move-object v5, p3

    move-object v6, p4

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/app/ActivityManager$ProcessErrorStateInfo;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8947
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 8948
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->stopFreezingAllLocked()V

    .line 8949
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v0

    return v0
.end method

.method private makeAppNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
    .locals 7
    .parameter "app"
    .parameter "activity"
    .parameter "shortMsg"
    .parameter "longMsg"

    .prologue
    .line 8954
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 8955
    const/4 v2, 0x2

    const/4 v6, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v3, p2

    move-object v4, p3

    move-object v5, p4

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/app/ActivityManager$ProcessErrorStateInfo;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8958
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 8959
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->stopFreezingAllLocked()V

    .line 8960
    return-void
.end method

.method private final moveActivityToFrontLocked(I)Lcom/android/server/am/HistoryRecord;
    .locals 6
    .parameter "where"

    .prologue
    const/4 v5, 0x1

    .line 3093
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    .line 3094
    .local v0, newTop:Lcom/android/server/am/HistoryRecord;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 3095
    .local v2, top:I
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v4, v2, v5

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3096
    .local v1, oldTop:Lcom/android/server/am/HistoryRecord;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, v2, v0}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 3097
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 3098
    iput-boolean v5, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 3099
    return-object v0
.end method

.method private final moveTaskBackwardsLocked(I)V
    .locals 2
    .parameter "task"

    .prologue
    .line 7545
    const-string v0, "ActivityManager"

    const-string v1, "moveTaskBackwards not yet implemented!"

    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 7546
    return-void
.end method

.method private final moveTaskToBackLocked(ILcom/android/server/am/HistoryRecord;)Z
    .locals 13
    .parameter "task"
    .parameter "reason"

    .prologue
    const/4 v12, 0x0

    const/4 v11, 0x0

    .line 7461
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "moveTaskToBack: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 7466
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v8, :cond_1

    .line 7467
    invoke-direct {p0, v11, p1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    .line 7468
    .local v5, next:Lcom/android/server/am/HistoryRecord;
    if-nez v5, :cond_0

    .line 7469
    invoke-direct {p0, v11, v12}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    .line 7471
    :cond_0
    if-eqz v5, :cond_1

    .line 7473
    const/4 v3, 0x1

    .line 7475
    .local v3, moveOK:Z
    :try_start_0
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    iget-object v9, v5, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-interface {v8, v9}, Landroid/app/IActivityController;->activityResuming(Ljava/lang/String;)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v3

    .line 7479
    :goto_0
    if-nez v3, :cond_1

    move v8, v12

    .line 7526
    .end local v3           #moveOK:Z
    .end local v5           #next:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return v8

    .line 7476
    .restart local v3       #moveOK:Z
    .restart local v5       #next:Lcom/android/server/am/HistoryRecord;
    :catch_0
    move-exception v8

    move-object v2, v8

    .line 7477
    .local v2, e:Landroid/os/RemoteException;
    iput-object v11, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_0

    .line 7485
    .end local v2           #e:Landroid/os/RemoteException;
    .end local v3           #moveOK:Z
    .end local v5           #next:Lcom/android/server/am/HistoryRecord;
    :cond_1
    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 7490
    .local v4, moved:Ljava/util/ArrayList;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7491
    .local v0, N:I
    const/4 v1, 0x0

    .line 7492
    .local v1, bottom:I
    const/4 v6, 0x0

    .line 7496
    .local v6, pos:I
    :goto_2
    if-ge v6, v0, :cond_3

    .line 7497
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 7500
    .local v7, r:Lcom/android/server/am/HistoryRecord;
    iget-object v8, v7, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v8, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v8, p1, :cond_2

    .line 7502
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7503
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v1, v7}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7504
    invoke-virtual {v4, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7505
    add-int/lit8 v1, v1, 0x1

    .line 7507
    :cond_2
    add-int/lit8 v6, v6, 0x1

    .line 7508
    goto :goto_2

    .line 7510
    .end local v7           #r:Lcom/android/server/am/HistoryRecord;
    :cond_3
    if-eqz p2, :cond_5

    iget-object v8, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v8}, Landroid/content/Intent;->getFlags()I

    move-result v8

    const/high16 v9, 0x1

    and-int/2addr v8, v9

    if-eqz v8, :cond_5

    .line 7512
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v8, v12}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 7513
    invoke-direct {p0, v11}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v7

    .line 7514
    .restart local v7       #r:Lcom/android/server/am/HistoryRecord;
    if-eqz v7, :cond_4

    .line 7515
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    invoke-virtual {v8, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7520
    .end local v7           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    :goto_3
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v8, v4}, Lcom/android/server/WindowManagerService;->moveAppTokensToBottom(Ljava/util/List;)V

    .line 7525
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->finishTaskMoveLocked(I)V

    .line 7526
    const/4 v8, 0x1

    goto :goto_1

    .line 7518
    :cond_5
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/16 v9, 0x200b

    invoke-virtual {v8, v9}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto :goto_3
.end method

.method private final moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V
    .locals 9
    .parameter "tr"
    .parameter "reason"

    .prologue
    const/4 v7, 0x1

    const/4 v8, 0x0

    .line 7349
    iget v4, p1, Lcom/android/server/am/TaskRecord;->taskId:I

    .line 7350
    .local v4, task:I
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    sub-int v5, v6, v7

    .line 7352
    .local v5, top:I
    if-ltz v5, :cond_0

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/HistoryRecord;

    iget-object v6, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, v4, :cond_1

    .line 7405
    :cond_0
    :goto_0
    return-void

    .line 7357
    :cond_1
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 7361
    .local v1, moved:Ljava/util/ArrayList;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    sub-int v5, v6, v7

    .line 7362
    move v2, v5

    .line 7366
    .local v2, pos:I
    :goto_1
    if-ltz v2, :cond_3

    .line 7367
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7370
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    const/4 v0, 0x1

    .line 7371
    .local v0, first:Z
    iget-object v6, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, v4, :cond_2

    .line 7373
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7374
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v5, v3}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7375
    invoke-virtual {v1, v8, v3}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7376
    add-int/lit8 v5, v5, -0x1

    .line 7377
    if-eqz v0, :cond_2

    .line 7378
    iget-object v6, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V

    .line 7379
    const/4 v0, 0x0

    .line 7382
    :cond_2
    add-int/lit8 v2, v2, -0x1

    .line 7383
    goto :goto_1

    .line 7387
    .end local v0           #first:Z
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_3
    if-eqz p2, :cond_5

    iget-object v6, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v6

    const/high16 v7, 0x1

    and-int/2addr v6, v7

    if-eqz v6, :cond_5

    .line 7389
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v8}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 7390
    const/4 v6, 0x0

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v3

    .line 7391
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    if-eqz v3, :cond_4

    .line 7392
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7398
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    :goto_2
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v1}, Lcom/android/server/WindowManagerService;->moveAppTokensToTop(Ljava/util/List;)V

    .line 7403
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->finishTaskMoveLocked(I)V

    .line 7404
    const/16 v6, 0x7532

    invoke-static {v6, v4}, Landroid/util/EventLog;->writeEvent(II)I

    goto :goto_0

    .line 7395
    :cond_5
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/16 v7, 0x100a

    invoke-virtual {v6, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto :goto_2
.end method

.method private final performClearTaskLocked(ILcom/android/server/am/HistoryRecord;IZ)Lcom/android/server/am/HistoryRecord;
    .locals 10
    .parameter "taskId"
    .parameter "newR"
    .parameter "launchFlags"
    .parameter "doClear"

    .prologue
    .line 3007
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 3010
    .local v2, i:I
    :cond_0
    if-lez v2, :cond_1

    .line 3011
    add-int/lit8 v2, v2, -0x1

    .line 3012
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3013
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v0, p1, :cond_0

    .line 3014
    add-int/lit8 v2, v2, 0x1

    .line 3020
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    if-lez v2, :cond_7

    .line 3021
    add-int/lit8 v2, v2, -0x1

    .line 3022
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3023
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_1

    .line 3026
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq v0, p1, :cond_2

    .line 3027
    const/4 v0, 0x0

    .line 3065
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v0

    .line 3029
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    iget-object v3, p2, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v3}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1

    .line 3031
    move-object v9, v1

    .line 3032
    .local v9, ret:Lcom/android/server/am/HistoryRecord;
    if-eqz p4, :cond_4

    .line 3033
    :cond_3
    :goto_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v3, 0x1

    sub-int/2addr v0, v3

    if-ge v2, v0, :cond_4

    .line 3034
    add-int/lit8 v2, v2, 0x1

    .line 3035
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3036
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_3

    .line 3039
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "clear"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_3

    .line 3041
    add-int/lit8 v2, v2, -0x1

    goto :goto_1

    .line 3049
    :cond_4
    iget v0, v9, Lcom/android/server/am/HistoryRecord;->launchMode:I

    if-nez v0, :cond_6

    const/high16 v0, 0x2000

    and-int/2addr v0, p3

    if-nez v0, :cond_6

    .line 3051
    iget-boolean v0, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_6

    .line 3052
    invoke-direct {p0, v9}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v5

    .line 3053
    .local v5, index:I
    if-ltz v5, :cond_5

    .line 3054
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "clear"

    move-object v3, p0

    move-object v4, v9

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 3057
    :cond_5
    const/4 v0, 0x0

    goto :goto_0

    .end local v5           #index:I
    :cond_6
    move-object v0, v9

    .line 3061
    goto :goto_0

    .line 3065
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    .end local v9           #ret:Lcom/android/server/am/HistoryRecord;
    :cond_7
    const/4 v0, 0x0

    goto :goto_0
.end method

.method static performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V
    .locals 8
    .parameter "app"
    .parameter "receiver"
    .parameter "intent"
    .parameter "resultCode"
    .parameter "data"
    .parameter "extras"
    .parameter "ordered"
    .parameter "sticky"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 12992
    if-eqz p0, :cond_0

    iget-object v0, p0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_0

    .line 12995
    iget-object v0, p0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move-object v4, p4

    move-object v5, p5

    move v6, p6

    move v7, p7

    invoke-interface/range {v0 .. v7}, Landroid/app/IApplicationThread;->scheduleRegisteredReceiver(Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V

    .line 13000
    :goto_0
    return-void

    .line 12998
    :cond_0
    invoke-interface/range {p1 .. p7}, Landroid/content/IIntentReceiver;->performReceive(Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V

    goto :goto_0
.end method

.method private final processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    .locals 9
    .parameter "r"
    .parameter "app"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    const/4 v1, 0x1

    const/4 v8, 0x0

    .line 12959
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v0, :cond_0

    .line 12960
    new-instance v0, Landroid/os/RemoteException;

    invoke-direct {v0}, Landroid/os/RemoteException;-><init>()V

    throw v0

    .line 12962
    :cond_0
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12963
    iput-object p2, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12964
    iput-object p1, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 12965
    invoke-direct {p0, p2, v1, v1}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 12968
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 12970
    const/4 v7, 0x0

    .line 12975
    .local v7, started:Z
    :try_start_0
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 12976
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    new-instance v1, Landroid/content/Intent;

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v4, p1, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v6, p1, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    invoke-interface/range {v0 .. v6}, Landroid/app/IApplicationThread;->scheduleReceiver(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;ILjava/lang/String;Landroid/os/Bundle;Z)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12978
    const/4 v7, 0x1

    .line 12980
    if-nez v7, :cond_1

    .line 12981
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12982
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12983
    iput-object v8, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 12987
    :cond_1
    return-void

    .line 12980
    :catchall_0
    move-exception v0

    if-nez v7, :cond_2

    .line 12981
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12982
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12983
    iput-object v8, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 12980
    :cond_2
    throw v0
.end method

.method private final processNextBroadcast(Z)V
    .locals 33
    .parameter "fromMsg"

    .prologue
    .line 13092
    monitor-enter p0

    .line 13099
    :try_start_0
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 13101
    if-eqz p1, :cond_0

    .line 13102
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    .line 13106
    :cond_0
    :goto_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_2

    .line 13107
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v29

    check-cast v29, Lcom/android/server/am/BroadcastRecord;

    .line 13108
    .local v29, r:Lcom/android/server/am/BroadcastRecord;
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    .line 13109
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v14

    .line 13112
    .local v14, N:I
    const/16 v19, 0x0

    .local v19, i:I
    :goto_1
    move/from16 v0, v19

    move v1, v14

    if-ge v0, v1, :cond_1

    .line 13113
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v32

    .line 13117
    .local v32, target:Ljava/lang/Object;
    check-cast v32, Lcom/android/server/am/BroadcastFilter;

    .end local v32           #target:Ljava/lang/Object;
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object/from16 v2, v32

    move v3, v5

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V

    .line 13112
    add-int/lit8 v19, v19, 0x1

    goto :goto_1

    .line 13119
    :cond_1
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V

    goto :goto_0

    .line 13370
    .end local v14           #N:I
    .end local v19           #i:I
    .end local v29           #r:Lcom/android/server/am/BroadcastRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 13129
    :cond_2
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v5, v0

    if-eqz v5, :cond_5

    .line 13136
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 13137
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v7, v0

    iget-object v7, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    if-nez v6, :cond_3

    const/4 v6, 0x1

    move/from16 v21, v6

    .line 13138
    .local v21, isDead:Z
    :goto_2
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 13139
    if-nez v21, :cond_4

    .line 13141
    :try_start_3
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 13371
    .end local v21           #isDead:Z
    :goto_3
    return-void

    .line 13137
    :cond_3
    const/4 v6, 0x0

    move/from16 v21, v6

    goto :goto_2

    .line 13138
    :catchall_1
    move-exception v6

    :try_start_4
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v6

    .line 13143
    .restart local v21       #isDead:Z
    :cond_4
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "pending app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v7, v0

    iget-object v7, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " died before responding to broadcast"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13145
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13149
    .end local v21           #isDead:Z
    :cond_5
    const/16 v22, 0x0

    .line 13152
    .local v22, looped:Z
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_8

    .line 13154
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 13155
    if-eqz v22, :cond_7

    .line 13159
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 13161
    :cond_7
    monitor-exit p0

    goto :goto_3

    .line 13163
    :cond_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v29

    check-cast v29, Lcom/android/server/am/BroadcastRecord;

    .line 13164
    .restart local v29       #r:Lcom/android/server/am/BroadcastRecord;
    const/16 v18, 0x0

    .line 13174
    .local v18, forceReceive:Z
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    if-eqz v5, :cond_a

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v5

    move/from16 v27, v5

    .line 13175
    .local v27, numReceivers:I
    :goto_4
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v5, v0

    if-eqz v5, :cond_9

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    const-wide/16 v9, 0x0

    cmp-long v5, v7, v9

    if-lez v5, :cond_9

    .line 13176
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v25

    .line 13177
    .local v25, now:J
    if-lez v27, :cond_9

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    const v5, 0x9c40

    mul-int v5, v5, v27

    int-to-long v9, v5

    add-long/2addr v7, v9

    cmp-long v5, v25, v7

    if-lez v5, :cond_9

    .line 13179
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Hung broadcast discarded after timeout failure: now="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-wide/from16 v1, v25

    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " dispatchTime="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " startTime="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v7, v0

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " intent="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " numReceivers="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " nextReceiver="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " state="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13187
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->broadcastTimeout()V

    .line 13188
    const/16 v18, 0x1

    .line 13189
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13193
    .end local v25           #now:J
    :cond_9
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    move v5, v0

    if-eqz v5, :cond_b

    .line 13197
    monitor-exit p0

    goto/16 :goto_3

    .line 13174
    .end local v27           #numReceivers:I
    :cond_a
    const/4 v5, 0x0

    move/from16 v27, v5

    goto/16 :goto_4

    .line 13200
    .restart local v27       #numReceivers:I
    :cond_b
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    if-eqz v5, :cond_c

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v5, v0

    move v0, v5

    move/from16 v1, v27

    if-ge v0, v1, :cond_c

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v5, v0

    if-nez v5, :cond_c

    if-eqz v18, :cond_e

    .line 13204
    :cond_c
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;

    move-object v5, v0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    if-eqz v5, :cond_d

    .line 13211
    :try_start_6
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;

    move-object v6, v0

    new-instance v7, Landroid/content/Intent;

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v8, v0

    invoke-direct {v7, v8}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v8, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v9, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v10, v0

    const/4 v11, 0x0

    const/4 v12, 0x0

    invoke-static/range {v5 .. v12}, Lcom/android/server/am/ActivityManagerService;->performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_0

    .line 13220
    :cond_d
    :goto_5
    :try_start_7
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->removeMessages(I)V

    .line 13226
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V

    .line 13227
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 13228
    const/16 v29, 0x0

    .line 13229
    const/16 v22, 0x1

    .line 13232
    :cond_e
    if-eqz v29, :cond_6

    .line 13235
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move/from16 v30, v0

    add-int/lit8 v5, v30, 0x1

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    .line 13239
    .local v30, recIdx:I
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    .line 13240
    if-nez v30, :cond_f

    .line 13241
    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v7, v0

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    .line 13248
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v23

    .line 13249
    .local v23, msg:Landroid/os/Message;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v7, v0

    const-wide/16 v9, 0x4e20

    add-long/2addr v7, v9

    move-object v0, v5

    move-object/from16 v1, v23

    move-wide v2, v7

    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 13252
    .end local v23           #msg:Landroid/os/Message;
    :cond_f
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v30

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v24

    .line 13253
    .local v24, nextReceiver:Ljava/lang/Object;
    move-object/from16 v0, v24

    instance-of v0, v0, Lcom/android/server/am/BroadcastFilter;

    move v5, v0

    if-eqz v5, :cond_12

    .line 13256
    move-object/from16 v0, v24

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object/from16 v17, v0

    .line 13260
    .local v17, filter:Lcom/android/server/am/BroadcastFilter;
    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    move v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object/from16 v2, v17

    move v3, v5

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V

    .line 13261
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v5, v0

    if-eqz v5, :cond_10

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    move v5, v0

    if-nez v5, :cond_11

    .line 13266
    :cond_10
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13267
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 13269
    :cond_11
    monitor-exit p0

    goto/16 :goto_3

    .line 13214
    .end local v17           #filter:Lcom/android/server/am/BroadcastFilter;
    .end local v24           #nextReceiver:Ljava/lang/Object;
    .end local v30           #recIdx:I
    :catch_0
    move-exception v5

    move-object/from16 v16, v5

    .line 13215
    .local v16, e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Failure sending broadcast result of "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v16

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_5

    .line 13275
    .end local v16           #e:Landroid/os/RemoteException;
    .restart local v24       #nextReceiver:Ljava/lang/Object;
    .restart local v30       #recIdx:I
    :cond_12
    move-object/from16 v0, v24

    check-cast v0, Landroid/content/pm/ResolveInfo;

    move-object/from16 v20, v0

    .line 13278
    .local v20, info:Landroid/content/pm/ResolveInfo;
    const/16 v31, 0x0

    .line 13279
    .local v31, skip:Z
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    move v6, v0

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-boolean v8, v8, Landroid/content/pm/ActivityInfo;->exported:Z

    if-eqz v8, :cond_16

    const/4 v8, -0x1

    :goto_6
    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v6

    move v3, v7

    move v4, v8

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v28

    .line 13283
    .local v28, perm:I
    if-eqz v28, :cond_13

    .line 13284
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: broadcasting "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v7}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ")"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " due to receiver "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "/"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13291
    const/16 v31, 0x1

    .line 13293
    :cond_13
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v5, v0

    const/16 v6, 0x3e8

    if-eq v5, v6, :cond_14

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v5, v0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_0

    if-eqz v5, :cond_14

    .line 13296
    :try_start_8
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v6, v0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v5, v6, v7}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_8 .. :try_end_8} :catch_1

    move-result v28

    .line 13302
    :goto_7
    if-eqz v28, :cond_14

    .line 13303
    :try_start_9
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: receiving "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " to "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " due to sender "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (uid "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ")"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13309
    const/16 v31, 0x1

    .line 13312
    :cond_14
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_15

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-boolean v5, v5, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v5, :cond_15

    .line 13314
    const/16 v31, 0x1

    .line 13317
    :cond_15
    if-eqz v31, :cond_17

    .line 13318
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 13319
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 13320
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13321
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 13322
    monitor-exit p0

    goto/16 :goto_3

    .line 13279
    .end local v28           #perm:I
    :cond_16
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    goto/16 :goto_6

    .line 13299
    .restart local v28       #perm:I
    :catch_1
    move-exception v5

    move-object/from16 v16, v5

    .line 13300
    .restart local v16       #e:Landroid/os/RemoteException;
    const/16 v28, -0x1

    goto/16 :goto_7

    .line 13325
    .end local v16           #e:Landroid/os/RemoteException;
    :cond_17
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13326
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v6, v5, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    .line 13327
    .local v6, targetProcess:Ljava/lang/String;
    new-instance v5, Landroid/content/ComponentName;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v5, v7, v8}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    .line 13330
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    .line 13333
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v15

    .line 13335
    .local v15, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v15, :cond_18

    iget-object v5, v15, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_0

    if-eqz v5, :cond_18

    .line 13337
    :try_start_a
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object v2, v15

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_a .. :try_end_a} :catch_2

    .line 13338
    :try_start_b
    monitor-exit p0

    goto/16 :goto_3

    .line 13339
    :catch_2
    move-exception v16

    .line 13340
    .restart local v16       #e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception when sending broadcast to "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v8, v0

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v16

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 13349
    .end local v16           #e:Landroid/os/RemoteException;
    :cond_18
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v7, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v8, 0x1

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getFlags()I

    move-result v5

    or-int/lit8 v9, v5, 0x4

    const-string v10, "broadcast"

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v11, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v12, 0x800

    and-int/2addr v5, v12

    if-eqz v5, :cond_19

    const/4 v5, 0x1

    move v12, v5

    :goto_8
    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v12}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-nez v5, :cond_1a

    .line 13357
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #targetProcess:Ljava/lang/String;
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unable to launch app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "/"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " for broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ": process is bad"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13361
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 13362
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v8, v0

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v9, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v11, v0

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v12, v0

    const/4 v13, 0x1

    move-object/from16 v7, p0

    invoke-direct/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 13364
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 13365
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13366
    monitor-exit p0

    goto/16 :goto_3

    .line 13349
    .restart local v6       #targetProcess:Ljava/lang/String;
    :cond_19
    const/4 v5, 0x0

    move v12, v5

    goto/16 :goto_8

    .line 13369
    :cond_1a
    move-object/from16 v0, v29

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13370
    monitor-exit p0
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_0

    goto/16 :goto_3
.end method

.method private final processStartTimedOutLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 12
    .parameter "app"

    .prologue
    const/4 v11, 0x1

    const-string v10, "ActivityManager"

    .line 5410
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 5411
    .local v4, pid:I
    const/4 v1, 0x0

    .line 5412
    .local v1, gone:Z
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v6

    .line 5413
    :try_start_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 5414
    .local v3, knownApp:Lcom/android/server/am/ProcessRecord;
    if-eqz v3, :cond_0

    iget-object v7, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v7, :cond_0

    .line 5415
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->remove(I)V

    .line 5416
    const/4 v1, 0x1

    .line 5418
    :cond_0
    monitor-exit v6
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5420
    if-eqz v1, :cond_5

    .line 5421
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Process "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " failed to attach"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5422
    const/16 v6, 0x7555

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v7, v11

    const/4 v8, 0x2

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 5424
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v6, v7, v8}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 5426
    invoke-virtual {p0, p1, v11}, Lcom/android/server/am/ActivityManagerService;->checkAppInLaunchingProvidersLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 5428
    const/4 v2, 0x0

    .local v2, i:I
    :goto_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-ge v2, v6, :cond_2

    .line 5429
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 5430
    .local v5, sr:Lcom/android/server/am/ServiceRecord;
    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v7, v5, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v6, v7, :cond_1

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, v5, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_1

    .line 5432
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Forcing bringing down service: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5433
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5434
    add-int/lit8 v2, v2, -0x1

    .line 5435
    invoke-direct {p0, v5, v11}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 5428
    :cond_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 5418
    .end local v2           #i:I
    .end local v3           #knownApp:Lcom/android/server/am/ProcessRecord;
    .end local v5           #sr:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v7

    :try_start_1
    monitor-exit v6
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v7

    .line 5438
    .restart local v2       #i:I
    .restart local v3       #knownApp:Lcom/android/server/am/ProcessRecord;
    :cond_2
    invoke-static {v4}, Landroid/os/Process;->killProcess(I)V

    .line 5439
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    if-eqz v6, :cond_3

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v6, v6, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v6, v6, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v6, v4, :cond_3

    .line 5440
    const-string v6, "ActivityManager"

    const-string v6, "Unattached app died before backup, skipping"

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5442
    :try_start_2
    const-string v6, "backup"

    invoke-static {v6}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v6

    invoke-static {v6}, Landroid/app/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/backup/IBackupManager;

    move-result-object v0

    .line 5444
    .local v0, bm:Landroid/app/backup/IBackupManager;
    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v0, v6}, Landroid/app/backup/IBackupManager;->agentDisconnected(Ljava/lang/String;)V
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 5449
    .end local v0           #bm:Landroid/app/backup/IBackupManager;
    :cond_3
    :goto_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v6, :cond_4

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    iget-object v6, v6, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iget v6, v6, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v6, v4, :cond_4

    .line 5450
    const-string v6, "ActivityManager"

    const-string v6, "Unattached app died before broadcast acknowledged, skipping"

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5451
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 5452
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 5457
    .end local v2           #i:I
    :cond_4
    :goto_2
    return-void

    .line 5455
    :cond_5
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Spurious process start timeout - pid not known for "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_2

    .line 5445
    .restart local v2       #i:I
    :catch_0
    move-exception v6

    goto :goto_1
.end method

.method private final realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    .locals 13
    .parameter "r"
    .parameter "app"
    .parameter "andResume"
    .parameter "checkConfig"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 1774
    const/4 v0, 0x0

    invoke-virtual {p1, p2, v0}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 1775
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, p1, v1}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 1783
    if-eqz p4, :cond_0

    .line 1784
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {p1, p2}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v2

    if-eqz v2, :cond_2

    move-object v2, p1

    :goto_0
    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v10

    .line 1787
    .local v10, config:Landroid/content/res/Configuration;
    invoke-virtual {p0, v10, p1}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 1790
    .end local v10           #config:Landroid/content/res/Configuration;
    :cond_0
    iput-object p2, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 1794
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v12

    .line 1795
    .local v12, idx:I
    if-gez v12, :cond_1

    .line 1796
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 1798
    :cond_1
    const/4 v0, 0x1

    const/4 v1, 0x1

    invoke-direct {p0, p2, v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 1801
    :try_start_0
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v0, :cond_3

    .line 1802
    new-instance v0, Landroid/os/RemoteException;

    invoke-direct {v0}, Landroid/os/RemoteException;-><init>()V

    throw v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1827
    :catch_0
    move-exception v0

    move-object v11, v0

    .line 1828
    .local v11, e:Landroid/os/RemoteException;
    iget-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->launchFailed:Z

    if-eqz v0, :cond_9

    .line 1831
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Second failure launching "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", giving up"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v11}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1834
    iget v0, p2, Lcom/android/server/am/ProcessRecord;->pid:I

    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-direct {p0, p2, v0, v1}, Lcom/android/server/am/ActivityManagerService;->appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    .line 1835
    const/4 v0, 0x0

    const/4 v1, 0x0

    const-string v2, "2nd-crash"

    invoke-direct {p0, p1, v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 1837
    const/4 v0, 0x0

    .line 1878
    .end local v11           #e:Landroid/os/RemoteException;
    :goto_1
    return v0

    .line 1784
    .end local v12           #idx:I
    :cond_2
    const/4 v2, 0x0

    goto :goto_0

    .line 1804
    .restart local v12       #idx:I
    :cond_3
    const/4 v6, 0x0

    .line 1805
    .local v6, results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    const/4 v7, 0x0

    .line 1806
    .local v7, newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    if-eqz p3, :cond_4

    .line 1807
    :try_start_1
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 1808
    iget-object v7, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 1814
    :cond_4
    if-eqz p3, :cond_5

    .line 1815
    const/16 v0, 0x7536

    const/4 v1, 0x3

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v3, v3, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x2

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1819
    :cond_5
    iget-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->isHomeActivity:Z

    if-eqz v0, :cond_6

    .line 1820
    iput-object p2, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    .line 1822
    :cond_6
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 1823
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    new-instance v1, Landroid/content/Intent;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    if-nez p3, :cond_8

    const/4 v2, 0x1

    move v8, v2

    :goto_2
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->isNextTransitionForward()Z

    move-result v9

    move-object v2, p1

    invoke-interface/range {v0 .. v9}, Landroid/app/IApplicationThread;->scheduleLaunchActivity(Landroid/content/Intent;Landroid/os/IBinder;ILandroid/content/pm/ActivityInfo;Landroid/os/Bundle;Ljava/util/List;Ljava/util/List;ZZ)V
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 1846
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->launchFailed:Z

    .line 1847
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v0

    if-eqz v0, :cond_7

    .line 1848
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Activity "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " being launched, but already in LRU list"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 1852
    :cond_7
    if-eqz p3, :cond_a

    .line 1855
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 1856
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 1857
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 1858
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 1859
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 1860
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v0}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 1861
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 1862
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 1878
    :goto_3
    const/4 v0, 0x1

    goto/16 :goto_1

    .line 1823
    :cond_8
    const/4 v2, 0x0

    move v8, v2

    goto :goto_2

    .line 1842
    .end local v6           #results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    .end local v7           #newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    .restart local v11       #e:Landroid/os/RemoteException;
    :cond_9
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 1843
    throw v11

    .line 1868
    .end local v11           #e:Landroid/os/RemoteException;
    .restart local v6       #results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    .restart local v7       #newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    :cond_a
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 1869
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    goto :goto_3
.end method

.method private final realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    .locals 7
    .parameter "r"
    .parameter "app"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    const/4 v6, 0x0

    const/4 v5, 0x1

    .line 11071
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_0

    .line 11072
    new-instance v1, Landroid/os/RemoteException;

    invoke-direct {v1}, Landroid/os/RemoteException;-><init>()V

    throw v1

    .line 11075
    :cond_0
    iput-object p2, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 11076
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->restartTime:J

    .line 11078
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v1, p1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11079
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11080
    invoke-direct {p0, p2, v5, v5}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 11082
    const/4 v0, 0x0

    .line 11086
    .local v0, created:Z
    :try_start_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    const/4 v2, 0x0

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 11087
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v1}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v1

    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    const/4 v3, 0x0

    const/4 v4, 0x1

    invoke-virtual {v1, v2, v3, v4}, Landroid/content/Intent;->toShortString(Ljava/lang/StringBuilder;ZZ)V

    .line 11088
    const/16 v1, 0x754e

    const/4 v2, 0x4

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v3, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x1

    iget-object v4, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v4, v2, v3

    const/4 v3, 0x2

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x3

    iget-object v4, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v4, v4, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    invoke-static {v1, v2}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 11091
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v1}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v1

    monitor-enter v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 11092
    :try_start_1
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->startLaunchedLocked()V

    .line 11093
    monitor-exit v1
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11094
    :try_start_2
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v1, v1, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 11095
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    invoke-interface {v1, p1, v2}, Landroid/app/IApplicationThread;->scheduleCreateService(Landroid/os/IBinder;Landroid/content/pm/ServiceInfo;)V

    .line 11096
    invoke-virtual {p1}, Lcom/android/server/am/ServiceRecord;->postNotification()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11097
    const/4 v0, 0x1

    .line 11099
    if-nez v0, :cond_1

    .line 11100
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v1, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11101
    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z

    .line 11105
    :cond_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingsLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11110
    iget-boolean v1, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v1, :cond_3

    iget-boolean v1, p1, Lcom/android/server/am/ServiceRecord;->callStart:Z

    if-eqz v1, :cond_3

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-nez v1, :cond_3

    .line 11111
    iget v1, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    add-int/lit8 v1, v1, 0x1

    iput v1, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11112
    iget v1, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ge v1, v5, :cond_2

    .line 11113
    iput v5, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11115
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    new-instance v2, Lcom/android/server/am/ServiceRecord$StartItem;

    iget v3, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    const/4 v4, 0x0

    invoke-direct {v2, v3, v4}, Lcom/android/server/am/ServiceRecord$StartItem;-><init>(ILandroid/content/Intent;)V

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11118
    :cond_3
    invoke-direct {p0, p1, v5}, Lcom/android/server/am/ActivityManagerService;->sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11119
    return-void

    .line 11093
    :catchall_0
    move-exception v2

    :try_start_3
    monitor-exit v1
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v2
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 11099
    :catchall_1
    move-exception v1

    if-nez v0, :cond_4

    .line 11100
    iget-object v2, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11101
    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z

    .line 11099
    :cond_4
    throw v1
.end method

.method private final relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z
    .locals 11
    .parameter "r"
    .parameter "changes"
    .parameter "andResume"

    .prologue
    const/4 v10, 0x0

    const/4 v9, 0x1

    const/4 v8, 0x0

    .line 13646
    const/4 v2, 0x0

    .line 13647
    .local v2, results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    const/4 v3, 0x0

    .line 13648
    .local v3, newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    if-eqz p3, :cond_0

    .line 13649
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 13650
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 13655
    :cond_0
    if-eqz p3, :cond_2

    const/16 v0, 0x7543

    :goto_0
    const/4 v1, 0x3

    new-array v1, v1, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v8

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v9

    const/4 v4, 0x2

    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v5, v1, v4

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 13659
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {p1, v0, v8}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 13663
    :try_start_0
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez p3, :cond_3

    move v5, v9

    :goto_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v1, p1

    move v4, p2

    invoke-interface/range {v0 .. v6}, Landroid/app/IApplicationThread;->scheduleRelaunchActivity(Landroid/os/IBinder;Ljava/util/List;Ljava/util/List;IZLandroid/content/res/Configuration;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13672
    if-eqz p3, :cond_1

    .line 13673
    iput-object v10, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 13674
    iput-object v10, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 13675
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->reportResumedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    :cond_1
    move v0, v9

    .line 13678
    :goto_2
    return v0

    .line 13655
    :cond_2
    const/16 v0, 0x7544

    goto :goto_0

    :cond_3
    move v5, v8

    .line 13663
    goto :goto_1

    .line 13668
    :catch_0
    move-exception v0

    move-object v7, v0

    .local v7, e:Landroid/os/RemoteException;
    move v0, v8

    .line 13669
    goto :goto_2
.end method

.method private final removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 2
    .parameter "r"

    .prologue
    .line 4482
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v0, v1, :cond_0

    .line 4483
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4484
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 4485
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4486
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v0, p1}, Lcom/android/server/WindowManagerService;->removeAppToken(Landroid/os/IBinder;)V

    .line 4490
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4491
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4493
    :cond_0
    return-void
.end method

.method private removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 3
    .parameter "activity"

    .prologue
    .line 6621
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    if-eqz v2, :cond_1

    .line 6622
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .local v0, i$:Ljava/util/Iterator;
    :cond_0
    :goto_0
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/UriPermission;

    .line 6623
    .local v1, perm:Lcom/android/server/am/UriPermission;
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6624
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->size()I

    move-result v2

    if-nez v2, :cond_0

    iget v2, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    and-int/lit8 v2, v2, 0x1

    if-nez v2, :cond_0

    .line 6626
    iget v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v2, v2, -0x2

    iput v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6627
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V

    goto :goto_0

    .line 6631
    .end local v0           #i$:Ljava/util/Iterator;
    .end local v1           #perm:Lcom/android/server/am/UriPermission;
    :cond_1
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    if-eqz v2, :cond_3

    .line 6632
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .restart local v0       #i$:Ljava/util/Iterator;
    :cond_2
    :goto_1
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_3

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/UriPermission;

    .line 6633
    .restart local v1       #perm:Lcom/android/server/am/UriPermission;
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6634
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->size()I

    move-result v2

    if-nez v2, :cond_2

    iget v2, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    and-int/lit8 v2, v2, 0x2

    if-nez v2, :cond_2

    .line 6636
    iget v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v2, v2, -0x3

    iput v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6637
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V

    goto :goto_1

    .line 6641
    .end local v0           #i$:Ljava/util/Iterator;
    .end local v1           #perm:Lcom/android/server/am/UriPermission;
    :cond_3
    return-void
.end method

.method private removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V
    .locals 8
    .parameter "c"
    .parameter "skipApp"
    .parameter "skipAct"

    .prologue
    const/4 v7, 0x0

    .line 11792
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v4}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    .line 11793
    .local v1, binder:Landroid/os/IBinder;
    iget-object v0, p1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    .line 11794
    .local v0, b:Lcom/android/server/am/AppBindRecord;
    iget-object v3, v0, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    .line 11795
    .local v3, s:Lcom/android/server/am/ServiceRecord;
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v4, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11796
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11797
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    if-eqz v4, :cond_0

    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    if-eq v4, p3, :cond_0

    .line 11798
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v4, v4, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-eqz v4, :cond_0

    .line 11799
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v4, v4, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11802
    :cond_0
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    if-eq v4, p2, :cond_1

    .line 11803
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11805
    :cond_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v4, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11807
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4}, Ljava/util/HashSet;->size()I

    move-result v4

    if-nez v4, :cond_2

    .line 11808
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v4, v4, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    iget-object v5, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11813
    :cond_2
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_3

    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_3

    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v4, v4, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->size()I

    move-result v4

    if-nez v4, :cond_3

    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v4, v4, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    if-eqz v4, :cond_3

    .line 11816
    :try_start_0
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11817
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11818
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 11821
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/IntentBindRecord;->doRebind:Z

    .line 11822
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v5, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v5, v5, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v5}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v5

    invoke-interface {v4, v3, v5}, Landroid/app/IApplicationThread;->scheduleUnbindService(Landroid/os/IBinder;Landroid/content/Intent;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 11829
    :cond_3
    :goto_0
    iget v4, p1, Lcom/android/server/am/ConnectionRecord;->flags:I

    and-int/lit8 v4, v4, 0x1

    if-eqz v4, :cond_4

    .line 11830
    invoke-direct {p0, v3, v7}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11832
    :cond_4
    return-void

    .line 11823
    :catch_0
    move-exception v4

    move-object v2, v4

    .line 11824
    .local v2, e:Ljava/lang/Exception;
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Exception when unbinding service "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11825
    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_0
.end method

.method private removeContentProviderExternal(Ljava/lang/String;)V
    .locals 5
    .parameter "name"

    .prologue
    .line 8091
    monitor-enter p0

    .line 8092
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v2, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ContentProviderRecord;

    .line 8093
    .local v0, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v0, :cond_0

    .line 8096
    monitor-exit p0

    .line 8107
    :goto_0
    return-void

    .line 8100
    :cond_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v3, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v3, v3, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 8101
    .local v1, localCpr:Lcom/android/server/am/ContentProviderRecord;
    iget v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    const/4 v3, 0x1

    sub-int/2addr v2, v3

    iput v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    .line 8102
    iget v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    if-gez v2, :cond_1

    .line 8103
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Externals < 0 for content provider "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 8105
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 8106
    monitor-exit p0

    goto :goto_0

    .end local v0           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v1           #localCpr:Lcom/android/server/am/ContentProviderRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method private final removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V
    .locals 9
    .parameter "proc"
    .parameter "cpr"

    .prologue
    .line 10520
    monitor-enter p2

    .line 10521
    const/4 v4, 0x0

    :try_start_0
    iput-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    .line 10522
    invoke-virtual {p2}, Ljava/lang/Object;->notifyAll()V

    .line 10523
    monitor-exit p2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 10525
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v5, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v5, v5, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10526
    iget-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v4, v4, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;

    const-string v5, ";"

    invoke-virtual {v4, v5}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    .line 10527
    .local v3, names:[Ljava/lang/String;
    const/4 v2, 0x0

    .local v2, j:I
    :goto_0
    array-length v4, v3

    if-ge v2, v4, :cond_0

    .line 10528
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    aget-object v5, v3, v2

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10527
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 10523
    .end local v2           #j:I
    .end local v3           #names:[Ljava/lang/String;
    :catchall_0
    move-exception v4

    :try_start_1
    monitor-exit p2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 10531
    .restart local v2       #j:I
    .restart local v3       #names:[Ljava/lang/String;
    :cond_0
    iget-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v4}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 10532
    .local v1, cit:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    :cond_1
    :goto_1
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_2

    .line 10533
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 10534
    .local v0, capp:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v4, :cond_1

    iget-object v4, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_1

    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v4, :cond_1

    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_1

    .line 10537
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Kill "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "): provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v6, v6, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " in dying process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 10540
    const/16 v4, 0x7547

    const/4 v5, 0x4

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    iget v7, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x1

    iget-object v7, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v7, v5, v6

    const/4 v6, 0x2

    iget v7, v0, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x3

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "dying provider "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 10542
    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4}, Landroid/os/Process;->killProcess(I)V

    goto/16 :goto_1

    .line 10546
    .end local v0           #capp:Lcom/android/server/am/ProcessRecord;
    :cond_2
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4, p2}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10547
    return-void
.end method

.method private static removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V
    .locals 3
    .parameter "list"
    .parameter "app"

    .prologue
    .line 4581
    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 4585
    .local v0, i:I
    :cond_0
    :goto_0
    if-lez v0, :cond_1

    .line 4586
    add-int/lit8 v0, v0, -0x1

    .line 4587
    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4590
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v2, p1, :cond_0

    .line 4592
    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_0

    .line 4595
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    return-void
.end method

.method private final removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z
    .locals 7
    .parameter "app"
    .parameter "callerWillRestart"

    .prologue
    .line 5377
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    .line 5378
    .local v0, name:Ljava/lang/String;
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I

    .line 5383
    .local v3, uid:I
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v4, v0, v3}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 5384
    const/4 v1, 0x0

    .line 5385
    .local v1, needRestart:Z
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v4, :cond_2

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_2

    .line 5386
    iget v2, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 5387
    .local v2, pid:I
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v4

    .line 5388
    :try_start_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, v2}, Landroid/util/SparseArray;->remove(I)V

    .line 5389
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v6, 0x14

    invoke-virtual {v5, v6, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5390
    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5391
    const/4 v4, 0x1

    invoke-direct {p0, p1, v4}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5392
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5393
    invoke-static {v2}, Landroid/os/Process;->killProcess(I)V

    .line 5395
    iget-boolean v4, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v4, :cond_0

    .line 5396
    if-nez p2, :cond_1

    .line 5397
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;

    .line 5406
    .end local v2           #pid:I
    :cond_0
    :goto_0
    return v1

    .line 5390
    .restart local v2       #pid:I
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5

    .line 5399
    :cond_1
    const/4 v1, 0x1

    goto :goto_0

    .line 5403
    .end local v2           #pid:I
    :cond_2
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_0
.end method

.method private removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V
    .locals 3
    .parameter "perm"

    .prologue
    .line 6605
    iget v1, p1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v1, v1, 0x3

    if-nez v1, :cond_0

    .line 6607
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    iget v2, p1, Lcom/android/server/am/UriPermission;->uid:I

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/HashMap;

    .line 6609
    .local v0, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-eqz v0, :cond_0

    .line 6612
    iget-object v1, p1, Lcom/android/server/am/UriPermission;->uri:Landroid/net/Uri;

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6613
    invoke-virtual {v0}, Ljava/util/HashMap;->size()I

    move-result v1

    if-nez v1, :cond_0

    .line 6614
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    iget v2, p1, Lcom/android/server/am/UriPermission;->uid:I

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->remove(I)V

    .line 6618
    .end local v0           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    :cond_0
    return-void
.end method

.method private reportResumedActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 4
    .parameter "r"

    .prologue
    .line 2573
    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v1

    .line 2574
    .local v1, identHash:I
    const/4 v3, 0x1

    invoke-direct {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V

    .line 2576
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->beginBroadcast()I

    move-result v0

    .line 2577
    .local v0, i:I
    :cond_0
    :goto_0
    if-lez v0, :cond_1

    .line 2578
    add-int/lit8 v0, v0, -0x1

    .line 2579
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3, v0}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;

    move-result-object v2

    check-cast v2, Landroid/app/IActivityWatcher;

    .line 2580
    .local v2, w:Landroid/app/IActivityWatcher;
    if-eqz v2, :cond_0

    .line 2582
    :try_start_0
    invoke-interface {v2, v1}, Landroid/app/IActivityWatcher;->activityResuming(I)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 2583
    :catch_0
    move-exception v3

    goto :goto_0

    .line 2587
    .end local v2           #w:Landroid/app/IActivityWatcher;
    :cond_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    .line 2588
    return-void
.end method

.method private reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V
    .locals 5
    .parameter "watcher"
    .parameter "cn"
    .parameter "report"

    .prologue
    const-string v4, "ActivityManager"

    .line 13446
    const-string v2, "ActivityManager"

    invoke-static {v4, p3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13448
    if-eqz p1, :cond_0

    .line 13449
    :try_start_0
    new-instance v1, Landroid/os/Bundle;

    invoke-direct {v1}, Landroid/os/Bundle;-><init>()V

    .line 13450
    .local v1, results:Landroid/os/Bundle;
    const-string v2, "id"

    const-string v3, "ActivityManagerService"

    invoke-virtual {v1, v2, v3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 13451
    const-string v2, "Error"

    invoke-virtual {v1, v2, p3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 13452
    const/4 v2, -0x1

    invoke-interface {p1, p2, v2, v1}, Landroid/app/IInstrumentationWatcher;->instrumentationStatus(Landroid/content/ComponentName;ILandroid/os/Bundle;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13457
    .end local v1           #results:Landroid/os/Bundle;
    :cond_0
    :goto_0
    return-void

    .line 13454
    :catch_0
    move-exception v2

    move-object v0, v2

    .line 13455
    .local v0, e:Landroid/os/RemoteException;
    const-string v2, "ActivityManager"

    invoke-static {v4, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0
.end method

.method private final requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z
    .locals 10
    .parameter "token"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "reason"

    .prologue
    const/4 v9, 0x1

    const/4 v4, 0x0

    .line 4092
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v2

    .line 4093
    .local v2, index:I
    if-gez v2, :cond_0

    move v0, v4

    .line 4121
    :goto_0
    return v0

    .line 4096
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4099
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    const/4 v7, 0x1

    .line 4100
    .local v7, lastActivity:Z
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    sub-int v6, v0, v9

    .local v6, i:I
    :goto_1
    if-ltz v6, :cond_1

    .line 4101
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/HistoryRecord;

    .line 4102
    .local v8, p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v8, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_2

    if-eq v8, v1, :cond_2

    .line 4103
    const/4 v7, 0x0

    .line 4110
    .end local v8           #p:Lcom/android/server/am/HistoryRecord;
    :cond_1
    if-eqz v7, :cond_3

    .line 4111
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    const-string v3, "android.intent.category.HOME"

    invoke-virtual {v0, v3}, Landroid/content/Intent;->hasCategory(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_3

    move v0, v4

    .line 4112
    goto :goto_0

    .line 4100
    .restart local v8       #p:Lcom/android/server/am/HistoryRecord;
    :cond_2
    add-int/lit8 v6, v6, -0x1

    goto :goto_1

    .end local v8           #p:Lcom/android/server/am/HistoryRecord;
    :cond_3
    move-object v0, p0

    move v3, p2

    move-object v4, p3

    move-object v5, p4

    .line 4116
    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 4119
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v3, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v3}, Lcom/android/server/WindowManagerService;->initializeHoldMode(Ljava/lang/String;)V

    move v0, v9

    .line 4121
    goto :goto_0
.end method

.method private final requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z
    .locals 5
    .parameter "r"
    .parameter "i"
    .parameter "rebind"

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 11037
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_1

    :cond_0
    move v1, v3

    .line 11056
    :goto_0
    return v1

    .line 11041
    :cond_1
    iget-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->requested:Z

    if-eqz v1, :cond_2

    if-eqz p3, :cond_4

    :cond_2
    iget-object v1, p2, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_4

    .line 11043
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11046
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v2, p2, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v2}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v2

    invoke-interface {v1, p1, v2, p3}, Landroid/app/IApplicationThread;->scheduleBindService(Landroid/os/IBinder;Landroid/content/Intent;Z)V

    .line 11047
    if-nez p3, :cond_3

    .line 11048
    const/4 v1, 0x1

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->requested:Z

    .line 11050
    :cond_3
    const/4 v1, 0x1

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 11051
    const/4 v1, 0x0

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->doRebind:Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    :cond_4
    move v1, v4

    .line 11056
    goto :goto_0

    .line 11052
    :catch_0
    move-exception v1

    move-object v0, v1

    .local v0, e:Landroid/os/RemoteException;
    move v1, v3

    .line 11053
    goto :goto_0
.end method

.method private final requestServiceBindingsLocked(Lcom/android/server/am/ServiceRecord;)V
    .locals 3
    .parameter "r"

    .prologue
    .line 11060
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .line 11061
    .local v0, bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_0
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1

    .line 11062
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 11063
    .local v1, i:Lcom/android/server/am/IntentBindRecord;
    const/4 v2, 0x0

    invoke-direct {p0, p1, v1, v2}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    move-result v2

    if-nez v2, :cond_0

    .line 11067
    .end local v1           #i:Lcom/android/server/am/IntentBindRecord;
    :cond_1
    return-void
.end method

.method private final resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .locals 26
    .parameter "taskTop"
    .parameter "newActivity"

    .prologue
    .line 7030
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v3, v3, 0x4

    if-eqz v3, :cond_1

    const/4 v3, 0x1

    move/from16 v18, v3

    .line 7032
    .local v18, forceReset:Z
    :goto_0
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/am/TaskRecord;->getInactiveDuration()J

    move-result-wide v6

    const-wide/32 v8, 0x1b7740

    cmp-long v3, v6, v8

    if-lez v3, :cond_0

    .line 7033
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v3, v3, 0x8

    if-nez v3, :cond_0

    .line 7035
    const/16 v18, 0x1

    .line 7039
    :cond_0
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object/from16 v24, v0

    .line 7044
    .local v24, task:Lcom/android/server/am/TaskRecord;
    const/16 v22, 0x0

    .line 7045
    .local v22, target:Lcom/android/server/am/HistoryRecord;
    const/16 v23, 0x0

    .line 7046
    .local v23, targetI:I
    const/16 v25, -0x1

    .line 7047
    .local v25, taskTopI:I
    const/16 v21, -0x1

    .line 7048
    .local v21, replyChainEnd:I
    const/16 v20, -0x1

    .line 7049
    .local v20, lastReparentPos:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v19, v3, v4

    .end local p2
    .local v19, i:I
    :goto_1
    const/4 v3, -0x1

    move/from16 v0, v19

    move v1, v3

    if-lt v0, v1, :cond_2d

    .line 7050
    if-ltz v19, :cond_2

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v13, p2

    .line 7052
    .local v13, below:Lcom/android/server/am/HistoryRecord;
    :goto_2
    if-eqz v13, :cond_3

    iget-boolean v3, v13, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_3

    .line 7049
    :goto_3
    add-int/lit8 v19, v19, -0x1

    goto :goto_1

    .line 7030
    .end local v13           #below:Lcom/android/server/am/HistoryRecord;
    .end local v18           #forceReset:Z
    .end local v19           #i:I
    .end local v20           #lastReparentPos:I
    .end local v21           #replyChainEnd:I
    .end local v22           #target:Lcom/android/server/am/HistoryRecord;
    .end local v23           #targetI:I
    .end local v24           #task:Lcom/android/server/am/TaskRecord;
    .end local v25           #taskTopI:I
    .restart local p2
    :cond_1
    const/4 v3, 0x0

    move/from16 v18, v3

    goto :goto_0

    .line 7050
    .end local p2
    .restart local v18       #forceReset:Z
    .restart local v19       #i:I
    .restart local v20       #lastReparentPos:I
    .restart local v21       #replyChainEnd:I
    .restart local v22       #target:Lcom/android/server/am/HistoryRecord;
    .restart local v23       #targetI:I
    .restart local v24       #task:Lcom/android/server/am/TaskRecord;
    .restart local v25       #taskTopI:I
    :cond_2
    const/4 v3, 0x0

    move-object v13, v3

    goto :goto_2

    .line 7055
    .restart local v13       #below:Lcom/android/server/am/HistoryRecord;
    :cond_3
    if-nez v22, :cond_4

    .line 7056
    move-object/from16 v22, v13

    .line 7057
    move/from16 v23, v19

    .line 7061
    const/16 v21, -0x1

    .line 7062
    goto :goto_3

    .line 7065
    :cond_4
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    move-object v0, v3

    iget v0, v0, Landroid/content/pm/ActivityInfo;->flags:I

    move/from16 v17, v0

    .line 7067
    .local v17, flags:I
    and-int/lit8 v3, v17, 0x2

    if-eqz v3, :cond_7

    const/4 v3, 0x1

    move/from16 v16, v3

    .line 7069
    .local v16, finishOnTaskLaunch:Z
    :goto_4
    and-int/lit8 v3, v17, 0x40

    if-eqz v3, :cond_8

    const/4 v3, 0x1

    move v12, v3

    .line 7072
    .local v12, allowTaskReparenting:Z
    :goto_5
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_1f

    .line 7078
    if-gez v25, :cond_5

    .line 7079
    move/from16 v25, v23

    .line 7081
    :cond_5
    if-eqz v13, :cond_1e

    iget-object v3, v13, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_1e

    .line 7082
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v4, 0x8

    and-int/2addr v3, v4

    if-eqz v3, :cond_9

    const/4 v3, 0x1

    move v14, v3

    .line 7085
    .local v14, clearWhenTaskReset:Z
    :goto_6
    if-nez v16, :cond_a

    if-nez v14, :cond_a

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-eqz v3, :cond_a

    .line 7092
    if-gez v21, :cond_6

    .line 7093
    move/from16 v21, v23

    .line 7304
    .end local v14           #clearWhenTaskReset:Z
    :cond_6
    :goto_7
    move-object/from16 v22, v13

    .line 7305
    move/from16 v23, v19

    goto :goto_3

    .line 7067
    .end local v12           #allowTaskReparenting:Z
    .end local v16           #finishOnTaskLaunch:Z
    :cond_7
    const/4 v3, 0x0

    move/from16 v16, v3

    goto :goto_4

    .line 7069
    .restart local v16       #finishOnTaskLaunch:Z
    :cond_8
    const/4 v3, 0x0

    move v12, v3

    goto :goto_5

    .line 7082
    .restart local v12       #allowTaskReparenting:Z
    :cond_9
    const/4 v3, 0x0

    move v14, v3

    goto :goto_6

    .line 7095
    .restart local v14       #clearWhenTaskReset:Z
    :cond_a
    if-nez v16, :cond_13

    if-nez v14, :cond_13

    if-eqz v12, :cond_13

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_13

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_13

    .line 7104
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    const/4 v4, 0x0

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7105
    .local v4, p:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_c

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_c

    .line 7110
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v0, v3

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7124
    :goto_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    move v5, v0

    move-object v0, v3

    move-object/from16 v1, v22

    move v2, v5

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    .line 7125
    if-gez v21, :cond_b

    .line 7126
    move/from16 v21, v23

    .line 7128
    :cond_b
    const/4 v15, 0x0

    .line 7129
    .local v15, dstPos:I
    move/from16 v5, v23

    .local v5, srcPos:I
    :goto_9
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_10

    .line 7130
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7131
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_f

    .line 7129
    :goto_a
    add-int/lit8 v5, v5, 0x1

    goto :goto_9

    .line 7114
    .end local v5           #srcPos:I
    .end local v15           #dstPos:I
    :cond_c
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v3, v0

    add-int/lit8 v3, v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 7115
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v3, v0

    if-gtz v3, :cond_d

    .line 7116
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 7118
    :cond_d
    new-instance v3, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    const/4 v7, 0x0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_e

    const/4 v8, 0x1

    :goto_b
    invoke-direct {v3, v5, v6, v7, v8}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    move-object v0, v3

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7120
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    iput-object v5, v3, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    goto :goto_8

    .line 7118
    :cond_e
    const/4 v8, 0x0

    goto :goto_b

    .line 7136
    .restart local v5       #srcPos:I
    .restart local v15       #dstPos:I
    :cond_f
    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->numActivities:I

    move v3, v0

    const/4 v6, 0x1

    sub-int/2addr v3, v6

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7137
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iput-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7138
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7139
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7140
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v15, v4}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7141
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    invoke-virtual {v3, v15, v4}, Lcom/android/server/WindowManagerService;->moveAppToken(ILandroid/os/IBinder;)V

    .line 7142
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-virtual {v3, v4, v6}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    .line 7143
    add-int/lit8 v15, v15, 0x1

    .line 7147
    add-int/lit8 v19, v19, 0x1

    goto/16 :goto_a

    .line 7149
    :cond_10
    move-object/from16 v0, p1

    move-object v1, v4

    if-ne v0, v1, :cond_11

    .line 7150
    move-object/from16 p1, v13

    .line 7152
    :cond_11
    move/from16 v0, v25

    move/from16 v1, v21

    if-ne v0, v1, :cond_12

    .line 7153
    const/16 v25, -0x1

    .line 7155
    :cond_12
    const/16 v21, -0x1

    .line 7156
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V

    goto/16 :goto_7

    .line 7157
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    .end local v15           #dstPos:I
    :cond_13
    if-nez v18, :cond_14

    if-nez v16, :cond_14

    if-eqz v14, :cond_1d

    .line 7163
    :cond_14
    if-eqz v14, :cond_18

    .line 7167
    add-int/lit8 v21, v23, 0x1

    .line 7170
    :goto_c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    move/from16 v0, v21

    move v1, v3

    if-ge v0, v1, :cond_15

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_15

    .line 7171
    add-int/lit8 v21, v21, 0x1

    goto :goto_c

    .line 7173
    :cond_15
    add-int/lit8 v21, v21, -0x1

    .line 7177
    :cond_16
    :goto_d
    const/4 v4, 0x0

    .line 7178
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    move/from16 v5, v23

    .restart local v5       #srcPos:I
    :goto_e
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_1a

    .line 7179
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7180
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_19

    .line 7178
    :cond_17
    :goto_f
    add-int/lit8 v5, v5, 0x1

    goto :goto_e

    .line 7174
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_18
    if-gez v21, :cond_16

    .line 7175
    move/from16 v21, v23

    goto :goto_d

    .line 7183
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    .restart local v5       #srcPos:I
    :cond_19
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "reset"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_17

    .line 7185
    add-int/lit8 v21, v21, -0x1

    .line 7186
    add-int/lit8 v5, v5, -0x1

    goto :goto_f

    .line 7189
    :cond_1a
    move-object/from16 v0, p1

    move-object v1, v4

    if-ne v0, v1, :cond_1b

    .line 7190
    move-object/from16 p1, v13

    .line 7192
    :cond_1b
    move/from16 v0, v25

    move/from16 v1, v21

    if-ne v0, v1, :cond_1c

    .line 7193
    const/16 v25, -0x1

    .line 7195
    :cond_1c
    const/16 v21, -0x1

    .line 7196
    goto/16 :goto_7

    .line 7200
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_1d
    const/16 v21, -0x1

    goto/16 :goto_7

    .line 7205
    .end local v14           #clearWhenTaskReset:Z
    :cond_1e
    const/16 v21, -0x1

    goto/16 :goto_7

    .line 7208
    :cond_1f
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-eqz v3, :cond_20

    .line 7215
    if-gez v21, :cond_6

    .line 7216
    move/from16 v21, v23

    goto/16 :goto_7

    .line 7219
    :cond_20
    if-ltz v25, :cond_6

    if-eqz v12, :cond_6

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_6

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v3, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_6

    .line 7233
    if-nez v18, :cond_21

    if-eqz v16, :cond_26

    .line 7234
    :cond_21
    if-gez v21, :cond_22

    .line 7235
    move/from16 v21, v23

    .line 7237
    :cond_22
    const/4 v4, 0x0

    .line 7238
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    move/from16 v5, v23

    .restart local v5       #srcPos:I
    :goto_10
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_25

    .line 7239
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7240
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_24

    .line 7238
    :cond_23
    :goto_11
    add-int/lit8 v5, v5, 0x1

    goto :goto_10

    .line 7243
    :cond_24
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "reset"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_23

    .line 7245
    add-int/lit8 v25, v25, -0x1

    .line 7246
    add-int/lit8 v20, v20, -0x1

    .line 7247
    add-int/lit8 v21, v21, -0x1

    .line 7248
    add-int/lit8 v5, v5, -0x1

    goto :goto_11

    .line 7251
    :cond_25
    const/16 v21, -0x1

    .line 7252
    goto/16 :goto_7

    .line 7253
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_26
    if-gez v21, :cond_27

    .line 7254
    move/from16 v21, v23

    .line 7256
    :cond_27
    move/from16 v5, v21

    .restart local v5       #srcPos:I
    :goto_12
    move v0, v5

    move/from16 v1, v23

    if-lt v0, v1, :cond_2a

    .line 7257
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7258
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_28

    .line 7256
    :goto_13
    add-int/lit8 v5, v5, -0x1

    goto :goto_12

    .line 7261
    :cond_28
    if-gez v20, :cond_29

    .line 7262
    move/from16 v20, v25

    .line 7263
    move-object/from16 p1, v4

    .line 7267
    :goto_14
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7268
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    const/4 v7, 0x1

    sub-int/2addr v6, v7

    iput v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7269
    move-object/from16 v0, v24

    move-object v1, v4

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7270
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v20

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7273
    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->numActivities:I

    move v3, v0

    add-int/lit8 v3, v3, 0x1

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7274
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v20

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->moveAppToken(ILandroid/os/IBinder;)V

    .line 7275
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-virtual {v3, v4, v6}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    goto :goto_13

    .line 7265
    :cond_29
    add-int/lit8 v20, v20, -0x1

    goto :goto_14

    .line 7280
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    :cond_2a
    const/16 v21, -0x1

    .line 7286
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->launchMode:I

    const/4 v4, 0x1

    if-ne v3, v4, :cond_6

    .line 7287
    const/4 v3, 0x1

    sub-int v8, v20, v3

    .end local v5           #srcPos:I
    .local v8, j:I
    :goto_15
    if-ltz v8, :cond_6

    .line 7288
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7289
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_2c

    .line 7287
    :cond_2b
    :goto_16
    add-int/lit8 v8, v8, -0x1

    goto :goto_15

    .line 7292
    :cond_2c
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v3

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v3, v5}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_2b

    .line 7293
    const/4 v9, 0x0

    const/4 v10, 0x0

    const-string v11, "replace"

    move-object/from16 v6, p0

    move-object v7, v4

    invoke-direct/range {v6 .. v11}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_2b

    .line 7295
    add-int/lit8 v25, v25, -0x1

    .line 7296
    add-int/lit8 v20, v20, -0x1

    goto :goto_16

    .line 7308
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v8           #j:I
    .end local v12           #allowTaskReparenting:Z
    .end local v13           #below:Lcom/android/server/am/HistoryRecord;
    .end local v16           #finishOnTaskLaunch:Z
    .end local v17           #flags:I
    :cond_2d
    return-object p1
.end method

.method private final resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z
    .locals 23
    .parameter "prev"

    .prologue
    .line 2601
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v6

    .line 2605
    .local v6, next:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    move/from16 v22, v0

    .line 2606
    .local v22, userLeaving:Z
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 2608
    if-nez v6, :cond_0

    .line 2611
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->startHomeActivityLocked()Z

    move-result v5

    .line 2859
    .end local v6           #next:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return v5

    .line 2614
    .restart local v6       #next:Lcom/android/server/am/HistoryRecord;
    :cond_0
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    .line 2617
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-ne v5, v6, :cond_1

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v5, v7, :cond_1

    .line 2620
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2621
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 2622
    const/4 v5, 0x0

    goto :goto_0

    .line 2627
    :cond_1
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    move v5, v0

    if-nez v5, :cond_2

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v5, v0

    if-eqz v5, :cond_3

    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-ne v5, v6, :cond_3

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v5, v7, :cond_3

    .line 2631
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2632
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 2633
    const/4 v5, 0x0

    goto :goto_0

    .line 2638
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2639
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2645
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_4

    .line 2647
    const/4 v5, 0x0

    goto :goto_0

    .line 2652
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_5

    .line 2654
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move/from16 v1, v22

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 2655
    const/4 v5, 0x1

    goto :goto_0

    .line 2658
    :cond_5
    if-eqz p1, :cond_6

    move-object/from16 v0, p1

    move-object v1, v6

    if-eq v0, v1, :cond_6

    .line 2659
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    move v5, v0

    if-nez v5, :cond_a

    if-eqz v6, :cond_a

    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-nez v5, :cond_a

    .line 2660
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 2661
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2691
    :cond_6
    :goto_1
    if-eqz p1, :cond_10

    .line 2692
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-eqz v5, :cond_d

    .line 2695
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_b

    .line 2696
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2702
    :goto_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setAppWillBeHidden(Landroid/os/IBinder;)V

    .line 2703
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    move v2, v7

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2729
    :cond_7
    :goto_3
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v5, :cond_17

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_17

    .line 2733
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x1

    invoke-virtual {v5, v6, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2735
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object/from16 v18, v0

    .line 2736
    .local v18, lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    move-object v0, v6

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v19, v0

    .line 2738
    .local v19, lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2740
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2741
    move-object v0, v6

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2742
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v5}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 2743
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v7, 0x1

    const/4 v8, 0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v7

    move v3, v8

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 2744
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2749
    monitor-enter p0

    .line 2750
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v6, v8}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v8

    if-eqz v8, :cond_12

    move-object v8, v6

    :goto_4
    invoke-virtual {v5, v7, v8}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v16

    .line 2753
    .local v16, config:Landroid/content/res/Configuration;
    if-eqz v16, :cond_8

    .line 2754
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 2756
    :cond_8
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    move-object v2, v6

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    move-result v21

    .line 2757
    .local v21, updated:Z
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 2758
    if-nez v21, :cond_13

    .line 2764
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v20

    .line 2768
    .local v20, nextNext:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v20

    move-object v1, v6

    if-eq v0, v1, :cond_9

    .line 2770
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v7, 0x13

    invoke-virtual {v5, v7}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 2772
    :cond_9
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 2773
    const/4 v5, 0x0

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v6

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 2774
    .end local v6           #next:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2775
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 2776
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2673
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .end local v20           #nextNext:Lcom/android/server/am/HistoryRecord;
    .end local v21           #updated:Z
    .restart local v6       #next:Lcom/android/server/am/HistoryRecord;
    :cond_a
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-eqz v5, :cond_6

    .line 2674
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    move v2, v7

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    goto/16 :goto_1

    .line 2698
    :cond_b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v7, v8, :cond_c

    const/16 v7, 0x2007

    :goto_5
    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_2

    :cond_c
    const/16 v7, 0x2009

    goto :goto_5

    .line 2707
    :cond_d
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_e

    .line 2708
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    .line 2710
    :cond_e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v7, v8, :cond_f

    const/16 v7, 0x1006

    :goto_6
    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    :cond_f
    const/16 v7, 0x1008

    goto :goto_6

    .line 2719
    :cond_10
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v7, 0x1

    if-le v5, v7, :cond_7

    .line 2722
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_11

    .line 2723
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    .line 2725
    :cond_11
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/16 v7, 0x1006

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    .line 2750
    .restart local v18       #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .restart local v19       #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    :cond_12
    const/4 v8, 0x0

    goto/16 :goto_4

    .line 2757
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5

    .line 2781
    .restart local v16       #config:Landroid/content/res/Configuration;
    .restart local v21       #updated:Z
    :cond_13
    :try_start_2
    iget-object v15, v6, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 2782
    .local v15, a:Ljava/util/ArrayList;
    if-eqz v15, :cond_14

    .line 2783
    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 2784
    .local v14, N:I
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v5, :cond_14

    if-lez v14, :cond_14

    .line 2788
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v5, v6, v15}, Landroid/app/IApplicationThread;->scheduleSendResult(Landroid/os/IBinder;Ljava/util/List;)V

    .line 2792
    .end local v14           #N:I
    :cond_14
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    if-eqz v5, :cond_15

    .line 2793
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    invoke-interface {v5, v7, v6}, Landroid/app/IApplicationThread;->scheduleNewIntent(Ljava/util/List;Landroid/os/IBinder;)V

    .line 2796
    :cond_15
    const/16 v5, 0x7537

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    invoke-static {v6}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v9, v9, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x2

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v5, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2800
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->isNextTransitionForward()Z

    move-result v7

    invoke-interface {v5, v6, v7}, Landroid/app/IApplicationThread;->scheduleResumeActivity(Landroid/os/IBinder;Z)V

    .line 2803
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V
    :try_end_2
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    .line 2827
    const/4 v5, 0x1

    :try_start_3
    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2828
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V
    :try_end_3
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_1

    .line 2839
    const/4 v5, 0x0

    iput-object v5, v6, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 2840
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 2841
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 2859
    .end local v15           #a:Ljava/util/ArrayList;
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .end local v21           #updated:Z
    :goto_7
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2805
    .restart local v16       #config:Landroid/content/res/Configuration;
    .restart local v18       #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .restart local v19       #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .restart local v21       #updated:Z
    :catch_0
    move-exception v5

    move-object/from16 v17, v5

    .line 2807
    .local v17, e:Ljava/lang/Exception;
    move-object/from16 v0, v19

    move-object v1, v6

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2808
    move-object/from16 v0, v18

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2809
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Restarting because process died: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v5, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2810
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    if-nez v5, :cond_16

    .line 2811
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    .line 2820
    :goto_8
    const/4 v5, 0x1

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 2821
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2814
    :cond_16
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    iget v8, v6, Lcom/android/server/am/HistoryRecord;->theme:I

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    iget v10, v6, Lcom/android/server/am/HistoryRecord;->labelRes:I

    iget v11, v6, Lcom/android/server/am/HistoryRecord;->icon:I

    const/4 v12, 0x0

    const/4 v13, 0x1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    goto :goto_8

    .line 2829
    .end local v17           #e:Ljava/lang/Exception;
    .restart local v15       #a:Ljava/util/ArrayList;
    :catch_1
    move-exception v5

    move-object/from16 v17, v5

    .line 2832
    .restart local v17       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception thrown during resume of "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v17

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2833
    const/4 v5, 0x0

    const/4 v7, 0x0

    const-string v8, "resume-exception"

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move-object v3, v7

    move-object v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 2835
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2845
    .end local v15           #a:Ljava/util/ArrayList;
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v17           #e:Ljava/lang/Exception;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .end local v21           #updated:Z
    :cond_17
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    if-nez v5, :cond_18

    .line 2846
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    .line 2856
    :goto_9
    const/4 v5, 0x1

    const/4 v7, 0x1

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    goto/16 :goto_7

    .line 2849
    :cond_18
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    iget v8, v6, Lcom/android/server/am/HistoryRecord;->theme:I

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    iget v10, v6, Lcom/android/server/am/HistoryRecord;->labelRes:I

    iget v11, v6, Lcom/android/server/am/HistoryRecord;->icon:I

    const/4 v12, 0x0

    const/4 v13, 0x1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    goto :goto_9
.end method

.method private final resumedAppLocked()Lcom/android/server/am/HistoryRecord;
    .locals 2

    .prologue
    .line 14319
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 14320
    .local v0, resumedActivity:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-nez v1, :cond_2

    .line 14321
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 14322
    if-eqz v0, :cond_1

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-nez v1, :cond_2

    .line 14323
    :cond_1
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 14326
    :cond_2
    return-object v0
.end method

.method private retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .locals 19
    .parameter "service"
    .parameter "resolvedType"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    .line 10899
    const/4 v5, 0x0

    .line 10900
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v6

    if-eqz v6, :cond_0

    .line 10901
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10903
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    new-instance v13, Landroid/content/Intent$FilterComparison;

    move-object v0, v13

    move-object/from16 v1, p1

    invoke-direct {v0, v1}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 10904
    .local v13, filter:Landroid/content/Intent$FilterComparison;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v13}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10905
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    if-nez v5, :cond_9

    .line 10907
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v6

    const/16 v7, 0x400

    move-object v0, v6

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    move v3, v7

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveService(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v17

    .line 10910
    .local v17, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v17, :cond_1

    move-object/from16 v0, v17

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object v6, v0

    move-object v10, v6

    .line 10912
    .local v10, sInfo:Landroid/content/pm/ServiceInfo;
    :goto_0
    if-nez v10, :cond_2

    .line 10913
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to start service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ": not found"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10915
    const/4 v6, 0x0

    move-object v9, v13

    .line 10963
    .end local v10           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .end local v17           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v9, filter:Landroid/content/Intent$FilterComparison;
    :goto_1
    return-object v6

    .line 10910
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v17       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_1
    const/4 v6, 0x0

    move-object v10, v6

    goto :goto_0

    .line 10918
    .restart local v10       #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_2
    new-instance v8, Landroid/content/ComponentName;

    iget-object v6, v10, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    invoke-direct {v8, v6, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 10920
    .local v8, name:Landroid/content/ComponentName;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v8}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/android/server/am/ServiceRecord;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1

    .line 10921
    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .local v16, r:Lcom/android/server/am/ServiceRecord;
    if-nez v16, :cond_8

    .line 10922
    :try_start_1
    new-instance v9, Landroid/content/Intent$FilterComparison;

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object v6

    invoke-direct {v9, v6}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_2

    .line 10923
    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    :try_start_2
    new-instance v11, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;

    const/4 v6, 0x0

    move-object v0, v11

    move-object/from16 v1, p0

    move-object v2, v6

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ActivityManagerService$1;)V

    .line 10924
    .local v11, res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    const/4 v7, 0x0

    .line 10925
    .local v7, ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object v6, v0

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v18

    .line 10926
    .local v18, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v18
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 10927
    :try_start_3
    iget-object v6, v10, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v12, v10, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    iget-object v13, v10, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v0, v18

    move v1, v6

    move-object v2, v12

    move-object v3, v13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/internal/os/BatteryStatsImpl;->getServiceStatsLocked(ILjava/lang/String;Ljava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    move-result-object v7

    .line 10930
    monitor-exit v18
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 10931
    :try_start_4
    new-instance v5, Lcom/android/server/am/ServiceRecord;

    move-object/from16 v6, p0

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ServiceRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;Landroid/content/ComponentName;Landroid/content/Intent$FilterComparison;Landroid/content/pm/ServiceInfo;Ljava/lang/Runnable;)V
    :try_end_4
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_0

    .line 10932
    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :try_start_5
    invoke-virtual {v11, v5}, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;->setService(Lcom/android/server/am/ServiceRecord;)V

    .line 10933
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v8, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 10934
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v9, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 10937
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v6, v0

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v12

    .line 10938
    .local v12, N:I
    const/4 v14, 0x0

    .local v14, i:I
    :goto_2
    if-ge v14, v12, :cond_4

    .line 10939
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v6, v0

    invoke-virtual {v6, v14}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/android/server/am/ServiceRecord;

    .line 10940
    .local v15, pr:Lcom/android/server/am/ServiceRecord;
    iget-object v6, v15, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v6, v8}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_3

    .line 10941
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v6, v0

    invoke-virtual {v6, v14}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
    :try_end_5
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_3

    .line 10942
    add-int/lit8 v14, v14, -0x1

    .line 10943
    add-int/lit8 v12, v12, -0x1

    .line 10938
    :cond_3
    add-int/lit8 v14, v14, 0x1

    goto :goto_2

    .line 10930
    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v12           #N:I
    .end local v14           #i:I
    .end local v15           #pr:Lcom/android/server/am/ServiceRecord;
    .restart local v16       #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v6

    :try_start_6
    monitor-exit v18
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    :try_start_7
    throw v6
    :try_end_7
    .catch Landroid/os/RemoteException; {:try_start_7 .. :try_end_7} :catch_0

    .line 10947
    .end local v7           #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .end local v11           #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .end local v18           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catch_0
    move-exception v6

    move-object/from16 v5, v16

    .line 10951
    .end local v8           #name:Landroid/content/ComponentName;
    .end local v10           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .end local v17           #rInfo:Landroid/content/pm/ResolveInfo;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_4
    :goto_3
    if-eqz v5, :cond_7

    .line 10952
    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    iget-boolean v7, v5, Lcom/android/server/am/ServiceRecord;->exported:Z

    if-eqz v7, :cond_5

    const/4 v7, -0x1

    :goto_4
    move-object/from16 v0, p0

    move-object v1, v6

    move/from16 v2, p3

    move/from16 v3, p4

    move v4, v7

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-eqz v6, :cond_6

    .line 10955
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Permission Denial: Accessing service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " from pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", uid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " requires "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10959
    new-instance v6, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    const/4 v7, 0x0

    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    move-object v0, v6

    move-object/from16 v1, p0

    move-object v2, v7

    move-object v3, v8

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto/16 :goto_1

    .line 10952
    :cond_5
    iget-object v7, v5, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_4

    .line 10961
    :cond_6
    new-instance v6, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    const/4 v7, 0x0

    move-object v0, v6

    move-object/from16 v1, p0

    move-object v2, v5

    move-object v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto/16 :goto_1

    .line 10963
    :cond_7
    const/4 v6, 0x0

    goto/16 :goto_1

    .line 10947
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    :catch_1
    move-exception v6

    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    goto :goto_3

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v8       #name:Landroid/content/ComponentName;
    .restart local v10       #sInfo:Landroid/content/pm/ServiceInfo;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v16       #r:Lcom/android/server/am/ServiceRecord;
    .restart local v17       #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_2
    move-exception v6

    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    move-object/from16 v5, v16

    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    goto/16 :goto_3

    .restart local v7       #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .restart local v11       #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .restart local v18       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catch_3
    move-exception v6

    goto/16 :goto_3

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v7           #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .end local v11           #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .end local v18           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v16       #r:Lcom/android/server/am/ServiceRecord;
    :cond_8
    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    move-object/from16 v5, v16

    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    goto/16 :goto_3

    .end local v8           #name:Landroid/content/ComponentName;
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .end local v10           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v17           #rInfo:Landroid/content/pm/ResolveInfo;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    :cond_9
    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    goto/16 :goto_3
.end method

.method private retrieveSettings()V
    .locals 8

    .prologue
    const/4 v7, 0x1

    const/4 v6, 0x0

    .line 8704
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    .line 8705
    .local v3, resolver:Landroid/content/ContentResolver;
    const-string v5, "debug_app"

    invoke-static {v3, v5}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 8707
    .local v2, debugApp:Ljava/lang/String;
    const-string v5, "wait_for_debugger"

    invoke-static {v3, v5, v6}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_0

    move v4, v7

    .line 8709
    .local v4, waitForDebugger:Z
    :goto_0
    const-string v5, "always_finish_activities"

    invoke-static {v3, v5, v6}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_1

    move v0, v7

    .line 8712
    .local v0, alwaysFinishActivities:Z
    :goto_1
    new-instance v1, Landroid/content/res/Configuration;

    invoke-direct {v1}, Landroid/content/res/Configuration;-><init>()V

    .line 8713
    .local v1, configuration:Landroid/content/res/Configuration;
    invoke-static {v3, v1}, Landroid/provider/Settings$System;->getConfiguration(Landroid/content/ContentResolver;Landroid/content/res/Configuration;)V

    .line 8715
    monitor-enter p0

    .line 8716
    :try_start_0
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 8717
    iput-boolean v4, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    iput-boolean v4, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 8718
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 8721
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {v5, v1}, Landroid/content/res/Configuration;->updateFrom(Landroid/content/res/Configuration;)I

    .line 8722
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    const/4 v6, 0x1

    iput v6, v5, Landroid/content/res/Configuration;->seq:I

    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 8724
    monitor-exit p0

    .line 8725
    return-void

    .end local v0           #alwaysFinishActivities:Z
    .end local v1           #configuration:Landroid/content/res/Configuration;
    .end local v4           #waitForDebugger:Z
    :cond_0
    move v4, v6

    .line 8707
    goto :goto_0

    .restart local v4       #waitForDebugger:Z
    :cond_1
    move v0, v6

    .line 8709
    goto :goto_1

    .line 8724
    .restart local v0       #alwaysFinishActivities:Z
    .restart local v1       #configuration:Landroid/content/res/Configuration;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5
.end method

.method private revokeUriPermissionLocked(ILandroid/net/Uri;I)V
    .locals 22
    .parameter "callingUid"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    .line 6645
    and-int/lit8 p3, p3, 0x3

    .line 6647
    if-nez p3, :cond_1

    .line 6727
    .end local p1
    :cond_0
    :goto_0
    return-void

    .line 6654
    .restart local p1
    :cond_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v16

    .line 6656
    .local v16, pm:Landroid/content/pm/IPackageManager;
    invoke-virtual/range {p2 .. p2}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v8

    .line 6657
    .local v8, authority:Ljava/lang/String;
    const/4 v15, 0x0

    .line 6658
    .local v15, pi:Landroid/content/pm/ProviderInfo;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object v1, v8

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/ContentProviderRecord;

    .line 6660
    .local v9, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v9, :cond_2

    .line 6661
    iget-object v15, v9, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6669
    :goto_1
    if-nez v15, :cond_3

    .line 6670
    const-string v19, "ActivityManager"

    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    const-string v21, "No content provider found for: "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move-object v1, v8

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v20

    invoke-static/range {v19 .. v20}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 6664
    :cond_2
    const/16 v19, 0x800

    :try_start_0
    move-object/from16 v0, v16

    move-object v1, v8

    move/from16 v2, v19

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v15

    goto :goto_1

    .line 6675
    :cond_3
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    move-object v2, v15

    move/from16 v3, p1

    move/from16 v4, p3

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v19

    if-nez v19, :cond_4

    .line 6679
    new-instance v19, Ljava/lang/SecurityException;

    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    const-string v21, "Uid "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v20

    const-string v21, " does not have permission to uri "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v20

    invoke-direct/range {v19 .. v20}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v19

    .line 6685
    :cond_4
    invoke-virtual/range {p2 .. p2}, Landroid/net/Uri;->getPathSegments()Ljava/util/List;

    move-result-object v7

    .line 6686
    .local v7, SEGMENTS:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v7, :cond_0

    .line 6687
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v6

    .line 6688
    .local v6, NS:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Landroid/util/SparseArray;->size()I

    move-result v5

    .line 6689
    .local v5, N:I
    const/4 v10, 0x0

    .end local p1
    .local v10, i:I
    :goto_2
    if-ge v10, v5, :cond_0

    .line 6690
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move v1, v10

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/util/HashMap;

    .line 6692
    .local v14, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    invoke-virtual {v14}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v19

    invoke-interface/range {v19 .. v19}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v11

    .line 6694
    .local v11, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/UriPermission;>;"
    :cond_5
    :goto_3
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_7

    .line 6695
    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/UriPermission;

    .line 6696
    .local v13, perm:Lcom/android/server/am/UriPermission;
    move-object v0, v13

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->uri:Landroid/net/Uri;

    move-object/from16 v18, v0

    .line 6697
    .local v18, targetUri:Landroid/net/Uri;
    invoke-virtual/range {v18 .. v18}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v19

    move-object v0, v8

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v19

    if-eqz v19, :cond_5

    .line 6700
    invoke-virtual/range {v18 .. v18}, Landroid/net/Uri;->getPathSegments()Ljava/util/List;

    move-result-object v17

    .line 6701
    .local v17, targetSegments:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v17, :cond_5

    .line 6704
    invoke-interface/range {v17 .. v17}, Ljava/util/List;->size()I

    move-result v19

    move/from16 v0, v19

    move v1, v6

    if-lt v0, v1, :cond_5

    .line 6707
    const/4 v12, 0x0

    .local v12, j:I
    :goto_4
    if-ge v12, v6, :cond_6

    .line 6708
    invoke-interface {v7, v12}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, v17

    move v1, v12

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v19

    move-object/from16 v0, p1

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v19

    if-eqz v19, :cond_5

    .line 6707
    add-int/lit8 v12, v12, 0x1

    goto :goto_4

    .line 6714
    :cond_6
    move-object v0, v13

    move/from16 v1, p3

    invoke-virtual {v0, v1}, Lcom/android/server/am/UriPermission;->clearModes(I)V

    .line 6715
    move-object v0, v13

    iget v0, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    move/from16 v19, v0

    if-nez v19, :cond_5

    .line 6716
    invoke-interface {v11}, Ljava/util/Iterator;->remove()V

    goto :goto_3

    .line 6719
    .end local v12           #j:I
    .end local v13           #perm:Lcom/android/server/am/UriPermission;
    .end local v17           #targetSegments:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v18           #targetUri:Landroid/net/Uri;
    :cond_7
    invoke-virtual {v14}, Ljava/util/HashMap;->size()I

    move-result v19

    if-nez v19, :cond_8

    .line 6720
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v20, v0

    move-object/from16 v0, v20

    move v1, v10

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v20

    invoke-virtual/range {v19 .. v20}, Landroid/util/SparseArray;->remove(I)V

    .line 6722
    add-int/lit8 v5, v5, -0x1

    .line 6723
    add-int/lit8 v10, v10, -0x1

    .line 6689
    :cond_8
    add-int/lit8 v10, v10, 0x1

    goto/16 :goto_2

    .line 6666
    .end local v5           #N:I
    .end local v6           #NS:I
    .end local v7           #SEGMENTS:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v10           #i:I
    .end local v11           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/UriPermission;>;"
    .end local v14           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    .restart local p1
    :catch_0
    move-exception v19

    goto/16 :goto_1
.end method

.method private saveLocaleLocked(Ljava/util/Locale;ZZ)V
    .locals 2
    .parameter "l"
    .parameter "isDiff"
    .parameter "isPersist"

    .prologue
    .line 13802
    if-eqz p2, :cond_0

    .line 13803
    const-string v0, "user.language"

    invoke-virtual {p1}, Ljava/util/Locale;->getLanguage()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13804
    const-string v0, "user.region"

    invoke-virtual {p1}, Ljava/util/Locale;->getCountry()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13807
    :cond_0
    if-eqz p3, :cond_1

    .line 13808
    const-string v0, "persist.sys.language"

    invoke-virtual {p1}, Ljava/util/Locale;->getLanguage()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13809
    const-string v0, "persist.sys.country"

    invoke-virtual {p1}, Ljava/util/Locale;->getCountry()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13810
    const-string v0, "persist.sys.localevar"

    invoke-virtual {p1}, Ljava/util/Locale;->getVariant()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13812
    :cond_1
    return-void
.end method

.method private static scanArgs([Ljava/lang/String;Ljava/lang/String;)Z
    .locals 5
    .parameter "args"
    .parameter "value"

    .prologue
    .line 10381
    if-eqz p0, :cond_1

    .line 10382
    move-object v1, p0

    .local v1, arr$:[Ljava/lang/String;
    array-length v3, v1

    .local v3, len$:I
    const/4 v2, 0x0

    .local v2, i$:I
    :goto_0
    if-ge v2, v3, :cond_1

    aget-object v0, v1, v2

    .line 10383
    .local v0, arg:Ljava/lang/String;
    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_0

    .line 10384
    const/4 v4, 0x1

    .line 10388
    .end local v0           #arg:Ljava/lang/String;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v2           #i$:I
    .end local v3           #len$:I
    :goto_1
    return v4

    .line 10382
    .restart local v0       #arg:Ljava/lang/String;
    .restart local v1       #arr$:[Ljava/lang/String;
    .restart local v2       #i$:I
    .restart local v3       #len$:I
    :cond_0
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 10388
    .end local v0           #arg:Ljava/lang/String;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v2           #i$:I
    .end local v3           #len$:I
    :cond_1
    const/4 v4, 0x0

    goto :goto_1
.end method

.method private final scheduleBroadcastsLocked()V
    .locals 2

    .prologue
    .line 12229
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    if-eqz v0, :cond_0

    .line 12234
    :goto_0
    return-void

    .line 12232
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/4 v1, 0x7

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 12233
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    goto :goto_0
.end method

.method private final scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z
    .locals 23
    .parameter "r"
    .parameter "allowCancel"

    .prologue
    .line 11123
    const/4 v4, 0x0

    .line 11125
    .local v4, canceled:Z
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v10

    .line 11126
    .local v10, now:J
    const-wide/16 v8, 0x1388

    .line 11127
    .local v8, minDuration:J
    const-wide/32 v14, 0xea60

    .line 11131
    .local v14, resetTime:J
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    invoke-virtual/range {v17 .. v17}, Ljava/util/ArrayList;->size()I

    move-result v3

    .line 11132
    .local v3, N:I
    if-lez v3, :cond_6

    .line 11133
    const/16 v17, 0x1

    sub-int v7, v3, v17

    .local v7, i:I
    :goto_0
    if-ltz v7, :cond_5

    .line 11134
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move v1, v7

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/android/server/am/ServiceRecord$StartItem;

    .line 11135
    .local v16, si:Lcom/android/server/am/ServiceRecord$StartItem;
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    move-object/from16 v17, v0

    if-nez v17, :cond_1

    .line 11133
    :cond_0
    :goto_1
    add-int/lit8 v7, v7, -0x1

    goto :goto_0

    .line 11137
    :cond_1
    if-eqz p2, :cond_2

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    move/from16 v17, v0

    const/16 v18, 0x3

    move/from16 v0, v17

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    move/from16 v17, v0

    const/16 v18, 0x6

    move/from16 v0, v17

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    .line 11139
    :cond_2
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    const/16 v18, 0x0

    move-object/from16 v0, v17

    move/from16 v1, v18

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 11140
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    move-object/from16 v0, v16

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->deliveredTime:J

    move-wide/from16 v19, v0

    sub-long v5, v17, v19

    .line 11141
    .local v5, dur:J
    const-wide/16 v17, 0x2

    mul-long v5, v5, v17

    .line 11142
    cmp-long v17, v8, v5

    if-gez v17, :cond_3

    move-wide v8, v5

    .line 11143
    :cond_3
    cmp-long v17, v14, v5

    if-gez v17, :cond_0

    move-wide v14, v5

    goto :goto_1

    .line 11145
    .end local v5           #dur:J
    :cond_4
    const-string v17, "ActivityManager"

    new-instance v18, Ljava/lang/StringBuilder;

    invoke-direct/range {v18 .. v18}, Ljava/lang/StringBuilder;-><init>()V

    const-string v19, "Canceling start item "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    move-object/from16 v19, v0

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v18

    const-string v19, " in service "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object/from16 v19, v0

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v18

    invoke-virtual/range {v18 .. v18}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v18

    invoke-static/range {v17 .. v18}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11147
    const/4 v4, 0x1

    goto :goto_1

    .line 11150
    .end local v16           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_5
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    invoke-virtual/range {v17 .. v17}, Ljava/util/ArrayList;->clear()V

    .line 11153
    .end local v7           #i:I
    :cond_6
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    move/from16 v17, v0

    add-int/lit8 v17, v17, 0x1

    move/from16 v0, v17

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    .line 11154
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    const-wide/16 v19, 0x0

    cmp-long v17, v17, v19

    if-nez v17, :cond_b

    .line 11155
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ServiceRecord;->restartCount:I

    move/from16 v17, v0

    add-int/lit8 v17, v17, 0x1

    move/from16 v0, v17

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ServiceRecord;->restartCount:I

    .line 11156
    move-wide v0, v8

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 11174
    :cond_7
    :goto_2
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    add-long v17, v17, v10

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 11180
    :cond_8
    const/4 v13, 0x0

    .line 11181
    .local v13, repeat:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    invoke-virtual/range {v17 .. v17}, Ljava/util/ArrayList;->size()I

    move-result v17

    const/16 v18, 0x1

    sub-int v7, v17, v18

    .restart local v7       #i:I
    :goto_3
    if-ltz v7, :cond_9

    .line 11182
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move v1, v7

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Lcom/android/server/am/ServiceRecord;

    .line 11183
    .local v12, r2:Lcom/android/server/am/ServiceRecord;
    move-object v0, v12

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_d

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    move-object v0, v12

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v19, v0

    const-wide/16 v21, 0x2710

    sub-long v19, v19, v21

    cmp-long v17, v17, v19

    if-ltz v17, :cond_d

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    move-object v0, v12

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v19, v0

    const-wide/16 v21, 0x2710

    add-long v19, v19, v21

    cmp-long v17, v17, v19

    if-gez v17, :cond_d

    .line 11187
    move-object v0, v12

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    const-wide/16 v19, 0x2710

    add-long v17, v17, v19

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 11188
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    sub-long v17, v17, v10

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 11189
    const/4 v13, 0x1

    .line 11193
    .end local v12           #r2:Lcom/android/server/am/ServiceRecord;
    :cond_9
    if-nez v13, :cond_8

    .line 11195
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v17

    if-nez v17, :cond_a

    .line 11196
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11199
    :cond_a
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11201
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object/from16 v17, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    .line 11202
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object/from16 v17, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    move-object/from16 v18, v0

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v19, v0

    invoke-virtual/range {v17 .. v20}, Landroid/os/Handler;->postAtTime(Ljava/lang/Runnable;J)Z

    .line 11203
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v19, v0

    add-long v17, v17, v19

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 11204
    const-string v17, "ActivityManager"

    new-instance v18, Ljava/lang/StringBuilder;

    invoke-direct/range {v18 .. v18}, Ljava/lang/StringBuilder;-><init>()V

    const-string v19, "Scheduling restart of crashed service "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object/from16 v19, v0

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    const-string v19, " in "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v19, v0

    invoke-virtual/range {v18 .. v20}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v18

    const-string v19, "ms"

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    invoke-virtual/range {v18 .. v18}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v18

    invoke-static/range {v17 .. v18}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11206
    const/16 v17, 0x7553

    const/16 v18, 0x2

    move/from16 v0, v18

    new-array v0, v0, [Ljava/lang/Object;

    move-object/from16 v18, v0

    const/16 v19, 0x0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object/from16 v20, v0

    aput-object v20, v18, v19

    const/16 v19, 0x1

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v20, v0

    invoke-static/range {v20 .. v21}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v20

    aput-object v20, v18, v19

    invoke-static/range {v17 .. v18}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 11209
    return v4

    .line 11163
    .end local v7           #i:I
    .end local v13           #repeat:Z
    :cond_b
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartTime:J

    move-wide/from16 v17, v0

    add-long v17, v17, v14

    cmp-long v17, v10, v17

    if-lez v17, :cond_c

    .line 11164
    const/16 v17, 0x1

    move/from16 v0, v17

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ServiceRecord;->restartCount:I

    .line 11165
    move-wide v0, v8

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    goto/16 :goto_2

    .line 11167
    :cond_c
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    const-wide/16 v19, 0x4

    mul-long v17, v17, v19

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 11168
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    cmp-long v17, v17, v8

    if-gez v17, :cond_7

    .line 11169
    move-wide v0, v8

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    goto/16 :goto_2

    .line 11181
    .restart local v7       #i:I
    .restart local v12       #r2:Lcom/android/server/am/ServiceRecord;
    .restart local v13       #repeat:Z
    :cond_d
    add-int/lit8 v7, v7, -0x1

    goto/16 :goto_3
.end method

.method public static self()Lcom/android/server/am/ActivityManagerService;
    .locals 1

    .prologue
    .line 1323
    sget-object v0, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    return-object v0
.end method

.method private final sendPackageBroadcastLocked(I[Ljava/lang/String;)V
    .locals 4
    .parameter "cmd"
    .parameter "packages"

    .prologue
    .line 12368
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 12369
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 12370
    .local v1, r:Lcom/android/server/am/ProcessRecord;
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_0

    .line 12372
    :try_start_0
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v2, p1, p2}, Landroid/app/IApplicationThread;->dispatchPackageBroadcast(I[Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 12368
    :cond_0
    :goto_1
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 12377
    .end local v1           #r:Lcom/android/server/am/ProcessRecord;
    :cond_1
    return-void

    .line 12373
    .restart local v1       #r:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v2

    goto :goto_1
.end method

.method private final sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .locals 8
    .parameter "r"
    .parameter "oomAdjusted"

    .prologue
    .line 10982
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10983
    .local v0, N:I
    if-nez v0, :cond_1

    .line 11033
    :cond_0
    :goto_0
    return-void

    .line 10987
    :cond_1
    const/4 v3, 0x0

    .line 10988
    .local v3, i:I
    :goto_1
    if-ge v3, v0, :cond_6

    .line 10990
    :try_start_0
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord$StartItem;

    .line 10993
    .local v4, si:Lcom/android/server/am/ServiceRecord$StartItem;
    iget-object v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    if-nez v5, :cond_2

    const/4 v5, 0x1

    if-le v0, v5, :cond_2

    .line 10996
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 10999
    :cond_2
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11000
    if-nez p2, :cond_3

    .line 11001
    const/4 p2, 0x1

    .line 11002
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11004
    :cond_3
    const/4 v2, 0x0

    .line 11005
    .local v2, flags:I
    iget v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    if-lez v5, :cond_4

    .line 11006
    or-int/lit8 v2, v2, 0x2

    .line 11008
    :cond_4
    iget v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    if-lez v5, :cond_5

    .line 11009
    or-int/lit8 v2, v2, 0x1

    .line 11011
    :cond_5
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget v6, v4, Lcom/android/server/am/ServiceRecord$StartItem;->id:I

    iget-object v7, v4, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    invoke-interface {v5, p1, v6, v2, v7}, Landroid/app/IApplicationThread;->scheduleServiceArgs(Landroid/os/IBinder;IILandroid/content/Intent;)V

    .line 11012
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v5

    iput-wide v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveredTime:J

    .line 11013
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v5, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11014
    iget v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    .line 11015
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 11016
    .end local v2           #flags:I
    .end local v4           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :catch_0
    move-exception v5

    move-object v1, v5

    .line 11025
    :cond_6
    :goto_2
    if-ne v3, v0, :cond_7

    .line 11026
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    goto :goto_0

    .line 11020
    :catch_1
    move-exception v5

    move-object v1, v5

    .line 11021
    .local v1, e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v6, "Unexpected exception"

    invoke-static {v5, v6, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_2

    .line 11028
    .end local v1           #e:Ljava/lang/Exception;
    :cond_7
    :goto_3
    if-lez v3, :cond_0

    .line 11029
    add-int/lit8 v3, v3, -0x1

    .line 11030
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_3
.end method

.method private final setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 2
    .parameter "r"

    .prologue
    .line 1597
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-eq v0, p1, :cond_0

    .line 1598
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 1599
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, p1, v1}, Lcom/android/server/WindowManagerService;->setFocusedApp(Landroid/os/IBinder;Z)V

    .line 1601
    :cond_0
    return-void
.end method

.method public static setSystemProcess()V
    .locals 8

    .prologue
    .line 1246
    :try_start_0
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    .line 1248
    .local v3, m:Lcom/android/server/am/ActivityManagerService;
    const-string v4, "activity"

    invoke-static {v4, v3}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1249
    const-string v4, "meminfo"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$MemBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$MemBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1251
    const-string v4, "cpuinfo"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$CpuBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$CpuBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1253
    const-string v4, "permission"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$PermissionController;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$PermissionController;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1255
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v4, v4, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    const-string v5, "android"

    const/16 v6, 0x400

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v2

    .line 1258
    .local v2, info:Landroid/content/pm/ApplicationInfo;
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v4, v2}, Landroid/app/ActivityThread;->installSystemApplicationInfo(Landroid/content/pm/ApplicationInfo;)V

    .line 1260
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    monitor-enter v4
    :try_end_0
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1261
    :try_start_1
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    sget-object v6, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v6}, Landroid/app/ActivityThread;->getApplicationThread()Landroid/app/ActivityThread$ApplicationThread;

    move-result-object v6

    iget-object v7, v2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6, v2, v7}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1264
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    const/4 v5, 0x1

    iput-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    .line 1265
    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    iput v5, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 1266
    const/16 v5, -0x10

    iput v5, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    .line 1267
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v6, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6, v7, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 1268
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 1269
    :try_start_2
    sget-object v6, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v6, v6, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v7, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v6, v7, v0}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 1270
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 1271
    :try_start_3
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    const/4 v6, 0x1

    const/4 v7, 0x1

    invoke-direct {v5, v0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 1272
    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 1277
    return-void

    .line 1270
    :catchall_0
    move-exception v6

    :try_start_4
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    :try_start_5
    throw v6

    .line 1272
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_1
    move-exception v5

    monitor-exit v4
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    :try_start_6
    throw v5
    :try_end_6
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_6 .. :try_end_6} :catch_0

    .line 1273
    .end local v2           #info:Landroid/content/pm/ApplicationInfo;
    .end local v3           #m:Lcom/android/server/am/ActivityManagerService;
    :catch_0
    move-exception v4

    move-object v1, v4

    .line 1274
    .local v1, e:Landroid/content/pm/PackageManager$NameNotFoundException;
    new-instance v4, Ljava/lang/RuntimeException;

    const-string v5, "Unable to find android system package"

    invoke-direct {v4, v5, v1}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V

    throw v4
.end method

.method private final startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I
    .locals 31
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "aInfo"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "callingPid"
    .parameter "callingUid"
    .parameter "onlyIfNeeded"
    .parameter "componentSpecified"

    .prologue
    .line 3140
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Starting activity: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3142
    const/16 v29, 0x0

    .line 3143
    .local v29, sourceRecord:Lcom/android/server/am/HistoryRecord;
    const/4 v7, 0x0

    .line 3144
    .local v7, resultRecord:Lcom/android/server/am/HistoryRecord;
    if-eqz p7, :cond_0

    .line 3145
    move-object/from16 v0, p0

    move-object/from16 v1, p7

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v24

    .line 3148
    .local v24, index:I
    if-ltz v24, :cond_0

    .line 3149
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v24

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v29

    .end local v29           #sourceRecord:Lcom/android/server/am/HistoryRecord;
    check-cast v29, Lcom/android/server/am/HistoryRecord;

    .line 3150
    .restart local v29       #sourceRecord:Lcom/android/server/am/HistoryRecord;
    if-ltz p9, :cond_0

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-nez v5, :cond_0

    .line 3151
    move-object/from16 v7, v29

    .line 3156
    .end local v24           #index:I
    :cond_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getFlags()I

    move-result v25

    .line 3158
    .local v25, launchFlags:I
    const/high16 v5, 0x200

    and-int v5, v5, v25

    if-eqz v5, :cond_2

    if-eqz v29, :cond_2

    .line 3162
    if-ltz p9, :cond_1

    .line 3163
    const/4 v5, -0x3

    .line 3283
    :goto_0
    return v5

    .line 3165
    :cond_1
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v7, v0

    .line 3166
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object/from16 p8, v0

    .line 3167
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move/from16 p9, v0

    .line 3168
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3169
    if-eqz v7, :cond_2

    .line 3170
    move-object v0, v7

    move-object/from16 v1, v29

    move-object/from16 v2, p8

    move/from16 v3, p9

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/HistoryRecord;->removeResultsLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 3175
    :cond_2
    const/16 v23, 0x0

    .line 3177
    .local v23, err:I
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    if-nez v5, :cond_3

    .line 3180
    const/16 v23, -0x1

    .line 3183
    :cond_3
    if-nez v23, :cond_4

    if-nez p6, :cond_4

    .line 3186
    const/16 v23, -0x2

    .line 3189
    :cond_4
    const/16 v21, 0x0

    .line 3190
    .local v21, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v23, :cond_5

    if-eqz p1, :cond_5

    .line 3191
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v21

    .line 3192
    if-eqz v21, :cond_7

    .line 3193
    move-object/from16 v0, v21

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 p10, v0

    .line 3194
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object v0, v5

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    move/from16 p11, v0

    .line 3203
    :cond_5
    :goto_1
    if-eqz v23, :cond_8

    .line 3204
    if-eqz v7, :cond_6

    .line 3205
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    :cond_6
    move/from16 v5, v23

    .line 3209
    goto :goto_0

    .line 3196
    :cond_7
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find app for caller "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v8, " (pid="

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, p10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v8, ") when starting: "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3199
    const/16 v23, -0x4

    goto :goto_1

    .line 3212
    :cond_8
    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p6

    iget-boolean v0, v0, Landroid/content/pm/ActivityInfo;->exported:Z

    move v6, v0

    if-eqz v6, :cond_a

    const/4 v6, -0x1

    :goto_2
    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, p10

    move/from16 v3, p11

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v28

    .line 3214
    .local v28, perm:I
    if-eqz v28, :cond_b

    .line 3215
    if-eqz v7, :cond_9

    .line 3216
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3220
    :cond_9
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: starting "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p11

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v26

    .line 3224
    .local v26, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3225
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 3212
    .end local v26           #msg:Ljava/lang/String;
    .end local v28           #perm:I
    :cond_a
    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    goto/16 :goto_2

    .line 3228
    .restart local v28       #perm:I
    :cond_b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    if-eqz v5, :cond_e

    .line 3229
    const/16 v20, 0x0

    .line 3233
    .local v20, abort:Z
    :try_start_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object v30

    .line 3234
    .local v30, watchIntent:Landroid/content/Intent;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v0, v5

    move-object/from16 v1, v30

    move-object v2, v6

    invoke-interface {v0, v1, v2}, Landroid/app/IActivityController;->activityStarting(Landroid/content/Intent;Ljava/lang/String;)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v5

    if-nez v5, :cond_d

    const/4 v5, 0x1

    move/from16 v20, v5

    .line 3240
    .end local v30           #watchIntent:Landroid/content/Intent;
    :goto_3
    if-eqz v20, :cond_e

    .line 3241
    if-eqz v7, :cond_c

    .line 3242
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3248
    :cond_c
    const/4 v5, 0x0

    goto/16 :goto_0

    .line 3234
    .restart local v30       #watchIntent:Landroid/content/Intent;
    :cond_d
    const/4 v5, 0x0

    move/from16 v20, v5

    goto :goto_3

    .line 3236
    .end local v30           #watchIntent:Landroid/content/Intent;
    :catch_0
    move-exception v5

    move-object/from16 v22, v5

    .line 3237
    .local v22, e:Landroid/os/RemoteException;
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_3

    .line 3252
    .end local v20           #abort:Z
    .end local v22           #e:Landroid/os/RemoteException;
    :cond_e
    new-instance v8, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v15, v0

    move-object/from16 v9, p0

    move-object/from16 v10, v21

    move/from16 v11, p11

    move-object/from16 v12, p2

    move-object/from16 v13, p3

    move-object/from16 v14, p6

    move-object/from16 v16, v7

    move-object/from16 v17, p8

    move/from16 v18, p9

    move/from16 v19, p13

    invoke-direct/range {v8 .. v19}, Lcom/android/server/am/HistoryRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/content/Intent;Ljava/lang/String;Landroid/content/pm/ActivityInfo;Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IZ)V

    .line 3256
    .local v8, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_f

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move v0, v5

    move/from16 v1, p11

    if-eq v0, v1, :cond_10

    .line 3258
    :cond_f
    const-string v5, "Activity start"

    move-object/from16 v0, p0

    move/from16 v1, p10

    move/from16 v2, p11

    move-object v3, v5

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_10

    .line 3259
    new-instance v27, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;

    move-object/from16 v0, v27

    move-object/from16 v1, p0

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    .line 3260
    .local v27, pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    move-object v0, v8

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->r:Lcom/android/server/am/HistoryRecord;

    .line 3261
    move-object/from16 v0, v29

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->sourceRecord:Lcom/android/server/am/HistoryRecord;

    .line 3262
    move-object/from16 v0, p4

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedUriPermissions:[Landroid/net/Uri;

    .line 3263
    move/from16 v0, p5

    move-object/from16 v1, v27

    iput v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedMode:I

    .line 3264
    move/from16 v0, p12

    move-object/from16 v1, v27

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->onlyIfNeeded:Z

    .line 3265
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3266
    const/4 v5, 0x4

    goto/16 :goto_0

    .line 3270
    .end local v27           #pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    :cond_10
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    move v5, v0

    if-eqz v5, :cond_11

    .line 3276
    const-wide/16 v5, 0x0

    move-wide v0, v5

    move-object/from16 v2, p0

    iput-wide v0, v2, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 3281
    :goto_4
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->doPendingActivityLaunchesLocked(Z)V

    .line 3283
    const/4 v15, 0x1

    move-object/from16 v9, p0

    move-object v10, v8

    move-object/from16 v11, v29

    move-object/from16 v12, p4

    move/from16 v13, p5

    move/from16 v14, p12

    invoke-direct/range {v9 .. v15}, Lcom/android/server/am/ActivityManagerService;->startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I

    move-result v5

    goto/16 :goto_0

    .line 3278
    :cond_11
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    goto :goto_4
.end method

.method private final startActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V
    .locals 21
    .parameter "r"
    .parameter "newTask"
    .parameter "doResume"

    .prologue
    .line 2864
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 2866
    .local v14, NH:I
    const/4 v4, -0x1

    .line 2868
    .local v4, addPos:I
    if-nez p2, :cond_4

    .line 2870
    const/16 v17, 0x0

    .line 2871
    .local v17, next:Lcom/android/server/am/HistoryRecord;
    const/16 v20, 0x1

    .line 2872
    .local v20, startIt:Z
    const/4 v3, 0x1

    sub-int v16, v14, v3

    .local v16, i:I
    :goto_0
    if-ltz v16, :cond_4

    .line 2873
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v18

    check-cast v18, Lcom/android/server/am/HistoryRecord;

    .line 2874
    .local v18, p:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v3, v0

    if-eqz v3, :cond_0

    .line 2872
    :goto_1
    add-int/lit8 v16, v16, -0x1

    goto :goto_0

    .line 2877
    :cond_0
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    if-ne v3, v5, :cond_2

    .line 2881
    add-int/lit8 v4, v16, 0x1

    .line 2882
    if-nez v20, :cond_4

    .line 2883
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 2884
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 2885
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 2886
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    .line 2992
    .end local v16           #i:I
    .end local v17           #next:Lcom/android/server/am/HistoryRecord;
    .end local v18           #p:Lcom/android/server/am/HistoryRecord;
    .end local v20           #startIt:Z
    :cond_1
    :goto_2
    return-void

    .line 2895
    .restart local v16       #i:I
    .restart local v17       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v18       #p:Lcom/android/server/am/HistoryRecord;
    .restart local v20       #startIt:Z
    :cond_2
    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v3, v0

    if-eqz v3, :cond_3

    .line 2896
    const/16 v20, 0x0

    .line 2898
    :cond_3
    move-object/from16 v17, v18

    goto :goto_1

    .line 2904
    .end local v16           #i:I
    .end local v17           #next:Lcom/android/server/am/HistoryRecord;
    .end local v18           #p:Lcom/android/server/am/HistoryRecord;
    .end local v20           #startIt:Z
    :cond_4
    if-gez v4, :cond_5

    .line 2905
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v4

    .line 2911
    :cond_5
    if-ge v4, v14, :cond_6

    .line 2912
    const/4 v3, 0x0

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 2917
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 2918
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 2919
    move/from16 v0, p2

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 2920
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 2921
    if-lez v14, :cond_12

    .line 2925
    move/from16 v13, p2

    .line 2926
    .local v13, showStartingIcon:Z
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    .line 2927
    .local v19, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v19, :cond_7

    .line 2928
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v3, v5, v6}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v19

    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    check-cast v19, Lcom/android/server/am/ProcessRecord;

    .line 2930
    .restart local v19       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_7
    if-eqz v19, :cond_8

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v3, v0

    if-nez v3, :cond_9

    .line 2931
    :cond_8
    const/4 v13, 0x1

    .line 2935
    :cond_9
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v5, 0x1

    and-int/2addr v3, v5

    if-eqz v3, :cond_d

    .line 2936
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    const/4 v5, 0x0

    invoke-virtual {v3, v5}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2937
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2947
    :goto_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    .line 2949
    const/4 v15, 0x1

    .line 2950
    .local v15, doShow:Z
    if-eqz p2, :cond_a

    .line 2956
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v5, 0x20

    and-int/2addr v3, v5

    if-eqz v3, :cond_a

    .line 2958
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    .line 2959
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p1

    if-ne v0, v1, :cond_10

    const/4 v3, 0x1

    move v15, v3

    .line 2962
    :cond_a
    :goto_4
    if-eqz v15, :cond_c

    .line 2967
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v12, v0

    .line 2968
    .local v12, prev:Lcom/android/server/am/HistoryRecord;
    if-eqz v12, :cond_b

    .line 2971
    iget-object v3, v12, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    if-eq v3, v5, :cond_11

    const/4 v12, 0x0

    .line 2975
    :cond_b
    :goto_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v7, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->theme:I

    move v8, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    move-object v9, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->labelRes:I

    move v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->icon:I

    move v11, v0

    move-object/from16 v6, p1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    .line 2989
    .end local v12           #prev:Lcom/android/server/am/HistoryRecord;
    .end local v13           #showStartingIcon:Z
    .end local v15           #doShow:Z
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_c
    :goto_6
    if-eqz p3, :cond_1

    .line 2990
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    goto/16 :goto_2

    .line 2938
    .restart local v13       #showStartingIcon:Z
    .restart local v19       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_d
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v5, 0x8

    and-int/2addr v3, v5

    if-eqz v3, :cond_e

    .line 2939
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    const/16 v5, 0x1008

    invoke-virtual {v3, v5}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2940
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    goto/16 :goto_3

    .line 2942
    :cond_e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    if-eqz p2, :cond_f

    const/16 v5, 0x1008

    :goto_7
    invoke-virtual {v3, v5}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2945
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    goto/16 :goto_3

    .line 2942
    :cond_f
    const/16 v5, 0x1006

    goto :goto_7

    .line 2959
    .restart local v15       #doShow:Z
    :cond_10
    const/4 v3, 0x0

    move v15, v3

    goto/16 :goto_4

    .line 2973
    .restart local v12       #prev:Lcom/android/server/am/HistoryRecord;
    :cond_11
    iget-boolean v3, v12, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v3, :cond_b

    const/4 v12, 0x0

    goto :goto_5

    .line 2982
    .end local v12           #prev:Lcom/android/server/am/HistoryRecord;
    .end local v13           #showStartingIcon:Z
    .end local v15           #doShow:Z
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_12
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    goto :goto_6
.end method

.method private final startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I
    .locals 24
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"
    .parameter "outResult"
    .parameter "config"

    .prologue
    .line 3679
    if-eqz p2, :cond_0

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    if-eqz v4, :cond_0

    .line 3680
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3683
    :cond_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    if-eqz v4, :cond_5

    const/4 v4, 0x1

    move/from16 v17, v4

    .line 3686
    .local v17, componentSpecified:Z
    :goto_0
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 3691
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const v5, 0x10400

    move-object v0, v4

    move-object v1, v6

    move-object/from16 v2, p3

    move v3, v5

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v22

    .line 3696
    .local v22, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v22, :cond_6

    move-object/from16 v0, v22

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-object v10, v4

    .line 3701
    .end local v22           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :goto_1
    if-eqz v10, :cond_1

    .line 3706
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3710
    if-eqz p10, :cond_1

    .line 3711
    iget-object v4, v10, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    const-string v5, "system"

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_1

    .line 3712
    iget-object v4, v10, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    const/4 v5, 0x1

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v7

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->setDebugApp(Ljava/lang/String;ZZ)V

    .line 3717
    :cond_1
    monitor-enter p0

    .line 3720
    if-nez p1, :cond_7

    .line 3721
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v14

    .line 3722
    .local v14, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v15

    .line 3727
    .local v15, callingUid:I
    :goto_2
    if-eqz p12, :cond_8

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p12

    invoke-virtual {v0, v1}, Landroid/content/res/Configuration;->diff(Landroid/content/res/Configuration;)I

    move-result v4

    if-eqz v4, :cond_8

    const/4 v4, 0x1

    :goto_3
    move v0, v4

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    .line 3731
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v19

    .local v19, origId:J
    move-object/from16 v4, p0

    move-object/from16 v5, p1

    move-object/from16 v7, p3

    move-object/from16 v8, p4

    move/from16 v9, p5

    move-object/from16 v11, p6

    move-object/from16 v12, p7

    move/from16 v13, p8

    move/from16 v16, p9

    .line 3733
    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v23

    .line 3738
    .local v23, res:I
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    move v4, v0

    if-eqz v4, :cond_2

    .line 3743
    const-string v4, "android.permission.CHANGE_CONFIGURATION"

    const-string v5, "updateConfiguration()"

    move-object/from16 v0, p0

    move-object v1, v4

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 3745
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    .line 3748
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p12

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 3751
    :cond_2
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 3753
    if-eqz p11, :cond_4

    .line 3754
    move/from16 v0, v23

    move-object/from16 v1, p11

    iput v0, v1, Landroid/app/IActivityManager$WaitResult;->result:I

    .line 3755
    if-nez v23, :cond_9

    .line 3756
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p11

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 3759
    :cond_3
    :try_start_2
    invoke-virtual/range {p0 .. p0}, Ljava/lang/Object;->wait()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_2 .. :try_end_2} :catch_1

    .line 3762
    :goto_4
    :try_start_3
    move-object/from16 v0, p11

    iget-boolean v0, v0, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    move v4, v0

    if-nez v4, :cond_4

    move-object/from16 v0, p11

    iget-object v0, v0, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    move-object v4, v0

    if-eqz v4, :cond_3

    .line 3783
    .end local v6           #intent:Landroid/content/Intent;
    :cond_4
    :goto_5
    monitor-exit p0

    return v23

    .line 3683
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v17           #componentSpecified:Z
    .end local v19           #origId:J
    .end local v23           #res:I
    .restart local p2
    :cond_5
    const/4 v4, 0x0

    move/from16 v17, v4

    goto/16 :goto_0

    .line 3696
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v17       #componentSpecified:Z
    .restart local v22       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_6
    const/4 v4, 0x0

    move-object v10, v4

    goto/16 :goto_1

    .line 3697
    .end local v22           #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_0
    move-exception v4

    move-object/from16 v18, v4

    .line 3698
    .local v18, e:Landroid/os/RemoteException;
    const/4 v10, 0x0

    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    goto/16 :goto_1

    .line 3724
    .end local v18           #e:Landroid/os/RemoteException;
    :cond_7
    const/4 v15, -0x1

    .restart local v15       #callingUid:I
    move v14, v15

    .restart local v14       #callingPid:I
    goto/16 :goto_2

    .line 3727
    :cond_8
    const/4 v4, 0x0

    goto :goto_3

    .line 3763
    .restart local v19       #origId:J
    .restart local v23       #res:I
    :cond_9
    const/4 v4, 0x2

    move/from16 v0, v23

    move v1, v4

    if-ne v0, v1, :cond_4

    .line 3764
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v21

    .line 3765
    .local v21, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v21

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    move v4, v0

    if-eqz v4, :cond_a

    .line 3766
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p11

    iput-boolean v0, v1, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    .line 3767
    new-instance v4, Landroid/content/ComponentName;

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    .end local v6           #intent:Landroid/content/Intent;
    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v0, v4

    move-object/from16 v1, p11

    iput-object v0, v1, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    .line 3768
    const-wide/16 v4, 0x0

    move-wide v0, v4

    move-object/from16 v2, p11

    iput-wide v0, v2, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    .line 3769
    const-wide/16 v4, 0x0

    move-wide v0, v4

    move-object/from16 v2, p11

    iput-wide v0, v2, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    goto :goto_5

    .line 3784
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v19           #origId:J
    .end local v21           #r:Lcom/android/server/am/HistoryRecord;
    .end local v23           #res:I
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    throw v4

    .line 3771
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v14       #callingPid:I
    .restart local v15       #callingUid:I
    .restart local v19       #origId:J
    .restart local v21       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v23       #res:I
    :cond_a
    :try_start_4
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    move-wide v0, v4

    move-object/from16 v2, p11

    iput-wide v0, v2, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    .line 3772
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p11

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 3775
    :cond_b
    :try_start_5
    invoke-virtual/range {p0 .. p0}, Ljava/lang/Object;->wait()V
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_5 .. :try_end_5} :catch_2

    .line 3778
    :goto_6
    :try_start_6
    move-object/from16 v0, p11

    iget-boolean v0, v0, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    move v4, v0

    if-nez v4, :cond_4

    move-object/from16 v0, p11

    iget-object v0, v0, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    move-object v4, v0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    if-eqz v4, :cond_b

    goto/16 :goto_5

    .line 3760
    .end local v21           #r:Lcom/android/server/am/HistoryRecord;
    :catch_1
    move-exception v4

    goto/16 :goto_4

    .line 3776
    .restart local v21       #r:Lcom/android/server/am/HistoryRecord;
    :catch_2
    move-exception v4

    goto :goto_6
.end method

.method private final startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I
    .locals 28
    .parameter "r"
    .parameter "sourceRecord"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "onlyIfNeeded"
    .parameter "doResume"

    .prologue
    .line 3304
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object/from16 v20, v0

    .line 3305
    .local v20, intent:Landroid/content/Intent;
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchedFromUid:I

    move v6, v0

    .line 3307
    .local v6, callingUid:I
    invoke-virtual/range {v20 .. v20}, Landroid/content/Intent;->getFlags()I

    move-result v21

    .line 3311
    .local v21, launchFlags:I
    const/high16 v5, 0x4

    and-int v5, v5, v21

    if-nez v5, :cond_3

    const/4 v5, 0x1

    :goto_0
    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 3318
    if-nez p6, :cond_0

    .line 3319
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    .line 3322
    :cond_0
    const/high16 v5, 0x100

    and-int v5, v5, v21

    if-eqz v5, :cond_4

    move-object/from16 v23, p1

    .line 3329
    .local v23, notTop:Lcom/android/server/am/HistoryRecord;
    :goto_1
    if-eqz p5, :cond_2

    .line 3330
    move-object/from16 v17, p2

    .line 3331
    .local v17, checkedCaller:Lcom/android/server/am/HistoryRecord;
    if-nez v17, :cond_1

    .line 3332
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v17

    .line 3334
    :cond_1
    move-object/from16 v0, v17

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v5, v7}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_2

    .line 3336
    const/16 p5, 0x0

    .line 3340
    .end local v17           #checkedCaller:Lcom/android/server/am/HistoryRecord;
    :cond_2
    if-eqz p3, :cond_5

    if-lez v6, :cond_5

    .line 3341
    const/16 v19, 0x0

    .local v19, i:I
    :goto_2
    move-object/from16 v0, p3

    array-length v0, v0

    move v5, v0

    move/from16 v0, v19

    move v1, v5

    if-ge v0, v1, :cond_5

    .line 3342
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v7, v0

    aget-object v8, p3, v19

    move-object/from16 v5, p0

    move/from16 v9, p4

    move-object/from16 v10, p1

    invoke-direct/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    .line 3341
    add-int/lit8 v19, v19, 0x1

    goto :goto_2

    .line 3311
    .end local v19           #i:I
    .end local v23           #notTop:Lcom/android/server/am/HistoryRecord;
    :cond_3
    const/4 v5, 0x0

    goto :goto_0

    .line 3322
    :cond_4
    const/4 v5, 0x0

    move-object/from16 v23, v5

    goto :goto_1

    .line 3347
    .restart local v23       #notTop:Lcom/android/server/am/HistoryRecord;
    :cond_5
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p0

    move v1, v6

    move-object v2, v5

    move-object/from16 v3, v20

    move-object/from16 v4, p1

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 3350
    if-nez p2, :cond_f

    .line 3353
    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-nez v5, :cond_6

    .line 3354
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #callingUid:I
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "startActivity called from non-Activity context; forcing Intent.FLAG_ACTIVITY_NEW_TASK for: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3356
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    .line 3370
    :cond_6
    :goto_3
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_7

    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_7

    .line 3376
    const-string v5, "ActivityManager"

    const-string v6, "Activity is launching as a new task, so cancelling activity result."

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3377
    const/4 v8, -0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v9, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v11, v0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object/from16 v7, p0

    invoke-virtual/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3380
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3383
    :cond_7
    const/4 v15, 0x0

    .line 3384
    .local v15, addingToTask:Z
    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_8

    const/high16 v5, 0x800

    and-int v5, v5, v21

    if-eqz v5, :cond_9

    :cond_8
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-eq v5, v6, :cond_9

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_1f

    .line 3391
    :cond_9
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_1f

    .line 3396
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-eq v5, v6, :cond_12

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v20

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findTaskLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    move-object/from16 v25, v5

    .line 3399
    .local v25, taskTop:Lcom/android/server/am/HistoryRecord;
    :goto_4
    if-eqz v25, :cond_1f

    .line 3400
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-nez v5, :cond_a

    .line 3405
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    move-object v0, v5

    move-object/from16 v1, v20

    move-object v2, v6

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3413
    :cond_a
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v18

    .line 3414
    .local v18, curTop:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    if-eq v5, v6, :cond_c

    .line 3415
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    const/high16 v6, 0x40

    invoke-virtual {v5, v6}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 3416
    if-eqz p2, :cond_b

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    if-ne v5, v6, :cond_13

    :cond_b
    const/4 v5, 0x1

    move/from16 v16, v5

    .line 3418
    .local v16, callerAtFront:Z
    :goto_5
    if-eqz v16, :cond_c

    .line 3421
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V

    .line 3426
    .end local v16           #callerAtFront:Z
    :cond_c
    const/high16 v5, 0x20

    and-int v5, v5, v21

    if-eqz v5, :cond_d

    .line 3427
    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v25

    .line 3429
    :cond_d
    if-eqz p5, :cond_14

    .line 3434
    if-eqz p6, :cond_e

    .line 3435
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3437
    :cond_e
    const/4 v5, 0x1

    .line 3643
    .end local v18           #curTop:Lcom/android/server/am/HistoryRecord;
    .end local v25           #taskTop:Lcom/android/server/am/HistoryRecord;
    .end local p3
    :goto_6
    return v5

    .line 3358
    .end local v15           #addingToTask:Z
    .restart local v6       #callingUid:I
    .restart local p3
    :cond_f
    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_10

    .line 3362
    .end local v6           #callingUid:I
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    goto/16 :goto_3

    .line 3363
    :cond_10
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-eq v5, v6, :cond_11

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-ne v5, v6, :cond_6

    .line 3367
    :cond_11
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    goto/16 :goto_3

    .line 3396
    .restart local v15       #addingToTask:Z
    :cond_12
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v20

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findActivityLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    move-object/from16 v25, v5

    goto/16 :goto_4

    .line 3416
    .restart local v18       #curTop:Lcom/android/server/am/HistoryRecord;
    .restart local v25       #taskTop:Lcom/android/server/am/HistoryRecord;
    :cond_13
    const/4 v5, 0x0

    move/from16 v16, v5

    goto :goto_5

    .line 3439
    :cond_14
    const/high16 v5, 0x400

    and-int v5, v5, v21

    if-nez v5, :cond_15

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-eq v5, v6, :cond_15

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_1a

    .line 3446
    :cond_15
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move/from16 v3, v21

    move v4, v6

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->performClearTaskLocked(ILcom/android/server/am/HistoryRecord;IZ)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3448
    .local v26, top:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_19

    .line 3449
    move-object/from16 v0, v26

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    move v5, v0

    if-eqz v5, :cond_16

    .line 3454
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3456
    :cond_16
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3457
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3508
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_17
    :goto_7
    if-nez v15, :cond_1f

    .line 3512
    if-eqz p6, :cond_18

    .line 3513
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3515
    :cond_18
    const/4 v5, 0x2

    goto/16 :goto_6

    .line 3463
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    :cond_19
    const/4 v15, 0x1

    .line 3467
    move-object/from16 p2, v25

    goto :goto_7

    .line 3469
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_1a
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget-object v6, v6, Lcom/android/server/am/TaskRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_1d

    .line 3476
    const/high16 v5, 0x2000

    and-int v5, v5, v21

    if-eqz v5, :cond_1c

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v6, v0

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_1c

    .line 3478
    const/16 v5, 0x7533

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3479
    move-object/from16 v0, v25

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    move v5, v0

    if-eqz v5, :cond_1b

    .line 3480
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3482
    :cond_1b
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    goto :goto_7

    .line 3483
    :cond_1c
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget-object v6, v6, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5, v6}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-nez v5, :cond_17

    .line 3487
    const/4 v15, 0x1

    .line 3488
    move-object/from16 p2, v25

    goto/16 :goto_7

    .line 3490
    :cond_1d
    const/high16 v5, 0x20

    and-int v5, v5, v21

    if-nez v5, :cond_1e

    .line 3496
    const/4 v15, 0x1

    .line 3497
    move-object/from16 p2, v25

    goto/16 :goto_7

    .line 3498
    :cond_1e
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget-boolean v5, v5, Lcom/android/server/am/TaskRecord;->rootWasReset:Z

    if-nez v5, :cond_17

    .line 3506
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    goto/16 :goto_7

    .line 3527
    .end local v18           #curTop:Lcom/android/server/am/HistoryRecord;
    .end local v25           #taskTop:Lcom/android/server/am/HistoryRecord;
    :cond_1f
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_23

    .line 3531
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3532
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_25

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_25

    .line 3533
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v6, v0

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_25

    .line 3534
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_25

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_25

    .line 3535
    const/high16 v5, 0x2000

    and-int v5, v5, v21

    if-nez v5, :cond_20

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x1

    if-eq v5, v6, :cond_20

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-ne v5, v6, :cond_25

    .line 3538
    :cond_20
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, v26

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3541
    if-eqz p6, :cond_21

    .line 3542
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3544
    :cond_21
    if-eqz p5, :cond_22

    .line 3548
    const/4 v5, 0x1

    goto/16 :goto_6

    .line 3550
    :cond_22
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3551
    const/4 v5, 0x3

    goto/16 :goto_6

    .line 3558
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_23
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_24

    .line 3559
    const/4 v8, -0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v9, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v11, v0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object/from16 v7, p0

    invoke-virtual/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3563
    :cond_24
    const/4 v5, -0x2

    goto/16 :goto_6

    .line 3566
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    :cond_25
    const/16 v22, 0x0

    .line 3569
    .local v22, newTask:Z
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_29

    if-nez v15, :cond_29

    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_29

    .line 3572
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    add-int/lit8 v5, v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 3573
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    if-gtz v5, :cond_26

    .line 3574
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 3576
    :cond_26
    new-instance v5, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_28

    const/4 v8, 0x1

    :goto_8
    move-object v0, v5

    move v1, v6

    move-object v2, v7

    move-object/from16 v3, v20

    move v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 3580
    const/16 v22, 0x1

    .line 3581
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V

    .line 3638
    .end local p3
    :goto_9
    if-eqz v22, :cond_27

    .line 3639
    const/16 v5, 0x7534

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v5, v6}, Landroid/util/EventLog;->writeEvent(II)I

    .line 3641
    :cond_27
    const/16 v5, 0x7535

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3642
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, v22

    move/from16 v3, p6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 3643
    const/4 v5, 0x0

    goto/16 :goto_6

    .line 3576
    .restart local p3
    :cond_28
    const/4 v8, 0x0

    goto :goto_8

    .line 3583
    :cond_29
    if-eqz p2, :cond_2e

    .line 3584
    if-nez v15, :cond_2b

    const/high16 v5, 0x400

    and-int v5, v5, v21

    if-eqz v5, :cond_2b

    .line 3589
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move/from16 v3, v21

    move v4, v6

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->performClearTaskLocked(ILcom/android/server/am/HistoryRecord;IZ)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3591
    if-eqz v26, :cond_2d

    .line 3592
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3593
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3596
    if-eqz p6, :cond_2a

    .line 3597
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3599
    :cond_2a
    const/4 v5, 0x3

    goto/16 :goto_6

    .line 3601
    :cond_2b
    if-nez v15, :cond_2d

    const/high16 v5, 0x2

    and-int v5, v5, v21

    if-eqz v5, :cond_2d

    .line 3606
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findActivityInHistoryLocked(Lcom/android/server/am/HistoryRecord;I)I

    move-result v27

    .line 3607
    .local v27, where:I
    if-ltz v27, :cond_2d

    .line 3608
    move-object/from16 v0, p0

    move/from16 v1, v27

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->moveActivityToFrontLocked(I)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3609
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3610
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3611
    if-eqz p6, :cond_2c

    .line 3612
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3614
    :cond_2c
    const/4 v5, 0x3

    goto/16 :goto_6

    .line 3620
    .end local v27           #where:I
    :cond_2d
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    goto/16 :goto_9

    .line 3628
    :cond_2e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 3629
    .local v14, N:I
    if-lez v14, :cond_2f

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x1

    sub-int v6, v14, v6

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    .end local p3
    check-cast p3, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v24, p3

    .line 3631
    .local v24, prev:Lcom/android/server/am/HistoryRecord;
    :goto_a
    if-eqz v24, :cond_30

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    :goto_b
    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    goto/16 :goto_9

    .line 3629
    .end local v24           #prev:Lcom/android/server/am/HistoryRecord;
    .restart local p3
    :cond_2f
    const/4 v5, 0x0

    move-object/from16 v24, v5

    goto :goto_a

    .line 3631
    .end local p3
    .restart local v24       #prev:Lcom/android/server/am/HistoryRecord;
    :cond_30
    new-instance v5, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_31

    const/4 v8, 0x1

    :goto_c
    move-object v0, v5

    move v1, v6

    move-object v2, v7

    move-object/from16 v3, v20

    move v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    goto :goto_b

    :cond_31
    const/4 v8, 0x0

    goto :goto_c
.end method

.method private startHomeActivityLocked()Z
    .locals 15

    .prologue
    .line 2481
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    const/4 v1, 0x1

    if-ne v0, v1, :cond_0

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    if-nez v0, :cond_0

    .line 2486
    const/4 v0, 0x0

    .line 2513
    :goto_0
    return v0

    .line 2488
    :cond_0
    new-instance v2, Landroid/content/Intent;

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    if-eqz v1, :cond_4

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    invoke-static {v1}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v1

    :goto_1
    invoke-direct {v2, v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 2491
    .local v2, intent:Landroid/content/Intent;
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2492
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    const/4 v1, 0x1

    if-eq v0, v1, :cond_1

    .line 2493
    const-string v0, "android.intent.category.HOME"

    invoke-virtual {v2, v0}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 2495
    :cond_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v0

    const/16 v1, 0x400

    invoke-virtual {v2, v0, v1}, Landroid/content/Intent;->resolveActivityInfo(Landroid/content/pm/PackageManager;I)Landroid/content/pm/ActivityInfo;

    move-result-object v6

    .line 2498
    .local v6, aInfo:Landroid/content/pm/ActivityInfo;
    if-eqz v6, :cond_3

    .line 2499
    new-instance v0, Landroid/content/ComponentName;

    iget-object v1, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v3, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v0, v1, v3}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2503
    iget-object v0, v6, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    iget-object v1, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v14

    .line 2505
    .local v14, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v14, :cond_2

    iget-object v0, v14, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-nez v0, :cond_3

    .line 2506
    :cond_2
    invoke-virtual {v2}, Landroid/content/Intent;->getFlags()I

    move-result v0

    const/high16 v1, 0x1000

    or-int/2addr v0, v1

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 2507
    const/4 v1, 0x0

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object v0, p0

    invoke-direct/range {v0 .. v13}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    .line 2513
    .end local v14           #app:Lcom/android/server/am/ProcessRecord;
    :cond_3
    const/4 v0, 0x1

    goto :goto_0

    .line 2488
    .end local v2           #intent:Landroid/content/Intent;
    .end local v6           #aInfo:Landroid/content/pm/ActivityInfo;
    :cond_4
    const/4 v1, 0x0

    goto :goto_1
.end method

.method private final startPausingLocked(ZZ)V
    .locals 10
    .parameter "userLeaving"
    .parameter "uiSleeping"

    .prologue
    const/16 v9, 0x10

    const/4 v7, 0x0

    const-string v8, "ActivityManager"

    .line 2115
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v3, :cond_0

    .line 2116
    new-instance v0, Ljava/lang/RuntimeException;

    invoke-direct {v0}, Ljava/lang/RuntimeException;-><init>()V

    .line 2117
    .local v0, e:Ljava/lang/RuntimeException;
    const-string v3, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Trying to pause when pause is already pending for "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v8, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2120
    .end local v0           #e:Ljava/lang/RuntimeException;
    :cond_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2121
    .local v2, prev:Lcom/android/server/am/HistoryRecord;
    if-nez v2, :cond_1

    .line 2122
    new-instance v0, Ljava/lang/RuntimeException;

    invoke-direct {v0}, Ljava/lang/RuntimeException;-><init>()V

    .line 2123
    .restart local v0       #e:Ljava/lang/RuntimeException;
    const-string v3, "ActivityManager"

    const-string v3, "Trying to pause when nothing is resumed"

    invoke-static {v8, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2124
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2192
    .end local v0           #e:Ljava/lang/RuntimeException;
    :goto_0
    return-void

    .line 2128
    :cond_1
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2129
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2130
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2131
    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v3, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2132
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v3}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 2134
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2136
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_4

    .line 2139
    const/16 v3, 0x753d

    const/4 v4, 0x2

    :try_start_0
    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v6

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x1

    iget-object v6, v2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v6, v4, v5

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2142
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v4, v2, Lcom/android/server/am/HistoryRecord;->finishing:Z

    iget v5, v2, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v3, v2, v4, p1, v5}, Landroid/app/IApplicationThread;->schedulePauseActivity(Landroid/os/IBinder;ZZI)V

    .line 2144
    const/4 v3, 0x0

    invoke-direct {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 2158
    :goto_1
    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v3, :cond_2

    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-nez v3, :cond_2

    .line 2159
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v3}, Landroid/os/PowerManager$WakeLock;->acquire()V

    .line 2160
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v3, v9}, Landroid/os/Handler;->hasMessages(I)Z

    move-result v3

    if-nez v3, :cond_2

    .line 2162
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v3, v9}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 2163
    .local v1, msg:Landroid/os/Message;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x2710

    invoke-virtual {v3, v1, v4, v5}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2168
    .end local v1           #msg:Landroid/os/Message;
    :cond_2
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v3, :cond_5

    .line 2173
    if-nez p2, :cond_3

    .line 2174
    invoke-virtual {v2}, Lcom/android/server/am/HistoryRecord;->pauseKeyDispatchingLocked()V

    .line 2182
    :cond_3
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 2183
    .restart local v1       #msg:Landroid/os/Message;
    iput-object v2, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2184
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x1f4

    invoke-virtual {v3, v1, v4, v5}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    goto :goto_0

    .line 2145
    .end local v1           #msg:Landroid/os/Message;
    :catch_0
    move-exception v3

    move-object v0, v3

    .line 2147
    .local v0, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    const-string v3, "Exception thrown during pause"

    invoke-static {v8, v3, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2148
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2149
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    goto :goto_1

    .line 2152
    .end local v0           #e:Ljava/lang/Exception;
    :cond_4
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2153
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    goto :goto_1

    .line 2190
    :cond_5
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    goto/16 :goto_0
.end method

.method private final startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;
    .locals 8
    .parameter "processName"
    .parameter "info"
    .parameter "knownToBeDead"
    .parameter "intentFlags"
    .parameter "hostingType"
    .parameter "hostingName"
    .parameter "allowWhileBooting"

    .prologue
    const/4 v7, 0x1

    const/4 v6, 0x0

    const/4 v5, 0x0

    .line 1916
    iget v2, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1927
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v0, :cond_2

    iget v2, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v2, :cond_2

    .line 1928
    if-eqz p3, :cond_0

    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v2, :cond_1

    :cond_0
    move-object v2, v0

    .line 1984
    :goto_0
    return-object v2

    .line 1935
    :cond_1
    invoke-direct {p0, v0, v7}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 1939
    :cond_2
    if-eqz p6, :cond_3

    invoke-virtual {p6}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    move-object v1, v2

    .line 1942
    .local v1, hostingNameStr:Ljava/lang/String;
    :goto_1
    and-int/lit8 v2, p4, 0x4

    if-eqz v2, :cond_4

    .line 1945
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v2

    if-eqz v2, :cond_5

    move-object v2, v5

    .line 1946
    goto :goto_0

    .end local v1           #hostingNameStr:Ljava/lang/String;
    :cond_3
    move-object v1, v5

    .line 1939
    goto :goto_1

    .line 1953
    .restart local v1       #hostingNameStr:Ljava/lang/String;
    :cond_4
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 1954
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v2

    if-eqz v2, :cond_5

    .line 1955
    const/16 v2, 0x7540

    const/4 v3, 0x2

    new-array v3, v3, [Ljava/lang/Object;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v6

    iget-object v4, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v4, v3, v7

    invoke-static {v2, v3}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1957
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 1958
    if-eqz v0, :cond_5

    .line 1959
    iput-boolean v6, v0, Lcom/android/server/am/ProcessRecord;->bad:Z

    .line 1964
    :cond_5
    if-nez v0, :cond_7

    .line 1965
    invoke-virtual {p0, v5, p2, p1}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1966
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget v3, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, p1, v3, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 1974
    :goto_2
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    if-nez v2, :cond_8

    invoke-virtual {p0, p2}, Lcom/android/server/am/ActivityManagerService;->isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z

    move-result v2

    if-nez v2, :cond_8

    if-nez p7, :cond_8

    .line 1977
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_6

    .line 1978
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_6
    move-object v2, v0

    .line 1980
    goto :goto_0

    .line 1969
    :cond_7
    iget-object v2, p2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v2}, Lcom/android/server/am/ProcessRecord;->addPackage(Ljava/lang/String;)Z

    goto :goto_2

    .line 1983
    :cond_8
    invoke-direct {p0, v0, p5, v1}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 1984
    iget v2, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v2, :cond_9

    move-object v2, v0

    goto/16 :goto_0

    :cond_9
    move-object v2, v5

    goto/16 :goto_0
.end method

.method private final startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V
    .locals 17
    .parameter "app"
    .parameter "hostingType"
    .parameter "hostingNameStr"

    .prologue
    .line 1993
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    if-lez v4, :cond_0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_0

    .line 1994
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    monitor-enter v4

    .line 1995
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v6, v0

    invoke-virtual {v5, v6}, Landroid/util/SparseArray;->remove(I)V

    .line 1996
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x14

    move-object v0, v5

    move v1, v6

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 1997
    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 1998
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2001
    :cond_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2003
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2005
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v4, v0

    const/4 v5, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v6, v0

    const/4 v7, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v8, v0

    array-length v8, v8

    const/4 v9, 0x1

    sub-int/2addr v8, v9

    invoke-static {v4, v5, v6, v7, v8}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    .line 2006
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v4, v0

    const/4 v5, 0x0

    const/4 v6, 0x0

    aput v6, v4, v5

    .line 2009
    :try_start_1
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v6, v4, Landroid/content/pm/ApplicationInfo;->uid:I
    :try_end_1
    .catch Ljava/lang/RuntimeException; {:try_start_1 .. :try_end_1} :catch_1

    .line 2010
    .local v6, uid:I
    const/4 v8, 0x0

    .line 2012
    .local v8, gids:[I
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Landroid/content/pm/PackageManager;->getPackageGids(Ljava/lang/String;)[I
    :try_end_2
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_2 .. :try_end_2} :catch_0
    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_1

    move-result-object v8

    .line 2017
    :goto_0
    :try_start_3
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    if-eqz v4, :cond_2

    .line 2018
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x1

    if-ne v4, v5, :cond_1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    move-object v4, v0

    if-eqz v4, :cond_1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_1

    .line 2021
    const/4 v6, 0x0

    .line 2023
    :cond_1
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x2

    if-ne v4, v5, :cond_2

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x10

    if-eqz v4, :cond_2

    .line 2025
    const/4 v6, 0x0

    .line 2028
    :cond_2
    const/4 v9, 0x0

    .line 2029
    .local v9, debugFlags:I
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x2

    if-eqz v4, :cond_3

    .line 2030
    or-int/lit8 v9, v9, 0x1

    .line 2034
    :cond_3
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit16 v4, v4, 0x4000

    if-nez v4, :cond_4

    sget-boolean v4, Ldalvik/system/Zygote;->systemInSafeMode:Z

    const/4 v5, 0x1

    if-ne v4, v5, :cond_5

    .line 2036
    :cond_4
    or-int/lit8 v9, v9, 0x8

    .line 2038
    :cond_5
    const-string v4, "1"

    const-string v5, "debug.checkjni"

    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_6

    .line 2039
    or-int/lit8 v9, v9, 0x2

    .line 2041
    :cond_6
    const-string v4, "1"

    const-string v5, "debug.assert"

    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_7

    .line 2042
    or-int/lit8 v9, v9, 0x4

    .line 2044
    :cond_7
    const-string v4, "android.app.ActivityThread"

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    move v5, v0

    if-eqz v5, :cond_c

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    :goto_1
    const/4 v10, 0x0

    move v7, v6

    invoke-static/range {v4 .. v10}, Landroid/os/Process;->start(Ljava/lang/String;Ljava/lang/String;II[II[Ljava/lang/String;)I

    move-result v16

    .line 2047
    .local v16, pid:I
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v11

    .line 2048
    .local v11, bs:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v11
    :try_end_3
    .catch Ljava/lang/RuntimeException; {:try_start_3 .. :try_end_3} :catch_1

    .line 2049
    :try_start_4
    invoke-virtual {v11}, Lcom/android/internal/os/BatteryStatsImpl;->isOnBattery()Z

    move-result v4

    if-eqz v4, :cond_8

    .line 2050
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->incStartsLocked()V

    .line 2052
    :cond_8
    monitor-exit v11
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 2054
    const/16 v4, 0x753e

    const/4 v5, 0x5

    :try_start_5
    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {v16 .. v16}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    .end local v9           #debugFlags:I
    aput-object v9, v5, v7

    const/4 v7, 0x1

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v5, v7

    const/4 v7, 0x2

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v9, v0

    aput-object v9, v5, v7

    const/4 v7, 0x3

    aput-object p2, v5, v7

    const/4 v7, 0x4

    if-eqz p3, :cond_d

    move-object/from16 v9, p3

    :goto_2
    aput-object v9, v5, v7

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2058
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v4, v0

    if-eqz v4, :cond_9

    .line 2059
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object v0, v4

    move-object/from16 v1, p1

    move-object v2, v5

    move/from16 v3, v16

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/Watchdog;->processStarted(Lcom/android/server/Watchdog$PssRequestor;Ljava/lang/String;I)V

    .line 2062
    :cond_9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    move-object v12, v0

    .line 2063
    .local v12, buf:Ljava/lang/StringBuilder;
    const/4 v4, 0x0

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 2064
    const-string v4, "Start proc "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2065
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2066
    const-string v4, " for "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2067
    move-object v0, v12

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2068
    if-eqz p3, :cond_a

    .line 2069
    const-string v4, " "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2070
    move-object v0, v12

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2072
    :cond_a
    const-string v4, ": pid="

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2073
    move-object v0, v12

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 2074
    const-string v4, " uid="

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2075
    invoke-virtual {v12, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 2076
    const-string v4, " gids={"

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2077
    if-eqz v8, :cond_e

    .line 2078
    const/4 v14, 0x0

    .local v14, gi:I
    :goto_3
    array-length v4, v8

    if-ge v14, v4, :cond_e

    .line 2079
    if-eqz v14, :cond_b

    const-string v4, ", "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2080
    :cond_b
    aget v4, v8, v14

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
    :try_end_5
    .catch Ljava/lang/RuntimeException; {:try_start_5 .. :try_end_5} :catch_1

    .line 2078
    add-int/lit8 v14, v14, 0x1

    goto :goto_3

    .line 1997
    .end local v6           #uid:I
    .end local v8           #gids:[I
    .end local v11           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v12           #buf:Ljava/lang/StringBuilder;
    .end local v14           #gi:I
    .end local v16           #pid:I
    :catchall_0
    move-exception v5

    :try_start_6
    monitor-exit v4
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    throw v5

    .line 2014
    .restart local v6       #uid:I
    .restart local v8       #gids:[I
    :catch_0
    move-exception v4

    move-object v13, v4

    .line 2015
    .local v13, e:Landroid/content/pm/PackageManager$NameNotFoundException;
    :try_start_7
    const-string v4, "ActivityManager"

    const-string v5, "Unable to retrieve gids"

    invoke-static {v4, v5, v13}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_7
    .catch Ljava/lang/RuntimeException; {:try_start_7 .. :try_end_7} :catch_1

    goto/16 :goto_0

    .line 2107
    .end local v6           #uid:I
    .end local v8           #gids:[I
    .end local v13           #e:Landroid/content/pm/PackageManager$NameNotFoundException;
    :catch_1
    move-exception v4

    move-object v13, v4

    .line 2109
    .local v13, e:Ljava/lang/RuntimeException;
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2110
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failure starting process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v13}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2112
    .end local v13           #e:Ljava/lang/RuntimeException;
    :goto_4
    return-void

    .line 2044
    .restart local v6       #uid:I
    .restart local v8       #gids:[I
    .restart local v9       #debugFlags:I
    :cond_c
    const/4 v5, 0x0

    goto/16 :goto_1

    .line 2052
    .restart local v11       #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v16       #pid:I
    :catchall_1
    move-exception v4

    :try_start_8
    monitor-exit v11
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_1

    :try_start_9
    throw v4

    .line 2054
    .end local v9           #debugFlags:I
    :cond_d
    const-string v9, ""

    goto/16 :goto_2

    .line 2084
    .restart local v12       #buf:Ljava/lang/StringBuilder;
    :cond_e
    const-string v4, "}"

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2085
    const-string v4, "ActivityManager"

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2086
    if-eqz v16, :cond_f

    sget v4, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, v16

    move v1, v4

    if-ne v0, v1, :cond_10

    .line 2088
    :cond_f
    sget v4, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2089
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 2090
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_4

    .line 2091
    :cond_10
    if-lez v16, :cond_11

    .line 2092
    move/from16 v0, v16

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2093
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 2094
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    monitor-enter v4
    :try_end_9
    .catch Ljava/lang/RuntimeException; {:try_start_9 .. :try_end_9} :catch_1

    .line 2095
    :try_start_a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v16

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 2096
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x14

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    .end local v6           #uid:I
    move-result-object v15

    .line 2097
    .local v15, msg:Landroid/os/Message;
    move-object/from16 v0, p1

    move-object v1, v15

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2098
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const-wide/16 v6, 0x2710

    invoke-virtual {v5, v15, v6, v7}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2099
    monitor-exit v4

    goto :goto_4

    .end local v15           #msg:Landroid/os/Message;
    :catchall_2
    move-exception v5

    monitor-exit v4
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_2

    :try_start_b
    throw v5

    .line 2101
    .restart local v6       #uid:I
    :cond_11
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2102
    new-instance v13, Ljava/lang/RuntimeException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failure starting process "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ": returned pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v13, v4}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    .line 2105
    .restart local v13       #e:Ljava/lang/RuntimeException;
    const-string v4, "ActivityManager"

    invoke-virtual {v13}, Ljava/lang/RuntimeException;->getMessage()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v13}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_b
    .catch Ljava/lang/RuntimeException; {:try_start_b .. :try_end_b} :catch_1

    goto/16 :goto_4
.end method

.method private startSetupActivityLocked()V
    .locals 23

    .prologue
    .line 2521
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mCheckedForSetup:Z

    move v3, v0

    if-eqz v3, :cond_1

    .line 2568
    :cond_0
    :goto_0
    return-void

    .line 2528
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v19

    .line 2529
    .local v19, resolver:Landroid/content/ContentResolver;
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v3, v0

    const/4 v4, 0x1

    if-eq v3, v4, :cond_0

    const-string v3, "device_provisioned"

    const/4 v4, 0x0

    move-object/from16 v0, v19

    move-object v1, v3

    move v2, v4

    invoke-static {v0, v1, v2}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v3

    if-eqz v3, :cond_0

    .line 2532
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mCheckedForSetup:Z

    .line 2535
    new-instance v5, Landroid/content/Intent;

    const-string v3, "android.intent.action.UPGRADE_SETUP"

    invoke-direct {v5, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 2536
    .local v5, intent:Landroid/content/Intent;
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v3, v3, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v3

    const/16 v4, 0x80

    invoke-virtual {v3, v5, v4}, Landroid/content/pm/PackageManager;->queryIntentActivities(Landroid/content/Intent;I)Ljava/util/List;

    move-result-object v21

    .line 2540
    .local v21, ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/16 v20, 0x0

    .line 2541
    .local v20, ri:Landroid/content/pm/ResolveInfo;
    const/16 v17, 0x0

    .local v17, i:I
    :goto_1
    if-eqz v21, :cond_2

    invoke-interface/range {v21 .. v21}, Ljava/util/List;->size()I

    move-result v3

    move/from16 v0, v17

    move v1, v3

    if-ge v0, v1, :cond_2

    .line 2542
    move-object/from16 v0, v21

    move/from16 v1, v17

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    iget-object v3, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v3, v3, 0x1

    if-eqz v3, :cond_4

    .line 2544
    move-object/from16 v0, v21

    move/from16 v1, v17

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v20

    .end local v20           #ri:Landroid/content/pm/ResolveInfo;
    check-cast v20, Landroid/content/pm/ResolveInfo;

    .line 2549
    .restart local v20       #ri:Landroid/content/pm/ResolveInfo;
    :cond_2
    if-eqz v20, :cond_0

    .line 2550
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    if-eqz v3, :cond_5

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    const-string v4, "android.SETUP_VERSION"

    invoke-virtual {v3, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v22, v3

    .line 2553
    .local v22, vers:Ljava/lang/String;
    :goto_2
    if-nez v22, :cond_3

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->metaData:Landroid/os/Bundle;

    if-eqz v3, :cond_3

    .line 2554
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->metaData:Landroid/os/Bundle;

    const-string v4, "android.SETUP_VERSION"

    invoke-virtual {v3, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v22

    .line 2557
    :cond_3
    const-string v3, "last_setup_shown"

    move-object/from16 v0, v19

    move-object v1, v3

    invoke-static {v0, v1}, Landroid/provider/Settings$Secure;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v18

    .line 2559
    .local v18, lastVers:Ljava/lang/String;
    if-eqz v22, :cond_0

    move-object/from16 v0, v22

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_0

    .line 2560
    const/high16 v3, 0x1000

    invoke-virtual {v5, v3}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 2561
    new-instance v3, Landroid/content/ComponentName;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v3, v4, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v5, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2563
    const/4 v4, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v9, v0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    goto/16 :goto_0

    .line 2541
    .end local v18           #lastVers:Ljava/lang/String;
    .end local v22           #vers:Ljava/lang/String;
    :cond_4
    add-int/lit8 v17, v17, 0x1

    goto/16 :goto_1

    .line 2550
    :cond_5
    const/4 v3, 0x0

    move-object/from16 v22, v3

    goto :goto_2
.end method

.method private final startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V
    .locals 10
    .parameter "r"
    .parameter "andResume"
    .parameter "checkConfig"

    .prologue
    const/4 v4, 0x0

    const-wide/16 v2, 0x0

    .line 1884
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 1887
    .local v8, app:Lcom/android/server/am/ProcessRecord;
    iget-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_1

    .line 1888
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    .line 1889
    iget-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_0

    .line 1890
    iget-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    .line 1896
    :cond_0
    :goto_0
    if-eqz v8, :cond_2

    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_2

    .line 1898
    :try_start_0
    invoke-direct {p0, p1, v8, p2, p3}, Lcom/android/server/am/ActivityManagerService;->realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1911
    :goto_1
    return-void

    .line 1892
    :cond_1
    iget-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_0

    .line 1893
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    goto :goto_0

    .line 1900
    :catch_0
    move-exception v9

    .line 1901
    .local v9, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception when starting activity "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1909
    .end local v9           #e:Landroid/os/RemoteException;
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v2, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v3, 0x1

    const-string v5, "activity"

    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v6

    move-object v0, p0

    move v7, v4

    invoke-direct/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    goto :goto_1
.end method

.method private final stopActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "r"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 4047
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getFlags()I

    move-result v1

    const/high16 v2, 0x4000

    and-int/2addr v1, v2

    if-nez v1, :cond_0

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v1, v1, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit16 v1, v1, 0x80

    if-eqz v1, :cond_2

    .line 4049
    :cond_0
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v1, :cond_1

    .line 4050
    const-string v1, "no-history"

    invoke-direct {p0, p1, v3, v5, v1}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 4080
    :cond_1
    :goto_0
    return-void

    .line 4053
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_1

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v1, :cond_1

    .line 4054
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_3

    .line 4055
    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4057
    :cond_3
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 4059
    const/4 v1, 0x0

    :try_start_0
    iput-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 4060
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4063
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v1, :cond_4

    .line 4064
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v2, 0x0

    invoke-virtual {v1, p1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 4066
    :cond_4
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v2, p1, Lcom/android/server/am/HistoryRecord;->visible:Z

    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v1, p1, v2, v3}, Landroid/app/IApplicationThread;->scheduleStopActivity(Landroid/os/IBinder;ZI)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 4067
    :catch_0
    move-exception v1

    move-object v0, v1

    .line 4071
    .local v0, e:Ljava/lang/Exception;
    const-string v1, "ActivityManager"

    const-string v2, "Exception thrown during pause"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 4073
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 4074
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4075
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v1, :cond_1

    .line 4076
    invoke-direct {p0, p1, v4}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    goto :goto_0
.end method

.method private final topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "token"
    .parameter "taskId"

    .prologue
    .line 1727
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1728
    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 1729
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1731
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_0

    if-eq p1, v1, :cond_0

    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq p2, v2, :cond_0

    move-object v2, v1

    .line 1736
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v2

    .line 1734
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    .line 1735
    goto :goto_0

    .line 1736
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, 0x0

    goto :goto_1
.end method

.method private final topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "notTop"

    .prologue
    .line 1694
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1695
    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 1696
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1697
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_0

    if-eq v1, p1, :cond_0

    move-object v2, v1

    .line 1702
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v2

    .line 1700
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    .line 1701
    goto :goto_0

    .line 1702
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, 0x0

    goto :goto_1
.end method

.method private final topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "notTop"

    .prologue
    .line 1706
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1707
    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 1708
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1709
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_0

    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    if-nez v2, :cond_0

    if-eq v1, p1, :cond_0

    move-object v2, v1

    .line 1714
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v2

    .line 1712
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    .line 1713
    goto :goto_0

    .line 1714
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, 0x0

    goto :goto_1
.end method

.method private final trimApplications()V
    .locals 13

    .prologue
    .line 14416
    monitor-enter p0

    .line 14421
    :try_start_0
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x1

    sub-int v5, v10, v11

    .local v5, i:I
    :goto_0
    if-ltz v5, :cond_3

    .line 14422
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14423
    .local v1, app:Lcom/android/server/am/ProcessRecord;
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-nez v10, :cond_0

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_0

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_0

    .line 14425
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting empty application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_1

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_1
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14430
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_2

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_2

    .line 14431
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 14439
    :goto_2
    const/4 v10, 0x0

    const/4 v11, -0x1

    invoke-direct {p0, v1, v10, v11}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V

    .line 14440
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 14442
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v10, :cond_0

    .line 14443
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v10, :cond_0

    .line 14444
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {p0, v10}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 14421
    :cond_0
    add-int/lit8 v5, v5, -0x1

    goto :goto_0

    .line 14425
    :cond_1
    const/4 v12, 0x0

    goto :goto_1

    .line 14434
    :cond_2
    :try_start_1
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_2

    .line 14435
    :catch_0
    move-exception v10

    goto :goto_2

    .line 14454
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_3
    :try_start_2
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    move-result v10

    if-nez v10, :cond_16

    .line 14457
    const/4 v7, 0x0

    .line 14458
    .local v7, numServiceProcs:I
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x1

    sub-int v5, v10, v11

    :goto_3
    if-ltz v5, :cond_6

    .line 14459
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14461
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_4

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_4

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_4

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-lez v10, :cond_5

    .line 14469
    :cond_4
    add-int/lit8 v7, v7, 0x1

    .line 14458
    :cond_5
    add-int/lit8 v5, v5, -0x1

    goto :goto_3

    .line 14473
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_6
    iget v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 14474
    .local v4, curMaxProcs:I
    if-gtz v4, :cond_7

    const/4 v4, 0x2

    .line 14475
    :cond_7
    iget-boolean v10, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    if-eqz v10, :cond_8

    .line 14476
    const/4 v4, 0x1

    .line 14478
    :cond_8
    add-int/2addr v4, v7

    .line 14483
    const/4 v5, 0x0

    .line 14485
    :goto_4
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_c

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v4, :cond_c

    .line 14487
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14490
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_9

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-nez v10, :cond_9

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_9

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_9

    .line 14492
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting empty application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_a

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_5
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14497
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_b

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_b

    .line 14498
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 14510
    :goto_6
    const/4 v10, 0x0

    invoke-direct {p0, v1, v10, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 14511
    add-int/lit8 v5, v5, -0x1

    .line 14486
    :cond_9
    add-int/lit8 v5, v5, 0x1

    goto :goto_4

    .line 14492
    :cond_a
    const/4 v12, 0x0

    goto :goto_5

    .line 14501
    :cond_b
    :try_start_3
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_1

    goto :goto_6

    .line 14502
    :catch_1
    move-exception v10

    goto :goto_6

    .line 14520
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_c
    const/4 v5, 0x0

    .line 14522
    :goto_7
    :try_start_4
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_16

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v4, :cond_16

    .line 14524
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14527
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_e

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_e

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_e

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-nez v10, :cond_e

    const/4 v10, 0x1

    move v2, v10

    .line 14530
    .local v2, canQuit:Z
    :goto_8
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 14534
    .local v0, NUMA:I
    const/4 v6, 0x0

    .local v6, j:I
    :goto_9
    if-ge v6, v0, :cond_10

    if-eqz v2, :cond_10

    .line 14535
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 14539
    .local v9, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v10, :cond_d

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-nez v10, :cond_f

    :cond_d
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v10, :cond_f

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stopped:Z

    if-eqz v10, :cond_f

    const/4 v10, 0x1

    move v2, v10

    .line 14534
    :goto_a
    add-int/lit8 v6, v6, 0x1

    goto :goto_9

    .line 14527
    .end local v0           #NUMA:I
    .end local v2           #canQuit:Z
    .end local v6           #j:I
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_e
    const/4 v10, 0x0

    move v2, v10

    goto :goto_8

    .line 14539
    .restart local v0       #NUMA:I
    .restart local v2       #canQuit:Z
    .restart local v6       #j:I
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    :cond_f
    const/4 v10, 0x0

    move v2, v10

    goto :goto_a

    .line 14542
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_10
    if-eqz v2, :cond_13

    .line 14544
    const/4 v6, 0x0

    :goto_b
    if-ge v6, v0, :cond_12

    .line 14545
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 14546
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v10, :cond_11

    .line 14547
    const/4 v10, 0x0

    invoke-direct {p0, v9, v10}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 14549
    :cond_11
    const/4 v10, 0x0

    iput-object v10, v9, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 14544
    add-int/lit8 v6, v6, 0x1

    goto :goto_b

    .line 14551
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_12
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_14

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_c
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14555
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_15

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_15

    .line 14556
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 14568
    :goto_d
    const/4 v10, 0x0

    invoke-direct {p0, v1, v10, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 14569
    add-int/lit8 v5, v5, -0x1

    .line 14523
    :cond_13
    add-int/lit8 v5, v5, 0x1

    goto/16 :goto_7

    .line 14551
    :cond_14
    const/4 v12, 0x0

    goto :goto_c

    .line 14559
    :cond_15
    :try_start_5
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_2

    goto :goto_d

    .line 14560
    :catch_2
    move-exception v10

    goto :goto_d

    .line 14576
    .end local v0           #NUMA:I
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #canQuit:Z
    .end local v4           #curMaxProcs:I
    .end local v6           #j:I
    .end local v7           #numServiceProcs:I
    :cond_16
    const/16 v3, 0x14

    .line 14577
    .local v3, curMaxActivities:I
    :try_start_6
    iget-boolean v10, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    if-eqz v10, :cond_17

    .line 14578
    const/4 v3, 0x1

    .line 14583
    :cond_17
    const/4 v5, 0x0

    .line 14585
    :goto_e
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_1a

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v3, :cond_1a

    .line 14587
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 14592
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v10, :cond_18

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-nez v10, :cond_19

    :cond_18
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v10, :cond_19

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stopped:Z

    if-eqz v10, :cond_19

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v10, :cond_19

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v10, :cond_19

    .line 14594
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v8

    .line 14595
    .local v8, origSize:I
    const/4 v10, 0x1

    invoke-direct {p0, v9, v10}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 14602
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v8, v10, :cond_19

    .line 14603
    add-int/lit8 v5, v5, -0x1

    .line 14586
    .end local v8           #origSize:I
    :cond_19
    add-int/lit8 v5, v5, 0x1

    goto :goto_e

    .line 14607
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1a
    monitor-exit p0

    .line 14608
    return-void

    .line 14607
    .end local v3           #curMaxActivities:I
    .end local v5           #i:I
    :catchall_0
    move-exception v10

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    throw v10
.end method

.method private final unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z
    .locals 4
    .parameter "r"

    .prologue
    .line 11220
    iget-wide v0, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v2, 0x0

    cmp-long v0, v0, v2

    if-nez v0, :cond_0

    .line 11221
    const/4 v0, 0x0

    .line 11226
    :goto_0
    return v0

    .line 11223
    :cond_0
    invoke-virtual {p1}, Lcom/android/server/am/ServiceRecord;->resetRestartCounter()V

    .line 11224
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 11225
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    .line 11226
    const/4 v0, 0x1

    goto :goto_0
.end method

.method private final updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z
    .locals 2
    .parameter "r"

    .prologue
    .line 1688
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v0

    .line 1689
    .local v0, hadit:Z
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 1690
    return v0
.end method

.method private final updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V
    .locals 11
    .parameter "app"
    .parameter "oomAdj"
    .parameter "updateActivityTime"
    .parameter "bestPos"

    .prologue
    .line 1606
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v4

    .line 1607
    .local v4, lrui:I
    if-ltz v4, :cond_0

    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 1609
    :cond_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v7

    const/4 v8, 0x1

    sub-int v2, v7, v8

    .line 1610
    .local v2, i:I
    const/4 v6, 0x0

    .line 1612
    .local v6, skipTop:I
    iget v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    iput v7, p1, Lcom/android/server/am/ProcessRecord;->lruSeq:I

    .line 1615
    if-eqz p3, :cond_1

    .line 1616
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    .line 1618
    :cond_1
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v7

    if-lez v7, :cond_7

    .line 1621
    iget-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    .line 1637
    :goto_0
    if-ltz v2, :cond_4

    .line 1638
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 1641
    .local v5, p:Lcom/android/server/am/ProcessRecord;
    if-lez v6, :cond_2

    iget v7, v5, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v8, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v7, v8, :cond_2

    .line 1642
    add-int/lit8 v6, v6, -0x1

    .line 1644
    :cond_2
    iget-wide v7, v5, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    iget-wide v9, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    cmp-long v7, v7, v9

    if-lez v7, :cond_3

    if-ge v2, p4, :cond_9

    .line 1645
    :cond_3
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    add-int/lit8 v8, v2, 0x1

    invoke-virtual {v7, v8, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 1650
    .end local v5           #p:Lcom/android/server/am/ProcessRecord;
    :cond_4
    if-gez v2, :cond_5

    .line 1651
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    const/4 v8, 0x0

    invoke-virtual {v7, v8, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 1656
    :cond_5
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->size()I

    move-result v7

    if-lez v7, :cond_a

    .line 1657
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .local v3, i$:Ljava/util/Iterator;
    :cond_6
    :goto_1
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_a

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ConnectionRecord;

    .line 1658
    .local v1, cr:Lcom/android/server/am/ConnectionRecord;
    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    if-eqz v7, :cond_6

    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    if-eqz v7, :cond_6

    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v7, v7, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_6

    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v7, v7, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->lruSeq:I

    iget v8, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    if-eq v7, v8, :cond_6

    .line 1661
    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v7, v7, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    add-int/lit8 v8, v2, 0x1

    invoke-direct {p0, v7, p2, p3, v8}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V

    goto :goto_1

    .line 1622
    .end local v1           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #i$:Ljava/util/Iterator;
    :cond_7
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->size()I

    move-result v7

    if-lez v7, :cond_8

    .line 1625
    iget-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    const-wide/16 v9, 0x3a98

    sub-long/2addr v7, v9

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    .line 1627
    const/4 v6, 0x2

    goto/16 :goto_0

    .line 1632
    :cond_8
    iget-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    const-wide/32 v9, 0x1d4c0

    sub-long/2addr v7, v9

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    .line 1634
    const/4 v6, 0x2

    goto/16 :goto_0

    .line 1648
    .restart local v5       #p:Lcom/android/server/am/ProcessRecord;
    :cond_9
    add-int/lit8 v2, v2, -0x1

    .line 1649
    goto/16 :goto_0

    .line 1666
    .end local v5           #p:Lcom/android/server/am/ProcessRecord;
    :cond_a
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->size()I

    move-result v7

    if-lez v7, :cond_c

    .line 1667
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->keySet()Ljava/util/Set;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .restart local v3       #i$:Ljava/util/Iterator;
    :cond_b
    :goto_2
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_c

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ContentProviderRecord;

    .line 1668
    .local v0, cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v7, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_b

    iget-object v7, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->lruSeq:I

    iget v8, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    if-eq v7, v8, :cond_b

    .line 1669
    iget-object v7, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    add-int/lit8 v8, v2, 0x1

    invoke-direct {p0, v7, p2, p3, v8}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V

    goto :goto_2

    .line 1676
    .end local v0           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i$:Ljava/util/Iterator;
    :cond_c
    if-eqz p2, :cond_d

    .line 1677
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 1679
    :cond_d
    return-void
.end method

.method private final updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V
    .locals 1
    .parameter "app"
    .parameter "oomAdj"
    .parameter "updateActivityTime"

    .prologue
    .line 1683
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    add-int/lit8 v0, v0, 0x1

    iput v0, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    .line 1684
    const/4 v0, 0x0

    invoke-direct {p0, p1, p2, p3, v0}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V

    .line 1685
    return-void
.end method

.method private final updateOomAdjLocked()Z
    .locals 14

    .prologue
    .line 14352
    const/4 v4, 0x1

    .line 14353
    .local v4, didOomAdj:Z
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->resumedAppLocked()Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 14354
    .local v0, TOP_ACT:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_3

    iget-object v10, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v1, v10

    .line 14362
    .local v1, TOP_APP:Lcom/android/server/am/ProcessRecord;
    :goto_0
    iget v10, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    add-int/lit8 v10, v10, 0x1

    iput v10, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 14368
    sget v10, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    sub-int/2addr v10, v11

    add-int/lit8 v8, v10, 0x1

    .line 14369
    .local v8, numSlots:I
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x4

    sub-int/2addr v10, v11

    div-int v5, v10, v8

    .line 14370
    .local v5, factor:I
    const/4 v10, 0x1

    if-ge v5, v10, :cond_0

    const/4 v5, 0x1

    .line 14371
    :cond_0
    const/4 v9, 0x0

    .line 14372
    .local v9, step:I
    const/4 v7, 0x0

    .line 14376
    .local v7, numHidden:I
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 14377
    .local v6, i:I
    sget v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 14378
    .local v3, curHiddenAdj:I
    :cond_1
    :goto_1
    if-lez v6, :cond_5

    .line 14379
    add-int/lit8 v6, v6, -0x1

    .line 14380
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 14382
    .local v2, app:Lcom/android/server/am/ProcessRecord;
    invoke-direct {p0, v2, v3, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z

    move-result v10

    if-eqz v10, :cond_4

    .line 14383
    sget v10, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-ge v3, v10, :cond_2

    iget v10, v2, Lcom/android/server/am/ProcessRecord;->curAdj:I

    if-ne v10, v3, :cond_2

    .line 14385
    add-int/lit8 v9, v9, 0x1

    .line 14386
    if-lt v9, v5, :cond_2

    .line 14387
    const/4 v9, 0x0

    .line 14388
    add-int/lit8 v3, v3, 0x1

    .line 14391
    :cond_2
    iget v10, v2, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v10, v11, :cond_1

    .line 14392
    iget-boolean v10, v2, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    if-nez v10, :cond_1

    .line 14393
    add-int/lit8 v7, v7, 0x1

    .line 14394
    const/16 v10, 0xf

    if-le v7, v10, :cond_1

    .line 14395
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "No longer want "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " (pid "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget v12, v2, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, "): hidden #"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14397
    const/16 v10, 0x7547

    const/4 v11, 0x4

    new-array v11, v11, [Ljava/lang/Object;

    const/4 v12, 0x0

    iget v13, v2, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v13}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v13

    aput-object v13, v11, v12

    const/4 v12, 0x1

    iget-object v13, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v13, v11, v12

    const/4 v12, 0x2

    iget v13, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v13}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v13

    aput-object v13, v11, v12

    const/4 v12, 0x3

    const-string v13, "too many background"

    aput-object v13, v11, v12

    invoke-static {v10, v11}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 14399
    const/4 v10, 0x1

    iput-boolean v10, v2, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    .line 14400
    iget v10, v2, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcessQuiet(I)V

    goto/16 :goto_1

    .line 14354
    .end local v1           #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #curHiddenAdj:I
    .end local v5           #factor:I
    .end local v6           #i:I
    .end local v7           #numHidden:I
    .end local v8           #numSlots:I
    .end local v9           #step:I
    :cond_3
    const/4 v10, 0x0

    move-object v1, v10

    goto/16 :goto_0

    .line 14405
    .restart local v1       #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #curHiddenAdj:I
    .restart local v5       #factor:I
    .restart local v6       #i:I
    .restart local v7       #numHidden:I
    .restart local v8       #numSlots:I
    .restart local v9       #step:I
    :cond_4
    const/4 v4, 0x0

    goto/16 :goto_1

    .line 14412
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    :cond_5
    iget v10, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    if-lez v10, :cond_6

    const/4 v10, 0x0

    :goto_2
    return v10

    :cond_6
    move v10, v4

    goto :goto_2
.end method

.method private final updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z
    .locals 10
    .parameter "app"

    .prologue
    const/4 v9, 0x1

    const/4 v8, 0x0

    .line 14330
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->resumedAppLocked()Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 14331
    .local v0, TOP_ACT:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_1

    iget-object v6, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v1, v6

    .line 14332
    .local v1, TOP_APP:Lcom/android/server/am/ProcessRecord;
    :goto_0
    iget v2, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 14333
    .local v2, curAdj:I
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_2

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    if-gt v6, v7, :cond_2

    move v5, v9

    .line 14336
    .local v5, wasHidden:Z
    :goto_1
    iget v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    add-int/lit8 v6, v6, 0x1

    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 14338
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    invoke-direct {p0, p1, v6, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z

    move-result v4

    .line 14339
    .local v4, res:Z
    if-eqz v4, :cond_0

    .line 14340
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_3

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    if-gt v6, v7, :cond_3

    move v3, v9

    .line 14342
    .local v3, nowHidden:Z
    :goto_2
    if-eq v3, v5, :cond_0

    .line 14345
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 14348
    .end local v3           #nowHidden:Z
    :cond_0
    return v4

    .line 14331
    .end local v1           #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .end local v2           #curAdj:I
    .end local v4           #res:Z
    .end local v5           #wasHidden:Z
    :cond_1
    const/4 v6, 0x0

    move-object v1, v6

    goto :goto_0

    .restart local v1       #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #curAdj:I
    :cond_2
    move v5, v8

    .line 14333
    goto :goto_1

    .restart local v4       #res:Z
    .restart local v5       #wasHidden:Z
    :cond_3
    move v3, v8

    .line 14340
    goto :goto_2
.end method

.method private final updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z
    .locals 8
    .parameter "app"
    .parameter "hiddenAdj"
    .parameter "TOP_APP"

    .prologue
    const/4 v7, 0x1

    const/4 v6, 0x0

    .line 14254
    iput p2, p1, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    .line 14256
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v4, :cond_0

    move v4, v7

    .line 14315
    :goto_0
    return v4

    .line 14260
    :cond_0
    invoke-direct {p0, p1, p2, p3, v6}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I

    move-result v0

    .line 14262
    .local v0, adj:I
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v4, :cond_1

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_2

    :cond_1
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v4

    if-eqz v4, :cond_6

    .line 14263
    :cond_2
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    if-eq v4, v5, :cond_4

    .line 14264
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-le v4, v5, :cond_7

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-gt v4, v5, :cond_7

    .line 14268
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14275
    :cond_3
    :goto_1
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iput v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    .line 14277
    :cond_4
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    if-eq v0, v4, :cond_5

    .line 14278
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4, v0}, Landroid/os/Process;->setOomAdj(II)Z

    move-result v4

    if-eqz v4, :cond_8

    .line 14282
    iput v0, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 14287
    :cond_5
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    if-eq v4, v5, :cond_6

    .line 14288
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    iput v4, p1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    .line 14293
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 14295
    .local v2, oldId:J
    :try_start_0
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    invoke-static {v4, v5}, Landroid/os/Process;->setProcessGroup(II)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 14301
    :goto_2
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local v2           #oldId:J
    :cond_6
    move v4, v7

    .line 14315
    goto :goto_0

    .line 14269
    :cond_7
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v4, v5, :cond_3

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-ge v4, v5, :cond_3

    .line 14273
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    goto :goto_1

    :cond_8
    move v4, v6

    .line 14284
    goto :goto_0

    .line 14296
    .restart local v2       #oldId:J
    :catch_0
    move-exception v4

    move-object v1, v4

    .line 14297
    .local v1, e:Ljava/lang/Exception;
    :try_start_1
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed setting process group of "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " to "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14299
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_2

    .line 14301
    .end local v1           #e:Ljava/lang/Exception;
    :catchall_0
    move-exception v4

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v4
.end method

.method private updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V
    .locals 2
    .parameter "resumedComponent"
    .parameter "resumed"

    .prologue
    .line 2473
    if-eqz p2, :cond_0

    .line 2474
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Lcom/android/server/am/UsageStatsService;->noteResumeComponent(Landroid/content/ComponentName;)V

    .line 2478
    :goto_0
    return-void

    .line 2476
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Lcom/android/server/am/UsageStatsService;->notePauseComponent(Landroid/content/ComponentName;)V

    goto :goto_0
.end method


# virtual methods
.method public final activityDestroyed(Landroid/os/IBinder;)V
    .locals 6
    .parameter "token"

    .prologue
    .line 6017
    monitor-enter p0

    .line 6018
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v5, 0x11

    invoke-virtual {v4, v5, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 6020
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6021
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6022
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 6023
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v4, v5, :cond_0

    .line 6024
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 6025
    .local v1, origId:J
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 6026
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6029
    .end local v1           #origId:J
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    monitor-exit p0

    .line 6030
    return-void

    .line 6029
    .end local v0           #index:I
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method public final activityIdle(Landroid/os/IBinder;Landroid/content/res/Configuration;)V
    .locals 3
    .parameter "token"
    .parameter "config"

    .prologue
    .line 5688
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5689
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, v2, p2}, Lcom/android/server/am/ActivityManagerService;->activityIdleInternal(Landroid/os/IBinder;ZLandroid/content/res/Configuration;)V

    .line 5690
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5691
    return-void
.end method

.method final activityIdleInternal(Landroid/os/IBinder;ZLandroid/content/res/Configuration;)V
    .locals 27
    .parameter "token"
    .parameter "fromTimeout"
    .parameter "config"

    .prologue
    .line 5746
    const/16 v24, 0x0

    .line 5747
    .local v24, stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/16 v19, 0x0

    .line 5748
    .local v19, finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/16 v25, 0x0

    .line 5749
    .local v25, thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/4 v14, 0x0

    .line 5750
    .local v14, NS:I
    const/4 v13, 0x0

    .line 5751
    .local v13, NF:I
    const/4 v15, 0x0

    .line 5752
    .local v15, NT:I
    const/16 v23, 0x0

    .line 5753
    .local v23, sendThumbnail:Landroid/app/IApplicationThread;
    const/16 v16, 0x0

    .line 5754
    .local v16, booting:Z
    const/16 v18, 0x0

    .line 5756
    .local v18, enableScreen:Z
    monitor-enter p0

    .line 5757
    if-eqz p1, :cond_0

    .line 5758
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    const/16 v4, 0xa

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5762
    :cond_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v22

    .line 5763
    .local v22, index:I
    if-ltz v22, :cond_9

    .line 5764
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5766
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    if-eqz p2, :cond_1

    .line 5767
    const-wide/16 v6, -0x1

    const-wide/16 v8, -0x1

    move-object/from16 v3, p0

    move/from16 v4, p2

    invoke-virtual/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->reportActivityLaunchedLocked(ZLcom/android/server/am/HistoryRecord;JJ)V

    .line 5775
    :cond_1
    if-eqz p3, :cond_2

    .line 5776
    move-object/from16 v0, p3

    move-object v1, v5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 5780
    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-ne v3, v5, :cond_3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v3

    if-eqz v3, :cond_3

    .line 5781
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    const/16 v4, 0x10

    invoke-virtual {v3, v4}, Landroid/os/Handler;->removeMessages(I)V

    .line 5782
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 5787
    :cond_3
    const/4 v3, 0x1

    iput-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->idle:Z

    .line 5788
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 5789
    iget-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    if-eqz v3, :cond_4

    iget-object v3, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    iget-object v3, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_4

    .line 5790
    iget-object v3, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v0, v3

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v23, v0

    .line 5791
    const/4 v3, 0x0

    iput-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    .line 5797
    :cond_4
    const/4 v3, 0x0

    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    move v2, v4

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 5800
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    move v3, v0

    if-nez v3, :cond_5

    if-nez p2, :cond_5

    .line 5801
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 5802
    const/16 v18, 0x1

    .line 5810
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_5
    :goto_0
    const/4 v3, 0x1

    move-object/from16 v0, p0

    move v1, v3

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->processStoppingActivitiesLocked(Z)Ljava/util/ArrayList;

    move-result-object v24

    .line 5811
    if-eqz v24, :cond_a

    invoke-virtual/range {v24 .. v24}, Ljava/util/ArrayList;->size()I

    move-result v3

    move v14, v3

    .line 5812
    :goto_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v13

    if-lez v13, :cond_6

    .line 5813
    new-instance v20, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object/from16 v0, v20

    move-object v1, v3

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5814
    .end local v19           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .local v20, finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->clear()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_3

    move-object/from16 v19, v20

    .line 5816
    .end local v20           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v19       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_6
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-lez v15, :cond_7

    .line 5817
    new-instance v26, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v3, v0

    move-object/from16 v0, v26

    move-object v1, v3

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5818
    .end local v25           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .local v26, thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :try_start_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->clear()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_4

    move-object/from16 v25, v26

    .line 5821
    .end local v26           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v25       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_7
    :try_start_4
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    move/from16 v16, v0

    .line 5822
    const/4 v3, 0x0

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 5823
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 5828
    if-eqz v23, :cond_8

    .line 5830
    :try_start_5
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/app/IApplicationThread;->requestThumbnail(Landroid/os/IBinder;)V
    :try_end_5
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_0

    .line 5839
    :cond_8
    :goto_2
    const/16 v21, 0x0

    .local v21, i:I
    :goto_3
    move/from16 v0, v21

    move v1, v14

    if-ge v0, v1, :cond_c

    .line 5840
    move-object/from16 v0, v24

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5841
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5842
    :try_start_6
    iget-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_b

    .line 5843
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;

    .line 5847
    :goto_4
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 5839
    add-int/lit8 v21, v21, 0x1

    goto :goto_3

    .line 5805
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    .end local v21           #i:I
    :cond_9
    if-eqz p2, :cond_5

    .line 5806
    const/4 v8, 0x0

    const-wide/16 v9, -0x1

    const-wide/16 v11, -0x1

    move-object/from16 v6, p0

    move/from16 v7, p2

    :try_start_7
    invoke-virtual/range {v6 .. v12}, Lcom/android/server/am/ActivityManagerService;->reportActivityLaunchedLocked(ZLcom/android/server/am/HistoryRecord;JJ)V

    goto/16 :goto_0

    .line 5823
    .end local v22           #index:I
    :catchall_0
    move-exception v3

    :goto_5
    monitor-exit p0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_0

    throw v3

    .line 5811
    .restart local v22       #index:I
    :cond_a
    const/4 v3, 0x0

    move v14, v3

    goto/16 :goto_1

    .line 5831
    :catch_0
    move-exception v17

    .line 5832
    .local v17, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    const-string v4, "Exception thrown when requesting thumbnail"

    move-object v0, v3

    move-object v1, v4

    move-object/from16 v2, v17

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5833
    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x1

    move-object/from16 v6, p0

    move-object/from16 v8, p1

    invoke-virtual/range {v6 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    goto :goto_2

    .line 5845
    .end local v17           #e:Ljava/lang/Exception;
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #i:I
    :cond_b
    :try_start_8
    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->stopActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    goto :goto_4

    .line 5847
    :catchall_1
    move-exception v3

    monitor-exit p0
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_1

    throw v3

    .line 5852
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_c
    const/16 v21, 0x0

    :goto_6
    move/from16 v0, v21

    move v1, v13

    if-ge v0, v1, :cond_d

    .line 5853
    move-object/from16 v0, v19

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5854
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5855
    const/4 v3, 0x1

    :try_start_9
    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 5856
    monitor-exit p0

    .line 5852
    add-int/lit8 v21, v21, 0x1

    goto :goto_6

    .line 5856
    :catchall_2
    move-exception v3

    monitor-exit p0
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_2

    throw v3

    .line 5860
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_d
    const/16 v21, 0x0

    :goto_7
    move/from16 v0, v21

    move v1, v15

    if-ge v0, v1, :cond_e

    .line 5861
    move-object/from16 v0, v25

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5862
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x1

    move-object/from16 v4, p0

    invoke-virtual/range {v4 .. v9}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 5860
    add-int/lit8 v21, v21, 0x1

    goto :goto_7

    .line 5865
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_e
    if-eqz v16, :cond_f

    .line 5866
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->finishBooting()V

    .line 5869
    :cond_f
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 5873
    if-eqz v18, :cond_10

    .line 5874
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->enableScreenAfterBoot()V

    .line 5876
    :cond_10
    return-void

    .line 5823
    .end local v19           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .end local v21           #i:I
    .restart local v20       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :catchall_3
    move-exception v3

    move-object/from16 v19, v20

    .end local v20           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v19       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    goto :goto_5

    .end local v25           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v26       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :catchall_4
    move-exception v3

    move-object/from16 v25, v26

    .end local v26           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v25       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    goto :goto_5
.end method

.method public final activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;)V
    .locals 4
    .parameter "token"
    .parameter "icicle"

    .prologue
    .line 5942
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 5943
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Bundle"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 5946
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5947
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, p2, v2}, Lcom/android/server/am/ActivityManagerService;->activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;Z)V

    .line 5948
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5949
    return-void
.end method

.method final activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;Z)V
    .locals 7
    .parameter "token"
    .parameter "icicle"
    .parameter "timeout"

    .prologue
    .line 5956
    const/4 v2, 0x0

    .line 5958
    .local v2, r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5959
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 5960
    .local v1, index:I
    if-ltz v1, :cond_1

    .line 5961
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    move-object v0, v3

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object v2, v0

    .line 5962
    if-nez p3, :cond_0

    .line 5963
    iput-object p2, v2, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 5964
    const/4 v3, 0x1

    iput-boolean v3, v2, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 5966
    :cond_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5967
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, v2, :cond_2

    .line 5968
    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v3, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 5969
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->completePauseLocked()V

    .line 5977
    :cond_1
    :goto_0
    monitor-exit p0

    .line 5978
    return-void

    .line 5971
    :cond_2
    const/16 v3, 0x753c

    const/4 v4, 0x3

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v6

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x1

    iget-object v6, v2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v6, v4, v5

    const/4 v5, 0x2

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v6, :cond_3

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v6, v6, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    :goto_1
    aput-object v6, v4, v5

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_0

    .line 5977
    .end local v1           #index:I
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 5971
    .restart local v1       #index:I
    :cond_3
    :try_start_1
    const-string v6, "(none)"
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_1
.end method

.method public final activityStopped(Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;)V
    .locals 10
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"

    .prologue
    const/4 v3, 0x0

    .line 5985
    const/4 v2, 0x0

    .line 5987
    .local v2, r:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 5989
    .local v8, origId:J
    monitor-enter p0

    .line 5990
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v7

    .line 5991
    .local v7, index:I
    if-ltz v7, :cond_0

    .line 5992
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v1, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    move-object v0, v4

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object v2, v0

    .line 5993
    iput-object p2, v2, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 5994
    iput-object p3, v2, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    .line 5995
    const/4 v1, 0x1

    iput-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 5996
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 5997
    iget-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v1, :cond_0

    .line 5998
    iget-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v1, :cond_0

    .line 5999
    const/4 v1, 0x1

    invoke-direct {p0, v2, v1}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 6000
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 6004
    :cond_0
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6006
    if-eqz v2, :cond_1

    .line 6007
    const/4 v6, 0x0

    move-object v1, p0

    move-object v4, v3

    move-object v5, v3

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 6010
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 6012
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6013
    return-void

    .line 6004
    .end local v7           #index:I
    :catchall_0
    move-exception v1

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v1
.end method

.method final addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    .locals 5
    .parameter "info"

    .prologue
    const/4 v3, 0x0

    const/4 v4, 0x1

    .line 8200
    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v2, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 8202
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_0

    .line 8203
    invoke-virtual {p0, v3, p1, v3}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 8204
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v2, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v3, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v1, v2, v3, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 8205
    invoke-direct {p0, v0, v4, v4}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 8208
    :cond_0
    iget v1, p1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v1, v1, 0x9

    const/16 v2, 0x9

    if-ne v1, v2, :cond_1

    .line 8210
    iput-boolean v4, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    .line 8211
    const/16 v1, -0xc

    iput v1, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    .line 8213
    :cond_1
    iget-object v1, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_2

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v1

    if-gez v1, :cond_2

    .line 8214
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8215
    const-string v1, "added application"

    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-direct {p0, v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 8218
    :cond_2
    return-object v0
.end method

.method public addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V
    .locals 19
    .parameter "eventType"
    .parameter "process"
    .parameter "activity"
    .parameter "parent"
    .parameter "subject"
    .parameter "report"
    .parameter "logFile"
    .parameter "crashInfo"

    .prologue
    .line 9218
    if-eqz p2, :cond_0

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_2

    .line 9219
    :cond_0
    const-string v18, "system_server_"

    .line 9226
    .local v18, prefix:Ljava/lang/String;
    :goto_0
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    move-object v0, v4

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    .line 9227
    .local v10, dropboxTag:Ljava/lang/String;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    const-string v5, "dropbox"

    invoke-virtual {v4, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/os/DropBoxManager;

    .line 9231
    .local v11, dbox:Landroid/os/DropBoxManager;
    if-eqz v11, :cond_1

    invoke-virtual {v11, v10}, Landroid/os/DropBoxManager;->isTagEnabled(Ljava/lang/String;)Z

    move-result v4

    if-nez v4, :cond_4

    .line 9328
    :cond_1
    :goto_1
    return-void

    .line 9220
    .end local v10           #dropboxTag:Ljava/lang/String;
    .end local v11           #dbox:Landroid/os/DropBoxManager;
    .end local v18           #prefix:Ljava/lang/String;
    :cond_2
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x1

    if-eqz v4, :cond_3

    .line 9221
    const-string v18, "system_app_"

    .restart local v18       #prefix:Ljava/lang/String;
    goto :goto_0

    .line 9223
    .end local v18           #prefix:Ljava/lang/String;
    :cond_3
    const-string v18, "data_app_"

    .restart local v18       #prefix:Ljava/lang/String;
    goto :goto_0

    .line 9233
    .restart local v10       #dropboxTag:Ljava/lang/String;
    .restart local v11       #dbox:Landroid/os/DropBoxManager;
    :cond_4
    new-instance v7, Ljava/lang/StringBuilder;

    const/16 v4, 0x400

    invoke-direct {v7, v4}, Ljava/lang/StringBuilder;-><init>(I)V

    .line 9234
    .local v7, sb:Ljava/lang/StringBuilder;
    if-eqz p2, :cond_5

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_7

    .line 9235
    :cond_5
    const-string v4, "Process: system_server\n"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9239
    :goto_2
    if-eqz p2, :cond_8

    .line 9240
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v13, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 9241
    .local v13, flags:I
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v17

    .line 9242
    .local v17, pm:Landroid/content/pm/IPackageManager;
    const-string v4, "Flags: 0x"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const/16 v5, 0x10

    invoke-static {v13, v5}, Ljava/lang/Integer;->toString(II)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9243
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pkgList:Ljava/util/HashSet;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .local v14, i$:Ljava/util/Iterator;
    :goto_3
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_8

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Ljava/lang/String;

    .line 9244
    .local v16, pkg:Ljava/lang/String;
    const-string v4, "Package: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9246
    const/4 v4, 0x0

    :try_start_0
    move-object/from16 v0, v17

    move-object/from16 v1, v16

    move v2, v4

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v15

    .line 9247
    .local v15, pi:Landroid/content/pm/PackageInfo;
    if-eqz v15, :cond_6

    .line 9248
    const-string v4, " v"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget v5, v15, Landroid/content/pm/PackageInfo;->versionCode:I

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 9249
    iget-object v4, v15, Landroid/content/pm/PackageInfo;->versionName:Ljava/lang/String;

    if-eqz v4, :cond_6

    .line 9250
    const-string v4, " ("

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v15, Landroid/content/pm/PackageInfo;->versionName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ")"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 9256
    .end local v15           #pi:Landroid/content/pm/PackageInfo;
    :cond_6
    :goto_4
    const-string v4, "\n"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_3

    .line 9237
    .end local v13           #flags:I
    .end local v14           #i$:Ljava/util/Iterator;
    .end local v16           #pkg:Ljava/lang/String;
    .end local v17           #pm:Landroid/content/pm/IPackageManager;
    :cond_7
    const-string v4, "Process: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto/16 :goto_2

    .line 9253
    .restart local v13       #flags:I
    .restart local v14       #i$:Ljava/util/Iterator;
    .restart local v16       #pkg:Ljava/lang/String;
    .restart local v17       #pm:Landroid/content/pm/IPackageManager;
    :catch_0
    move-exception v4

    move-object v12, v4

    .line 9254
    .local v12, e:Landroid/os/RemoteException;
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Error getting package info: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v12}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_4

    .line 9259
    .end local v12           #e:Landroid/os/RemoteException;
    .end local v13           #flags:I
    .end local v14           #i$:Ljava/util/Iterator;
    .end local v16           #pkg:Ljava/lang/String;
    .end local v17           #pm:Landroid/content/pm/IPackageManager;
    :cond_8
    if-eqz p3, :cond_9

    .line 9260
    const-string v4, "Activity: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9262
    :cond_9
    if-eqz p4, :cond_a

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_a

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget v4, v4, Lcom/android/server/am/ProcessRecord;->pid:I

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    if-eq v4, v5, :cond_a

    .line 9263
    const-string v4, "Parent-Process: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9265
    :cond_a
    if-eqz p4, :cond_b

    move-object/from16 v0, p4

    move-object/from16 v1, p3

    if-eq v0, v1, :cond_b

    .line 9266
    const-string v4, "Parent-Activity: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9268
    :cond_b
    if-eqz p5, :cond_c

    .line 9269
    const-string v4, "Subject: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9271
    :cond_c
    const-string v4, "Build: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    sget-object v5, Landroid/os/Build;->FINGERPRINT:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9272
    const-string v4, "\n"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9276
    new-instance v3, Lcom/android/server/am/ActivityManagerService$8;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Error dump: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v4, p0

    move-object/from16 v6, p6

    move-object/from16 v8, p7

    move-object/from16 v9, p8

    invoke-direct/range {v3 .. v11}, Lcom/android/server/am/ActivityManagerService$8;-><init>(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;Ljava/lang/String;Ljava/lang/StringBuilder;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;Ljava/lang/String;Landroid/os/DropBoxManager;)V

    .line 9323
    .local v3, worker:Ljava/lang/Thread;
    if-eqz p2, :cond_d

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_e

    .line 9324
    :cond_d
    invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService$8;->run()V

    goto/16 :goto_1

    .line 9326
    :cond_e
    invoke-virtual {v3}, Ljava/lang/Thread;->start()V

    goto/16 :goto_1
.end method

.method final addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 6
    .parameter "proc"

    .prologue
    .line 14222
    const/4 v0, 0x0

    .line 14223
    .local v0, added:Z
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v1, v2, v3

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_0

    .line 14224
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    iget-wide v2, v2, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    iget-wide v4, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    cmp-long v2, v2, v4

    if-gez v2, :cond_2

    .line 14226
    const/4 v0, 0x1

    .line 14227
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    add-int/lit8 v3, v1, 0x1

    invoke-virtual {v2, v3, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 14231
    :cond_0
    if-nez v0, :cond_1

    .line 14232
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    const/4 v3, 0x0

    invoke-virtual {v2, v3, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 14234
    :cond_1
    return-void

    .line 14223
    :cond_2
    add-int/lit8 v1, v1, -0x1

    goto :goto_0
.end method

.method final appNotResponding(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V
    .locals 25
    .parameter "app"
    .parameter "activity"
    .parameter "parent"
    .parameter "annotation"

    .prologue
    .line 4840
    new-instance v21, Ljava/util/ArrayList;

    const/16 v5, 0x14

    move-object/from16 v0, v21

    move v1, v5

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    .line 4842
    .local v21, pids:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/Integer;>;"
    monitor-enter p0

    .line 4844
    :try_start_0
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v5, v0

    if-eqz v5, :cond_1

    .line 4845
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "During shutdown skipping ANR: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4846
    monitor-exit p0

    .line 4956
    :cond_0
    :goto_0
    return-void

    .line 4847
    :cond_1
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    move v5, v0

    if-eqz v5, :cond_2

    .line 4848
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Skipping duplicate ANR: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4849
    monitor-exit p0

    goto :goto_0

    .line 4879
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 4850
    :cond_2
    :try_start_1
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    move v5, v0

    if-eqz v5, :cond_3

    .line 4851
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Crashing app skipping ANR: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4852
    monitor-exit p0

    goto :goto_0

    .line 4857
    :cond_3
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 4860
    const/16 v5, 0x7538

    const/4 v6, 0x4

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v8, v0

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v8, v0

    aput-object v8, v6, v7

    const/4 v7, 0x2

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->flags:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v6, v7

    const/4 v7, 0x3

    aput-object p4, v6, v7

    invoke-static {v5, v6}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4864
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4866
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 v19, v0

    .line 4867
    .local v19, parentPid:I
    if-eqz p3, :cond_4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v5, :cond_4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object v0, v5

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 v19, v0

    .line 4868
    :cond_4
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    move/from16 v0, v19

    move v1, v5

    if-eq v0, v1, :cond_5

    invoke-static/range {v19 .. v19}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4870
    :cond_5
    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v6, v0

    if-eq v5, v6, :cond_6

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v0, v5

    move/from16 v1, v19

    if-eq v0, v1, :cond_6

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4872
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v15, v5, v6

    .local v15, i:I
    :goto_1
    if-ltz v15, :cond_8

    .line 4873
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Lcom/android/server/am/ProcessRecord;

    .line 4874
    .local v22, r:Lcom/android/server/am/ProcessRecord;
    if-eqz v22, :cond_7

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v5, v0

    if-eqz v5, :cond_7

    .line 4875
    move-object/from16 v0, v22

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 v20, v0

    .line 4876
    .local v20, pid:I
    if-lez v20, :cond_7

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    move/from16 v0, v20

    move v1, v5

    if-eq v0, v1, :cond_7

    move/from16 v0, v20

    move/from16 v1, v19

    if-eq v0, v1, :cond_7

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, v20

    move v1, v5

    if-eq v0, v1, :cond_7

    invoke-static/range {v20 .. v20}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4872
    .end local v20           #pid:I
    :cond_7
    add-int/lit8 v15, v15, -0x1

    goto :goto_1

    .line 4879
    .end local v22           #r:Lcom/android/server/am/ProcessRecord;
    :cond_8
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 4881
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v21

    invoke-static {v0, v1}, Lcom/android/server/am/ActivityManagerService;->dumpStackTraces(ZLjava/util/ArrayList;)Ljava/io/File;

    move-result-object v12

    .line 4884
    .local v12, tracesFile:Ljava/io/File;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    move-object/from16 v16, v0

    .line 4885
    .local v16, info:Ljava/lang/StringBuilder;
    const/4 v5, 0x0

    move-object/from16 v0, v16

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 4886
    const-string v5, "ANR in "

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4887
    if-eqz p2, :cond_9

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_9

    .line 4888
    const-string v5, " ("

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4890
    :cond_9
    const-string v5, "\n"

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4891
    if-eqz p4, :cond_a

    .line 4892
    const-string v5, "Reason: "

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "\n"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4894
    :cond_a
    if-eqz p3, :cond_b

    move-object/from16 v0, p3

    move-object/from16 v1, p2

    if-eq v0, v1, :cond_b

    .line 4895
    const-string v5, "Parent: "

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "\n"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4898
    :cond_b
    const/4 v11, 0x0

    .line 4900
    .local v11, cpuInfo:Ljava/lang/String;
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStatsNow()V

    .line 4901
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    move-object v5, v0

    monitor-enter v5

    .line 4902
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object v6, v0

    invoke-virtual {v6}, Lcom/android/server/ProcessStats;->printCurrentState()Ljava/lang/String;

    move-result-object v11

    .line 4903
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_2

    .line 4904
    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4907
    const-string v5, "ActivityManager"

    invoke-virtual/range {v16 .. v16}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 4908
    if-nez v12, :cond_c

    .line 4910
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    const/4 v6, 0x3

    invoke-static {v5, v6}, Landroid/os/Process;->sendSignal(II)V

    .line 4913
    :cond_c
    const-string v6, "anr"

    const/4 v13, 0x0

    move-object/from16 v5, p0

    move-object/from16 v7, p1

    move-object/from16 v8, p2

    move-object/from16 v9, p3

    move-object/from16 v10, p4

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/am/ActivityManagerService;->addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 4915
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    if-eqz v5, :cond_d

    .line 4918
    :try_start_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v7, v0

    invoke-virtual/range {v16 .. v16}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-interface {v5, v6, v7, v8}, Landroid/app/IActivityController;->appNotResponding(Ljava/lang/String;ILjava/lang/String;)I

    move-result v23

    .line 4919
    .local v23, res:I
    if-eqz v23, :cond_d

    .line 4920
    if-gez v23, :cond_0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    sget v6, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v5, v6, :cond_0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    invoke-static {v5}, Landroid/os/Process;->killProcess(I)V
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    goto/16 :goto_0

    .line 4923
    .end local v23           #res:I
    :catch_0
    move-exception v5

    move-object v14, v5

    .line 4924
    .local v14, e:Landroid/os/RemoteException;
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 4929
    .end local v14           #e:Landroid/os/RemoteException;
    :cond_d
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v5

    const-string v6, "anr_show_background"

    const/4 v7, 0x0

    invoke-static {v5, v6, v7}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_e

    const/4 v5, 0x1

    move/from16 v24, v5

    .line 4932
    .local v24, showBackground:Z
    :goto_2
    monitor-enter p0

    .line 4933
    if-nez v24, :cond_f

    :try_start_4
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/am/ProcessRecord;->isInterestingToUserLocked()Z

    move-result v5

    if-nez v5, :cond_f

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    sget v6, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v5, v6, :cond_f

    .line 4934
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    invoke-static {v5}, Landroid/os/Process;->killProcess(I)V

    .line 4935
    monitor-exit p0

    goto/16 :goto_0

    .line 4955
    :catchall_1
    move-exception v5

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    throw v5

    .line 4903
    .end local v24           #showBackground:Z
    :catchall_2
    move-exception v6

    :try_start_5
    monitor-exit v5
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_2

    throw v6

    .line 4929
    :cond_e
    const/4 v5, 0x0

    move/from16 v24, v5

    goto :goto_2

    .line 4939
    .restart local v24       #showBackground:Z
    :cond_f
    if-eqz p2, :cond_11

    :try_start_6
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    :goto_3
    if-eqz p4, :cond_12

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "ANR "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    :goto_4
    invoke-virtual/range {v16 .. v16}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object v2, v5

    move-object v3, v6

    move-object v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->makeAppNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    .line 4945
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v18

    .line 4946
    .local v18, msg:Landroid/os/Message;
    new-instance v17, Ljava/util/HashMap;

    invoke-direct/range {v17 .. v17}, Ljava/util/HashMap;-><init>()V

    .line 4947
    .local v17, map:Ljava/util/HashMap;
    const/4 v5, 0x2

    move v0, v5

    move-object/from16 v1, v18

    iput v0, v1, Landroid/os/Message;->what:I

    .line 4948
    move-object/from16 v0, v17

    move-object/from16 v1, v18

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 4949
    const-string v5, "app"

    move-object/from16 v0, v17

    move-object v1, v5

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 4950
    if-eqz p2, :cond_10

    .line 4951
    const-string v5, "activity"

    move-object/from16 v0, v17

    move-object v1, v5

    move-object/from16 v2, p2

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 4954
    :cond_10
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 4955
    monitor-exit p0

    goto/16 :goto_0

    .line 4939
    .end local v17           #map:Ljava/util/HashMap;
    .end local v18           #msg:Landroid/os/Message;
    :cond_11
    const/4 v5, 0x0

    goto :goto_3

    :cond_12
    const-string v6, "ANR"
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    goto :goto_4
.end method

.method public final attachApplication(Landroid/app/IApplicationThread;)V
    .locals 4
    .parameter "thread"

    .prologue
    .line 5679
    monitor-enter p0

    .line 5680
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v0

    .line 5681
    .local v0, callingPid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 5682
    .local v1, origId:J
    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->attachApplicationLocked(Landroid/app/IApplicationThread;I)Z

    .line 5683
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5684
    monitor-exit p0

    .line 5685
    return-void

    .line 5684
    .end local v0           #callingPid:I
    .end local v1           #origId:J
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method public backupAgentCreated(Ljava/lang/String;Landroid/os/IBinder;)V
    .locals 7
    .parameter "agentPackageName"
    .parameter "agent"

    .prologue
    const-string v4, "ActivityManager"

    .line 12142
    monitor-enter p0

    .line 12143
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_0

    .line 12144
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Backup agent created for "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " but not requested!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12145
    monitor-exit p0

    .line 12162
    :goto_0
    return-void

    .line 12148
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-wide v2

    .line 12150
    .local v2, oldIdent:J
    :try_start_1
    const-string v4, "backup"

    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v4

    invoke-static {v4}, Landroid/app/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/backup/IBackupManager;

    move-result-object v0

    .line 12152
    .local v0, bm:Landroid/app/backup/IBackupManager;
    invoke-interface {v0, p1, p2}, Landroid/app/backup/IBackupManager;->agentConnected(Ljava/lang/String;Landroid/os/IBinder;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    .line 12159
    :try_start_2
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12161
    .end local v0           #bm:Landroid/app/backup/IBackupManager;
    :goto_1
    monitor-exit p0

    goto :goto_0

    .end local v2           #oldIdent:J
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v4

    .line 12155
    .restart local v2       #oldIdent:J
    :catch_0
    move-exception v4

    move-object v1, v4

    .line 12156
    .local v1, e:Ljava/lang/Exception;
    :try_start_3
    const-string v4, "ActivityManager"

    const-string v5, "Exception trying to deliver BackupAgent binding: "

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12157
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 12159
    :try_start_4
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_1

    .end local v1           #e:Ljava/lang/Exception;
    :catchall_1
    move-exception v4

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v4

    .line 12153
    :catch_1
    move-exception v4

    .line 12159
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    goto :goto_1
.end method

.method public bindBackupAgent(Landroid/content/pm/ApplicationInfo;I)Z
    .locals 13
    .parameter "app"
    .parameter "backupMode"

    .prologue
    const/4 v12, 0x0

    .line 12089
    const-string v0, "android.permission.BACKUP"

    const-string v1, "startBackupAgent"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 12091
    monitor-enter p0

    .line 12093
    const/4 v10, 0x0

    .line 12094
    .local v10, ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v0}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v11

    .line 12095
    .local v11, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v11
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 12096
    :try_start_1
    iget v0, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v2, p1, Landroid/content/pm/ApplicationInfo;->name:Ljava/lang/String;

    invoke-virtual {v11, v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl;->getServiceStatsLocked(ILjava/lang/String;Ljava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    move-result-object v10

    .line 12097
    monitor-exit v11
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12099
    :try_start_2
    new-instance v9, Lcom/android/server/am/BackupRecord;

    invoke-direct {v9, v10, p1, p2}, Lcom/android/server/am/BackupRecord;-><init>(Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;Landroid/content/pm/ApplicationInfo;I)V

    .line 12100
    .local v9, r:Lcom/android/server/am/BackupRecord;
    new-instance v6, Landroid/content/ComponentName;

    iget-object v0, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->backupAgentName:Ljava/lang/String;

    invoke-direct {v6, v0, v1}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 12102
    .local v6, hostingName:Landroid/content/ComponentName;
    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "backup"

    const/4 v7, 0x0

    move-object v0, p0

    move-object v2, p1

    invoke-direct/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 12104
    .local v8, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v8, :cond_0

    .line 12105
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to start backup agent process "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12106
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    move v0, v12

    .line 12134
    :goto_0
    return v0

    .line 12097
    .end local v6           #hostingName:Landroid/content/ComponentName;
    .end local v8           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v9           #r:Lcom/android/server/am/BackupRecord;
    :catchall_0
    move-exception v0

    :try_start_3
    monitor-exit v11
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v0

    .line 12132
    .end local v11           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_1
    move-exception v0

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    throw v0

    .line 12109
    .restart local v6       #hostingName:Landroid/content/ComponentName;
    .restart local v8       #proc:Lcom/android/server/am/ProcessRecord;
    .restart local v9       #r:Lcom/android/server/am/BackupRecord;
    .restart local v11       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :cond_0
    :try_start_5
    iput-object v8, v9, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 12110
    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 12111
    iget-object v0, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 12114
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 12118
    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    if-eqz v0, :cond_1

    .line 12121
    :try_start_6
    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0, p1, p2}, Landroid/app/IApplicationThread;->scheduleCreateBackupAgent(Landroid/content/pm/ApplicationInfo;I)V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_0

    .line 12132
    :cond_1
    :goto_1
    :try_start_7
    monitor-exit p0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    .line 12134
    const/4 v0, 0x1

    goto :goto_0

    .line 12122
    :catch_0
    move-exception v0

    goto :goto_1
.end method

.method public bindService(Landroid/app/IApplicationThread;Landroid/os/IBinder;Landroid/content/Intent;Ljava/lang/String;Landroid/app/IServiceConnection;I)I
    .locals 20
    .parameter "caller"
    .parameter "token"
    .parameter "service"
    .parameter "resolvedType"
    .parameter "connection"
    .parameter "flags"

    .prologue
    .line 11663
    if-eqz p3, :cond_0

    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v8

    const/4 v9, 0x1

    if-ne v8, v9, :cond_0

    .line 11664
    new-instance v8, Ljava/lang/IllegalArgumentException;

    const-string v9, "File descriptors passed in Intent"

    invoke-direct {v8, v9}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v8

    .line 11667
    :cond_0
    monitor-enter p0

    .line 11671
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v14

    .line 11672
    .local v14, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v14, :cond_1

    .line 11673
    new-instance v8, Ljava/lang/SecurityException;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Unable to find app for caller "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object v0, v9

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (pid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ") when binding service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object v0, v9

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v8, v9}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v8

    .line 11785
    .end local v14           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v8

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v8

    .line 11679
    .restart local v14       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/4 v7, 0x0

    .line 11680
    .local v7, activity:Lcom/android/server/am/HistoryRecord;
    if-eqz p2, :cond_3

    .line 11681
    :try_start_1
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v12

    .line 11682
    .local v12, aindex:I
    if-gez v12, :cond_2

    .line 11683
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Binding with unknown activity: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object v0, v9

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11684
    const/4 v8, 0x0

    monitor-exit p0

    .line 11787
    .end local v12           #aindex:I
    :goto_0
    return v8

    .line 11686
    .restart local v12       #aindex:I
    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v8, v0

    invoke-virtual {v8, v12}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    .end local v7           #activity:Lcom/android/server/am/HistoryRecord;
    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 11689
    .end local v12           #aindex:I
    .restart local v7       #activity:Lcom/android/server/am/HistoryRecord;
    :cond_3
    const/4 v10, 0x0

    .line 11690
    .local v10, clientLabel:I
    const/4 v11, 0x0

    .line 11692
    .local v11, clientIntent:Landroid/app/PendingIntent;
    iget-object v8, v14, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    const/16 v9, 0x3e8

    if-ne v8, v9, :cond_4

    .line 11697
    :try_start_2
    const-string v8, "android.intent.extra.client_intent"

    move-object/from16 v0, p3

    move-object v1, v8

    invoke-virtual {v0, v1}, Landroid/content/Intent;->getParcelableExtra(Ljava/lang/String;)Landroid/os/Parcelable;

    move-result-object v12

    move-object v0, v12

    check-cast v0, Landroid/app/PendingIntent;

    move-object v11, v0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_1

    .line 11701
    :goto_1
    if-eqz v11, :cond_4

    .line 11702
    :try_start_3
    const-string v8, "android.intent.extra.client_label"

    const/4 v9, 0x0

    move-object/from16 v0, p3

    move-object v1, v8

    move v2, v9

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I

    move-result v10

    .line 11703
    if-eqz v10, :cond_4

    .line 11707
    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object p3

    .line 11712
    :cond_4
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    move-object/from16 v0, p0

    move-object/from16 v1, p3

    move-object/from16 v2, p4

    move v3, v8

    move v4, v9

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v18

    .line 11715
    .local v18, res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-nez v18, :cond_5

    .line 11716
    const/4 v8, 0x0

    monitor-exit p0

    goto :goto_0

    .line 11718
    :cond_5
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    move-object v8, v0

    if-nez v8, :cond_6

    .line 11719
    const/4 v8, -0x1

    monitor-exit p0

    goto :goto_0

    .line 11721
    :cond_6
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    move-object/from16 v19, v0

    .line 11723
    .local v19, s:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v16

    .line 11725
    .local v16, origId:J
    move-object/from16 v0, p0

    move-object/from16 v1, v19

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    move-result v8

    if-eqz v8, :cond_7

    .line 11730
    :cond_7
    move-object/from16 v0, v19

    move-object/from16 v1, p3

    move-object v2, v14

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ServiceRecord;->retrieveAppBindingLocked(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;)Lcom/android/server/am/AppBindRecord;

    move-result-object v6

    .line 11731
    .local v6, b:Lcom/android/server/am/AppBindRecord;
    new-instance v5, Lcom/android/server/am/ConnectionRecord;

    move-object/from16 v8, p5

    move/from16 v9, p6

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ConnectionRecord;-><init>(Lcom/android/server/am/AppBindRecord;Lcom/android/server/am/HistoryRecord;Landroid/app/IServiceConnection;IILandroid/app/PendingIntent;)V

    .line 11734
    .local v5, c:Lcom/android/server/am/ConnectionRecord;
    invoke-interface/range {p5 .. p5}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v13

    .line 11735
    .local v13, binder:Landroid/os/IBinder;
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object v8, v0

    invoke-virtual {v8, v13, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 11736
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v8, v5}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11737
    if-eqz v7, :cond_9

    .line 11738
    iget-object v8, v7, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-nez v8, :cond_8

    .line 11739
    new-instance v8, Ljava/util/HashSet;

    invoke-direct {v8}, Ljava/util/HashSet;-><init>()V

    iput-object v8, v7, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    .line 11741
    :cond_8
    iget-object v8, v7, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v8, v5}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11743
    :cond_9
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v8, v5}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11744
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    move-object v8, v0

    invoke-virtual {v8, v13, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 11746
    and-int/lit8 v8, p6, 0x1

    if-eqz v8, :cond_a

    .line 11747
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v8

    move-wide v0, v8

    move-object/from16 v2, v19

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    .line 11748
    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->getFlags()I

    move-result v8

    const/4 v9, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v19

    move v2, v8

    move v3, v9

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    move-result v8

    if-nez v8, :cond_a

    .line 11749
    const/4 v8, 0x0

    monitor-exit p0

    goto/16 :goto_0

    .line 11753
    :cond_a
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    if-eqz v8, :cond_b

    .line 11755
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    move-object/from16 v0, p0

    move-object v1, v8

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11763
    :cond_b
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    if-eqz v8, :cond_d

    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v8, v8, Lcom/android/server/am/IntentBindRecord;->received:Z
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    if-eqz v8, :cond_d

    .line 11767
    :try_start_4
    iget-object v8, v5, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object v9, v0

    iget-object v10, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    .end local v10           #clientLabel:I
    iget-object v10, v10, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    invoke-interface {v8, v9, v10}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0

    .line 11777
    :goto_2
    :try_start_5
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v8, v8, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    const/4 v9, 0x1

    if-ne v8, v9, :cond_c

    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v8, v8, Lcom/android/server/am/IntentBindRecord;->doRebind:Z

    if-eqz v8, :cond_c

    .line 11778
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v9, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v19

    move-object v2, v8

    move v3, v9

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    .line 11784
    :cond_c
    :goto_3
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11785
    monitor-exit p0

    .line 11787
    const/4 v8, 0x1

    goto/16 :goto_0

    .line 11768
    :catch_0
    move-exception v8

    move-object v15, v8

    .line 11769
    .local v15, e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failure sending service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object v10, v0

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " to connection "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v10}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (in "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v10, v10, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ")"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v15}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_2

    .line 11780
    .end local v15           #e:Ljava/lang/Exception;
    .restart local v10       #clientLabel:I
    :cond_d
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v8, v8, Lcom/android/server/am/IntentBindRecord;->requested:Z

    if-nez v8, :cond_c

    .line 11781
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v9, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v19

    move-object v2, v8

    move v3, v9

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto :goto_3

    .line 11699
    .end local v5           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v6           #b:Lcom/android/server/am/AppBindRecord;
    .end local v13           #binder:Landroid/os/IBinder;
    .end local v16           #origId:J
    .end local v18           #res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .end local v19           #s:Lcom/android/server/am/ServiceRecord;
    :catch_1
    move-exception v8

    goto/16 :goto_1
.end method

.method public final broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZ)I
    .locals 21
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "serialized"
    .parameter "sticky"

    .prologue
    .line 12702
    if-eqz p2, :cond_0

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v2

    const/4 v3, 0x1

    if-ne v2, v3, :cond_0

    .line 12703
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Intent"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 12706
    :cond_0
    monitor-enter p0

    .line 12707
    :try_start_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getFlags()I

    move-result v16

    .line 12709
    .local v16, flags:I
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v2, v0

    if-nez v2, :cond_1

    .line 12712
    const/high16 v2, 0x1000

    and-int v2, v2, v16

    if-eqz v2, :cond_2

    .line 12713
    new-instance v17, Landroid/content/Intent;

    move-object/from16 v0, v17

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12714
    .end local p2
    .local v17, intent:Landroid/content/Intent;
    const/high16 v2, 0x4000

    :try_start_1
    move-object/from16 v0, v17

    move v1, v2

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    move-object/from16 p2, v17

    .line 12722
    .end local v17           #intent:Landroid/content/Intent;
    .restart local p2
    :cond_1
    const/high16 v2, 0x800

    and-int v2, v2, v16

    if-eqz v2, :cond_3

    .line 12723
    :try_start_2
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "Can\'t use FLAG_RECEIVER_BOOT_UPGRADE here"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 12738
    .end local v16           #flags:I
    :catchall_0
    move-exception v2

    :goto_0
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 12715
    .restart local v16       #flags:I
    :cond_2
    const/high16 v2, 0x4000

    and-int v2, v2, v16

    if-nez v2, :cond_1

    .line 12716
    :try_start_3
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Attempt to launch receivers of broadcast intent "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " before boot completion"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12718
    new-instance v2, Ljava/lang/IllegalStateException;

    const-string v3, "Cannot broadcast before boot completed"

    invoke-direct {v2, v3}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 12727
    :cond_3
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v3

    .line 12728
    .local v3, callerApp:Lcom/android/server/am/ProcessRecord;
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v14

    .line 12729
    .local v14, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v15

    .line 12730
    .local v15, callingUid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 12731
    .local v18, origId:J
    if-eqz v3, :cond_4

    iget-object v2, v3, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v4, v2

    :goto_1
    move-object/from16 v2, p0

    move-object/from16 v5, p2

    move-object/from16 v6, p3

    move-object/from16 v7, p4

    move/from16 v8, p5

    move-object/from16 v9, p6

    move-object/from16 v10, p7

    move-object/from16 v11, p8

    move/from16 v12, p9

    move/from16 v13, p10

    invoke-direct/range {v2 .. v15}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v20

    .line 12736
    .local v20, res:I
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12737
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    return v20

    .line 12731
    .end local v20           #res:I
    :cond_4
    const/4 v2, 0x0

    move-object v4, v2

    goto :goto_1

    .line 12738
    .end local v3           #callerApp:Lcom/android/server/am/ProcessRecord;
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v18           #origId:J
    .end local p2
    .restart local v17       #intent:Landroid/content/Intent;
    :catchall_1
    move-exception v2

    move-object/from16 p2, v17

    .end local v17           #intent:Landroid/content/Intent;
    .restart local p2
    goto :goto_0
.end method

.method broadcastIntentInPackage(Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZ)I
    .locals 17
    .parameter "packageName"
    .parameter "uid"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "serialized"
    .parameter "sticky"

    .prologue
    .line 12745
    monitor-enter p0

    .line 12746
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v14

    .line 12747
    .local v14, origId:J
    const/4 v1, 0x0

    const/4 v12, -0x1

    move-object/from16 v0, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move-object/from16 v5, p5

    move/from16 v6, p6

    move-object/from16 v7, p7

    move-object/from16 v8, p8

    move-object/from16 v9, p9

    move/from16 v10, p10

    move/from16 v11, p11

    move/from16 v13, p2

    invoke-direct/range {v0 .. v13}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v16

    .line 12750
    .local v16, res:I
    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12751
    monitor-exit p0

    return v16

    .line 12752
    .end local v14           #origId:J
    .end local v16           #res:I
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public cancelIntentSender(Landroid/content/IIntentSender;)V
    .locals 7
    .parameter "sender"

    .prologue
    .line 6165
    instance-of v5, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v5, :cond_0

    .line 6187
    :goto_0
    return-void

    .line 6168
    :cond_0
    monitor-enter p0

    .line 6169
    :try_start_0
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v3, v0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6171
    .local v3, rec:Lcom/android/server/am/PendingIntentRecord;
    :try_start_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-interface {v5, v6}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I

    move-result v4

    .line 6173
    .local v4, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    if-eq v4, v5, :cond_1

    .line 6174
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: cancelIntentSender() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is not allowed to cancel packges "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 6179
    .local v2, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6180
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 6182
    .end local v2           #msg:Ljava/lang/String;
    .end local v4           #uid:I
    :catch_0
    move-exception v5

    move-object v1, v5

    .line 6183
    .local v1, e:Landroid/os/RemoteException;
    :try_start_2
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/Throwable;)V

    throw v5

    .line 6186
    .end local v1           #e:Landroid/os/RemoteException;
    .end local v3           #rec:Lcom/android/server/am/PendingIntentRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v5

    .line 6185
    .restart local v3       #rec:Lcom/android/server/am/PendingIntentRecord;
    .restart local v4       #uid:I
    :cond_1
    const/4 v5, 0x1

    :try_start_3
    invoke-virtual {p0, v3, v5}, Lcom/android/server/am/ActivityManagerService;->cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V

    .line 6186
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_0
.end method

.method cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V
    .locals 2
    .parameter "rec"
    .parameter "cleanActivity"

    .prologue
    .line 6190
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/PendingIntentRecord;->canceled:Z

    .line 6191
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    iget-object v1, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6192
    if-eqz p2, :cond_0

    iget-object v0, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord$Key;->activity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_0

    .line 6193
    iget-object v0, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord$Key;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    iget-object v1, p1, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6195
    :cond_0
    return-void
.end method

.method checkAppInLaunchingProvidersLocked(Lcom/android/server/am/ProcessRecord;Z)Z
    .locals 5
    .parameter "app"
    .parameter "alwaysBad"

    .prologue
    .line 10724
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10725
    .local v0, NL:I
    const/4 v3, 0x0

    .line 10726
    .local v3, restart:Z
    const/4 v2, 0x0

    .local v2, i:I
    :goto_0
    if-ge v2, v0, :cond_2

    .line 10727
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 10729
    .local v1, cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v4, v1, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    if-ne v4, p1, :cond_0

    .line 10730
    if-nez p2, :cond_1

    iget-boolean v4, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    if-nez v4, :cond_1

    .line 10731
    const/4 v3, 0x1

    .line 10726
    :cond_0
    :goto_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 10733
    :cond_1
    invoke-direct {p0, p1, v1}, Lcom/android/server/am/ActivityManagerService;->removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V

    .line 10734
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1

    .line 10738
    .end local v1           #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_2
    return v3
.end method

.method checkAppSwitchAllowedLocked(IILjava/lang/String;)Z
    .locals 6
    .parameter "callingPid"
    .parameter "callingUid"
    .parameter "name"

    .prologue
    const/4 v5, 0x1

    .line 8385
    iget-wide v1, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    cmp-long v1, v1, v3

    if-gez v1, :cond_0

    move v1, v5

    .line 8397
    :goto_0
    return v1

    .line 8389
    :cond_0
    const-string v1, "android.permission.STOP_APP_SWITCHES"

    const/4 v2, -0x1

    invoke-virtual {p0, v1, p1, p2, v2}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v0

    .line 8392
    .local v0, perm:I
    if-nez v0, :cond_1

    move v1, v5

    .line 8393
    goto :goto_0

    .line 8396
    :cond_1
    const-string v1, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " request from "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " stopped"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8397
    const/4 v1, 0x0

    goto :goto_0
.end method

.method checkCallingPermission(Ljava/lang/String;)I
    .locals 2
    .parameter "permission"

    .prologue
    .line 6360
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v0

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {p0, p1, v0, v1}, Lcom/android/server/am/ActivityManagerService;->checkPermission(Ljava/lang/String;II)I

    move-result v0

    return v0
.end method

.method checkComponentPermission(Ljava/lang/String;III)I
    .locals 7
    .parameter "permission"
    .parameter "pid"
    .parameter "uid"
    .parameter "reqUid"

    .prologue
    const/4 v6, 0x0

    const/4 v5, -0x1

    const-string v4, "ActivityManager"

    .line 6308
    sget-object v2, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v2}, Ljava/lang/ThreadLocal;->get()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ActivityManagerService$Identity;

    .line 6309
    .local v1, tlsIdentity:Lcom/android/server/am/ActivityManagerService$Identity;
    if-eqz v1, :cond_0

    .line 6310
    const-string v2, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "checkComponentPermission() adjusting {pid,uid} to {"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget v3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ","

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget v3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "}"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v4, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 6312
    iget p3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    .line 6313
    iget p2, v1, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    .line 6317
    :cond_0
    if-eqz p3, :cond_1

    const/16 v2, 0x3e8

    if-eq p3, v2, :cond_1

    sget v2, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq p2, v2, :cond_1

    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v2

    if-nez v2, :cond_2

    :cond_1
    move v2, v6

    .line 6336
    :goto_0
    return v2

    .line 6322
    :cond_2
    if-ltz p4, :cond_3

    if-eq p3, p4, :cond_3

    .line 6323
    const-string v2, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Permission denied: checkComponentPermission() reqUid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v4, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    move v2, v5

    .line 6324
    goto :goto_0

    .line 6326
    :cond_3
    if-nez p1, :cond_4

    move v2, v6

    .line 6327
    goto :goto_0

    .line 6330
    :cond_4
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    invoke-interface {v2, p1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v2

    goto :goto_0

    .line 6332
    :catch_0
    move-exception v2

    move-object v0, v2

    .line 6334
    .local v0, e:Landroid/os/RemoteException;
    const-string v2, "ActivityManager"

    const-string v2, "PackageManager is dead?!?"

    invoke-static {v4, v2, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    move v2, v5

    .line 6336
    goto :goto_0
.end method

.method public checkPermission(Ljava/lang/String;II)I
    .locals 1
    .parameter "permission"
    .parameter "pid"
    .parameter "uid"

    .prologue
    const/4 v0, -0x1

    .line 6349
    if-nez p1, :cond_0

    .line 6352
    :goto_0
    return v0

    :cond_0
    invoke-virtual {p0, p1, p2, p3, v0}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v0

    goto :goto_0
.end method

.method public checkUriPermission(Landroid/net/Uri;III)I
    .locals 3
    .parameter "uri"
    .parameter "pid"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v2, 0x0

    .line 6421
    sget-object v1, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v1}, Ljava/lang/ThreadLocal;->get()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ActivityManagerService$Identity;

    .line 6422
    .local v0, tlsIdentity:Lcom/android/server/am/ActivityManagerService$Identity;
    if-eqz v0, :cond_0

    .line 6423
    iget p3, v0, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    .line 6424
    iget p2, v0, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    .line 6428
    :cond_0
    sget v1, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne p2, v1, :cond_1

    move v1, v2

    .line 6432
    :goto_0
    return v1

    .line 6431
    :cond_1
    monitor-enter p0

    .line 6432
    :try_start_0
    invoke-direct {p0, p1, p3, p4}, Lcom/android/server/am/ActivityManagerService;->checkUriPermissionLocked(Landroid/net/Uri;II)Z

    move-result v1

    if-eqz v1, :cond_2

    move v1, v2

    :goto_1
    monitor-exit p0

    goto :goto_0

    .line 6435
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1

    .line 6432
    :cond_2
    const/4 v1, -0x1

    goto :goto_1
.end method

.method public clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)Z
    .locals 25
    .parameter "packageName"
    .parameter "observer"

    .prologue
    .line 5039
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v24

    .line 5040
    .local v24, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v21

    .line 5041
    .local v21, pid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v19

    .line 5043
    .local v19, callingId:J
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v23

    .line 5044
    .local v23, pm:Landroid/content/pm/IPackageManager;
    const/16 v22, -0x1

    .line 5045
    .local v22, pkgUid:I
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 5047
    :try_start_1
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    move-result v22

    .line 5050
    :goto_0
    const/4 v5, -0x1

    move/from16 v0, v22

    move v1, v5

    if-ne v0, v1, :cond_0

    .line 5051
    :try_start_2
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Invalid packageName:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5052
    const/4 v5, 0x0

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5080
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5082
    :goto_1
    return v5

    .line 5054
    :cond_0
    move/from16 v0, v24

    move/from16 v1, v22

    if-eq v0, v1, :cond_1

    :try_start_3
    const-string v5, "android.permission.CLEAR_APP_USER_DATA"

    const/4 v6, -0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, v21

    move/from16 v3, v24

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v5

    if-nez v5, :cond_2

    .line 5058
    :cond_1
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, v22

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;I)V

    .line 5064
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 5068
    :try_start_4
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)V

    .line 5069
    new-instance v8, Landroid/content/Intent;

    const-string v5, "android.intent.action.PACKAGE_DATA_CLEARED"

    const-string v6, "package"

    const/4 v7, 0x0

    move-object v0, v6

    move-object/from16 v1, p1

    move-object v2, v7

    invoke-static {v0, v1, v2}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v6

    invoke-direct {v8, v5, v6}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 5071
    .local v8, intent:Landroid/content/Intent;
    const-string v5, "android.intent.extra.UID"

    move-object v0, v8

    move-object v1, v5

    move/from16 v2, v22

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 5072
    monitor-enter p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_0

    .line 5073
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    :try_start_5
    sget v17, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v18, 0x3e8

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v18}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5076
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_2

    .line 5080
    .end local v8           #intent:Landroid/content/Intent;
    :goto_2
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5082
    const/4 v5, 0x1

    goto :goto_1

    .line 5060
    :cond_2
    :try_start_6
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    move-object v0, v6

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " does not have permission:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "android.permission.CLEAR_APP_USER_DATA"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " to clear data"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "for process:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 5064
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    :try_start_7
    throw v5
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    .line 5080
    .end local v22           #pkgUid:I
    .end local v23           #pm:Landroid/content/pm/IPackageManager;
    :catchall_1
    move-exception v5

    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v5

    .line 5076
    .restart local v8       #intent:Landroid/content/Intent;
    .restart local v22       #pkgUid:I
    .restart local v23       #pm:Landroid/content/pm/IPackageManager;
    :catchall_2
    move-exception v5

    :try_start_8
    monitor-exit p0
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_2

    :try_start_9
    throw v5
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_9 .. :try_end_9} :catch_0

    .line 5077
    .end local v8           #intent:Landroid/content/Intent;
    :catch_0
    move-exception v5

    goto :goto_2

    .line 5048
    :catch_1
    move-exception v5

    goto/16 :goto_0
.end method

.method public closeSystemDialogs(Ljava/lang/String;)V
    .locals 23
    .parameter "reason"

    .prologue
    .line 5179
    new-instance v9, Landroid/content/Intent;

    const-string v3, "android.intent.action.CLOSE_SYSTEM_DIALOGS"

    invoke-direct {v9, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 5180
    .local v9, intent:Landroid/content/Intent;
    if-eqz p1, :cond_0

    .line 5181
    const-string v3, "reason"

    move-object v0, v9

    move-object v1, v3

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;

    .line 5184
    :cond_0
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v19

    .line 5185
    .local v19, uid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v20

    .line 5186
    .local v20, origId:J
    monitor-enter p0

    .line 5187
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->beginBroadcast()I

    move-result v5

    .line 5188
    .local v5, i:I
    :cond_1
    :goto_0
    if-lez v5, :cond_2

    .line 5189
    add-int/lit8 v5, v5, -0x1

    .line 5190
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;

    move-result-object v22

    check-cast v22, Landroid/app/IActivityWatcher;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5191
    .local v22, w:Landroid/app/IActivityWatcher;
    if-eqz v22, :cond_1

    .line 5193
    :try_start_1
    move-object/from16 v0, v22

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/app/IActivityWatcher;->closingSystemDialogs(Ljava/lang/String;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_0

    .line 5194
    :catch_0
    move-exception v3

    goto :goto_0

    .line 5198
    .end local v22           #w:Landroid/app/IActivityWatcher;
    :cond_2
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    .line 5200
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->closeSystemDialogs(Ljava/lang/String;)V

    .line 5202
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v5, v3, v4

    :goto_1
    if-ltz v5, :cond_4

    .line 5203
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 5204
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit16 v3, v3, 0x100

    if-eqz v3, :cond_3

    .line 5205
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "close-sys"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 5202
    :cond_3
    add-int/lit8 v5, v5, -0x1

    goto :goto_1

    .line 5210
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, -0x1

    move-object/from16 v6, p0

    invoke-direct/range {v6 .. v19}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5212
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5213
    invoke-static/range {v20 .. v21}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5214
    return-void

    .line 5212
    .end local v5           #i:I
    :catchall_0
    move-exception v3

    :try_start_3
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    throw v3
.end method

.method public collectPss(Lcom/android/server/Watchdog$PssStats;)V
    .locals 6
    .parameter "stats"

    .prologue
    const/4 v4, 0x0

    .line 8630
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    .line 8631
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    .line 8632
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    .line 8633
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    .line 8634
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mServicePss:I

    .line 8635
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mServiceCount:I

    .line 8636
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    .line 8637
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    .line 8638
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    .line 8639
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    .line 8640
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    .line 8641
    monitor-enter p0

    .line 8643
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    array-length v4, v4

    iget-object v5, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v5, v5

    if-ge v4, v5, :cond_0

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    array-length v4, v4

    move v0, v4

    .line 8645
    .local v0, NPD:I
    :goto_0
    const/4 v1, 0x0

    .line 8646
    .local v1, aggr:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_1
    if-ge v2, v0, :cond_1

    .line 8647
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    aget v4, v4, v2

    add-int/2addr v1, v4

    .line 8648
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    aput v1, v4, v2

    .line 8646
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    .line 8643
    .end local v0           #NPD:I
    .end local v1           #aggr:I
    .end local v2           #i:I
    :cond_0
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v4, v4

    move v0, v4

    goto :goto_0

    .line 8650
    .restart local v0       #NPD:I
    .restart local v1       #aggr:I
    .restart local v2       #i:I
    :cond_1
    :goto_2
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v4, v4

    if-ge v2, v4, :cond_2

    .line 8651
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    const/4 v5, 0x0

    aput v5, v4, v2

    .line 8652
    add-int/lit8 v2, v2, 0x1

    goto :goto_2

    .line 8655
    :cond_2
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    const/4 v5, 0x1

    sub-int v2, v4, v5

    :goto_3
    if-ltz v2, :cond_8

    .line 8656
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8657
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v4, :cond_3

    .line 8655
    :goto_4
    add-int/lit8 v2, v2, -0x1

    goto :goto_3

    .line 8661
    :cond_3
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    if-nez v4, :cond_4

    .line 8662
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    goto :goto_4

    .line 8681
    .end local v0           #NPD:I
    .end local v1           #aggr:I
    .end local v2           #i:I
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 8665
    .restart local v0       #NPD:I
    .restart local v1       #aggr:I
    .restart local v2       #i:I
    .restart local v3       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_4
    :try_start_1
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v4, v5, :cond_6

    .line 8666
    iget-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->empty:Z

    if-eqz v4, :cond_5

    .line 8667
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    .line 8668
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    goto :goto_4

    .line 8670
    :cond_5
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    .line 8671
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    goto :goto_4

    .line 8673
    :cond_6
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v4, v5, :cond_7

    .line 8674
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    .line 8675
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    goto :goto_4

    .line 8677
    :cond_7
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    .line 8678
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    goto :goto_4

    .line 8681
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_8
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8682
    return-void
.end method

.method createAppErrorIntentLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/content/Intent;
    .locals 3
    .parameter "r"
    .parameter "timeMillis"
    .parameter "crashInfo"

    .prologue
    .line 9424
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/am/ActivityManagerService;->createAppErrorReportLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/app/ApplicationErrorReport;

    move-result-object v0

    .line 9425
    .local v0, report:Landroid/app/ApplicationErrorReport;
    if-nez v0, :cond_0

    .line 9426
    const/4 v2, 0x0

    .line 9432
    :goto_0
    return-object v2

    .line 9428
    :cond_0
    new-instance v1, Landroid/content/Intent;

    const-string v2, "android.intent.action.APP_ERROR"

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 9429
    .local v1, result:Landroid/content/Intent;
    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    invoke-virtual {v1, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 9430
    const-string v2, "android.intent.extra.BUG_REPORT"

    invoke-virtual {v1, v2, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    .line 9431
    const/high16 v2, 0x1000

    invoke-virtual {v1, v2}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    move-object v2, v1

    .line 9432
    goto :goto_0
.end method

.method protected dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
    .locals 10
    .parameter "fd"
    .parameter "pw"
    .parameter "args"

    .prologue
    .line 9582
    const-string v0, "android.permission.DUMP"

    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_0

    .line 9584
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Permission Denial: can\'t dump ActivityManager from from pid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ", uid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " without permission "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "android.permission.DUMP"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9708
    :goto_0
    return-void

    .line 9592
    :cond_0
    const/4 v5, 0x0

    .line 9594
    .local v5, dumpAll:Z
    const/4 v4, 0x0

    .line 9595
    .local v4, opti:I
    :goto_1
    array-length v0, p3

    if-ge v4, v0, :cond_1

    .line 9596
    aget-object v9, p3, v4

    .line 9597
    .local v9, opt:Ljava/lang/String;
    if-eqz v9, :cond_1

    invoke-virtual {v9}, Ljava/lang/String;->length()I

    move-result v0

    if-lez v0, :cond_1

    const/4 v0, 0x0

    invoke-virtual {v9, v0}, Ljava/lang/String;->charAt(I)C

    move-result v0

    const/16 v1, 0x2d

    if-eq v0, v1, :cond_3

    .line 9621
    .end local v9           #opt:Ljava/lang/String;
    :cond_1
    array-length v0, p3

    if-ge v4, v0, :cond_11

    .line 9622
    aget-object v7, p3, v4

    .line 9623
    .local v7, cmd:Ljava/lang/String;
    add-int/lit8 v4, v4, 0x1

    .line 9624
    const-string v0, "activities"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_2

    const-string v0, "a"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_6

    .line 9625
    :cond_2
    monitor-enter p0

    .line 9626
    const/4 v5, 0x1

    const/4 v6, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_0
    invoke-virtual/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->dumpActivitiesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZZ)Z

    .line 9627
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto :goto_0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    .line 9600
    .end local v7           #cmd:Ljava/lang/String;
    .restart local v5       #dumpAll:Z
    .restart local v9       #opt:Ljava/lang/String;
    :cond_3
    add-int/lit8 v4, v4, 0x1

    .line 9601
    const-string v0, "-a"

    invoke-virtual {v0, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_4

    .line 9602
    const/4 v5, 0x1

    goto :goto_1

    .line 9603
    :cond_4
    const-string v0, "-h"

    invoke-virtual {v0, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_5

    .line 9604
    const-string v0, "Activity manager dump options:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9605
    const-string v0, "  [-a] [-h] [cmd] ..."

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9606
    const-string v0, "  cmd may be one of:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9607
    const-string v0, "    activities: activity stack state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9608
    const-string v0, "    broadcasts: broadcast state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9609
    const-string v0, "    intents: pending intent state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9610
    const-string v0, "    processes: process state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9611
    const-string v0, "    providers: content provider state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9612
    const-string v0, "    services: service state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9613
    const-string v0, "    service [name]: service client-side state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_0

    .line 9616
    :cond_5
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Unknown argument: "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "; use -h for help"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_1

    .line 9629
    .end local v9           #opt:Ljava/lang/String;
    .restart local v7       #cmd:Ljava/lang/String;
    :cond_6
    const-string v0, "broadcasts"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_7

    const-string v0, "b"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_8

    .line 9630
    :cond_7
    monitor-enter p0

    .line 9631
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_1
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpBroadcastsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9632
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_1
    move-exception v0

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    throw v0

    .line 9634
    .restart local v5       #dumpAll:Z
    :cond_8
    const-string v0, "intents"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_9

    const-string v0, "i"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_a

    .line 9635
    :cond_9
    monitor-enter p0

    .line 9636
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_2
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpPendingIntentsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9637
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_2
    move-exception v0

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_2

    throw v0

    .line 9639
    .restart local v5       #dumpAll:Z
    :cond_a
    const-string v0, "processes"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_b

    const-string v0, "p"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_c

    .line 9640
    :cond_b
    monitor-enter p0

    .line 9641
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_3
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProcessesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9642
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_3
    move-exception v0

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_3

    throw v0

    .line 9644
    .restart local v5       #dumpAll:Z
    :cond_c
    const-string v0, "providers"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_d

    const-string v0, "prov"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_e

    .line 9645
    :cond_d
    monitor-enter p0

    .line 9646
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_4
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProvidersLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9647
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_4
    move-exception v0

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_4

    throw v0

    .line 9649
    .restart local v5       #dumpAll:Z
    :cond_e
    const-string v0, "service"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_f

    .line 9650
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)V

    goto/16 :goto_0

    .line 9652
    :cond_f
    const-string v0, "services"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_10

    const-string v0, "s"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_11

    .line 9653
    :cond_10
    monitor-enter p0

    .line 9654
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_5
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpServicesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9655
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_5
    move-exception v0

    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_5

    throw v0

    .line 9661
    .end local v7           #cmd:Ljava/lang/String;
    .restart local v5       #dumpAll:Z
    :cond_11
    monitor-enter p0

    .line 9663
    if-eqz v5, :cond_12

    .line 9664
    :try_start_6
    const-string v0, "Providers in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_12
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9666
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProvidersLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9667
    .local v8, needSep:Z
    if-eqz v8, :cond_13

    .line 9668
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9670
    :cond_13
    if-eqz v5, :cond_14

    .line 9671
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9672
    const-string v0, "Broadcasts in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_14
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9674
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpBroadcastsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9675
    if-eqz v8, :cond_15

    .line 9676
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9678
    :cond_15
    if-eqz v5, :cond_16

    .line 9679
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9680
    const-string v0, "Services in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_16
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9682
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpServicesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9683
    if-eqz v8, :cond_17

    .line 9684
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9686
    :cond_17
    if-eqz v5, :cond_18

    .line 9687
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9688
    const-string v0, "PendingIntents in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_18
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9690
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpPendingIntentsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9691
    if-eqz v8, :cond_19

    .line 9692
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9694
    :cond_19
    if-eqz v5, :cond_1a

    .line 9695
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9696
    const-string v0, "Activities in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9698
    :cond_1a
    if-nez v5, :cond_1d

    const/4 v0, 0x1

    move v6, v0

    :goto_2
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->dumpActivitiesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZZ)Z

    move-result v8

    .line 9699
    if-eqz v8, :cond_1b

    .line 9700
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9702
    :cond_1b
    if-eqz v5, :cond_1c

    .line 9703
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9704
    const-string v0, "Processes in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_1c
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9706
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProcessesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9707
    monitor-exit p0

    goto/16 :goto_0

    .end local v8           #needSep:Z
    :catchall_6
    move-exception v0

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_6

    throw v0

    .line 9698
    .restart local v8       #needSep:Z
    :cond_1d
    const/4 v0, 0x0

    move v6, v0

    goto :goto_2
.end method

.method dumpActivitiesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZZ)Z
    .locals 9
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"
    .parameter "needHeader"

    .prologue
    const/4 v8, 0x1

    const/4 v7, 0x0

    const-string v6, "  "

    const-string v5, " "

    .line 9712
    if-eqz p6, :cond_0

    .line 9713
    const-string v3, "  Activity stack:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9715
    :cond_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Hist"

    invoke-static {p2, v3, v6, v4, v8}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9716
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9717
    const-string v3, "  Running activities (most recent first):"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9718
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Run"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9719
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_1

    .line 9720
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9721
    const-string v3, "  Activities waiting for another to become visible:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9722
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Wait"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9724
    :cond_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_2

    .line 9725
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9726
    const-string v3, "  Activities waiting to stop:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9727
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Stop"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9729
    :cond_2
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_3

    .line 9730
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9731
    const-string v3, "  Activities waiting to finish:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9732
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Fin"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9735
    :cond_3
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9736
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mPausingActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9737
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mResumedActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9738
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mFocusedActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9739
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mLastPausedActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9741
    if-eqz p5, :cond_4

    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_4

    .line 9742
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9743
    const-string v3, "Recent tasks in Current Activity Manager State:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9745
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 9746
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_4

    .line 9747
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/TaskRecord;

    .line 9748
    .local v2, tr:Lcom/android/server/am/TaskRecord;
    const-string v3, "  * Recent #"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v3, ": "

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9749
    invoke-virtual {p2, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9750
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/TaskRecord;

    const-string v4, "    "

    invoke-virtual {v3, p2, v4}, Lcom/android/server/am/TaskRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9746
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .line 9754
    .end local v0           #N:I
    .end local v1           #i:I
    .end local v2           #tr:Lcom/android/server/am/TaskRecord;
    :cond_4
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9755
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mCurTask: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget v4, p0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9757
    return v8
.end method

.method dumpBroadcastsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 19
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 9991
    const/4 v12, 0x0

    .line 9993
    .local v12, needSep:Z
    if-eqz p5, :cond_1

    .line 9994
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/HashMap;->size()I

    move-result v15

    if-lez v15, :cond_0

    .line 9995
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9996
    const-string v15, "  Registered Receivers:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9997
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v15

    invoke-interface {v15}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v11

    .line 9998
    .local v11, it:Ljava/util/Iterator;
    :goto_0
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v15

    if-eqz v15, :cond_0

    .line 9999
    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/ReceiverList;

    .line 10000
    .local v13, r:Lcom/android/server/am/ReceiverList;
    const-string v15, "  * "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object v1, v13

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10001
    const-string v15, "    "

    move-object v0, v13

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ReceiverList;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 10005
    .end local v11           #it:Ljava/util/Iterator;
    .end local v13           #r:Lcom/android/server/am/ReceiverList;
    :cond_0
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10006
    const-string v15, "Receiver Resolver Table:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10007
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v15, v0

    const/16 v16, 0x0

    const-string v17, "  "

    const/16 v18, 0x0

    move-object v0, v15

    move-object/from16 v1, p2

    move-object/from16 v2, v16

    move-object/from16 v3, v17

    move-object/from16 v4, v18

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/IntentResolver;->dump(Ljava/io/PrintWriter;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z

    .line 10008
    const/4 v12, 0x1

    .line 10011
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-gtz v15, :cond_2

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-gtz v15, :cond_2

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    if-eqz v15, :cond_7

    .line 10013
    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-lez v15, :cond_3

    .line 10014
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10015
    const-string v15, "  Active broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10017
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    const/16 v16, 0x1

    sub-int v8, v15, v16

    .end local p1
    .local v8, i:I
    :goto_1
    if-ltz v8, :cond_4

    .line 10018
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  Broadcast #"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v15

    const-string v16, ":"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10019
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/BroadcastRecord;

    const-string v15, "    "

    move-object/from16 v0, p1

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10017
    add-int/lit8 v8, v8, -0x1

    goto :goto_1

    .line 10021
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-lez v15, :cond_5

    .line 10022
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10023
    const-string v15, "  Active ordered broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10025
    :cond_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    const/16 v16, 0x1

    sub-int v8, v15, v16

    :goto_2
    if-ltz v8, :cond_6

    .line 10026
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  Serialized Broadcast #"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v15

    const-string v16, ":"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10027
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/BroadcastRecord;

    const-string v15, "    "

    move-object/from16 v0, p1

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10025
    add-int/lit8 v8, v8, -0x1

    goto :goto_2

    .line 10029
    :cond_6
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10030
    const-string v15, "  Pending broadcast:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10031
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    if-eqz v15, :cond_c

    .line 10032
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    const-string v16, "    "

    move-object v0, v15

    move-object/from16 v1, p2

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10036
    :goto_3
    const/4 v12, 0x1

    .line 10039
    .end local v8           #i:I
    :cond_7
    if-eqz p5, :cond_9

    .line 10040
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10041
    const-string v15, "  Historical broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10042
    const/4 v8, 0x0

    .restart local v8       #i:I
    :goto_4
    const/16 v15, 0x64

    if-ge v8, v15, :cond_8

    .line 10043
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    aget-object v13, v15, v8

    .line 10044
    .local v13, r:Lcom/android/server/am/BroadcastRecord;
    if-nez v13, :cond_d

    .line 10050
    .end local v13           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_8
    const/4 v12, 0x1

    .line 10053
    .end local v8           #i:I
    :cond_9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v15, v0

    if-eqz v15, :cond_f

    .line 10054
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10055
    const-string v15, "  Sticky broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10056
    new-instance v14, Ljava/lang/StringBuilder;

    const/16 v15, 0x80

    invoke-direct {v14, v15}, Ljava/lang/StringBuilder;-><init>(I)V

    .line 10058
    .local v14, sb:Ljava/lang/StringBuilder;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v15

    invoke-interface {v15}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v9

    .local v9, i$:Ljava/util/Iterator;
    :cond_a
    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z

    move-result v15

    if-eqz v15, :cond_e

    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/util/Map$Entry;

    .line 10059
    .local v7, ent:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Ljava/util/ArrayList<Landroid/content/Intent;>;>;"
    const-string v15, "  * Sticky action "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface {v7}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10060
    const-string v15, ":"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10061
    invoke-interface {v7}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Ljava/util/ArrayList;

    .line 10062
    .local v10, intents:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v5

    .line 10063
    .local v5, N:I
    const/4 v8, 0x0

    .restart local v8       #i:I
    :goto_5
    if-ge v8, v5, :cond_a

    .line 10064
    const/4 v15, 0x0

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 10065
    const-string v15, "    Intent: "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 10066
    invoke-virtual {v10, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Landroid/content/Intent;

    const/4 v15, 0x1

    const/16 v16, 0x0

    move-object/from16 v0, p1

    move-object v1, v14

    move v2, v15

    move/from16 v3, v16

    invoke-virtual {v0, v1, v2, v3}, Landroid/content/Intent;->toShortString(Ljava/lang/StringBuilder;ZZ)V

    .line 10067
    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10068
    invoke-virtual {v10, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Landroid/content/Intent;

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getExtras()Landroid/os/Bundle;

    move-result-object v6

    .line 10069
    .local v6, bundle:Landroid/os/Bundle;
    if-eqz v6, :cond_b

    .line 10070
    const-string v15, "      "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10071
    invoke-virtual {v6}, Landroid/os/Bundle;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10063
    :cond_b
    add-int/lit8 v8, v8, 0x1

    goto :goto_5

    .line 10034
    .end local v5           #N:I
    .end local v6           #bundle:Landroid/os/Bundle;
    .end local v7           #ent:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Ljava/util/ArrayList<Landroid/content/Intent;>;>;"
    .end local v9           #i$:Ljava/util/Iterator;
    .end local v10           #intents:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    .end local v14           #sb:Ljava/lang/StringBuilder;
    :cond_c
    const-string v15, "    (null)"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_3

    .line 10047
    .restart local v13       #r:Lcom/android/server/am/BroadcastRecord;
    :cond_d
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  Historical Broadcast #"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v15

    const-string v16, ":"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10048
    const-string v15, "    "

    move-object v0, v13

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10042
    add-int/lit8 v8, v8, 0x1

    goto/16 :goto_4

    .line 10075
    .end local v8           #i:I
    .end local v13           #r:Lcom/android/server/am/BroadcastRecord;
    .restart local v9       #i$:Ljava/util/Iterator;
    .restart local v14       #sb:Ljava/lang/StringBuilder;
    :cond_e
    const/4 v12, 0x1

    .line 10078
    .end local v9           #i$:Ljava/util/Iterator;
    .end local v14           #sb:Ljava/lang/StringBuilder;
    :cond_f
    if-eqz p5, :cond_10

    .line 10079
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10080
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  mBroadcastsScheduled="

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    move/from16 v16, v0

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10081
    const-string v15, "  mHandler:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10082
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v15, v0

    new-instance v16, Landroid/util/PrintWriterPrinter;

    move-object/from16 v0, v16

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/util/PrintWriterPrinter;-><init>(Ljava/io/PrintWriter;)V

    const-string v17, "    "

    invoke-virtual/range {v15 .. v17}, Landroid/os/Handler;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 10083
    const/4 v12, 0x1

    .line 10086
    :cond_10
    return v12
.end method

.method dumpPendingIntentsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 6
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    const-string v5, "  * "

    .line 10221
    const/4 v1, 0x0

    .line 10223
    .local v1, needSep:Z
    if-eqz p5, :cond_2

    .line 10224
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->size()I

    move-result v4

    if-lez v4, :cond_2

    .line 10225
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .line 10227
    .end local p0
    .local v0, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    :goto_0
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_2

    .line 10228
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/ref/WeakReference;

    .line 10229
    .local v3, ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    if-eqz v3, :cond_0

    invoke-virtual {v3}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Lcom/android/server/am/PendingIntentRecord;

    move-object v2, p0

    .line 10230
    .local v2, rec:Lcom/android/server/am/PendingIntentRecord;
    :goto_1
    const/4 v1, 0x1

    .line 10231
    if-eqz v2, :cond_1

    .line 10232
    const-string v4, "  * "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10233
    const-string v4, "    "

    invoke-virtual {v2, p2, v4}, Lcom/android/server/am/PendingIntentRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 10229
    .end local v2           #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_0
    const/4 v4, 0x0

    move-object v2, v4

    goto :goto_1

    .line 10235
    .restart local v2       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_1
    const-string v4, "  * "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/Object;)V

    goto :goto_0

    .line 10241
    .end local v0           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    .end local v2           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v3           #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    :cond_2
    return v1
.end method

.method dumpProcessesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 24
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 9762
    const/4 v15, 0x0

    .line 9763
    .local v15, needSep:Z
    const/16 v18, 0x0

    .line 9765
    .local v18, numPers:I
    if-eqz p5, :cond_4

    .line 9766
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .local v13, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_4

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Landroid/util/SparseArray;

    .line 9767
    .local v20, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual/range {v20 .. v20}, Landroid/util/SparseArray;->size()I

    move-result v11

    .line 9768
    .local v11, NA:I
    const/4 v14, 0x0

    .local v14, ia:I
    :goto_0
    if-ge v14, v11, :cond_0

    .line 9769
    if-nez v15, :cond_1

    .line 9770
    const-string v3, "  All known processes:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9771
    const/4 v15, 0x1

    .line 9773
    :cond_1
    move-object/from16 v0, v20

    move v1, v14

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Lcom/android/server/am/ProcessRecord;

    .line 9774
    .local v22, r:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v22

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v3, v0

    if-eqz v3, :cond_3

    const-string v3, "  *PERS*"

    :goto_1
    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9775
    const-string v3, " UID "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v20

    move v1, v14

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9776
    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9777
    const-string v3, "    "

    move-object/from16 v0, v22

    move-object/from16 v1, p2

    move-object v2, v3

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ProcessRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9778
    move-object/from16 v0, v22

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v3, v0

    if-eqz v3, :cond_2

    .line 9779
    add-int/lit8 v18, v18, 0x1

    .line 9768
    :cond_2
    add-int/lit8 v14, v14, 0x1

    goto :goto_0

    .line 9774
    :cond_3
    const-string v3, "  *APP*"

    goto :goto_1

    .line 9785
    .end local v11           #NA:I
    .end local v13           #i$:Ljava/util/Iterator;
    .end local v14           #ia:I
    .end local v20           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v22           #r:Lcom/android/server/am/ProcessRecord;
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_6

    .line 9786
    if-eqz v15, :cond_5

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9787
    :cond_5
    const/4 v15, 0x1

    .line 9788
    const-string v3, "  Running processes (most recent first):"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9789
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "App "

    const-string v8, "PERS"

    const/4 v9, 0x1

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9791
    const/4 v15, 0x1

    .line 9794
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v3, v0

    monitor-enter v3

    .line 9795
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I

    move-result v4

    if-lez v4, :cond_8

    .line 9796
    if-eqz v15, :cond_7

    const-string v4, " "

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9797
    :cond_7
    const/4 v15, 0x1

    .line 9798
    const-string v4, "  PID mappings:"

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9799
    const/4 v12, 0x0

    .local v12, i:I
    :goto_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I

    move-result v4

    if-ge v12, v4, :cond_8

    .line 9800
    const-string v4, "    PID #"

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4, v12}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v4

    move-object/from16 v0, p2

    move v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9801
    const-string v4, ": "

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4, v12}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9799
    add-int/lit8 v12, v12, 0x1

    goto :goto_2

    .line 9804
    .end local v12           #i:I
    :cond_8
    monitor-exit v3
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 9806
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/util/SparseArray;->size()I

    move-result v3

    if-lez v3, :cond_a

    .line 9807
    if-eqz v15, :cond_9

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9808
    :cond_9
    const/4 v15, 0x1

    .line 9809
    const-string v3, "  Foreground Processes:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9810
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/util/SparseArray;->size()I

    move-result v3

    if-ge v12, v3, :cond_a

    .line 9811
    const-string v3, "    PID #"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3, v12}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9812
    const-string v3, ": "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3, v12}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9810
    add-int/lit8 v12, v12, 0x1

    goto :goto_3

    .line 9804
    .end local v12           #i:I
    :catchall_0
    move-exception v4

    :try_start_1
    monitor-exit v3
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 9816
    :cond_a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_c

    .line 9817
    if-eqz v15, :cond_b

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9818
    :cond_b
    const/4 v15, 0x1

    .line 9819
    const-string v3, "  Persisent processes that are starting:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9820
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "Starting Norm"

    const-string v8, "Restarting PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9824
    :cond_c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_e

    .line 9825
    if-eqz v15, :cond_d

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9826
    :cond_d
    const/4 v15, 0x1

    .line 9827
    const-string v3, "  Processes that are starting:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9828
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "Starting Norm"

    const-string v8, "Starting PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9832
    :cond_e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_10

    .line 9833
    if-eqz v15, :cond_f

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9834
    :cond_f
    const/4 v15, 0x1

    .line 9835
    const-string v3, "  Processes that are being removed:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9836
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "Removed Norm"

    const-string v8, "Removed PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9840
    :cond_10
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_12

    .line 9841
    if-eqz v15, :cond_11

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9842
    :cond_11
    const/4 v15, 0x1

    .line 9843
    const-string v3, "  Processes that are on old until the system is ready:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9844
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "OnHold Norm"

    const-string v8, "OnHold PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9848
    :cond_12
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_14

    .line 9849
    if-eqz v15, :cond_13

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9850
    :cond_13
    const/4 v15, 0x1

    .line 9851
    const-string v3, "  Processes that are waiting to GC:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9852
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v16

    .line 9853
    .local v16, now:J
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-ge v12, v3, :cond_14

    .line 9854
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v12}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/android/server/am/ProcessRecord;

    .line 9855
    .local v19, proc:Lcom/android/server/am/ProcessRecord;
    const-string v3, "    Process "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9856
    const-string v3, "      lowMem="

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v19

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    move v3, v0

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Z)V

    .line 9857
    const-string v3, ", last gced="

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9858
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    move-wide v3, v0

    sub-long v3, v16, v3

    move-object/from16 v0, p2

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 9859
    const-string v3, " ms ago, last lowMem="

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9860
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    move-wide v3, v0

    sub-long v3, v16, v3

    move-object/from16 v0, p2

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 9861
    const-string v3, " ms ago"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9853
    add-int/lit8 v12, v12, 0x1

    goto :goto_4

    .line 9866
    .end local v12           #i:I
    .end local v16           #now:J
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_14
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->size()I

    move-result v3

    if-lez v3, :cond_17

    .line 9867
    if-eqz v15, :cond_15

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9868
    :cond_15
    const/4 v15, 0x1

    .line 9869
    const-string v3, "  Time since processes crashed:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9870
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v16

    .line 9872
    .restart local v16       #now:J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .end local p1
    .restart local v13       #i$:Ljava/util/Iterator;
    :cond_16
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_17

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Ljava/util/Map$Entry;

    .line 9873
    .local v21, procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Landroid/util/SparseArray;

    .line 9874
    .local v23, uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    invoke-virtual/range {v23 .. v23}, Landroid/util/SparseArray;->size()I

    move-result v10

    .line 9875
    .local v10, N:I
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_5
    if-ge v12, v10, :cond_16

    .line 9876
    const-string v3, "    Process "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9877
    const-string v3, " uid "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9878
    const-string v3, ": last crashed "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9879
    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/Long;

    invoke-virtual/range {p1 .. p1}, Ljava/lang/Long;->longValue()J

    move-result-wide v3

    sub-long v3, v16, v3

    move-object/from16 v0, p2

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 9880
    const-string v3, " ms ago"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9875
    add-int/lit8 v12, v12, 0x1

    goto :goto_5

    .line 9885
    .end local v10           #N:I
    .end local v12           #i:I
    .end local v13           #i$:Ljava/util/Iterator;
    .end local v16           #now:J
    .end local v21           #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    .end local v23           #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    :cond_17
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->size()I

    move-result v3

    if-lez v3, :cond_1a

    .line 9886
    if-eqz v15, :cond_18

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9887
    :cond_18
    const/4 v15, 0x1

    .line 9888
    const-string v3, "  Bad processes:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9890
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .restart local v13       #i$:Ljava/util/Iterator;
    :cond_19
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1a

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Ljava/util/Map$Entry;

    .line 9891
    .restart local v21       #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Landroid/util/SparseArray;

    .line 9892
    .restart local v23       #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    invoke-virtual/range {v23 .. v23}, Landroid/util/SparseArray;->size()I

    move-result v10

    .line 9893
    .restart local v10       #N:I
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_6
    if-ge v12, v10, :cond_19

    .line 9894
    const-string v3, "    Bad process "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9895
    const-string v3, " uid "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9896
    const-string v3, ": crashed at time "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9897
    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9893
    add-int/lit8 v12, v12, 0x1

    goto :goto_6

    .line 9902
    .end local v10           #N:I
    .end local v12           #i:I
    .end local v13           #i$:Ljava/util/Iterator;
    .end local v21           #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    .end local v23           #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    :cond_1a
    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9903
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mHomeProcess: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9904
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mConfiguration: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9905
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mConfigWillChange: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9906
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mSleeping="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mShuttingDown="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9907
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v3, v0

    if-nez v3, :cond_1b

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v3, v0

    if-nez v3, :cond_1b

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v3, v0

    if-nez v3, :cond_1b

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v3, v0

    if-eqz v3, :cond_1c

    .line 9909
    :cond_1b
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mDebugApp="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "/orig="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mDebugTransient="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mOrigWaitForDebugger="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9913
    :cond_1c
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    move v3, v0

    if-nez v3, :cond_1d

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v3, v0

    if-eqz v3, :cond_1e

    .line 9914
    :cond_1d
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mAlwaysFinishActivities="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mController="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9917
    :cond_1e
    if-eqz p5, :cond_1f

    .line 9918
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  Total persistent processes: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object v0, v3

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9919
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mStartRunning="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mSystemReady="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mBooting="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mBooted="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mFactoryTest="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9924
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mGoingToSleep="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9925
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mLaunchingActivity="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9926
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mAdjSeq="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mLruSeq="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9929
    :cond_1f
    const/4 v3, 0x1

    return v3
.end method

.method dumpProvidersLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 11
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 10159
    const/4 v4, 0x0

    .line 10161
    .local v4, needSep:Z
    if-eqz p5, :cond_4

    .line 10162
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_2

    .line 10163
    if-eqz v4, :cond_0

    const-string v9, " "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10164
    :cond_0
    const-string v9, "  Published content providers (by class):"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10165
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 10166
    .local v3, it:Ljava/util/Iterator;
    :goto_0
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_1

    .line 10167
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/Map$Entry;

    .line 10168
    .local v0, e:Ljava/util/Map$Entry;
    invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 10169
    .local v7, r:Lcom/android/server/am/ContentProviderRecord;
    const-string v9, "  * "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10170
    const-string v9, "    "

    invoke-virtual {v7, p2, v9}, Lcom/android/server/am/ContentProviderRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 10172
    .end local v0           #e:Ljava/util/Map$Entry;
    .end local v7           #r:Lcom/android/server/am/ContentProviderRecord;
    :cond_1
    const/4 v4, 0x1

    .line 10175
    .end local v3           #it:Ljava/util/Iterator;
    :cond_2
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_4

    .line 10176
    const-string v9, " "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10177
    const-string v9, "  Authority to provider mappings:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10178
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 10179
    .restart local v3       #it:Ljava/util/Iterator;
    :goto_1
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_3

    .line 10180
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/Map$Entry;

    .line 10181
    .restart local v0       #e:Ljava/util/Map$Entry;
    invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 10182
    .restart local v7       #r:Lcom/android/server/am/ContentProviderRecord;
    const-string v9, "  "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface {v0}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v9

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/Object;)V

    const-string v9, ": "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10183
    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    goto :goto_1

    .line 10185
    .end local v0           #e:Ljava/util/Map$Entry;
    .end local v7           #r:Lcom/android/server/am/ContentProviderRecord;
    :cond_3
    const/4 v4, 0x1

    .line 10189
    .end local v3           #it:Ljava/util/Iterator;
    :cond_4
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_7

    .line 10190
    if-eqz v4, :cond_5

    const-string v9, " "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10191
    :cond_5
    const-string v9, "  Launching content providers:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10192
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    const/4 v10, 0x1

    sub-int v1, v9, v10

    .local v1, i:I
    :goto_2
    if-ltz v1, :cond_6

    .line 10193
    const-string v9, "  Launching #"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v9, ": "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10194
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10192
    add-int/lit8 v1, v1, -0x1

    goto :goto_2

    .line 10196
    :cond_6
    const/4 v4, 0x1

    .line 10199
    .end local v1           #i:I
    :cond_7
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9}, Landroid/util/SparseArray;->size()I

    move-result v9

    if-lez v9, :cond_a

    .line 10200
    invoke-virtual {p2}, Ljava/io/PrintWriter;->println()V

    .line 10201
    const-string v9, "Granted Uri Permissions:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10202
    const/4 v1, 0x0

    .restart local v1       #i:I
    :goto_3
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9}, Landroid/util/SparseArray;->size()I

    move-result v9

    if-ge v1, v9, :cond_9

    .line 10203
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v8

    .line 10204
    .local v8, uid:I
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/util/HashMap;

    .line 10206
    .local v6, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    const-string v9, "  * UID "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v8}, Ljava/io/PrintWriter;->print(I)V

    .line 10207
    const-string v9, " holds:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10208
    invoke-virtual {v6}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :goto_4
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_8

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/UriPermission;

    .line 10209
    .local v5, perm:Lcom/android/server/am/UriPermission;
    const-string v9, "    "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10210
    const-string v9, "      "

    invoke-virtual {v5, p2, v9}, Lcom/android/server/am/UriPermission;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_4

    .line 10202
    .end local v5           #perm:Lcom/android/server/am/UriPermission;
    :cond_8
    add-int/lit8 v1, v1, 0x1

    goto :goto_3

    .line 10213
    .end local v2           #i$:Ljava/util/Iterator;
    .end local v6           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    .end local v8           #uid:I
    :cond_9
    const/4 v4, 0x1

    .line 10216
    .end local v1           #i:I
    :cond_a
    return v4
.end method

.method protected dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)V
    .locals 8
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 9945
    array-length v6, p3

    if-lt p4, v6, :cond_2

    .line 9946
    const/4 v1, 0x0

    .line 9947
    .local v1, componentNameString:Ljava/lang/String;
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->EMPTY_STRING_ARRAY:[Ljava/lang/String;

    .line 9948
    .local v3, newArgs:[Ljava/lang/String;
    const/4 v4, 0x0

    .line 9958
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    :goto_0
    if-eqz v4, :cond_4

    .line 9959
    invoke-direct {p0, p1, p2, v4, v3}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V

    .line 9968
    :cond_1
    return-void

    .line 9950
    .end local v1           #componentNameString:Ljava/lang/String;
    .end local v3           #newArgs:[Ljava/lang/String;
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_2
    aget-object v1, p3, p4

    .line 9951
    .restart local v1       #componentNameString:Ljava/lang/String;
    add-int/lit8 p4, p4, 0x1

    .line 9952
    invoke-static {v1}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;

    move-result-object v0

    .line 9953
    .local v0, componentName:Landroid/content/ComponentName;
    if-eqz v0, :cond_3

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v6, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ServiceRecord;

    move-object v4, v6

    .line 9954
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    :goto_1
    array-length v6, p3

    sub-int/2addr v6, p4

    new-array v3, v6, [Ljava/lang/String;

    .line 9955
    .restart local v3       #newArgs:[Ljava/lang/String;
    array-length v6, p3

    const/4 v7, 0x2

    if-le v6, v7, :cond_0

    const/4 v6, 0x0

    array-length v7, p3

    sub-int/2addr v7, p4

    invoke-static {p3, p4, v3, v6, v7}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    goto :goto_0

    .line 9953
    .end local v3           #newArgs:[Ljava/lang/String;
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_3
    const/4 v6, 0x0

    move-object v4, v6

    goto :goto_1

    .line 9961
    .end local v0           #componentName:Landroid/content/ComponentName;
    .restart local v3       #newArgs:[Ljava/lang/String;
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    :cond_4
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v6

    invoke-interface {v6}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :cond_5
    :goto_2
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_1

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 9962
    .local v5, r1:Lcom/android/server/am/ServiceRecord;
    if-eqz v1, :cond_6

    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v6}, Landroid/content/ComponentName;->flattenToString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6, v1}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v6

    if-eqz v6, :cond_5

    .line 9964
    :cond_6
    invoke-direct {p0, p1, p2, v5, v3}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V

    goto :goto_2
.end method

.method dumpServicesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 9
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    const-string v8, "  * "

    const-string v7, " "

    const-string v6, "    "

    .line 10091
    const/4 v3, 0x0

    .line 10093
    .local v3, needSep:Z
    if-eqz p5, :cond_1

    .line 10094
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_1

    .line 10095
    const-string v5, "  Active services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10096
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 10097
    .local v2, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_0

    .line 10098
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10099
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * "

    invoke-virtual {p2, v8}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10100
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 10102
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    const/4 v3, 0x1

    .line 10106
    .end local v2           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :cond_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_4

    .line 10107
    if-eqz v3, :cond_2

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10108
    :cond_2
    const-string v5, "  Pending services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10109
    const/4 v0, 0x0

    .local v0, i:I
    :goto_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_3

    .line 10110
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10111
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Pending "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10112
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10109
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 10114
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_3
    const/4 v3, 0x1

    .line 10117
    .end local v0           #i:I
    :cond_4
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_7

    .line 10118
    if-eqz v3, :cond_5

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10119
    :cond_5
    const-string v5, "  Restarting services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10120
    const/4 v0, 0x0

    .restart local v0       #i:I
    :goto_2
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_6

    .line 10121
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10122
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Restarting "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10123
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10120
    add-int/lit8 v0, v0, 0x1

    goto :goto_2

    .line 10125
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_6
    const/4 v3, 0x1

    .line 10128
    .end local v0           #i:I
    :cond_7
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_a

    .line 10129
    if-eqz v3, :cond_8

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10130
    :cond_8
    const-string v5, "  Stopping services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10131
    const/4 v0, 0x0

    .restart local v0       #i:I
    :goto_3
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_9

    .line 10132
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10133
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Stopping "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10134
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10131
    add-int/lit8 v0, v0, 0x1

    goto :goto_3

    .line 10136
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_9
    const/4 v3, 0x1

    .line 10139
    .end local v0           #i:I
    :cond_a
    if-eqz p5, :cond_d

    .line 10140
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_d

    .line 10141
    if-eqz v3, :cond_b

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10142
    :cond_b
    const-string v5, "  Connection bindings to services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10143
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 10145
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_4
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_c

    .line 10146
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ConnectionRecord;

    .line 10147
    .local v4, r:Lcom/android/server/am/ConnectionRecord;
    const-string v5, "  * "

    invoke-virtual {p2, v8}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10148
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ConnectionRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_4

    .line 10150
    .end local v4           #r:Lcom/android/server/am/ConnectionRecord;
    :cond_c
    const/4 v3, 0x1

    .line 10154
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_d
    return v3
.end method

.method enableScreenAfterBoot()V
    .locals 3

    .prologue
    .line 5737
    const/16 v0, 0xbea

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    invoke-static {v0, v1, v2}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 5739
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v0}, Lcom/android/server/WindowManagerService;->enableScreenAfterBoot()V

    .line 5740
    return-void
.end method

.method enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V
    .locals 3
    .parameter "permission"
    .parameter "func"

    .prologue
    .line 6369
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v1

    if-nez v1, :cond_0

    .line 6371
    return-void

    .line 6374
    :cond_0
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Permission Denial: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " from pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", uid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " requires "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 6378
    .local v0, msg:Ljava/lang/String;
    const-string v1, "ActivityManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6379
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, v0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method final ensureBootCompleted()V
    .locals 5

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 5924
    monitor-enter p0

    .line 5925
    :try_start_0
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 5926
    .local v0, booting:Z
    const/4 v2, 0x0

    iput-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 5927
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    if-nez v2, :cond_2

    move v1, v4

    .line 5928
    .local v1, enableScreen:Z
    :goto_0
    const/4 v2, 0x1

    iput-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 5929
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5931
    if-eqz v0, :cond_0

    .line 5932
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->finishBooting()V

    .line 5935
    :cond_0
    if-eqz v1, :cond_1

    .line 5936
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->enableScreenAfterBoot()V

    .line 5938
    :cond_1
    return-void

    .end local v1           #enableScreen:Z
    :cond_2
    move v1, v3

    .line 5927
    goto :goto_0

    .line 5929
    .end local v0           #booting:Z
    :catchall_0
    move-exception v2

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v2
.end method

.method public final enterSafeMode()V
    .locals 5

    .prologue
    .line 8476
    monitor-enter p0

    .line 8479
    :try_start_0
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    if-nez v2, :cond_0

    .line 8481
    :try_start_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    invoke-interface {v2}, Landroid/content/pm/IPackageManager;->enterSafeMode()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 8485
    :goto_0
    :try_start_2
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-static {v2}, Landroid/view/LayoutInflater;->from(Landroid/content/Context;)Landroid/view/LayoutInflater;

    move-result-object v2

    const v3, 0x1090053

    const/4 v4, 0x0

    invoke-virtual {v2, v3, v4}, Landroid/view/LayoutInflater;->inflate(ILandroid/view/ViewGroup;)Landroid/view/View;

    move-result-object v1

    .line 8487
    .local v1, v:Landroid/view/View;
    new-instance v0, Landroid/view/WindowManager$LayoutParams;

    invoke-direct {v0}, Landroid/view/WindowManager$LayoutParams;-><init>()V

    .line 8488
    .local v0, lp:Landroid/view/WindowManager$LayoutParams;
    const/16 v2, 0x7d6

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->type:I

    .line 8489
    const/4 v2, -0x2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->width:I

    .line 8490
    const/4 v2, -0x2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->height:I

    .line 8491
    const/16 v2, 0x53

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->gravity:I

    .line 8492
    invoke-virtual {v1}, Landroid/view/View;->getBackground()Landroid/graphics/drawable/Drawable;

    move-result-object v2

    invoke-virtual {v2}, Landroid/graphics/drawable/Drawable;->getOpacity()I

    move-result v2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->format:I

    .line 8493
    const/16 v2, 0x18

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->flags:I

    .line 8495
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    const-string v3, "window"

    invoke-virtual {v2, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/view/WindowManager;

    invoke-interface {v2, v1, v0}, Landroid/view/WindowManager;->addView(Landroid/view/View;Landroid/view/ViewGroup$LayoutParams;)V

    .line 8498
    .end local v0           #lp:Landroid/view/WindowManager$LayoutParams;
    .end local v1           #v:Landroid/view/View;
    :cond_0
    monitor-exit p0

    .line 8499
    return-void

    .line 8498
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 8482
    :catch_0
    move-exception v2

    goto :goto_0
.end method

.method public final finishActivity(Landroid/os/IBinder;ILandroid/content/Intent;)Z
    .locals 9
    .parameter "token"
    .parameter "resultCode"
    .parameter "resultData"

    .prologue
    const/4 v8, 0x0

    .line 4295
    if-eqz p3, :cond_0

    invoke-virtual {p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v6

    const/4 v7, 0x1

    if-ne v6, v7, :cond_0

    .line 4296
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "File descriptors passed in Intent"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 4299
    :cond_0
    monitor-enter p0

    .line 4300
    :try_start_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v6, :cond_1

    .line 4302
    const/4 v6, 0x0

    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-object v1

    .line 4303
    .local v1, next:Lcom/android/server/am/HistoryRecord;
    if-eqz v1, :cond_1

    .line 4305
    const/4 v5, 0x1

    .line 4307
    .local v5, resumeOK:Z
    :try_start_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    iget-object v7, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-interface {v6, v7}, Landroid/app/IActivityController;->activityResuming(Ljava/lang/String;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v5

    .line 4312
    :goto_0
    if-nez v5, :cond_1

    .line 4313
    :try_start_2
    monitor-exit p0

    move v6, v8

    .line 4321
    .end local v1           #next:Lcom/android/server/am/HistoryRecord;
    .end local v5           #resumeOK:Z
    :goto_1
    return v6

    .line 4308
    .restart local v1       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v5       #resumeOK:Z
    :catch_0
    move-exception v6

    move-object v0, v6

    .line 4309
    .local v0, e:Landroid/os/RemoteException;
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_0

    .line 4322
    .end local v0           #e:Landroid/os/RemoteException;
    .end local v1           #next:Lcom/android/server/am/HistoryRecord;
    .end local v5           #resumeOK:Z
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v6

    .line 4317
    :cond_1
    :try_start_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 4318
    .local v2, origId:J
    const-string v6, "app-request"

    invoke-direct {p0, p1, p2, p3, v6}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v4

    .line 4320
    .local v4, res:Z
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4321
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move v6, v4

    goto :goto_1
.end method

.method final finishBooting()V
    .locals 22

    .prologue
    .line 5879
    new-instance v20, Landroid/content/IntentFilter;

    invoke-direct/range {v20 .. v20}, Landroid/content/IntentFilter;-><init>()V

    .line 5880
    .local v20, pkgFilter:Landroid/content/IntentFilter;
    const-string v4, "android.intent.action.QUERY_PACKAGE_RESTART"

    move-object/from16 v0, v20

    move-object v1, v4

    invoke-virtual {v0, v1}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V

    .line 5881
    const-string v4, "package"

    move-object/from16 v0, v20

    move-object v1, v4

    invoke-virtual {v0, v1}, Landroid/content/IntentFilter;->addDataScheme(Ljava/lang/String;)V

    .line 5882
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    new-instance v5, Lcom/android/server/am/ActivityManagerService$5;

    move-object v0, v5

    move-object/from16 v1, p0

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService$5;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    move-object v0, v4

    move-object v1, v5

    move-object/from16 v2, v20

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;

    .line 5897
    monitor-enter p0

    .line 5900
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v18

    .line 5901
    .local v18, NP:I
    if-lez v18, :cond_0

    .line 5902
    new-instance v21, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    move-object/from16 v0, v21

    move-object v1, v4

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    .line 5904
    .local v21, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    const/16 v19, 0x0

    .local v19, ip:I
    :goto_0
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_0

    .line 5905
    move-object/from16 v0, v21

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ProcessRecord;

    const-string v5, "on-hold"

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5904
    add-int/lit8 v19, v19, 0x1

    goto :goto_0

    .line 5909
    .end local v19           #ip:I
    .end local v21           #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_0
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x1

    if-eq v4, v5, :cond_1

    .line 5911
    const/4 v5, 0x0

    const/4 v6, 0x0

    new-instance v7, Landroid/content/Intent;

    const-string v4, "android.intent.action.BOOT_COMPLETED"

    const/4 v8, 0x0

    invoke-direct {v7, v4, v8}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const-string v13, "android.permission.RECEIVE_BOOT_COMPLETED"

    const/4 v14, 0x0

    const/4 v15, 0x0

    sget v16, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v17, 0x3e8

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5916
    const-string v4, "ActivityManager"

    const-string v5, "!@bootcomplete"

    invoke-static {v4, v5}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5918
    :cond_1
    monitor-exit p0

    .line 5919
    return-void

    .line 5918
    .end local v18           #NP:I
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method public finishInstrumentation(Landroid/app/IApplicationThread;ILandroid/os/Bundle;)V
    .locals 6
    .parameter "target"
    .parameter "resultCode"
    .parameter "results"

    .prologue
    .line 13482
    if-eqz p3, :cond_0

    invoke-virtual {p3}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v3

    if-eqz v3, :cond_0

    .line 13483
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "File descriptors passed in Intent"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 13486
    :cond_0
    monitor-enter p0

    .line 13487
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 13488
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_1

    .line 13489
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "finishInstrumentation: no app for "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13490
    monitor-exit p0

    .line 13496
    :goto_0
    return-void

    .line 13492
    :cond_1
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 13493
    .local v1, origId:J
    invoke-virtual {p0, v0, p2, p3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 13494
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13495
    monitor-exit p0

    goto :goto_0

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #origId:J
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V
    .locals 6
    .parameter "app"
    .parameter "resultCode"
    .parameter "results"

    .prologue
    const/4 v3, 0x0

    const/4 v2, 0x0

    .line 13460
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    if-eqz v0, :cond_0

    .line 13463
    :try_start_0
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    invoke-interface {v0, v1, p2, p3}, Landroid/app/IInstrumentationWatcher;->instrumentationFinished(Landroid/content/ComponentName;ILandroid/os/Bundle;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13470
    :cond_0
    :goto_0
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    .line 13471
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    .line 13472
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    .line 13473
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    .line 13474
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    .line 13476
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    const/4 v2, -0x1

    const/4 v5, 0x1

    move-object v0, p0

    move v4, v3

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 13477
    return-void

    .line 13467
    :catch_0
    move-exception v0

    goto :goto_0
.end method

.method public finishOtherInstances(Landroid/os/IBinder;Landroid/content/ComponentName;)V
    .locals 10
    .parameter "token"
    .parameter "className"

    .prologue
    .line 7644
    monitor-enter p0

    .line 7645
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 7647
    .local v8, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 7648
    .local v6, N:I
    const/4 v7, 0x0

    .line 7649
    .local v7, lastTask:Lcom/android/server/am/TaskRecord;
    const/4 v2, 0x0

    .local v2, i:I
    :goto_0
    if-ge v2, v6, :cond_1

    .line 7650
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 7651
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, p2}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_0

    if-eq v1, p1, :cond_0

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v7, v0, :cond_0

    .line 7653
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "others"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_0

    .line 7655
    add-int/lit8 v2, v2, -0x1

    .line 7656
    add-int/lit8 v6, v6, -0x1

    .line 7659
    :cond_0
    iget-object v7, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7649
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 7662
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7663
    monitor-exit p0

    .line 7664
    return-void

    .line 7663
    .end local v2           #i:I
    .end local v6           #N:I
    .end local v7           #lastTask:Lcom/android/server/am/TaskRecord;
    .end local v8           #origId:J
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public finishReceiver(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;Z)V
    .locals 10
    .parameter "who"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "resultExtras"
    .parameter "resultAbort"

    .prologue
    .line 12844
    if-eqz p4, :cond_0

    invoke-virtual {p4}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 12845
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string v1, "File descriptors passed in Bundle"

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 12850
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 12852
    .local v8, origId:J
    monitor-enter p0

    .line 12853
    const/4 v6, 0x1

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move-object v3, p3

    move-object v4, p4

    move v5, p5

    :try_start_0
    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    move-result v7

    .line 12855
    .local v7, doNext:Z
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12857
    if-eqz v7, :cond_1

    .line 12858
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    .line 12860
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 12862
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12863
    return-void

    .line 12855
    .end local v7           #doNext:Z
    :catchall_0
    move-exception v0

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v0
.end method

.method public final finishSubActivity(Landroid/os/IBinder;Ljava/lang/String;I)V
    .locals 10
    .parameter "token"
    .parameter "resultWho"
    .parameter "requestCode"

    .prologue
    .line 4353
    monitor-enter p0

    .line 4354
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v6

    .line 4355
    .local v6, index:I
    if-gez v6, :cond_0

    .line 4356
    monitor-exit p0

    .line 4376
    :goto_0
    return-void

    .line 4358
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 4360
    .local v9, self:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v7

    .line 4363
    .local v7, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v3, 0x1

    sub-int v2, v0, v3

    .local v2, i:I
    :goto_1
    if-ltz v2, :cond_4

    .line 4364
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4365
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    if-ne v0, v9, :cond_3

    iget v0, v1, Lcom/android/server/am/HistoryRecord;->requestCode:I

    if-ne v0, p3, :cond_3

    .line 4366
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    if-nez v0, :cond_1

    if-eqz p2, :cond_2

    :cond_1
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    if-eqz v0, :cond_3

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    invoke-virtual {v0, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_3

    .line 4368
    :cond_2
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "request-sub"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 4363
    :cond_3
    add-int/lit8 v2, v2, -0x1

    goto :goto_1

    .line 4374
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4375
    monitor-exit p0

    goto :goto_0

    .end local v2           #i:I
    .end local v6           #index:I
    .end local v7           #origId:J
    .end local v9           #self:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public forceStopPackage(Ljava/lang/String;)V
    .locals 9
    .parameter "packageName"

    .prologue
    const-string v8, "android.permission.FORCE_STOP_PACKAGES"

    const-string v7, "ActivityManager"

    .line 5120
    const-string v5, "android.permission.FORCE_STOP_PACKAGES"

    invoke-virtual {p0, v8}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_0

    .line 5122
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: forceStopPackage() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.FORCE_STOP_PACKAGES"

    invoke-virtual {v5, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 5126
    .local v2, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    invoke-static {v7, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5127
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 5130
    .end local v2           #msg:Ljava/lang/String;
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5132
    .local v0, callingId:J
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    .line 5133
    .local v4, pm:Landroid/content/pm/IPackageManager;
    const/4 v3, -0x1

    .line 5134
    .local v3, pkgUid:I
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 5136
    :try_start_1
    invoke-interface {v4, p1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v3

    .line 5139
    :goto_0
    const/4 v5, -0x1

    if-ne v3, v5, :cond_1

    .line 5140
    :try_start_2
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Invalid packageName: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5141
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5146
    :goto_1
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5148
    return-void

    .line 5143
    :cond_1
    :try_start_3
    invoke-direct {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;I)V

    .line 5144
    monitor-exit p0

    goto :goto_1

    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 5146
    .end local v3           #pkgUid:I
    .end local v4           #pm:Landroid/content/pm/IPackageManager;
    :catchall_1
    move-exception v5

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v5

    .line 5137
    .restart local v3       #pkgUid:I
    .restart local v4       #pm:Landroid/content/pm/IPackageManager;
    :catch_0
    move-exception v5

    goto :goto_0
.end method

.method foregroundTokenDied(Lcom/android/server/am/ActivityManagerService$ForegroundToken;)V
    .locals 5
    .parameter "token"

    .prologue
    .line 6220
    monitor-enter p0

    .line 6221
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6222
    :try_start_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ActivityManagerService$ForegroundToken;

    .line 6224
    .local v0, cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    if-eq v0, p1, :cond_0

    .line 6225
    monitor-exit v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 6237
    :goto_0
    return-void

    .line 6227
    :cond_0
    :try_start_3
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->remove(I)V

    .line 6228
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 6229
    .local v1, pr:Lcom/android/server/am/ProcessRecord;
    if-nez v1, :cond_1

    .line 6230
    monitor-exit v2
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    :try_start_4
    monitor-exit p0

    goto :goto_0

    .line 6236
    .end local v0           #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v1           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v2

    .line 6232
    .restart local v0       #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v1       #pr:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/4 v3, 0x0

    :try_start_5
    iput-object v3, v1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 6233
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 6234
    monitor-exit v2
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 6235
    :try_start_6
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 6236
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    goto :goto_0

    .line 6234
    .end local v0           #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v1           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_1
    move-exception v3

    :try_start_7
    monitor-exit v2
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    :try_start_8
    throw v3
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0
.end method

.method public getActivityClassForToken(Landroid/os/IBinder;)Landroid/content/ComponentName;
    .locals 3
    .parameter "token"

    .prologue
    .line 6058
    monitor-enter p0

    .line 6059
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6060
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6061
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 6062
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    monitor-exit p0

    .line 6064
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v2

    :cond_0
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_0

    .line 6065
    .end local v0           #index:I
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public getCallingActivity(Landroid/os/IBinder;)Landroid/content/ComponentName;
    .locals 2
    .parameter "token"

    .prologue
    .line 6040
    monitor-enter p0

    .line 6041
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 6042
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    :goto_0
    monitor-exit p0

    return-object v1

    :cond_0
    const/4 v1, 0x0

    goto :goto_0

    .line 6043
    .end local v0           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public getCallingPackage(Landroid/os/IBinder;)Ljava/lang/String;
    .locals 2
    .parameter "token"

    .prologue
    .line 6033
    monitor-enter p0

    .line 6034
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 6035
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    :goto_0
    monitor-exit p0

    return-object v1

    :cond_0
    const/4 v1, 0x0

    goto :goto_0

    .line 6036
    .end local v0           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public getConfiguration()Landroid/content/res/Configuration;
    .locals 2

    .prologue
    .line 13523
    monitor-enter p0

    .line 13524
    :try_start_0
    new-instance v0, Landroid/content/res/Configuration;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-direct {v0, v1}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    .line 13525
    .local v0, ci:Landroid/content/res/Configuration;
    monitor-exit p0

    .line 13526
    return-object v0

    .line 13525
    .end local v0           #ci:Landroid/content/res/Configuration;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public final getContentProvider(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .locals 3
    .parameter "caller"
    .parameter "name"

    .prologue
    .line 8033
    if-nez p1, :cond_0

    .line 8034
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "null IApplicationThread when getting content provider "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 8036
    .local v0, msg:Ljava/lang/String;
    const-string v1, "ActivityManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8037
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, v0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 8040
    .end local v0           #msg:Ljava/lang/String;
    :cond_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v1

    return-object v1
.end method

.method public getDeviceConfigurationInfo()Landroid/content/pm/ConfigurationInfo;
    .locals 3

    .prologue
    .line 13503
    new-instance v0, Landroid/content/pm/ConfigurationInfo;

    invoke-direct {v0}, Landroid/content/pm/ConfigurationInfo;-><init>()V

    .line 13504
    .local v0, config:Landroid/content/pm/ConfigurationInfo;
    monitor-enter p0

    .line 13505
    :try_start_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->touchscreen:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqTouchScreen:I

    .line 13506
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqKeyboardType:I

    .line 13507
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqNavigation:I

    .line 13508
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    const/4 v2, 0x2

    if-eq v1, v2, :cond_0

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    const/4 v2, 0x3

    if-ne v1, v2, :cond_1

    .line 13510
    :cond_0
    iget v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    or-int/lit8 v1, v1, 0x2

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    .line 13512
    :cond_1
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    if-eqz v1, :cond_2

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    const/4 v2, 0x1

    if-eq v1, v2, :cond_2

    .line 13514
    iget v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    or-int/lit8 v1, v1, 0x1

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    .line 13516
    :cond_2
    iget v1, p0, Lcom/android/server/am/ActivityManagerService;->GL_ES_VERSION:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqGlEsVersion:I

    .line 13517
    monitor-exit p0

    .line 13518
    return-object v0

    .line 13517
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public getIntentSender(ILjava/lang/String;Landroid/os/IBinder;Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;I)Landroid/content/IIntentSender;
    .locals 23
    .parameter "type"
    .parameter "packageName"
    .parameter "token"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "flags"

    .prologue
    .line 6083
    if-eqz p6, :cond_0

    invoke-virtual/range {p6 .. p6}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v5

    const/4 v6, 0x1

    if-ne v5, v6, :cond_0

    .line 6084
    new-instance v5, Ljava/lang/IllegalArgumentException;

    const-string v6, "File descriptors passed in Intent"

    invoke-direct {v5, v6}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 6087
    :cond_0
    const/4 v5, 0x1

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_1

    .line 6088
    invoke-virtual/range {p6 .. p6}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v6, 0x800

    and-int/2addr v5, v6

    if-eqz v5, :cond_1

    .line 6089
    new-instance v5, Ljava/lang/IllegalArgumentException;

    const-string v6, "Can\'t use FLAG_RECEIVER_BOOT_UPGRADE here"

    invoke-direct {v5, v6}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 6094
    :cond_1
    monitor-enter p0

    .line 6095
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result v13

    .line 6097
    .local v13, callingUid:I
    if-eqz v13, :cond_2

    const/16 v5, 0x3e8

    if-eq v13, v5, :cond_2

    :try_start_1
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v5

    if-eqz v5, :cond_2

    .line 6099
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I

    move-result v21

    .line 6101
    .local v21, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    move/from16 v0, v21

    move v1, v5

    if-eq v0, v1, :cond_2

    .line 6102
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: getIntentSender() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", (need uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is not allowed to send as package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    .line 6107
    .local v17, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6108
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 6111
    .end local v17           #msg:Ljava/lang/String;
    .end local v21           #uid:I
    :catch_0
    move-exception v5

    move-object v15, v5

    .line 6112
    .local v15, e:Landroid/os/RemoteException;
    :try_start_2
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v15}, Ljava/lang/SecurityException;-><init>(Ljava/lang/Throwable;)V

    throw v5

    .line 6161
    .end local v13           #callingUid:I
    .end local v15           #e:Landroid/os/RemoteException;
    .end local p2
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v5

    .line 6114
    .restart local v13       #callingUid:I
    .restart local p2
    :cond_2
    const/4 v7, 0x0

    .line 6115
    .local v7, activity:Lcom/android/server/am/HistoryRecord;
    const/4 v5, 0x3

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_4

    .line 6116
    :try_start_3
    move-object/from16 v0, p0

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v16

    .line 6117
    .local v16, index:I
    if-gez v16, :cond_3

    .line 6118
    const/4 v5, 0x0

    monitor-exit p0

    .line 6160
    .end local v16           #index:I
    .end local p2
    :goto_0
    return-object v5

    .line 6120
    .restart local v16       #index:I
    .restart local p2
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    .end local v7           #activity:Lcom/android/server/am/HistoryRecord;
    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 6121
    .restart local v7       #activity:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v7, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_4

    .line 6122
    const/4 v5, 0x0

    monitor-exit p0

    goto :goto_0

    .line 6126
    .end local v16           #index:I
    :cond_4
    const/high16 v5, 0x2000

    and-int v5, v5, p8

    if-eqz v5, :cond_6

    const/4 v5, 0x1

    move/from16 v18, v5

    .line 6127
    .local v18, noCreate:Z
    :goto_1
    const/high16 v5, 0x1000

    and-int v5, v5, p8

    if-eqz v5, :cond_7

    const/4 v5, 0x1

    move v14, v5

    .line 6128
    .local v14, cancelCurrent:Z
    :goto_2
    const/high16 v5, 0x800

    and-int v5, v5, p8

    if-eqz v5, :cond_8

    const/4 v5, 0x1

    move/from16 v22, v5

    .line 6129
    .local v22, updateCurrent:Z
    :goto_3
    const v5, -0x38000001

    and-int p8, p8, v5

    .line 6132
    new-instance v4, Lcom/android/server/am/PendingIntentRecord$Key;

    move/from16 v5, p1

    move-object/from16 v6, p2

    move-object/from16 v8, p4

    move/from16 v9, p5

    move-object/from16 v10, p6

    move-object/from16 v11, p7

    move/from16 v12, p8

    invoke-direct/range {v4 .. v12}, Lcom/android/server/am/PendingIntentRecord$Key;-><init>(ILjava/lang/String;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;I)V

    .line 6136
    .local v4, key:Lcom/android/server/am/PendingIntentRecord$Key;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual {v5, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Ljava/lang/ref/WeakReference;

    .line 6137
    .local v20, ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    if-eqz v20, :cond_9

    invoke-virtual/range {v20 .. v20}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/PendingIntentRecord;

    move-object/from16 v19, p2

    .line 6138
    .local v19, rec:Lcom/android/server/am/PendingIntentRecord;
    :goto_4
    if-eqz v19, :cond_b

    .line 6139
    if-nez v14, :cond_a

    .line 6140
    if-eqz v22, :cond_5

    .line 6141
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/PendingIntentRecord$Key;->requestIntent:Landroid/content/Intent;

    move-object v0, v5

    move-object/from16 v1, p6

    invoke-virtual {v0, v1}, Landroid/content/Intent;->replaceExtras(Landroid/content/Intent;)Landroid/content/Intent;

    .line 6143
    :cond_5
    monitor-exit p0

    move-object/from16 v5, v19

    goto :goto_0

    .line 6126
    .end local v4           #key:Lcom/android/server/am/PendingIntentRecord$Key;
    .end local v14           #cancelCurrent:Z
    .end local v18           #noCreate:Z
    .end local v19           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v20           #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .end local v22           #updateCurrent:Z
    .restart local p2
    :cond_6
    const/4 v5, 0x0

    move/from16 v18, v5

    goto :goto_1

    .line 6127
    .restart local v18       #noCreate:Z
    :cond_7
    const/4 v5, 0x0

    move v14, v5

    goto :goto_2

    .line 6128
    .restart local v14       #cancelCurrent:Z
    :cond_8
    const/4 v5, 0x0

    move/from16 v22, v5

    goto :goto_3

    .line 6137
    .restart local v4       #key:Lcom/android/server/am/PendingIntentRecord$Key;
    .restart local v20       #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .restart local v22       #updateCurrent:Z
    :cond_9
    const/4 v5, 0x0

    move-object/from16 v19, v5

    goto :goto_4

    .line 6145
    .end local p2
    .restart local v19       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_a
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v19

    iput-boolean v0, v1, Lcom/android/server/am/PendingIntentRecord;->canceled:Z

    .line 6146
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual {v5, v4}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6148
    :cond_b
    if-eqz v18, :cond_c

    .line 6149
    monitor-exit p0

    move-object/from16 v5, v19

    goto/16 :goto_0

    .line 6151
    :cond_c
    new-instance v19, Lcom/android/server/am/PendingIntentRecord;

    .end local v19           #rec:Lcom/android/server/am/PendingIntentRecord;
    move-object/from16 v0, v19

    move-object/from16 v1, p0

    move-object v2, v4

    move v3, v13

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/PendingIntentRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/PendingIntentRecord$Key;I)V

    .line 6152
    .restart local v19       #rec:Lcom/android/server/am/PendingIntentRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    move-object v6, v0

    invoke-virtual {v5, v4, v6}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 6153
    const/4 v5, 0x3

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_e

    .line 6154
    iget-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    if-nez v5, :cond_d

    .line 6155
    new-instance v5, Ljava/util/HashSet;

    invoke-direct {v5}, Ljava/util/HashSet;-><init>()V

    iput-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 6158
    :cond_d
    iget-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6160
    :cond_e
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move-object/from16 v5, v19

    goto/16 :goto_0
.end method

.method public getMemoryInfo(Landroid/app/ActivityManager$MemoryInfo;)V
    .locals 5
    .parameter "outInfo"

    .prologue
    .line 6788
    invoke-static {}, Landroid/os/Process;->getFreeMemory()J

    move-result-wide v0

    iput-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->availMem:J

    .line 6789
    sget v0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    int-to-long v0, v0

    iput-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->threshold:J

    .line 6790
    iget-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->availMem:J

    sget v2, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MEM:I

    sget v4, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    sub-int/2addr v3, v4

    div-int/lit8 v3, v3, 0x2

    add-int/2addr v2, v3

    int-to-long v2, v2

    cmp-long v0, v0, v2

    if-gez v0, :cond_0

    const/4 v0, 0x1

    :goto_0
    iput-boolean v0, p1, Landroid/app/ActivityManager$MemoryInfo;->lowMemory:Z

    .line 6792
    return-void

    .line 6790
    :cond_0
    const/4 v0, 0x0

    goto :goto_0
.end method

.method public getPackageForIntentSender(Landroid/content/IIntentSender;)Ljava/lang/String;
    .locals 4
    .parameter "pendingResult"

    .prologue
    const/4 v3, 0x0

    .line 6198
    instance-of v2, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v2, :cond_0

    move-object v2, v3

    .line 6206
    :goto_0
    return-object v2

    .line 6202
    :cond_0
    :try_start_0
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v1, v0

    .line 6203
    .local v1, res:Lcom/android/server/am/PendingIntentRecord;
    iget-object v2, v1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v2, v2, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;
    :try_end_0
    .catch Ljava/lang/ClassCastException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 6204
    .end local v1           #res:Lcom/android/server/am/PendingIntentRecord;
    :catch_0
    move-exception v2

    move-object v2, v3

    .line 6206
    goto :goto_0
.end method

.method public getPackageForToken(Landroid/os/IBinder;)Ljava/lang/String;
    .locals 3
    .parameter "token"

    .prologue
    .line 6069
    monitor-enter p0

    .line 6070
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6071
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6072
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 6073
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    monitor-exit p0

    .line 6075
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v2

    :cond_0
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_0

    .line 6076
    .end local v0           #index:I
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public getProcessLimit()I
    .locals 1

    .prologue
    .line 6216
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    return v0
.end method

.method public getProcessMemoryInfo([I)[Landroid/os/Debug$MemoryInfo;
    .locals 4
    .parameter "pids"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 5218
    array-length v2, p1

    new-array v1, v2, [Landroid/os/Debug$MemoryInfo;

    .line 5219
    .local v1, infos:[Landroid/os/Debug$MemoryInfo;
    array-length v2, p1

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_0

    .line 5220
    new-instance v2, Landroid/os/Debug$MemoryInfo;

    invoke-direct {v2}, Landroid/os/Debug$MemoryInfo;-><init>()V

    aput-object v2, v1, v0

    .line 5221
    aget v2, p1, v0

    aget-object v3, v1, v0

    invoke-static {v2, v3}, Landroid/os/Debug;->getMemoryInfo(ILandroid/os/Debug$MemoryInfo;)V

    .line 5219
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 5223
    :cond_0
    return-object v1
.end method

.method public getProcessesInErrorState()Ljava/util/List;
    .locals 8
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$ProcessErrorStateInfo;",
            ">;"
        }
    .end annotation

    .prologue
    const/4 v6, 0x1

    .line 9469
    const/4 v1, 0x0

    .line 9471
    .local v1, errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    monitor-enter p0

    .line 9474
    :try_start_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result v5

    sub-int v3, v5, v6

    .local v3, i:I
    move-object v2, v1

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .local v2, errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :goto_0
    if-ltz v3, :cond_5

    .line 9475
    :try_start_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 9476
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    iget-object v5, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_4

    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v5, :cond_0

    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v5, :cond_4

    .line 9479
    :cond_0
    const/4 v4, 0x0

    .line 9480
    .local v4, report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v5, :cond_2

    .line 9481
    iget-object v4, v0, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 9486
    :cond_1
    :goto_1
    if-eqz v4, :cond_3

    .line 9487
    if-nez v2, :cond_6

    .line 9488
    new-instance v1, Ljava/util/ArrayList;

    const/4 v5, 0x1

    invoke-direct {v1, v5}, Ljava/util/ArrayList;-><init>(I)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 9490
    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :goto_2
    :try_start_2
    invoke-interface {v1, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 9474
    .end local v4           #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :goto_3
    add-int/lit8 v3, v3, -0x1

    move-object v2, v1

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_0

    .line 9482
    .restart local v4       #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_2
    :try_start_3
    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v5, :cond_1

    .line 9483
    iget-object v4, v0, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    goto :goto_1

    .line 9492
    :cond_3
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Missing app error report, app = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " crashing = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-boolean v7, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " notResponding = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-boolean v7, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .end local v4           #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_4
    move-object v1, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_3

    .line 9498
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :cond_5
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 9500
    return-object v2

    .line 9498
    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .end local v3           #i:I
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :catchall_0
    move-exception v5

    :goto_4
    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v5

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v3       #i:I
    :catchall_1
    move-exception v5

    move-object v1, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_4

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v4       #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_6
    move-object v1, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_2
.end method

.method public getRecentTasks(II)Ljava/util/List;
    .locals 9
    .parameter "maxNum"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RecentTaskInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 6938
    monitor-enter p0

    .line 6939
    :try_start_0
    const-string v6, "android.permission.GET_TASKS"

    const-string v7, "getRecentTasks()"

    invoke-virtual {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6942
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    .line 6944
    .local v2, pm:Landroid/content/pm/IPackageManager;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 6945
    .local v0, N:I
    new-instance v3, Ljava/util/ArrayList;

    if-ge p1, v0, :cond_2

    move v6, p1

    :goto_0
    invoke-direct {v3, v6}, Ljava/util/ArrayList;-><init>(I)V

    .line 6948
    .local v3, res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    const/4 v1, 0x0

    .local v1, i:I
    :goto_1
    if-ge v1, v0, :cond_7

    if-lez p1, :cond_7

    .line 6949
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/TaskRecord;

    .line 6950
    .local v5, tr:Lcom/android/server/am/TaskRecord;
    and-int/lit8 v6, p2, 0x1

    if-nez v6, :cond_0

    iget-object v6, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v6, :cond_0

    iget-object v6, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v6

    const/high16 v7, 0x80

    and-int/2addr v6, v7

    if-nez v6, :cond_1

    .line 6954
    :cond_0
    new-instance v4, Landroid/app/ActivityManager$RecentTaskInfo;

    invoke-direct {v4}, Landroid/app/ActivityManager$RecentTaskInfo;-><init>()V

    .line 6956
    .local v4, rti:Landroid/app/ActivityManager$RecentTaskInfo;
    iget v6, v5, Lcom/android/server/am/TaskRecord;->numActivities:I

    if-lez v6, :cond_3

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    :goto_2
    iput v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->id:I

    .line 6957
    new-instance v6, Landroid/content/Intent;

    iget-object v7, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v7, :cond_4

    iget-object v7, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    :goto_3
    invoke-direct {v6, v7}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iput-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->baseIntent:Landroid/content/Intent;

    .line 6959
    iget-object v6, v5, Lcom/android/server/am/TaskRecord;->origActivity:Landroid/content/ComponentName;

    iput-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->origActivity:Landroid/content/ComponentName;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6961
    and-int/lit8 v6, p2, 0x2

    if-eqz v6, :cond_6

    .line 6964
    :try_start_1
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->origActivity:Landroid/content/ComponentName;

    if-eqz v6, :cond_5

    .line 6965
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->origActivity:Landroid/content/ComponentName;

    const/4 v7, 0x0

    invoke-interface {v2, v6, v7}, Landroid/content/pm/IPackageManager;->getActivityInfo(Landroid/content/ComponentName;I)Landroid/content/pm/ActivityInfo;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result-object v6

    if-nez v6, :cond_6

    .line 6948
    .end local v4           #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    :cond_1
    :goto_4
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .end local v1           #i:I
    .end local v3           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :cond_2
    move v6, v0

    .line 6945
    goto :goto_0

    .line 6956
    .restart local v1       #i:I
    .restart local v3       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .restart local v4       #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .restart local v5       #tr:Lcom/android/server/am/TaskRecord;
    :cond_3
    const/4 v6, -0x1

    goto :goto_2

    .line 6957
    :cond_4
    :try_start_2
    iget-object v7, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    goto :goto_3

    .line 6968
    :cond_5
    :try_start_3
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->baseIntent:Landroid/content/Intent;

    if-eqz v6, :cond_6

    .line 6969
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->baseIntent:Landroid/content/Intent;

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-interface {v2, v6, v7, v8}, Landroid/content/pm/IPackageManager;->queryIntentActivities(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    move-result-object v6

    if-eqz v6, :cond_1

    .line 6979
    :cond_6
    :goto_5
    :try_start_4
    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 6980
    add-int/lit8 p1, p1, -0x1

    goto :goto_4

    .line 6983
    .end local v4           #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :cond_7
    monitor-exit p0

    return-object v3

    .line 6984
    .end local v0           #N:I
    .end local v1           #i:I
    .end local v2           #pm:Landroid/content/pm/IPackageManager;
    .end local v3           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v6

    .line 6974
    .restart local v0       #N:I
    .restart local v1       #i:I
    .restart local v2       #pm:Landroid/content/pm/IPackageManager;
    .restart local v3       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .restart local v4       #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .restart local v5       #tr:Lcom/android/server/am/TaskRecord;
    :catch_0
    move-exception v6

    goto :goto_5
.end method

.method public getRequestedOrientation(Landroid/os/IBinder;)I
    .locals 3
    .parameter "token"

    .prologue
    .line 4035
    monitor-enter p0

    .line 4036
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 4037
    .local v0, index:I
    if-gez v0, :cond_0

    .line 4038
    const/4 v2, -0x1

    monitor-exit p0

    .line 4041
    :goto_0
    return v2

    .line 4040
    :cond_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4041
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v2, v1}, Lcom/android/server/WindowManagerService;->getAppOrientation(Landroid/view/IApplicationToken;)I

    move-result v2

    monitor-exit p0

    goto :goto_0

    .line 4042
    .end local v0           #index:I
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public getRunningAppProcesses()Ljava/util/List;
    .locals 10
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RunningAppProcessInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 9505
    const/4 v5, 0x0

    .line 9506
    .local v5, runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    monitor-enter p0

    .line 9508
    :try_start_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    move-result v7

    const/4 v8, 0x1

    sub-int v3, v7, v8

    .local v3, i:I
    move-object v6, v5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .local v6, runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_0
    if-ltz v3, :cond_8

    .line 9509
    :try_start_1
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 9510
    .local v1, app:Lcom/android/server/am/ProcessRecord;
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v7, :cond_a

    iget-boolean v7, v1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v7, :cond_a

    iget-boolean v7, v1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-nez v7, :cond_a

    .line 9512
    new-instance v2, Landroid/app/ActivityManager$RunningAppProcessInfo;

    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget v8, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v1}, Lcom/android/server/am/ProcessRecord;->getPackageList()[Ljava/lang/String;

    move-result-object v9

    invoke-direct {v2, v7, v8, v9}, Landroid/app/ActivityManager$RunningAppProcessInfo;-><init>(Ljava/lang/String;I[Ljava/lang/String;)V

    .line 9515
    .local v2, currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->uid:I

    .line 9516
    iget v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 9517
    .local v0, adj:I
    sget v7, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-lt v0, v7, :cond_2

    .line 9518
    const/16 v7, 0x1f4

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 9532
    :goto_1
    iget v7, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonCode:I

    .line 9533
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    instance-of v7, v7, Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_7

    .line 9534
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    check-cast v7, Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonPid:I

    .line 9539
    :cond_0
    :goto_2
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    instance-of v7, v7, Landroid/content/ComponentName;

    if-eqz v7, :cond_1

    .line 9540
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    check-cast v7, Landroid/content/ComponentName;

    iput-object v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonComponent:Landroid/content/ComponentName;

    .line 9544
    :cond_1
    if-nez v6, :cond_9

    .line 9545
    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 9547
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_3
    :try_start_2
    invoke-interface {v5, v2}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 9508
    .end local v0           #adj:I
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :goto_4
    add-int/lit8 v3, v3, -0x1

    move-object v6, v5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_0

    .line 9519
    .restart local v0       #adj:I
    .restart local v2       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :cond_2
    :try_start_3
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v0, v7, :cond_3

    .line 9520
    const/16 v7, 0x190

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 9521
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    sub-int v7, v0, v7

    add-int/lit8 v7, v7, 0x1

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->lru:I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_1

    .line 9550
    .end local v0           #adj:I
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :catchall_0
    move-exception v7

    move-object v5, v6

    .end local v3           #i:I
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_5
    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    throw v7

    .line 9522
    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v0       #adj:I
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .restart local v3       #i:I
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_3
    :try_start_5
    sget v7, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    if-lt v0, v7, :cond_4

    .line 9523
    const/16 v7, 0x190

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 9524
    const/4 v7, 0x0

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->lru:I

    goto :goto_1

    .line 9525
    :cond_4
    sget v7, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    if-lt v0, v7, :cond_5

    .line 9526
    const/16 v7, 0x12c

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_1

    .line 9527
    :cond_5
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v0, v7, :cond_6

    .line 9528
    const/16 v7, 0xc8

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_1

    .line 9530
    :cond_6
    const/16 v7, 0x64

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_1

    .line 9535
    :cond_7
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    instance-of v7, v7, Lcom/android/server/am/HistoryRecord;

    if-eqz v7, :cond_0

    .line 9536
    iget-object v4, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 9537
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_0

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonPid:I

    goto :goto_2

    .line 9550
    .end local v0           #adj:I
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_8
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 9551
    return-object v6

    .line 9550
    .end local v3           #i:I
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :catchall_1
    move-exception v7

    goto :goto_5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v0       #adj:I
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .restart local v3       #i:I
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_9
    move-object v5, v6

    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_3

    .end local v0           #adj:I
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_a
    move-object v5, v6

    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_4
.end method

.method public getRunningExternalApplications()Ljava/util/List;
    .locals 13
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/content/pm/ApplicationInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 9555
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->getRunningAppProcesses()Ljava/util/List;

    move-result-object v10

    .line 9556
    .local v10, runningApps:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    new-instance v9, Ljava/util/ArrayList;

    invoke-direct {v9}, Ljava/util/ArrayList;-><init>()V

    .line 9557
    .local v9, retList:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ApplicationInfo;>;"
    if-eqz v10, :cond_3

    invoke-interface {v10}, Ljava/util/List;->size()I

    move-result v11

    if-lez v11, :cond_3

    .line 9558
    new-instance v2, Ljava/util/HashSet;

    invoke-direct {v2}, Ljava/util/HashSet;-><init>()V

    .line 9559
    .local v2, extList:Ljava/util/Set;,"Ljava/util/Set<Ljava/lang/String;>;"
    invoke-interface {v10}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :cond_0
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_1

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/app/ActivityManager$RunningAppProcessInfo;

    .line 9560
    .local v0, app:Landroid/app/ActivityManager$RunningAppProcessInfo;
    iget-object v11, v0, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    if-eqz v11, :cond_0

    .line 9561
    iget-object v1, v0, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    .local v1, arr$:[Ljava/lang/String;
    array-length v6, v1

    .local v6, len$:I
    const/4 v4, 0x0

    .local v4, i$:I
    :goto_0
    if-ge v4, v6, :cond_0

    aget-object v7, v1, v4

    .line 9562
    .local v7, pkg:Ljava/lang/String;
    invoke-interface {v2, v7}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 9561
    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    .line 9566
    .end local v0           #app:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v4           #i$:I
    .end local v6           #len$:I
    .end local v7           #pkg:Ljava/lang/String;
    :cond_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v8

    .line 9567
    .local v8, pm:Landroid/content/pm/IPackageManager;
    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .local v3, i$:Ljava/util/Iterator;
    :cond_2
    :goto_1
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_3

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/lang/String;

    .line 9569
    .restart local v7       #pkg:Ljava/lang/String;
    const/4 v11, 0x0

    :try_start_0
    invoke-interface {v8, v7, v11}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v5

    .line 9570
    .local v5, info:Landroid/content/pm/ApplicationInfo;
    iget v11, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    const/high16 v12, 0x4

    and-int/2addr v11, v12

    if-eqz v11, :cond_2

    .line 9571
    invoke-interface {v9, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_1

    .line 9573
    .end local v5           #info:Landroid/content/pm/ApplicationInfo;
    :catch_0
    move-exception v11

    goto :goto_1

    .line 9577
    .end local v2           #extList:Ljava/util/Set;,"Ljava/util/Set<Ljava/lang/String;>;"
    .end local v3           #i$:Ljava/util/Iterator;
    .end local v7           #pkg:Ljava/lang/String;
    .end local v8           #pm:Landroid/content/pm/IPackageManager;
    :cond_3
    return-object v9
.end method

.method public getRunningServiceControlPanel(Landroid/content/ComponentName;)Landroid/app/PendingIntent;
    .locals 4
    .parameter "name"

    .prologue
    .line 10808
    monitor-enter p0

    .line 10809
    :try_start_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v3, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ServiceRecord;

    .line 10810
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_1

    .line 10811
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ConnectionRecord;

    .line 10812
    .local v0, conn:Lcom/android/server/am/ConnectionRecord;
    iget-object v3, v0, Lcom/android/server/am/ConnectionRecord;->clientIntent:Landroid/app/PendingIntent;

    if-eqz v3, :cond_0

    .line 10813
    iget-object v3, v0, Lcom/android/server/am/ConnectionRecord;->clientIntent:Landroid/app/PendingIntent;

    monitor-exit p0

    .line 10818
    .end local v0           #conn:Lcom/android/server/am/ConnectionRecord;
    .end local v1           #i$:Ljava/util/Iterator;
    :goto_0
    return-object v3

    .line 10817
    :cond_1
    monitor-exit p0

    .line 10818
    const/4 v3, 0x0

    goto :goto_0

    .line 10817
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method public getServices(II)Ljava/util/List;
    .locals 7
    .parameter "maxNum"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RunningServiceInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 10784
    monitor-enter p0

    .line 10785
    :try_start_0
    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 10788
    .local v4, res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_0

    .line 10789
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 10790
    .local v2, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v5, p1, :cond_0

    .line 10791
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_0

    .line 10804
    .end local v2           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .end local v4           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 10795
    .restart local v4       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    :cond_0
    const/4 v0, 0x0

    .local v0, i:I
    :goto_1
    :try_start_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_1

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v5, p1, :cond_1

    .line 10796
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ServiceRecord;

    .line 10797
    .local v3, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual {p0, v3}, Lcom/android/server/am/ActivityManagerService;->makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;

    move-result-object v1

    .line 10799
    .local v1, info:Landroid/app/ActivityManager$RunningServiceInfo;
    iget-wide v5, v3, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    iput-wide v5, v1, Landroid/app/ActivityManager$RunningServiceInfo;->restarting:J

    .line 10800
    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10795
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 10803
    .end local v1           #info:Landroid/app/ActivityManager$RunningServiceInfo;
    .end local v3           #r:Lcom/android/server/am/ServiceRecord;
    :cond_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    return-object v4
.end method

.method public getTaskForActivity(Landroid/os/IBinder;Z)I
    .locals 1
    .parameter "token"
    .parameter "onlyRoot"

    .prologue
    .line 7549
    monitor-enter p0

    .line 7550
    :try_start_0
    invoke-virtual {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getTaskForActivityLocked(Landroid/os/IBinder;Z)I

    move-result v0

    monitor-exit p0

    return v0

    .line 7551
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method getTaskForActivityLocked(Landroid/os/IBinder;Z)I
    .locals 6
    .parameter "token"
    .parameter "onlyRoot"

    .prologue
    const/4 v5, -0x1

    .line 7555
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7556
    .local v0, N:I
    const/4 v2, 0x0

    .line 7557
    .local v2, lastTask:Lcom/android/server/am/TaskRecord;
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_3

    .line 7558
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7559
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    if-ne v3, p1, :cond_2

    .line 7560
    if-eqz p2, :cond_0

    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v4, :cond_1

    .line 7561
    :cond_0
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    .line 7568
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return v4

    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    move v4, v5

    .line 7563
    goto :goto_1

    .line 7565
    :cond_2
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7557
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_3
    move v4, v5

    .line 7568
    goto :goto_1
.end method

.method public getTasks(IILandroid/app/IThumbnailReceiver;)Ljava/util/List;
    .locals 23
    .parameter "maxNum"
    .parameter "flags"
    .parameter "receiver"

    .prologue
    .line 6800
    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    .line 6802
    .local v11, list:Ljava/util/ArrayList;
    const/16 v16, 0x0

    .line 6803
    .local v16, pending:Lcom/android/server/am/PendingThumbnailsRecord;
    const/16 v22, 0x0

    .line 6804
    .local v22, topThumbnail:Landroid/app/IApplicationThread;
    const/4 v4, 0x0

    .line 6806
    .local v4, topRecord:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 6811
    :try_start_0
    const-string v2, "android.permission.GET_TASKS"

    move-object/from16 v0, p0

    move-object v1, v2

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result v2

    if-eqz v2, :cond_1

    .line 6813
    if-eqz p3, :cond_0

    .line 6817
    :try_start_1
    invoke-interface/range {p3 .. p3}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    .line 6821
    :cond_0
    :goto_0
    :try_start_2
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Permission Denial: getTasks() from pid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ", uid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " requires "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "android.permission.GET_TASKS"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    .line 6825
    .local v12, msg:Ljava/lang/String;
    const-string v2, "ActivityManager"

    invoke-static {v2, v12}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6826
    new-instance v2, Ljava/lang/SecurityException;

    invoke-direct {v2, v12}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 6908
    .end local v12           #msg:Ljava/lang/String;
    .end local p2
    :catchall_0
    move-exception v2

    :goto_1
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 6829
    .restart local p2
    :cond_1
    :try_start_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v18, v2, v3

    .line 6830
    .local v18, pos:I
    if-ltz v18, :cond_9

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/HistoryRecord;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move-object/from16 v13, p2

    .line 6832
    .local v13, next:Lcom/android/server/am/HistoryRecord;
    :goto_2
    const/16 v20, 0x0

    .line 6833
    .local v20, top:Lcom/android/server/am/HistoryRecord;
    const/16 v21, 0x0

    .line 6834
    .local v21, topDescription:Ljava/lang/CharSequence;
    const/4 v9, 0x0

    .line 6835
    .local v9, curTask:Lcom/android/server/am/TaskRecord;
    const/4 v14, 0x0

    .line 6836
    .local v14, numActivities:I
    const/4 v15, 0x0

    .local v15, numRunning:I
    move-object/from16 v17, v16

    .line 6837
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .local v17, pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :goto_3
    if-ltz v18, :cond_c

    if-lez p1, :cond_c

    .line 6838
    move-object/from16 v19, v13

    .line 6839
    .local v19, r:Lcom/android/server/am/HistoryRecord;
    add-int/lit8 v18, v18, -0x1

    .line 6840
    if-ltz v18, :cond_a

    :try_start_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v13, p2

    .line 6843
    :goto_4
    if-eqz v20, :cond_2

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->INITIALIZING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v2, v3, :cond_3

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v2, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    if-ne v2, v3, :cond_3

    .line 6846
    :cond_2
    move-object/from16 v20, v19

    .line 6847
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    move-object/from16 v21, v0

    .line 6848
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v9, v0

    .line 6849
    const/4 v15, 0x0

    move v14, v15

    .line 6853
    :cond_3
    add-int/lit8 v14, v14, 0x1

    .line 6854
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    if-eqz v2, :cond_4

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    iget-object v2, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_4

    .line 6855
    add-int/lit8 v15, v15, 0x1

    .line 6857
    :cond_4
    if-nez v21, :cond_5

    .line 6858
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    move-object/from16 v21, v0

    .line 6867
    :cond_5
    if-eqz v13, :cond_6

    iget-object v2, v13, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v9, :cond_12

    .line 6868
    :cond_6
    new-instance v8, Landroid/app/ActivityManager$RunningTaskInfo;

    invoke-direct {v8}, Landroid/app/ActivityManager$RunningTaskInfo;-><init>()V

    .line 6870
    .local v8, ci:Landroid/app/ActivityManager$RunningTaskInfo;
    iget v2, v9, Lcom/android/server/am/TaskRecord;->taskId:I

    iput v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->id:I

    .line 6871
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v2, v0

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->baseActivity:Landroid/content/ComponentName;

    .line 6872
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v2, v0

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->topActivity:Landroid/content/ComponentName;

    .line 6873
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    move-object v2, v0

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->thumbnail:Landroid/graphics/Bitmap;

    .line 6874
    move-object/from16 v0, v21

    move-object v1, v8

    iput-object v0, v1, Landroid/app/ActivityManager$RunningTaskInfo;->description:Ljava/lang/CharSequence;

    .line 6875
    iput v14, v8, Landroid/app/ActivityManager$RunningTaskInfo;->numActivities:I

    .line 6876
    iput v15, v8, Landroid/app/ActivityManager$RunningTaskInfo;->numRunning:I

    .line 6879
    iget-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->thumbnail:Landroid/graphics/Bitmap;

    if-nez v2, :cond_11

    if-eqz p3, :cond_11

    .line 6884
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v2, v3, :cond_7

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v2, v3, :cond_8

    .line 6886
    :cond_7
    move-object/from16 v0, v20

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->idle:Z

    move v2, v0

    if-eqz v2, :cond_b

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    if-eqz v2, :cond_b

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    iget-object v2, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_b

    .line 6888
    move-object/from16 v4, v20

    .line 6889
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    move-object v0, v2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v22, v0

    .line 6894
    :cond_8
    :goto_5
    if-nez v17, :cond_10

    .line 6895
    new-instance v16, Lcom/android/server/am/PendingThumbnailsRecord;

    move-object/from16 v0, v16

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Lcom/android/server/am/PendingThumbnailsRecord;-><init>(Landroid/app/IThumbnailReceiver;)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 6897
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :goto_6
    :try_start_5
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    move-object v2, v0

    move-object v0, v2

    move-object/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6899
    :goto_7
    invoke-virtual {v11, v8}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 6900
    add-int/lit8 p1, p1, -0x1

    .line 6901
    const/16 v20, 0x0

    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    :goto_8
    move-object/from16 v17, v16

    .line 6903
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto/16 :goto_3

    .line 6830
    .end local v9           #curTask:Lcom/android/server/am/TaskRecord;
    .end local v13           #next:Lcom/android/server/am/HistoryRecord;
    .end local v14           #numActivities:I
    .end local v15           #numRunning:I
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local v19           #r:Lcom/android/server/am/HistoryRecord;
    .end local v20           #top:Lcom/android/server/am/HistoryRecord;
    .end local v21           #topDescription:Ljava/lang/CharSequence;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local p2
    :cond_9
    const/4 v2, 0x0

    move-object v13, v2

    goto/16 :goto_2

    .line 6840
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local p2
    .restart local v9       #curTask:Lcom/android/server/am/TaskRecord;
    .restart local v13       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v14       #numActivities:I
    .restart local v15       #numRunning:I
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v19       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v20       #top:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #topDescription:Ljava/lang/CharSequence;
    :cond_a
    const/4 v2, 0x0

    move-object v13, v2

    goto/16 :goto_4

    .line 6891
    .restart local v8       #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    :cond_b
    const/4 v2, 0x1

    :try_start_6
    move v0, v2

    move-object/from16 v1, v20

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    goto :goto_5

    .line 6908
    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .end local v19           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_1
    move-exception v2

    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto/16 :goto_1

    .line 6905
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_c
    if-eqz v17, :cond_d

    .line 6906
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move-object/from16 v1, v17

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 6908
    :cond_d
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 6912
    if-eqz v22, :cond_e

    .line 6915
    :try_start_7
    move-object/from16 v0, v22

    move-object v1, v4

    invoke-interface {v0, v1}, Landroid/app/IApplicationThread;->requestThumbnail(Landroid/os/IBinder;)V
    :try_end_7
    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_7} :catch_0

    .line 6922
    :cond_e
    :goto_9
    if-nez v17, :cond_f

    if-eqz p3, :cond_f

    .line 6928
    :try_start_8
    invoke-interface/range {p3 .. p3}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_8
    .catch Landroid/os/RemoteException; {:try_start_8 .. :try_end_8} :catch_2

    .line 6933
    :cond_f
    :goto_a
    return-object v11

    .line 6916
    :catch_0
    move-exception v10

    .line 6917
    .local v10, e:Ljava/lang/Exception;
    const-string v2, "ActivityManager"

    const-string v3, "Exception thrown when requesting thumbnail"

    invoke-static {v2, v3, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 6918
    const/4 v3, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x1

    move-object/from16 v2, p0

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    goto :goto_9

    .line 6818
    .end local v9           #curTask:Lcom/android/server/am/TaskRecord;
    .end local v10           #e:Ljava/lang/Exception;
    .end local v13           #next:Lcom/android/server/am/HistoryRecord;
    .end local v14           #numActivities:I
    .end local v15           #numRunning:I
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local v18           #pos:I
    .end local v20           #top:Lcom/android/server/am/HistoryRecord;
    .end local v21           #topDescription:Ljava/lang/CharSequence;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local p2
    :catch_1
    move-exception v2

    goto/16 :goto_0

    .line 6929
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local p2
    .restart local v9       #curTask:Lcom/android/server/am/TaskRecord;
    .restart local v13       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v14       #numActivities:I
    .restart local v15       #numRunning:I
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v18       #pos:I
    .restart local v20       #top:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #topDescription:Ljava/lang/CharSequence;
    :catch_2
    move-exception v2

    goto :goto_a

    .restart local v8       #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .restart local v19       #r:Lcom/android/server/am/HistoryRecord;
    :cond_10
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_6

    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_11
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_7

    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_12
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_8
.end method

.method public goingToSleep()V
    .locals 2

    .prologue
    .line 8270
    monitor-enter p0

    .line 8271
    const/4 v0, 0x1

    :try_start_0
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 8272
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x0

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 8274
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_0

    .line 8275
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 8279
    :goto_0
    monitor-exit p0

    .line 8280
    return-void

    .line 8277
    :cond_0
    const-string v0, "ActivityManager"

    const-string v1, "goingToSleep with no resumed activity!"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 8279
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public grantUriPermission(Landroid/app/IApplicationThread;Ljava/lang/String;Landroid/net/Uri;I)V
    .locals 7
    .parameter "caller"
    .parameter "targetPkg"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    const-string v0, "ActivityManager"

    .line 6583
    monitor-enter p0

    .line 6584
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v6

    .line 6585
    .local v6, r:Lcom/android/server/am/ProcessRecord;
    if-nez v6, :cond_0

    .line 6586
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to find app for caller "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " when granting permission to uri "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 6601
    .end local v6           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    .line 6590
    .restart local v6       #r:Lcom/android/server/am/ProcessRecord;
    :cond_0
    if-nez p2, :cond_1

    .line 6591
    :try_start_1
    const-string v0, "ActivityManager"

    const-string v1, "grantUriPermission: null target"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6592
    monitor-exit p0

    .line 6602
    :goto_0
    return-void

    .line 6594
    :cond_1
    if-nez p3, :cond_2

    .line 6595
    const-string v0, "ActivityManager"

    const-string v1, "grantUriPermission: null uri"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6596
    monitor-exit p0

    goto :goto_0

    .line 6599
    :cond_2
    iget-object v0, v6, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    const/4 v5, 0x0

    move-object v0, p0

    move-object v2, p2

    move-object v3, p3

    move v4, p4

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    .line 6601
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_0
.end method

.method public handleApplicationCrash(Landroid/os/IBinder;Landroid/app/ApplicationErrorReport$CrashInfo;)V
    .locals 9
    .parameter "app"
    .parameter "crashInfo"

    .prologue
    const/4 v3, 0x0

    .line 9132
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->findAppProcess(Landroid/os/IBinder;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    .line 9134
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    const/16 v0, 0x7557

    const/4 v1, 0x7

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v4, 0x0

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    const/4 v4, 0x1

    if-nez p1, :cond_0

    const-string v5, "system"

    :goto_0
    aput-object v5, v1, v4

    const/4 v4, 0x2

    if-nez v2, :cond_2

    const/4 v5, -0x1

    :goto_1
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    const/4 v4, 0x3

    iget-object v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionClassName:Ljava/lang/String;

    aput-object v5, v1, v4

    const/4 v4, 0x4

    iget-object v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionMessage:Ljava/lang/String;

    aput-object v5, v1, v4

    const/4 v4, 0x5

    iget-object v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->throwFileName:Ljava/lang/String;

    aput-object v5, v1, v4

    const/4 v4, 0x6

    iget v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->throwLineNumber:I

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9142
    const-string v1, "crash"

    move-object v0, p0

    move-object v4, v3

    move-object v5, v3

    move-object v6, v3

    move-object v7, v3

    move-object v8, p2

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/am/ActivityManagerService;->addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 9144
    invoke-direct {p0, v2, p2}, Lcom/android/server/am/ActivityManagerService;->crashApplication(Lcom/android/server/am/ProcessRecord;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 9145
    return-void

    .line 9134
    :cond_0
    if-nez v2, :cond_1

    const-string v5, "unknown"

    goto :goto_0

    :cond_1
    iget-object v5, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    goto :goto_0

    :cond_2
    iget-object v5, v2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    goto :goto_1
.end method

.method public handleApplicationWtf(Landroid/os/IBinder;Ljava/lang/String;Landroid/app/ApplicationErrorReport$CrashInfo;)Z
    .locals 11
    .parameter "app"
    .parameter "tag"
    .parameter "crashInfo"

    .prologue
    const/4 v10, 0x1

    const/4 v9, 0x0

    const/4 v3, 0x0

    .line 9156
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->findAppProcess(Landroid/os/IBinder;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    .line 9158
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    const/16 v0, 0x7558

    const/4 v1, 0x5

    new-array v1, v1, [Ljava/lang/Object;

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v9

    if-nez p1, :cond_0

    const-string v4, "system"

    :goto_0
    aput-object v4, v1, v10

    const/4 v4, 0x2

    if-nez v2, :cond_2

    const/4 v5, -0x1

    :goto_1
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    const/4 v4, 0x3

    aput-object p2, v1, v4

    const/4 v4, 0x4

    iget-object v5, p3, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionMessage:Ljava/lang/String;

    aput-object v5, v1, v4

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9163
    const-string v1, "wtf"

    move-object v0, p0

    move-object v4, v3

    move-object v5, p2

    move-object v6, v3

    move-object v7, v3

    move-object v8, p3

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/am/ActivityManagerService;->addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 9165
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "wtf_is_fatal"

    invoke-static {v0, v1, v9}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v0

    if-eqz v0, :cond_3

    .line 9167
    invoke-direct {p0, v2, p3}, Lcom/android/server/am/ActivityManagerService;->crashApplication(Lcom/android/server/am/ProcessRecord;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    move v0, v10

    .line 9170
    :goto_2
    return v0

    .line 9158
    :cond_0
    if-nez v2, :cond_1

    const-string v4, "unknown"

    goto :goto_0

    :cond_1
    iget-object v4, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    goto :goto_0

    :cond_2
    iget-object v5, v2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    goto :goto_1

    :cond_3
    move v0, v9

    .line 9170
    goto :goto_2
.end method

.method isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z
    .locals 1
    .parameter "ai"

    .prologue
    .line 1988
    iget v0, p1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v0, v0, 0x8

    if-eqz v0, :cond_0

    const/4 v0, 0x1

    :goto_0
    return v0

    :cond_0
    const/4 v0, 0x0

    goto :goto_0
.end method

.method public isUserAMonkey()Z
    .locals 1

    .prologue
    .line 8458
    monitor-enter p0

    .line 8459
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v0, :cond_0

    const/4 v0, 0x1

    :goto_0
    monitor-exit p0

    return v0

    :cond_0
    const/4 v0, 0x0

    goto :goto_0

    .line 8460
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method killAppAtUsersRequest(Lcom/android/server/am/ProcessRecord;Landroid/app/Dialog;)V
    .locals 4
    .parameter "app"
    .parameter "fromDialog"

    .prologue
    .line 8992
    monitor-enter p0

    .line 8993
    const/4 v0, 0x0

    :try_start_0
    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 8994
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8995
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 8996
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8997
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    if-ne v0, p2, :cond_0

    .line 8998
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    .line 9000
    :cond_0
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    if-ne v0, p2, :cond_1

    .line 9001
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    .line 9003
    :cond_1
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v0, :cond_2

    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v1, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v0, v1, :cond_2

    .line 9004
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 9005
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Killing "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, "): user\'s request"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 9007
    const/16 v0, 0x7547

    const/4 v1, 0x4

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget v3, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    const/4 v2, 0x2

    iget v3, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x3

    const-string v3, "user\'s request after error"

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9009
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v0}, Landroid/os/Process;->killProcess(I)V

    .line 9011
    :cond_2
    monitor-exit p0

    .line 9012
    return-void

    .line 9011
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public killApplicationProcess(Ljava/lang/String;I)V
    .locals 5
    .parameter "processName"
    .parameter "uid"

    .prologue
    .line 5227
    if-nez p1, :cond_0

    .line 5251
    :goto_0
    return-void

    .line 5231
    :cond_0
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 5233
    .local v1, callerUid:I
    const/16 v2, 0x3e8

    if-ne v1, v2, :cond_2

    .line 5234
    monitor-enter p0

    .line 5235
    :try_start_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-object v0

    .line 5236
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v0, :cond_1

    .line 5238
    :try_start_1
    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v2}, Landroid/app/IApplicationThread;->scheduleSuicide()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 5246
    :goto_1
    :try_start_2
    monitor-exit p0

    goto :goto_0

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 5243
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_3
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Process/uid not found attempting kill of "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " / "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_1

    .line 5248
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :cond_2
    new-instance v2, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " cannot kill app process: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 5239
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v2

    goto :goto_1
.end method

.method public killApplicationWithUid(Ljava/lang/String;I)V
    .locals 5
    .parameter "pkg"
    .parameter "uid"

    .prologue
    .line 5155
    if-nez p1, :cond_0

    .line 5176
    :goto_0
    return-void

    .line 5159
    :cond_0
    if-gez p2, :cond_1

    .line 5160
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Invalid uid specified for pkg : "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 5163
    :cond_1
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5165
    .local v0, callerUid:I
    const/16 v2, 0x3e8

    if-ne v0, v2, :cond_2

    .line 5167
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v3, 0x16

    invoke-virtual {v2, v3}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 5168
    .local v1, msg:Landroid/os/Message;
    iput p2, v1, Landroid/os/Message;->arg1:I

    .line 5169
    const/4 v2, 0x0

    iput v2, v1, Landroid/os/Message;->arg2:I

    .line 5170
    iput-object p1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 5171
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    goto :goto_0

    .line 5173
    .end local v1           #msg:Landroid/os/Message;
    :cond_2
    new-instance v2, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " cannot kill pkg: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2
.end method

.method public killBackgroundProcesses(Ljava/lang/String;)V
    .locals 10
    .parameter "packageName"

    .prologue
    const-string v4, "android.permission.KILL_BACKGROUND_PROCESSES"

    const-string v3, "ActivityManager"

    .line 5086
    const-string v0, "android.permission.KILL_BACKGROUND_PROCESSES"

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_0

    const-string v0, "android.permission.RESTART_PACKAGES"

    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_0

    .line 5090
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Permission Denial: killBackgroundProcesses() from pid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ", uid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " requires "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "android.permission.KILL_BACKGROUND_PROCESSES"

    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    .line 5094
    .local v8, msg:Ljava/lang/String;
    const-string v0, "ActivityManager"

    invoke-static {v3, v8}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5095
    new-instance v0, Ljava/lang/SecurityException;

    invoke-direct {v0, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 5098
    .end local v8           #msg:Ljava/lang/String;
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 5100
    .local v6, callingId:J
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v9

    .line 5101
    .local v9, pm:Landroid/content/pm/IPackageManager;
    const/4 v2, -0x1

    .line 5102
    .local v2, pkgUid:I
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 5104
    :try_start_1
    invoke-interface {v9, p1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v2

    .line 5107
    :goto_0
    const/4 v0, -0x1

    if-ne v2, v0, :cond_1

    .line 5108
    :try_start_2
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Invalid packageName: "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5109
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5115
    :goto_1
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5117
    return-void

    .line 5111
    :cond_1
    :try_start_3
    sget v3, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    const/4 v4, 0x0

    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->killPackageProcessesLocked(Ljava/lang/String;IIZZ)Z

    .line 5113
    monitor-exit p0

    goto :goto_1

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 5115
    .end local v2           #pkgUid:I
    .end local v9           #pm:Landroid/content/pm/IPackageManager;
    :catchall_1
    move-exception v0

    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0

    .line 5105
    .restart local v2       #pkgUid:I
    .restart local v9       #pm:Landroid/content/pm/IPackageManager;
    :catch_0
    move-exception v0

    goto :goto_0
.end method

.method public killPids([ILjava/lang/String;)Z
    .locals 13
    .parameter "pids"
    .parameter "pReason"

    .prologue
    const-string v8, "ActivityManager"

    .line 8520
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    const/16 v9, 0x3e8

    if-eq v8, v9, :cond_0

    .line 8521
    new-instance v8, Ljava/lang/SecurityException;

    const-string v9, "killPids only available to the system"

    invoke-direct {v8, v9}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v8

    .line 8523
    :cond_0
    if-nez p2, :cond_2

    const-string v8, "Unknown"

    move-object v4, v8

    .line 8527
    .local v4, reason:Ljava/lang/String;
    :goto_0
    const/4 v2, 0x0

    .line 8528
    .local v2, killed:Z
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v8

    .line 8529
    :try_start_0
    array-length v9, p1

    new-array v6, v9, [I

    .line 8530
    .local v6, types:[I
    const/4 v7, 0x0

    .line 8531
    .local v7, worstType:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_1
    array-length v9, p1

    if-ge v1, v9, :cond_3

    .line 8532
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    aget v10, p1, v1

    invoke-virtual {v9, v10}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8533
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    if-eqz v3, :cond_1

    .line 8534
    iget v5, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 8535
    .local v5, type:I
    aput v5, v6, v1

    .line 8536
    if-le v5, v7, :cond_1

    .line 8537
    move v7, v5

    .line 8531
    .end local v5           #type:I
    :cond_1
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .end local v1           #i:I
    .end local v2           #killed:Z
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v4           #reason:Ljava/lang/String;
    .end local v6           #types:[I
    .end local v7           #worstType:I
    :cond_2
    move-object v4, p2

    .line 8523
    goto :goto_0

    .line 8544
    .restart local v1       #i:I
    .restart local v2       #killed:Z
    .restart local v4       #reason:Ljava/lang/String;
    .restart local v6       #types:[I
    .restart local v7       #worstType:I
    :cond_3
    sget v9, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-ge v7, v9, :cond_4

    sget v9, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-le v7, v9, :cond_4

    .line 8545
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 8547
    :cond_4
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Killing processes "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " at adjustment "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8548
    const/4 v1, 0x0

    :goto_2
    array-length v9, p1

    if-ge v1, v9, :cond_7

    .line 8549
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    aget v10, p1, v1

    invoke-virtual {v9, v10}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8550
    .restart local v3       #proc:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_6

    .line 8548
    :cond_5
    :goto_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 8553
    :cond_6
    iget v0, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 8554
    .local v0, adj:I
    if-lt v0, v7, :cond_5

    iget-boolean v9, v3, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    if-nez v9, :cond_5

    .line 8555
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Killing "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " (adj "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, "): "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8556
    const/16 v9, 0x7547

    const/4 v10, 0x4

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    iget v12, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    const/4 v11, 0x1

    iget-object v12, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v12, v10, v11

    const/4 v11, 0x2

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    const/4 v11, 0x3

    aput-object v4, v10, v11

    invoke-static {v9, v10}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8558
    const/4 v2, 0x1

    .line 8559
    const/4 v9, 0x1

    iput-boolean v9, v3, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    .line 8560
    aget v9, p1, v1

    invoke-static {v9}, Landroid/os/Process;->killProcessQuiet(I)V

    goto :goto_3

    .line 8563
    .end local v0           #adj:I
    .end local v1           #i:I
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v6           #types:[I
    .end local v7           #worstType:I
    :catchall_0
    move-exception v9

    monitor-exit v8
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v9

    .restart local v1       #i:I
    .restart local v6       #types:[I
    .restart local v7       #worstType:I
    :cond_7
    :try_start_1
    monitor-exit v8
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8564
    return v2
.end method

.method makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;
    .locals 5
    .parameter "r"

    .prologue
    .line 10746
    new-instance v2, Landroid/app/ActivityManager$RunningServiceInfo;

    invoke-direct {v2}, Landroid/app/ActivityManager$RunningServiceInfo;-><init>()V

    .line 10748
    .local v2, info:Landroid/app/ActivityManager$RunningServiceInfo;
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    iput-object v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->service:Landroid/content/ComponentName;

    .line 10749
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_0

    .line 10750
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->pid:I

    .line 10752
    :cond_0
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->uid:I

    .line 10753
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    iput-object v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->process:Ljava/lang/String;

    .line 10754
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    iput-boolean v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->foreground:Z

    .line 10755
    iget-wide v3, p1, Lcom/android/server/am/ServiceRecord;->createTime:J

    iput-wide v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->activeSince:J

    .line 10756
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    iput-boolean v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->started:Z

    .line 10757
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->size()I

    move-result v3

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->clientCount:I

    .line 10758
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->crashCount:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->crashCount:I

    .line 10759
    iget-wide v3, p1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    iput-wide v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->lastActivityTime:J

    .line 10760
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eqz v3, :cond_1

    .line 10761
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x2

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10763
    :cond_1
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v3, :cond_2

    .line 10764
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x1

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10766
    :cond_2
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_3

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v4, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v3, v4, :cond_3

    .line 10767
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x4

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10769
    :cond_3
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-boolean v3, v3, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v3, :cond_4

    .line 10770
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x8

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10772
    :cond_4
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_5
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_6

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ConnectionRecord;

    .line 10773
    .local v0, conn:Lcom/android/server/am/ConnectionRecord;
    iget v3, v0, Lcom/android/server/am/ConnectionRecord;->clientLabel:I

    if-eqz v3, :cond_5

    .line 10774
    iget-object v3, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v3, v3, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->clientPackage:Ljava/lang/String;

    .line 10775
    iget v3, v0, Lcom/android/server/am/ConnectionRecord;->clientLabel:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->clientLabel:I

    .line 10779
    .end local v0           #conn:Lcom/android/server/am/ConnectionRecord;
    :cond_6
    return-object v2
.end method

.method public monitor()V
    .locals 1

    .prologue
    .line 14696
    monitor-enter p0

    :try_start_0
    monitor-exit p0

    .line 14697
    return-void

    .line 14696
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public moveActivityTaskToBack(Landroid/os/IBinder;Z)Z
    .locals 5
    .parameter "token"
    .parameter "nonRoot"

    .prologue
    const/4 v4, 0x0

    .line 7438
    monitor-enter p0

    .line 7439
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7440
    .local v0, origId:J
    if-nez p2, :cond_0

    const/4 v3, 0x1

    :goto_0
    invoke-virtual {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->getTaskForActivityLocked(Landroid/os/IBinder;Z)I

    move-result v2

    .line 7441
    .local v2, taskId:I
    if-ltz v2, :cond_1

    .line 7442
    const/4 v3, 0x0

    invoke-direct {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->moveTaskToBackLocked(ILcom/android/server/am/HistoryRecord;)Z

    move-result v3

    monitor-exit p0

    .line 7446
    :goto_1
    return v3

    .end local v2           #taskId:I
    :cond_0
    move v3, v4

    .line 7440
    goto :goto_0

    .line 7444
    .restart local v2       #taskId:I
    :cond_1
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7445
    monitor-exit p0

    move v3, v4

    .line 7446
    goto :goto_1

    .line 7445
    .end local v0           #origId:J
    .end local v2           #taskId:I
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method public moveTaskBackwards(I)V
    .locals 5
    .parameter "task"

    .prologue
    .line 7530
    const-string v2, "android.permission.REORDER_TASKS"

    const-string v3, "moveTaskBackwards()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7533
    monitor-enter p0

    .line 7534
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const-string v4, "Task backwards"

    invoke-virtual {p0, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 7536
    monitor-exit p0

    .line 7542
    :goto_0
    return-void

    .line 7538
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7539
    .local v0, origId:J
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->moveTaskBackwardsLocked(I)V

    .line 7540
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7541
    monitor-exit p0

    goto :goto_0

    .end local v0           #origId:J
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public moveTaskToBack(I)V
    .locals 5
    .parameter "task"

    .prologue
    .line 7412
    const-string v2, "android.permission.REORDER_TASKS"

    const-string v3, "moveTaskToBack()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7415
    monitor-enter p0

    .line 7416
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v2, :cond_0

    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v2, p1, :cond_0

    .line 7417
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const-string v4, "Task to back"

    invoke-virtual {p0, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 7419
    monitor-exit p0

    .line 7426
    :goto_0
    return-void

    .line 7422
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7423
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->moveTaskToBackLocked(ILcom/android/server/am/HistoryRecord;)Z

    .line 7424
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7425
    monitor-exit p0

    goto :goto_0

    .end local v0           #origId:J
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public moveTaskToFront(I)V
    .locals 9
    .parameter "task"

    .prologue
    .line 7315
    const-string v6, "android.permission.REORDER_TASKS"

    const-string v7, "moveTaskToFront()"

    invoke-virtual {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7318
    monitor-enter p0

    .line 7319
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    const-string v8, "Task to front"

    invoke-virtual {p0, v6, v7, v8}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v6

    if-nez v6, :cond_0

    .line 7321
    monitor-exit p0

    .line 7344
    :goto_0
    return-void

    .line 7323
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-wide v3

    .line 7325
    .local v3, origId:J
    :try_start_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7326
    .local v0, N:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_1
    if-ge v2, v0, :cond_2

    .line 7327
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/TaskRecord;

    .line 7328
    .local v5, tr:Lcom/android/server/am/TaskRecord;
    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, p1, :cond_1

    .line 7329
    const/4 v6, 0x0

    invoke-direct {p0, v5, v6}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 7341
    :try_start_2
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7330
    monitor-exit p0

    goto :goto_0

    .line 7343
    .end local v0           #N:I
    .end local v2           #i:I
    .end local v3           #origId:J
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v6

    .line 7326
    .restart local v0       #N:I
    .restart local v2       #i:I
    .restart local v3       #origId:J
    .restart local v5       #tr:Lcom/android/server/am/TaskRecord;
    :cond_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    .line 7333
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :cond_2
    :try_start_3
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v2, v6, v7

    :goto_2
    if-ltz v2, :cond_4

    .line 7334
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 7335
    .local v1, hr:Lcom/android/server/am/HistoryRecord;
    iget-object v6, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, p1, :cond_3

    .line 7336
    iget-object v6, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    const/4 v7, 0x0

    invoke-direct {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 7341
    :try_start_4
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7337
    monitor-exit p0

    goto :goto_0

    .line 7333
    :cond_3
    add-int/lit8 v2, v2, -0x1

    goto :goto_2

    .line 7341
    .end local v0           #N:I
    .end local v1           #hr:Lcom/android/server/am/HistoryRecord;
    .end local v2           #i:I
    :catchall_1
    move-exception v6

    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v6

    .restart local v0       #N:I
    .restart local v2       #i:I
    :cond_4
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7343
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    goto :goto_0
.end method

.method final newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;
    .locals 4
    .parameter "thread"
    .parameter "info"
    .parameter "customProcess"

    .prologue
    .line 8190
    if-eqz p3, :cond_0

    move-object v0, p3

    .line 8191
    .local v0, proc:Ljava/lang/String;
    :goto_0
    const/4 v1, 0x0

    .line 8192
    .local v1, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v2

    .line 8193
    .local v2, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v2

    .line 8194
    :try_start_0
    iget v3, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v0}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v1

    .line 8195
    monitor-exit v2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8196
    new-instance v3, Lcom/android/server/am/ProcessRecord;

    invoke-direct {v3, v1, p1, p2, v0}, Lcom/android/server/am/ProcessRecord;-><init>(Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)V

    return-object v3

    .line 8190
    .end local v0           #proc:Ljava/lang/String;
    .end local v1           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .end local v2           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :cond_0
    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    move-object v0, v3

    goto :goto_0

    .line 8195
    .restart local v0       #proc:Ljava/lang/String;
    .restart local v1       #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .restart local v2       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_0
    move-exception v3

    :try_start_1
    monitor-exit v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v3
.end method

.method public noteWakeupAlarm(Landroid/content/IIntentSender;)V
    .locals 7
    .parameter "sender"

    .prologue
    .line 8502
    instance-of v6, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v6, :cond_0

    .line 8517
    :goto_0
    return-void

    .line 8505
    :cond_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    .line 8506
    .local v4, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v4

    .line 8507
    :try_start_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v6

    if-eqz v6, :cond_1

    .line 8508
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->enforceCallingPermission()V

    .line 8509
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v3, v0

    .line 8510
    .local v3, rec:Lcom/android/server/am/PendingIntentRecord;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 8511
    .local v1, MY_UID:I
    iget v6, v3, Lcom/android/server/am/PendingIntentRecord;->uid:I

    if-ne v6, v1, :cond_2

    const/16 v6, 0x3e8

    move v5, v6

    .line 8512
    .local v5, uid:I
    :goto_1
    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5, v6}, Lcom/android/internal/os/BatteryStatsImpl;->getPackageStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;

    move-result-object v2

    .line 8514
    .local v2, pkg:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;
    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;->incWakeupsLocked()V

    .line 8516
    .end local v1           #MY_UID:I
    .end local v2           #pkg:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;
    .end local v3           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v5           #uid:I
    :cond_1
    monitor-exit v4

    goto :goto_0

    :catchall_0
    move-exception v6

    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 8511
    .restart local v1       #MY_UID:I
    .restart local v3       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_2
    :try_start_1
    iget v6, v3, Lcom/android/server/am/PendingIntentRecord;->uid:I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move v5, v6

    goto :goto_1
.end method

.method public onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z
    .locals 3
    .parameter "code"
    .parameter "data"
    .parameter "reply"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 1482
    :try_start_0
    invoke-super {p0, p1, p2, p3, p4}, Landroid/app/ActivityManagerNative;->onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z
    :try_end_0
    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v1

    return v1

    .line 1483
    :catch_0
    move-exception v0

    .line 1486
    .local v0, e:Ljava/lang/RuntimeException;
    instance-of v1, v0, Ljava/lang/SecurityException;

    if-nez v1, :cond_0

    .line 1487
    const-string v1, "ActivityManager"

    const-string v2, "Activity Manager Crash"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1489
    :cond_0
    throw v0
.end method

.method public openContentUri(Landroid/net/Uri;)Landroid/os/ParcelFileDescriptor;
    .locals 7
    .parameter "uri"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 8239
    invoke-virtual {p1}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v1

    .line 8240
    .local v1, name:Ljava/lang/String;
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->getContentProviderExternal(Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v0

    .line 8241
    .local v0, cph:Landroid/app/IActivityManager$ContentProviderHolder;
    const/4 v2, 0x0

    .line 8242
    .local v2, pfd:Landroid/os/ParcelFileDescriptor;
    if-eqz v0, :cond_0

    .line 8250
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    new-instance v4, Lcom/android/server/am/ActivityManagerService$Identity;

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-direct {v4, p0, v5, v6}, Lcom/android/server/am/ActivityManagerService$Identity;-><init>(Lcom/android/server/am/ActivityManagerService;II)V

    invoke-virtual {v3, v4}, Ljava/lang/ThreadLocal;->set(Ljava/lang/Object;)V

    .line 8253
    :try_start_0
    iget-object v3, v0, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    const-string v4, "r"

    invoke-interface {v3, p1, v4}, Landroid/content/IContentProvider;->openFile(Landroid/net/Uri;Ljava/lang/String;)Landroid/os/ParcelFileDescriptor;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v2

    .line 8258
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    :goto_0
    invoke-virtual {v3}, Ljava/lang/ThreadLocal;->remove()V

    .line 8262
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeContentProviderExternal(Ljava/lang/String;)V

    .line 8266
    :goto_1
    return-object v2

    .line 8258
    :catchall_0
    move-exception v3

    sget-object v4, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v4}, Ljava/lang/ThreadLocal;->remove()V

    throw v3

    .line 8264
    :cond_0
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failed to get provider for authority \'"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\'"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_1

    .line 8254
    :catch_0
    move-exception v3

    .line 8258
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    goto :goto_0
.end method

.method public overridePendingTransition(Landroid/os/IBinder;Ljava/lang/String;II)V
    .locals 6
    .parameter "token"
    .parameter "packageName"
    .parameter "enterAnim"
    .parameter "exitAnim"

    .prologue
    .line 4396
    monitor-enter p0

    .line 4397
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 4398
    .local v0, index:I
    if-gez v0, :cond_0

    .line 4399
    monitor-exit p0

    .line 4413
    :goto_0
    return-void

    .line 4401
    :cond_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 4403
    .local v3, self:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 4405
    .local v1, origId:J
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v4, v5, :cond_1

    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v4, v5, :cond_2

    .line 4407
    :cond_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v4, p2, p3, p4}, Lcom/android/server/WindowManagerService;->overridePendingAppTransition(Ljava/lang/String;II)V

    .line 4411
    :cond_2
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4412
    monitor-exit p0

    goto :goto_0

    .end local v0           #index:I
    .end local v1           #origId:J
    .end local v3           #self:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method pauseIfSleepingLocked()V
    .locals 2

    .prologue
    .line 8320
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v0, :cond_0

    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-eqz v0, :cond_2

    .line 8321
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-nez v0, :cond_1

    .line 8322
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->acquire()V

    .line 8323
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-eqz v0, :cond_1

    .line 8324
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 8325
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v1, 0x10

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeMessages(I)V

    .line 8332
    :cond_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v0, :cond_2

    .line 8335
    const/4 v0, 0x0

    const/4 v1, 0x1

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 8338
    :cond_2
    return-void
.end method

.method public peekService(Landroid/content/Intent;Ljava/lang/String;)Landroid/os/IBinder;
    .locals 6
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 11527
    if-eqz p1, :cond_0

    invoke-virtual {p1}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_0

    .line 11528
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "File descriptors passed in Intent"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11531
    :cond_0
    const/4 v2, 0x0

    .line 11533
    .local v2, ret:Landroid/os/IBinder;
    monitor-enter p0

    .line 11534
    :try_start_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v1

    .line 11536
    .local v1, r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-eqz v1, :cond_2

    .line 11538
    iget-object v3, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-nez v3, :cond_1

    .line 11539
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: Accessing service "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v5, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " requires "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11550
    .end local v1           #r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 11545
    .restart local v1       #r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    :cond_1
    :try_start_1
    iget-object v3, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v3, v3, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v3, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/IntentBindRecord;

    .line 11546
    .local v0, ib:Lcom/android/server/am/IntentBindRecord;
    if-eqz v0, :cond_2

    .line 11547
    iget-object v2, v0, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 11550
    .end local v0           #ib:Lcom/android/server/am/IntentBindRecord;
    :cond_2
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11552
    return-object v2
.end method

.method final performAppGcLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 2
    .parameter "app"

    .prologue
    .line 14127
    :try_start_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    .line 14128
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_0

    .line 14129
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    if-eqz v0, :cond_1

    .line 14130
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    .line 14131
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->scheduleLowMemory()V

    .line 14139
    :cond_0
    :goto_0
    return-void

    .line 14133
    :cond_1
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->processInBackground()V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 14136
    :catch_0
    move-exception v0

    goto :goto_0
.end method

.method final performAppGcsIfAppropriateLocked()V
    .locals 1

    .prologue
    .line 14188
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->canGcNowLocked()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 14189
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->performAppGcsLocked()V

    .line 14194
    :goto_0
    return-void

    .line 14193
    :cond_0
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0
.end method

.method final performAppGcsLocked()V
    .locals 6

    .prologue
    .line 14156
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 14157
    .local v0, N:I
    if-gtz v0, :cond_1

    .line 14182
    :cond_0
    :goto_0
    return-void

    .line 14160
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->canGcNowLocked()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 14161
    :cond_2
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-lez v2, :cond_5

    .line 14162
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    const/4 v3, 0x0

    invoke-virtual {v2, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14163
    .local v1, proc:Lcom/android/server/am/ProcessRecord;
    iget v2, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-gt v2, v3, :cond_3

    iget-boolean v2, v1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    if-eqz v2, :cond_2

    .line 14164
    :cond_3
    iget-wide v2, v1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v4, 0xea60

    add-long/2addr v2, v4

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    cmp-long v2, v2, v4

    if-gtz v2, :cond_4

    .line 14168
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->performAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14169
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0

    .line 14174
    :cond_4
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14180
    .end local v1           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_5
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0
.end method

.method final performServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)V
    .locals 2
    .parameter "r"

    .prologue
    .line 11213
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_0

    .line 11217
    :goto_0
    return-void

    .line 11216
    :cond_0
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v0}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/Intent;->getFlags()I

    move-result v0

    const/4 v1, 0x1

    invoke-direct {p0, p1, v0, v1}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    goto :goto_0
.end method

.method final processStoppingActivitiesLocked(Z)Ljava/util/ArrayList;
    .locals 7
    .parameter "remove"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(Z)",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation

    .prologue
    const/4 v6, 0x0

    .line 5695
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 5696
    .local v0, N:I
    if-gtz v0, :cond_0

    const/4 v5, 0x0

    .line 5733
    :goto_0
    return-object v5

    .line 5698
    :cond_0
    const/4 v4, 0x0

    .line 5700
    .local v4, stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_4

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v5, v5, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v5, :cond_4

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v5, v5, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-nez v5, :cond_4

    const/4 v5, 0x1

    move v2, v5

    .line 5703
    .local v2, nowVisible:Z
    :goto_1
    const/4 v1, 0x0

    .local v1, i:I
    :goto_2
    if-ge v1, v0, :cond_5

    .line 5704
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 5708
    .local v3, s:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-eqz v5, :cond_1

    if-eqz v2, :cond_1

    .line 5709
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5710
    iput-boolean v6, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 5711
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_1

    .line 5718
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v3, v6}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 5721
    :cond_1
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-nez v5, :cond_3

    if-eqz p1, :cond_3

    .line 5723
    if-nez v4, :cond_2

    .line 5724
    new-instance v4, Ljava/util/ArrayList;

    .end local v4           #stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 5726
    .restart local v4       #stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_2
    invoke-virtual {v4, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 5727
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5728
    add-int/lit8 v0, v0, -0x1

    .line 5729
    add-int/lit8 v1, v1, -0x1

    .line 5703
    :cond_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .end local v1           #i:I
    .end local v2           #nowVisible:Z
    .end local v3           #s:Lcom/android/server/am/HistoryRecord;
    :cond_4
    move v2, v6

    .line 5700
    goto :goto_1

    .restart local v1       #i:I
    .restart local v2       #nowVisible:Z
    :cond_5
    move-object v5, v4

    .line 5733
    goto :goto_0
.end method

.method public profileControl(Ljava/lang/String;ZLjava/lang/String;Landroid/os/ParcelFileDescriptor;)Z
    .locals 10
    .parameter "process"
    .parameter "start"
    .parameter "path"
    .parameter "fd"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 14636
    :try_start_0
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 14639
    :try_start_1
    const-string v7, "android.permission.SET_ACTIVITY_WATCHER"

    invoke-virtual {p0, v7}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v7

    if-eqz v7, :cond_1

    .line 14641
    new-instance v7, Ljava/lang/SecurityException;

    const-string v8, "Requires permission android.permission.SET_ACTIVITY_WATCHER"

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 14681
    :catchall_0
    move-exception v7

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    :try_start_2
    throw v7
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 14682
    :catch_0
    move-exception v7

    move-object v2, v7

    .line 14683
    .local v2, e:Landroid/os/RemoteException;
    :try_start_3
    new-instance v7, Ljava/lang/IllegalStateException;

    const-string v8, "Process disappeared"

    invoke-direct {v7, v8}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 14685
    .end local v2           #e:Landroid/os/RemoteException;
    :catchall_1
    move-exception v7

    if-eqz p4, :cond_0

    .line 14687
    :try_start_4
    invoke-virtual {p4}, Landroid/os/ParcelFileDescriptor;->close()V
    :try_end_4
    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_2

    .line 14685
    :cond_0
    :goto_0
    throw v7

    .line 14645
    :cond_1
    if-eqz p2, :cond_2

    if-nez p4, :cond_2

    .line 14646
    :try_start_5
    new-instance v7, Ljava/lang/IllegalArgumentException;

    const-string v8, "null fd"

    invoke-direct {v7, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 14649
    :cond_2
    const/4 v5, 0x0

    .line 14651
    .local v5, proc:Lcom/android/server/am/ProcessRecord;
    :try_start_6
    invoke-static {p1}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result v4

    .line 14652
    .local v4, pid:I
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v8
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0
    .catch Ljava/lang/NumberFormatException; {:try_start_6 .. :try_end_6} :catch_1

    .line 14653
    :try_start_7
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v7

    move-object v0, v7

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    .line 14654
    monitor-exit v8
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_2

    .line 14658
    .end local v4           #pid:I
    :goto_1
    if-nez v5, :cond_3

    .line 14659
    :try_start_8
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v7}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v1

    .line 14661
    .local v1, all:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;>;"
    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/util/SparseArray;

    .line 14662
    .local v6, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    if-eqz v6, :cond_3

    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I

    move-result v7

    if-lez v7, :cond_3

    .line 14663
    const/4 v7, 0x0

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #proc:Lcom/android/server/am/ProcessRecord;
    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 14667
    .end local v1           #all:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;>;"
    .end local v6           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v5       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_3
    if-eqz v5, :cond_4

    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v7, :cond_5

    .line 14668
    :cond_4
    new-instance v7, Ljava/lang/IllegalArgumentException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Unknown process: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v7, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0

    .line 14654
    .restart local v4       #pid:I
    :catchall_2
    move-exception v7

    :try_start_9
    monitor-exit v8
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_2

    :try_start_a
    throw v7
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_0
    .catch Ljava/lang/NumberFormatException; {:try_start_a .. :try_end_a} :catch_1

    .line 14655
    .end local v4           #pid:I
    :catch_1
    move-exception v7

    goto :goto_1

    .line 14671
    :cond_5
    :try_start_b
    const-string v7, "1"

    const-string v8, "ro.secure"

    const-string v9, "0"

    invoke-static {v8, v9}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    .line 14672
    .local v3, isSecure:Z
    if-eqz v3, :cond_6

    .line 14673
    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v7, v7, 0x2

    if-nez v7, :cond_6

    .line 14674
    new-instance v7, Ljava/lang/SecurityException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Process not debuggable: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 14678
    :cond_6
    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v7, p2, p3, p4}, Landroid/app/IApplicationThread;->profilerControl(ZLjava/lang/String;Landroid/os/ParcelFileDescriptor;)V

    .line 14679
    const/4 p4, 0x0

    .line 14680
    const/4 v7, 0x1

    monitor-exit p0
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_0

    .line 14685
    if-eqz p4, :cond_7

    .line 14687
    :try_start_c
    throw p4
    :try_end_c
    .catch Ljava/io/IOException; {:try_start_c .. :try_end_c} :catch_3

    .line 14680
    :cond_7
    :goto_2
    return v7

    .line 14688
    .end local v3           #isSecure:Z
    .end local v5           #proc:Lcom/android/server/am/ProcessRecord;
    :catch_2
    move-exception v8

    goto/16 :goto_0

    .restart local v3       #isSecure:Z
    .restart local v5       #proc:Lcom/android/server/am/ProcessRecord;
    :catch_3
    move-exception v8

    goto :goto_2
.end method

.method public final publishContentProviders(Landroid/app/IApplicationThread;Ljava/util/List;)V
    .locals 13
    .parameter "caller"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/app/IApplicationThread;",
            "Ljava/util/List",
            "<",
            "Landroid/app/IActivityManager$ContentProviderHolder;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 8111
    .local p2, providers:Ljava/util/List;,"Ljava/util/List<Landroid/app/IActivityManager$ContentProviderHolder;>;"
    if-nez p2, :cond_0

    .line 8161
    :goto_0
    return-void

    .line 8115
    :cond_0
    monitor-enter p0

    .line 8116
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 8117
    .local v8, r:Lcom/android/server/am/ProcessRecord;
    if-nez v8, :cond_1

    .line 8118
    new-instance v10, Ljava/lang/SecurityException;

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Unable to find app for caller "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " (pid="

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v12

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ") when publishing content providers"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-direct {v10, v11}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v10

    .line 8160
    .end local v8           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v10

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v10

    .line 8124
    .restart local v8       #r:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 8126
    .local v6, origId:J
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v0

    .line 8127
    .local v0, N:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_1
    if-ge v3, v0, :cond_7

    .line 8128
    invoke-interface {p2, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Landroid/app/IActivityManager$ContentProviderHolder;

    .line 8129
    .local v9, src:Landroid/app/IActivityManager$ContentProviderHolder;
    if-eqz v9, :cond_2

    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->info:Landroid/content/pm/ProviderInfo;

    if-eqz v10, :cond_2

    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    if-nez v10, :cond_3

    .line 8127
    :cond_2
    :goto_2
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 8132
    :cond_3
    iget-object v10, v8, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    iget-object v11, v9, Landroid/app/IActivityManager$ContentProviderHolder;->info:Landroid/content/pm/ProviderInfo;

    iget-object v11, v11, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 8134
    .local v2, dst:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v2, :cond_2

    .line 8135
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v11, v2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v11, v11, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v11, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8136
    iget-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v10, v10, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;

    const-string v11, ";"

    invoke-virtual {v10, v11}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v5

    .line 8137
    .local v5, names:[Ljava/lang/String;
    const/4 v4, 0x0

    .local v4, j:I
    :goto_3
    array-length v10, v5

    if-ge v4, v10, :cond_4

    .line 8138
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    aget-object v11, v5, v4

    invoke-virtual {v10, v11, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8137
    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    .line 8141
    :cond_4
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 8143
    .local v1, NL:I
    const/4 v4, 0x0

    :goto_4
    if-ge v4, v1, :cond_6

    .line 8144
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v10

    if-ne v10, v2, :cond_5

    .line 8145
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 8146
    add-int/lit8 v4, v4, -0x1

    .line 8147
    add-int/lit8 v1, v1, -0x1

    .line 8143
    :cond_5
    add-int/lit8 v4, v4, 0x1

    goto :goto_4

    .line 8150
    :cond_6
    monitor-enter v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8151
    :try_start_2
    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    .line 8152
    iput-object v8, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 8153
    invoke-virtual {v2}, Ljava/lang/Object;->notifyAll()V

    .line 8154
    monitor-exit v2
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 8155
    :try_start_3
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_2

    .line 8154
    :catchall_1
    move-exception v10

    :try_start_4
    monitor-exit v2
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v10

    .line 8159
    .end local v1           #NL:I
    .end local v2           #dst:Lcom/android/server/am/ContentProviderRecord;
    .end local v4           #j:I
    .end local v5           #names:[Ljava/lang/String;
    .end local v9           #src:Landroid/app/IActivityManager$ContentProviderHolder;
    :cond_7
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8160
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto/16 :goto_0
.end method

.method public publishService(Landroid/os/IBinder;Landroid/content/Intent;Landroid/os/IBinder;)V
    .locals 12
    .parameter "token"
    .parameter "intent"
    .parameter "service"

    .prologue
    const/4 v10, 0x1

    .line 11862
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v9

    if-ne v9, v10, :cond_0

    .line 11863
    new-instance v9, Ljava/lang/IllegalArgumentException;

    const-string v10, "File descriptors passed in Intent"

    invoke-direct {v9, v10}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v9

    .line 11866
    :cond_0
    monitor-enter p0

    .line 11867
    :try_start_0
    instance-of v9, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v9, :cond_1

    .line 11868
    new-instance v9, Ljava/lang/IllegalArgumentException;

    const-string v10, "Invalid service token"

    invoke-direct {v9, v10}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v9

    .line 11914
    :catchall_0
    move-exception v9

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v9

    .line 11870
    :cond_1
    :try_start_1
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v8, v0

    .line 11872
    .local v8, r:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 11876
    .local v6, origId:J
    if-eqz v8, :cond_4

    .line 11877
    new-instance v4, Landroid/content/Intent$FilterComparison;

    invoke-direct {v4, p2}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 11879
    .local v4, filter:Landroid/content/Intent$FilterComparison;
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v9, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 11880
    .local v1, b:Lcom/android/server/am/IntentBindRecord;
    if-eqz v1, :cond_3

    iget-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->received:Z

    if-nez v9, :cond_3

    .line 11881
    iput-object p3, v1, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 11882
    const/4 v9, 0x1

    iput-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->requested:Z

    .line 11883
    const/4 v9, 0x1

    iput-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->received:Z

    .line 11884
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_3

    .line 11885
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 11887
    .local v5, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_2
    :goto_0
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_3

    .line 11888
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ConnectionRecord;

    .line 11889
    .local v2, c:Lcom/android/server/am/ConnectionRecord;
    iget-object v9, v2, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v9, v9, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v9, v9, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v4, v9}, Landroid/content/Intent$FilterComparison;->equals(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move-result v9

    if-eqz v9, :cond_2

    .line 11900
    :try_start_2
    iget-object v9, v2, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    iget-object v10, v8, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-interface {v9, v10, p3}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    goto :goto_0

    .line 11901
    :catch_0
    move-exception v9

    move-object v3, v9

    .line 11902
    .local v3, e:Ljava/lang/Exception;
    :try_start_3
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Failure sending service "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v8, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " to connection "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v2, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v11}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v11

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " (in "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v2, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v11, v11, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v11, v11, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, ")"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0

    .line 11910
    .end local v2           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #e:Ljava/lang/Exception;
    .end local v5           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_3
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v8}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v9

    invoke-virtual {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11912
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11914
    .end local v1           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v4           #filter:Landroid/content/Intent$FilterComparison;
    :cond_4
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 11915
    return-void
.end method

.method public registerActivityWatcher(Landroid/app/IActivityWatcher;)V
    .locals 1
    .parameter "watcher"

    .prologue
    .line 8464
    monitor-enter p0

    .line 8465
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->register(Landroid/os/IInterface;)Z

    .line 8466
    monitor-exit p0

    .line 8467
    return-void

    .line 8466
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public registerReceiver(Landroid/app/IApplicationThread;Landroid/content/IIntentReceiver;Landroid/content/IntentFilter;Ljava/lang/String;)Landroid/content/Intent;
    .locals 30
    .parameter "caller"
    .parameter "receiver"
    .parameter "filter"
    .parameter "permission"

    .prologue
    .line 12238
    monitor-enter p0

    .line 12239
    const/4 v6, 0x0

    .line 12240
    .local v6, callerApp:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_0

    .line 12241
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v6

    .line 12242
    if-nez v6, :cond_0

    .line 12243
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find app for caller "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ") when registering receiver "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v5, v7}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12319
    .end local p1
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 12250
    .restart local p1
    :cond_0
    const/16 v25, 0x0

    .line 12253
    .local v25, allSticky:Ljava/util/List;
    :try_start_1
    invoke-virtual/range {p3 .. p3}, Landroid/content/IntentFilter;->actionsIterator()Ljava/util/Iterator;

    move-result-object v24

    .line 12254
    .local v24, actions:Ljava/util/Iterator;
    if-eqz v24, :cond_1

    .line 12255
    :goto_0
    invoke-interface/range {v24 .. v24}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_2

    .line 12256
    invoke-interface/range {v24 .. v24}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Ljava/lang/String;

    .line 12257
    .local v23, action:Ljava/lang/String;
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    move-object/from16 v2, p3

    move-object/from16 v3, v25

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->getStickiesLocked(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;

    move-result-object v25

    .line 12258
    goto :goto_0

    .line 12260
    .end local v23           #action:Ljava/lang/String;
    :cond_1
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move-object/from16 v2, p3

    move-object/from16 v3, v25

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->getStickiesLocked(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;

    move-result-object v25

    .line 12265
    :cond_2
    if-eqz v25, :cond_3

    const/4 v5, 0x0

    move-object/from16 v0, v25

    move v1, v5

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    .end local p1
    check-cast p1, Landroid/content/Intent;

    move-object/from16 v29, p1

    .line 12270
    .local v29, sticky:Landroid/content/Intent;
    :goto_1
    if-nez p2, :cond_4

    .line 12271
    monitor-exit p0

    .line 12318
    :goto_2
    return-object v29

    .line 12265
    .end local v29           #sticky:Landroid/content/Intent;
    .restart local p1
    :cond_3
    const/4 v5, 0x0

    move-object/from16 v29, v5

    goto :goto_1

    .line 12274
    .end local p1
    .restart local v29       #sticky:Landroid/content/Intent;
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v5, v0

    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    invoke-virtual {v5, v7}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ReceiverList;

    .line 12276
    .local v4, rl:Lcom/android/server/am/ReceiverList;
    if-nez v4, :cond_5

    .line 12277
    new-instance v4, Lcom/android/server/am/ReceiverList;

    .end local v4           #rl:Lcom/android/server/am/ReceiverList;
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v7

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    move-object/from16 v5, p0

    move-object/from16 v9, p2

    invoke-direct/range {v4 .. v9}, Lcom/android/server/am/ReceiverList;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;IILandroid/content/IIntentReceiver;)V

    .line 12280
    .restart local v4       #rl:Lcom/android/server/am/ReceiverList;
    iget-object v5, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v5, :cond_8

    .line 12281
    iget-object v5, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v5, v4}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 12290
    :goto_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v5, v0

    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    invoke-virtual {v5, v7, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12292
    :cond_5
    new-instance v26, Lcom/android/server/am/BroadcastFilter;

    move-object/from16 v0, v26

    move-object/from16 v1, p3

    move-object v2, v4

    move-object/from16 v3, p4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastFilter;-><init>(Landroid/content/IntentFilter;Lcom/android/server/am/ReceiverList;Ljava/lang/String;)V

    .line 12293
    .local v26, bf:Lcom/android/server/am/BroadcastFilter;
    move-object v0, v4

    move-object/from16 v1, v26

    invoke-virtual {v0, v1}, Lcom/android/server/am/ReceiverList;->add(Ljava/lang/Object;)Z

    .line 12294
    invoke-virtual/range {v26 .. v26}, Lcom/android/server/am/BroadcastFilter;->debugCheck()Z

    move-result v5

    if-nez v5, :cond_6

    .line 12295
    const-string v5, "ActivityManager"

    const-string v7, "==> For Dynamic broadast"

    invoke-static {v5, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12297
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-virtual {v0, v1}, Lcom/android/server/IntentResolver;->addFilter(Landroid/content/IntentFilter;)V

    .line 12301
    if-eqz v25, :cond_9

    .line 12302
    new-instance v14, Ljava/util/ArrayList;

    invoke-direct {v14}, Ljava/util/ArrayList;-><init>()V

    .line 12303
    .local v14, receivers:Ljava/util/ArrayList;
    move-object v0, v14

    move-object/from16 v1, v26

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12305
    invoke-interface/range {v25 .. v25}, Ljava/util/List;->size()I

    move-result v22

    .line 12306
    .local v22, N:I
    const/16 v28, 0x0

    .local v28, i:I
    :goto_4
    move/from16 v0, v28

    move/from16 v1, v22

    if-ge v0, v1, :cond_9

    .line 12307
    move-object/from16 v0, v25

    move/from16 v1, v28

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/Intent;

    .line 12308
    .local v8, intent:Landroid/content/Intent;
    new-instance v7, Lcom/android/server/am/BroadcastRecord;

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, -0x1

    const/4 v12, -0x1

    const/4 v13, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    const/16 v20, 0x1

    const/16 v21, 0x1

    invoke-direct/range {v7 .. v21}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;ZZZ)V

    .line 12311
    .local v7, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_7

    .line 12312
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12314
    :cond_7
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12306
    add-int/lit8 v28, v28, 0x1

    goto :goto_4

    .line 12284
    .end local v7           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v8           #intent:Landroid/content/Intent;
    .end local v14           #receivers:Ljava/util/ArrayList;
    .end local v22           #N:I
    .end local v26           #bf:Lcom/android/server/am/BroadcastFilter;
    .end local v28           #i:I
    :cond_8
    :try_start_2
    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    const/4 v7, 0x0

    invoke-interface {v5, v4, v7}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 12288
    const/4 v5, 0x1

    :try_start_3
    iput-boolean v5, v4, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    goto/16 :goto_3

    .line 12285
    :catch_0
    move-exception v5

    move-object/from16 v27, v5

    .line 12286
    .local v27, e:Landroid/os/RemoteException;
    monitor-exit p0

    goto/16 :goto_2

    .line 12318
    .end local v27           #e:Landroid/os/RemoteException;
    .restart local v26       #bf:Lcom/android/server/am/BroadcastFilter;
    :cond_9
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto/16 :goto_2
.end method

.method public removeContentProvider(Landroid/app/IApplicationThread;Ljava/lang/String;)V
    .locals 8
    .parameter "caller"
    .parameter "name"

    .prologue
    const/4 v7, 0x1

    .line 8052
    monitor-enter p0

    .line 8053
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v4, p2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 8054
    .local v1, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v1, :cond_0

    .line 8058
    monitor-exit p0

    .line 8088
    :goto_0
    return-void

    .line 8060
    :cond_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v3

    .line 8061
    .local v3, r:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_1

    .line 8062
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " when removing content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 8087
    .end local v1           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 8067
    .restart local v1       #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v3       #r:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v5, v1, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v5, v5, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 8072
    .local v2, localCpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v4, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v4, v3, :cond_2

    .line 8074
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "removeContentProvider called on local provider: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v1, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v6, v6, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " in process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8076
    monitor-exit p0

    goto :goto_0

    .line 8078
    :cond_2
    iget-object v4, v3, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v4, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/Integer;

    .line 8079
    .local v0, cnt:Ljava/lang/Integer;
    if-eqz v0, :cond_3

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v4

    if-gt v4, v7, :cond_4

    .line 8080
    :cond_3
    iget-object v4, v2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v4, v3}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 8081
    iget-object v4, v3, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v4, v2}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 8086
    :goto_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 8087
    monitor-exit p0

    goto/16 :goto_0

    .line 8083
    :cond_4
    iget-object v4, v3, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    new-instance v5, Ljava/lang/Integer;

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v6

    sub-int/2addr v6, v7

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    invoke-virtual {v4, v2, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_1
.end method

.method removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V
    .locals 4
    .parameter "rl"

    .prologue
    .line 12360
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    iget-object v3, p1, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v3}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 12361
    invoke-virtual {p1}, Lcom/android/server/am/ReceiverList;->size()I

    move-result v0

    .line 12362
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_0

    .line 12363
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    invoke-virtual {p1, v1}, Lcom/android/server/am/ReceiverList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/IntentFilter;

    invoke-virtual {v3, v2}, Lcom/android/server/IntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 12362
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .line 12365
    :cond_0
    return-void
.end method

.method removeRequestedPss(Lcom/android/server/am/ProcessRecord;)V
    .locals 2
    .parameter "proc"

    .prologue
    .line 8614
    const/4 v0, 0x0

    .line 8615
    .local v0, callback:Ljava/lang/Runnable;
    monitor-enter p0

    .line 8616
    :try_start_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_0

    .line 8617
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-nez v1, :cond_0

    .line 8618
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8619
    const/4 v1, 0x0

    iput-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8622
    :cond_0
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8624
    if-eqz v0, :cond_1

    .line 8625
    invoke-interface {v0}, Ljava/lang/Runnable;->run()V

    .line 8627
    :cond_1
    return-void

    .line 8622
    :catchall_0
    move-exception v1

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v1
.end method

.method reportActivityLaunchedLocked(ZLcom/android/server/am/HistoryRecord;JJ)V
    .locals 5
    .parameter "timeout"
    .parameter "r"
    .parameter "thisTime"
    .parameter "totalTime"

    .prologue
    .line 3648
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 3649
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/app/IActivityManager$WaitResult;

    .line 3650
    .local v1, w:Landroid/app/IActivityManager$WaitResult;
    iput-boolean p1, v1, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    .line 3651
    if-eqz p2, :cond_0

    .line 3652
    new-instance v2, Landroid/content/ComponentName;

    iget-object v3, p2, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v4, p2, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    iput-object v2, v1, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    .line 3654
    :cond_0
    iput-wide p3, v1, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    .line 3655
    iput-wide p5, v1, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    .line 3648
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 3657
    .end local v1           #w:Landroid/app/IActivityManager$WaitResult;
    :cond_1
    invoke-virtual {p0}, Ljava/lang/Object;->notify()V

    .line 3658
    return-void
.end method

.method reportActivityVisibleLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "r"

    .prologue
    .line 3661
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 3662
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/app/IActivityManager$WaitResult;

    .line 3663
    .local v1, w:Landroid/app/IActivityManager$WaitResult;
    const/4 v2, 0x0

    iput-boolean v2, v1, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    .line 3664
    if-eqz p1, :cond_0

    .line 3665
    new-instance v2, Landroid/content/ComponentName;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    iput-object v2, v1, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    .line 3667
    :cond_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v2

    iget-wide v4, v1, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    sub-long/2addr v2, v4

    iput-wide v2, v1, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    .line 3668
    iget-wide v2, v1, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    iput-wide v2, v1, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    .line 3661
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 3670
    .end local v1           #w:Landroid/app/IActivityManager$WaitResult;
    :cond_1
    invoke-virtual {p0}, Ljava/lang/Object;->notify()V

    .line 3671
    return-void
.end method

.method public reportPss(Landroid/app/IApplicationThread;I)V
    .locals 4
    .parameter "caller"
    .parameter "pss"

    .prologue
    .line 8571
    monitor-enter p0

    .line 8572
    if-nez p1, :cond_1

    .line 8573
    :try_start_0
    monitor-exit p0

    .line 8587
    :cond_0
    :goto_0
    return-void

    .line 8575
    :cond_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 8576
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_2

    .line 8577
    monitor-exit p0

    goto :goto_0

    .line 8582
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 8579
    .restart local v0       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_2
    :try_start_1
    iput p2, v0, Lcom/android/server/am/ProcessRecord;->lastPss:I

    .line 8580
    move-object v2, v0

    .line 8581
    .local v2, req:Lcom/android/server/Watchdog$PssRequestor;
    iget-object v1, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    .line 8582
    .local v1, name:Ljava/lang/String;
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8583
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v3

    invoke-virtual {v3, v2, v1, p2}, Lcom/android/server/Watchdog;->reportPss(Lcom/android/server/Watchdog$PssRequestor;Ljava/lang/String;I)V

    .line 8584
    iget-boolean v3, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v3, :cond_0

    .line 8585
    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->removeRequestedPss(Lcom/android/server/am/ProcessRecord;)V

    goto :goto_0
.end method

.method public reportThumbnail(Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;)V
    .locals 8
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"

    .prologue
    .line 7673
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 7674
    .local v6, origId:J
    const/4 v1, 0x0

    const/4 v5, 0x1

    move-object v0, p0

    move-object v2, p1

    move-object v3, p2

    move-object v4, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 7675
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7676
    return-void
.end method

.method public requestPss(Ljava/lang/Runnable;)V
    .locals 6
    .parameter "completeCallback"

    .prologue
    const/4 v5, 0x1

    .line 8591
    monitor-enter p0

    .line 8592
    :try_start_0
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8593
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->clear()V

    .line 8594
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    sub-int v0, v4, v5

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 8595
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 8596
    .local v2, proc:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v4, :cond_0

    .line 8597
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8594
    :cond_0
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 8600
    .end local v2           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_1
    new-instance v3, Ljava/util/ArrayList;

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    .line 8601
    .local v3, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8603
    invoke-static {}, Landroid/os/Process;->myTid()I

    move-result v4

    invoke-static {v4}, Landroid/os/Process;->getThreadPriority(I)I

    move-result v1

    .line 8604
    .local v1, oldPri:I
    const/16 v4, 0xa

    invoke-static {v4}, Landroid/os/Process;->setThreadPriority(I)V

    .line 8605
    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v4

    sub-int v0, v4, v5

    :goto_1
    if-ltz v0, :cond_2

    .line 8606
    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 8607
    .restart local v2       #proc:Lcom/android/server/am/ProcessRecord;
    const/4 v4, 0x0

    iput v4, v2, Lcom/android/server/am/ProcessRecord;->lastPss:I

    .line 8608
    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->requestPss()V

    .line 8605
    add-int/lit8 v0, v0, -0x1

    goto :goto_1

    .line 8601
    .end local v0           #i:I
    .end local v1           #oldPri:I
    .end local v2           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v3           #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :catchall_0
    move-exception v4

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 8610
    .restart local v0       #i:I
    .restart local v1       #oldPri:I
    .restart local v3       #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_2
    invoke-static {v1}, Landroid/os/Process;->setThreadPriority(I)V

    .line 8611
    return-void
.end method

.method public resumeAppSwitches()V
    .locals 2

    .prologue
    .line 8369
    const-string v0, "android.permission.STOP_APP_SWITCHES"

    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_0

    .line 8371
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Requires permission android.permission.STOP_APP_SWITCHES"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 8375
    :cond_0
    monitor-enter p0

    .line 8379
    const-wide/16 v0, 0x0

    :try_start_0
    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 8380
    monitor-exit p0

    .line 8381
    return-void

    .line 8380
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public revokeUriPermission(Landroid/app/IApplicationThread;Landroid/net/Uri;I)V
    .locals 8
    .parameter "caller"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    const-string v5, "ActivityManager"

    .line 6731
    monitor-enter p0

    .line 6732
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v4

    .line 6733
    .local v4, r:Lcom/android/server/am/ProcessRecord;
    if-nez v4, :cond_0

    .line 6734
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unable to find app for caller "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " when revoking permission to uri "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 6770
    .end local v4           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 6738
    .restart local v4       #r:Lcom/android/server/am/ProcessRecord;
    :cond_0
    if-nez p2, :cond_1

    .line 6739
    :try_start_1
    const-string v5, "ActivityManager"

    const-string v6, "revokeUriPermission: null uri"

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6740
    monitor-exit p0

    .line 6771
    :goto_0
    return-void

    .line 6743
    :cond_1
    and-int/lit8 p3, p3, 0x3

    .line 6745
    if-nez p3, :cond_2

    .line 6746
    monitor-exit p0

    goto :goto_0

    .line 6749
    :cond_2
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    .line 6751
    .local v3, pm:Landroid/content/pm/IPackageManager;
    invoke-virtual {p2}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v0

    .line 6752
    .local v0, authority:Ljava/lang/String;
    const/4 v2, 0x0

    .line 6753
    .local v2, pi:Landroid/content/pm/ProviderInfo;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v5, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 6755
    .local v1, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v1, :cond_3

    .line 6756
    iget-object v2, v1, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6764
    :goto_1
    if-nez v2, :cond_4

    .line 6765
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "No content provider found for: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6766
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_0

    .line 6759
    :cond_3
    const/16 v5, 0x800

    :try_start_2
    invoke-interface {v3, v0, v5}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    move-result-object v2

    goto :goto_1

    .line 6769
    :cond_4
    :try_start_3
    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v5, p2, p3}, Lcom/android/server/am/ActivityManagerService;->revokeUriPermissionLocked(ILandroid/net/Uri;I)V

    .line 6770
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_0

    .line 6761
    :catch_0
    move-exception v5

    goto :goto_1
.end method

.method final scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 6
    .parameter "app"

    .prologue
    .line 14242
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    .line 14243
    .local v0, now:J
    iget-wide v2, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v4, 0xea60

    add-long/2addr v2, v4

    cmp-long v2, v2, v0

    if-lez v2, :cond_1

    .line 14250
    :cond_0
    :goto_0
    return-void

    .line 14246
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 14247
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14248
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0
.end method

.method final scheduleAppGcsLocked()V
    .locals 12

    .prologue
    const-wide/16 v10, 0x1388

    const/4 v8, 0x5

    const/4 v7, 0x0

    .line 14200
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v8}, Landroid/os/Handler;->removeMessages(I)V

    .line 14202
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-lez v6, :cond_1

    .line 14204
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 14205
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v8}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 14207
    .local v0, msg:Landroid/os/Message;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ProcessRecord;

    iget-wide v6, v6, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v8, 0xea60

    add-long v4, v6, v8

    .line 14208
    .local v4, when:J
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    .line 14209
    .local v1, now:J
    add-long v6, v1, v10

    cmp-long v6, v4, v6

    if-gez v6, :cond_0

    .line 14210
    add-long v4, v1, v10

    .line 14212
    :cond_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v0, v4, v5}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 14214
    .end local v0           #msg:Landroid/os/Message;
    .end local v1           #now:J
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v4           #when:J
    :cond_1
    return-void
.end method

.method sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V
    .locals 8
    .parameter "callingUid"
    .parameter "r"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "resultCode"
    .parameter "data"

    .prologue
    .line 4328
    if-lez p1, :cond_0

    .line 4329
    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-direct {p0, p1, v0, p6, p2}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 4336
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v0, p2, :cond_1

    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_1

    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_1

    .line 4338
    :try_start_0
    new-instance v7, Ljava/util/ArrayList;

    invoke-direct {v7}, Ljava/util/ArrayList;-><init>()V

    .line 4339
    .local v7, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ResultInfo;>;"
    new-instance v0, Landroid/app/ResultInfo;

    invoke-direct {v0, p3, p4, p5, p6}, Landroid/app/ResultInfo;-><init>(Ljava/lang/String;IILandroid/content/Intent;)V

    invoke-virtual {v7, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4341
    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0, p2, v7}, Landroid/app/IApplicationThread;->scheduleSendResult(Landroid/os/IBinder;Ljava/util/List;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 4349
    .end local v7           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ResultInfo;>;"
    :goto_0
    return-void

    .line 4343
    :catch_0
    move-exception v0

    move-object v6, v0

    .line 4344
    .local v6, e:Ljava/lang/Exception;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception thrown sending result to "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 4348
    .end local v6           #e:Ljava/lang/Exception;
    :cond_1
    const/4 v1, 0x0

    move-object v0, p2

    move-object v2, p3

    move v3, p4

    move v4, p5

    move-object v5, p6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/HistoryRecord;->addResultLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    goto :goto_0
.end method

.method final sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V
    .locals 11
    .parameter "r"
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"
    .parameter "always"

    .prologue
    .line 7680
    const/4 v8, 0x0

    .line 7681
    .local v8, task:Lcom/android/server/am/TaskRecord;
    const/4 v6, 0x0

    .line 7685
    .local v6, receivers:Ljava/util/ArrayList;
    monitor-enter p0

    .line 7686
    if-nez p1, :cond_1

    .line 7687
    :try_start_0
    invoke-direct {p0, p2}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v4

    .line 7688
    .local v4, index:I
    if-gez v4, :cond_0

    .line 7689
    monitor-exit p0

    .line 7743
    .end local v4           #index:I
    :goto_0
    return-void

    .line 7691
    .restart local v4       #index:I
    :cond_0
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v9, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    move-object v0, v9

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object p1, v0

    .line 7693
    .end local v4           #index:I
    :cond_1
    if-nez p3, :cond_2

    .line 7694
    iget-object p3, p1, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 7695
    iget-object p4, p1, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    .line 7697
    :cond_2
    if-nez p3, :cond_3

    if-nez p5, :cond_3

    .line 7701
    monitor-exit p0

    goto :goto_0

    .line 7725
    :catchall_0
    move-exception v9

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v9

    .line 7703
    :cond_3
    :try_start_1
    iget-object v8, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7705
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move-result v1

    .line 7706
    .local v1, N:I
    const/4 v3, 0x0

    .local v3, i:I
    move-object v7, v6

    .line 7707
    .end local v6           #receivers:Ljava/util/ArrayList;
    .local v7, receivers:Ljava/util/ArrayList;
    :goto_2
    if-ge v3, v1, :cond_6

    .line 7708
    :try_start_2
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/PendingThumbnailsRecord;

    .line 7711
    .local v5, pr:Lcom/android/server/am/PendingThumbnailsRecord;
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    invoke-virtual {v9, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    move-result v9

    if-eqz v9, :cond_4

    .line 7712
    if-nez v7, :cond_a

    .line 7713
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 7715
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    :goto_3
    :try_start_3
    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7716
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-nez v9, :cond_5

    .line 7717
    const/4 v9, 0x1

    iput-boolean v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->finished:Z

    .line 7718
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 7719
    add-int/lit8 v1, v1, -0x1

    move-object v7, v6

    .line 7720
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    goto :goto_2

    :cond_4
    move-object v6, v7

    .line 7723
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    :cond_5
    add-int/lit8 v3, v3, 0x1

    move-object v7, v6

    .line 7724
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    goto :goto_2

    .line 7725
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_6
    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 7727
    if-eqz v7, :cond_9

    .line 7728
    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 7729
    const/4 v3, 0x0

    :goto_4
    if-ge v3, v1, :cond_9

    .line 7731
    :try_start_5
    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/PendingThumbnailsRecord;

    .line 7733
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->receiver:Landroid/app/IThumbnailReceiver;

    if-eqz v8, :cond_8

    iget v10, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    :goto_5
    invoke-interface {v9, v10, p3, p4}, Landroid/app/IThumbnailReceiver;->newThumbnail(ILandroid/graphics/Bitmap;Ljava/lang/CharSequence;)V

    .line 7735
    iget-boolean v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->finished:Z

    if-eqz v9, :cond_7

    .line 7736
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->receiver:Landroid/app/IThumbnailReceiver;

    invoke-interface {v9}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_5
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_0

    .line 7729
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_7
    :goto_6
    add-int/lit8 v3, v3, 0x1

    goto :goto_4

    .line 7733
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_8
    const/4 v10, -0x1

    goto :goto_5

    .line 7738
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :catch_0
    move-exception v9

    move-object v2, v9

    .line 7739
    .local v2, e:Ljava/lang/Exception;
    const-string v9, "ActivityManager"

    const-string v10, "Exception thrown when sending thumbnail"

    invoke-static {v9, v10, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_6

    .end local v2           #e:Ljava/lang/Exception;
    :cond_9
    move-object v6, v7

    .line 7743
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto/16 :goto_0

    .line 7725
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    :catchall_1
    move-exception v9

    move-object v6, v7

    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto :goto_1

    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    :cond_a
    move-object v6, v7

    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto :goto_3
.end method

.method public serviceDoneExecuting(Landroid/os/IBinder;III)V
    .locals 9
    .parameter "token"
    .parameter "type"
    .parameter "startId"
    .parameter "res"

    .prologue
    const/4 v7, 0x1

    const-string v6, "ActivityManager"

    .line 11958
    monitor-enter p0

    .line 11959
    :try_start_0
    instance-of v6, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v6, :cond_0

    .line 11960
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "Invalid service token"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 12027
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 11962
    :cond_0
    :try_start_1
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v4, v0

    .line 11963
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v1

    .line 11964
    .local v1, inStopping:Z
    if-eqz v4, :cond_4

    .line 11968
    if-eq v4, p1, :cond_1

    .line 11969
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Done executing service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v4, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " with incorrect token: given "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", expected "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11972
    monitor-exit p0

    .line 12028
    :goto_0
    return-void

    .line 11975
    :cond_1
    if-ne p2, v7, :cond_3

    .line 11978
    const/4 v6, 0x1

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11979
    packed-switch p4, :pswitch_data_0

    .line 12012
    new-instance v6, Ljava/lang/IllegalArgumentException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unknown service start result: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 11983
    :pswitch_0
    const/4 v6, 0x1

    invoke-virtual {v4, p3, v6}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    .line 11985
    const/4 v6, 0x0

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    .line 12015
    :cond_2
    :goto_1
    if-nez p4, :cond_3

    .line 12016
    const/4 v6, 0x0

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 12020
    :cond_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 12021
    .local v2, origId:J
    invoke-virtual {p0, v4, v1}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 12022
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12027
    .end local v2           #origId:J
    :goto_2
    monitor-exit p0

    goto :goto_0

    .line 11990
    :pswitch_1
    const/4 v6, 0x1

    invoke-virtual {v4, p3, v6}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    .line 11991
    iget v6, v4, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ne v6, p3, :cond_2

    .line 11994
    const/4 v6, 0x1

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    goto :goto_1

    .line 12002
    :pswitch_2
    const/4 v6, 0x0

    invoke-virtual {v4, p3, v6}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    move-result-object v5

    .line 12003
    .local v5, si:Lcom/android/server/am/ServiceRecord$StartItem;
    if-eqz v5, :cond_2

    .line 12004
    const/4 v6, 0x0

    iput v6, v5, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    .line 12005
    iget v6, v5, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v5, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    .line 12007
    const/4 v6, 0x1

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    goto :goto_1

    .line 12024
    .end local v5           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_4
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Done executing unknown service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v4, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " with token "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_2

    .line 11979
    nop

    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_0
        :pswitch_0
        :pswitch_1
        :pswitch_2
    .end packed-switch
.end method

.method public serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .locals 3
    .parameter "r"
    .parameter "inStopping"

    .prologue
    .line 12031
    iget v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    iput v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 12032
    iget v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    if-gtz v0, :cond_2

    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_2

    .line 12033
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v0, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 12034
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->size()I

    move-result v0

    if-nez v0, :cond_0

    .line 12035
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v1, 0xc

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 12037
    :cond_0
    if-eqz p2, :cond_1

    .line 12038
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 12040
    :cond_1
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 12042
    :cond_2
    return-void
.end method

.method serviceTimeout(Lcom/android/server/am/ProcessRecord;)V
    .locals 13
    .parameter "proc"

    .prologue
    .line 12045
    const/4 v0, 0x0

    .line 12047
    .local v0, anrMessage:Ljava/lang/String;
    monitor-enter p0

    .line 12048
    :try_start_0
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-eqz v9, :cond_0

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v9, :cond_2

    .line 12049
    :cond_0
    monitor-exit p0

    .line 12078
    :cond_1
    :goto_0
    return-void

    .line 12051
    :cond_2
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v9

    const-wide/16 v11, 0x7530

    sub-long v2, v9, v11

    .line 12052
    .local v2, maxTime:J
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 12053
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    const/4 v8, 0x0

    .line 12054
    .local v8, timeout:Lcom/android/server/am/ServiceRecord;
    const-wide/16 v5, 0x0

    .line 12055
    .local v5, nextTime:J
    :cond_3
    :goto_1
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_4

    .line 12056
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ServiceRecord;

    .line 12057
    .local v7, sr:Lcom/android/server/am/ServiceRecord;
    iget-wide v9, v7, Lcom/android/server/am/ServiceRecord;->executingStart:J

    cmp-long v9, v9, v2

    if-gez v9, :cond_5

    .line 12058
    move-object v8, v7

    .line 12065
    .end local v7           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_4
    if-eqz v8, :cond_6

    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v9, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v9

    if-eqz v9, :cond_6

    .line 12066
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Timeout executing service: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12067
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Executing service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v8, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 12073
    :goto_2
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12075
    if-eqz v0, :cond_1

    .line 12076
    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-virtual {p0, p1, v9, v10, v0}, Lcom/android/server/am/ActivityManagerService;->appNotResponding(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V

    goto :goto_0

    .line 12061
    .restart local v7       #sr:Lcom/android/server/am/ServiceRecord;
    :cond_5
    :try_start_1
    iget-wide v9, v7, Lcom/android/server/am/ServiceRecord;->executingStart:J

    cmp-long v9, v9, v5

    if-lez v9, :cond_3

    .line 12062
    iget-wide v5, v7, Lcom/android/server/am/ServiceRecord;->executingStart:J

    goto :goto_1

    .line 12069
    .end local v7           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_6
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v10, 0xc

    invoke-virtual {v9, v10}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v4

    .line 12070
    .local v4, msg:Landroid/os/Message;
    iput-object p1, v4, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 12071
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v10, 0x7530

    add-long/2addr v10, v5

    invoke-virtual {v9, v4, v10, v11}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    goto :goto_2

    .line 12073
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .end local v2           #maxTime:J
    .end local v4           #msg:Landroid/os/Message;
    .end local v5           #nextTime:J
    .end local v8           #timeout:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v9

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v9
.end method

.method public setActivityController(Landroid/app/IActivityController;)V
    .locals 2
    .parameter "controller"

    .prologue
    .line 8448
    const-string v0, "android.permission.SET_ACTIVITY_WATCHER"

    const-string v1, "setActivityController()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8450
    monitor-enter p0

    .line 8451
    :try_start_0
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 8452
    monitor-exit p0

    .line 8453
    return-void

    .line 8452
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public setAlwaysFinish(Z)V
    .locals 3
    .parameter "enabled"

    .prologue
    .line 8435
    const-string v0, "android.permission.SET_ALWAYS_FINISH"

    const-string v1, "setAlwaysFinish()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8438
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "always_finish_activities"

    if-eqz p1, :cond_0

    const/4 v2, 0x1

    :goto_0
    invoke-static {v0, v1, v2}, Landroid/provider/Settings$System;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z

    .line 8442
    monitor-enter p0

    .line 8443
    :try_start_0
    iput-boolean p1, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 8444
    monitor-exit p0

    .line 8445
    return-void

    .line 8438
    :cond_0
    const/4 v2, 0x0

    goto :goto_0

    .line 8444
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public setDebugApp(Ljava/lang/String;ZZ)V
    .locals 9
    .parameter "packageName"
    .parameter "waitForDebugger"
    .parameter "persistent"

    .prologue
    const/4 v3, 0x1

    const/4 v2, 0x0

    .line 8402
    const-string v0, "android.permission.SET_DEBUG_APP"

    const-string v1, "setDebugApp()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8408
    if-eqz p3, :cond_0

    .line 8409
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v8

    .line 8410
    .local v8, resolver:Landroid/content/ContentResolver;
    const-string v0, "debug_app"

    invoke-static {v8, v0, p1}, Landroid/provider/Settings$System;->putString(Landroid/content/ContentResolver;Ljava/lang/String;Ljava/lang/String;)Z

    .line 8413
    const-string v0, "wait_for_debugger"

    if-eqz p2, :cond_3

    move v1, v3

    :goto_0
    invoke-static {v8, v0, v1}, Landroid/provider/Settings$System;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z

    .line 8418
    .end local v8           #resolver:Landroid/content/ContentResolver;
    :cond_0
    monitor-enter p0

    .line 8419
    if-nez p3, :cond_1

    .line 8420
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    .line 8421
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    .line 8423
    :cond_1
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 8424
    iput-boolean p2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 8425
    if-nez p3, :cond_4

    move v0, v3

    :goto_1
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    .line 8426
    if-eqz p1, :cond_2

    .line 8427
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 8428
    .local v6, origId:J
    const/4 v2, -0x1

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 8429
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8431
    .end local v6           #origId:J
    :cond_2
    monitor-exit p0

    .line 8432
    return-void

    .restart local v8       #resolver:Landroid/content/ContentResolver;
    :cond_3
    move v1, v2

    .line 8413
    goto :goto_0

    .end local v8           #resolver:Landroid/content/ContentResolver;
    :cond_4
    move v0, v2

    .line 8425
    goto :goto_1

    .line 8431
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public setPersistent(Landroid/os/IBinder;Z)V
    .locals 9
    .parameter "token"
    .parameter "isPersistent"

    .prologue
    const/4 v7, 0x1

    const-string v8, "android.permission.PERSISTENT_ACTIVITY"

    .line 4976
    const-string v6, "android.permission.PERSISTENT_ACTIVITY"

    invoke-virtual {p0, v8}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v6

    if-eqz v6, :cond_0

    .line 4978
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: setPersistent() from pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "android.permission.PERSISTENT_ACTIVITY"

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 4982
    .local v2, msg:Ljava/lang/String;
    const-string v6, "ActivityManager"

    invoke-static {v6, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4983
    new-instance v6, Ljava/lang/SecurityException;

    invoke-direct {v6, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 4986
    .end local v2           #msg:Ljava/lang/String;
    :cond_0
    monitor-enter p0

    .line 4987
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 4988
    .local v1, index:I
    if-gez v1, :cond_1

    .line 4989
    monitor-exit p0

    .line 5035
    :goto_0
    return-void

    .line 4991
    :cond_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 4992
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4997
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz p2, :cond_5

    .line 4998
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-eqz v6, :cond_2

    .line 5001
    monitor-exit p0

    goto :goto_0

    .line 5034
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #index:I
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 5003
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v1       #index:I
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    const/4 v6, 0x1

    :try_start_1
    iput-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    .line 5004
    iget v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    .line 5006
    iget v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-le v6, v7, :cond_3

    .line 5009
    monitor-exit p0

    goto :goto_0

    .line 5011
    :cond_3
    iget-boolean v6, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v6, :cond_4

    .line 5014
    monitor-exit p0

    goto :goto_0

    .line 5019
    :cond_4
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 5020
    .local v3, origId:J
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 5021
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5034
    :goto_1
    monitor-exit p0

    goto :goto_0

    .line 5024
    .end local v3           #origId:J
    :cond_5
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v6, :cond_6

    .line 5026
    monitor-exit p0

    goto :goto_0

    .line 5028
    :cond_6
    const/4 v6, 0x0

    iput-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    .line 5029
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 5030
    .restart local v3       #origId:J
    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 5031
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_1
.end method

.method public setProcessForeground(Landroid/os/IBinder;IZ)V
    .locals 8
    .parameter "token"
    .parameter "pid"
    .parameter "isForeground"

    .prologue
    .line 6240
    const-string v4, "android.permission.SET_PROCESS_LIMIT"

    const-string v5, "setProcessForeground()"

    invoke-virtual {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6242
    monitor-enter p0

    .line 6243
    const/4 v0, 0x0

    .line 6245
    .local v0, changed:Z
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6246
    :try_start_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 6247
    .local v3, pr:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_0

    .line 6248
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "setProcessForeground called on unknown pid: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6249
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 6282
    :goto_0
    return-void

    .line 6251
    :cond_0
    :try_start_3
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ActivityManagerService$ForegroundToken;

    .line 6252
    .local v2, oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    if-eqz v2, :cond_1

    .line 6253
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->token:Landroid/os/IBinder;

    const/4 v6, 0x0

    invoke-interface {v5, v2, v6}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z

    .line 6254
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->remove(I)V

    .line 6255
    const/4 v5, 0x0

    iput-object v5, v3, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 6256
    const/4 v0, 0x1

    .line 6258
    :cond_1
    if-eqz p3, :cond_2

    if-eqz p1, :cond_2

    .line 6259
    new-instance v1, Lcom/android/server/am/ActivityManagerService$6;

    invoke-direct {v1, p0}, Lcom/android/server/am/ActivityManagerService$6;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    .line 6264
    .local v1, newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    iput p2, v1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    .line 6265
    iput-object p1, v1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->token:Landroid/os/IBinder;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 6267
    const/4 v5, 0x0

    :try_start_4
    invoke-interface {p1, v1, v5}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V

    .line 6268
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2, v1}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 6269
    iput-object p1, v3, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_0

    .line 6270
    const/4 v0, 0x1

    .line 6276
    .end local v1           #newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    :cond_2
    :goto_1
    :try_start_5
    monitor-exit v4
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 6278
    if-eqz v0, :cond_3

    .line 6279
    :try_start_6
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 6281
    :cond_3
    monitor-exit p0

    goto :goto_0

    .end local v2           #oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v3           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    throw v4

    .line 6276
    :catchall_1
    move-exception v5

    :try_start_7
    monitor-exit v4
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    :try_start_8
    throw v5
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0

    .line 6271
    .restart local v1       #newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v2       #oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v3       #pr:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v5

    goto :goto_1
.end method

.method public setProcessLimit(I)V
    .locals 2
    .parameter "max"

    .prologue
    .line 6210
    const-string v0, "android.permission.SET_PROCESS_LIMIT"

    const-string v1, "setProcessLimit()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6212
    iput p1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 6213
    return-void
.end method

.method public setRequestedOrientation(Landroid/os/IBinder;I)V
    .locals 9
    .parameter "token"
    .parameter "requestedOrientation"

    .prologue
    const/4 v8, 0x0

    .line 4013
    monitor-enter p0

    .line 4014
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 4015
    .local v1, index:I
    if-gez v1, :cond_0

    .line 4016
    monitor-exit p0

    .line 4032
    :goto_0
    return-void

    .line 4018
    :cond_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 4019
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 4020
    .local v2, origId:J
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v4, p2}, Lcom/android/server/WindowManagerService;->setAppOrientation(Landroid/view/IApplicationToken;I)V

    .line 4021
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v4, v7}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v7

    if-eqz v7, :cond_2

    move-object v7, v4

    :goto_1
    invoke-virtual {v5, v6, v7}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v0

    .line 4024
    .local v0, config:Landroid/content/res/Configuration;
    if-eqz v0, :cond_1

    .line 4025
    const/4 v5, 0x1

    iput-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 4026
    invoke-virtual {p0, v0, v4}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    move-result v5

    if-nez v5, :cond_1

    .line 4027
    const/4 v5, 0x0

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 4030
    :cond_1
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4031
    monitor-exit p0

    goto :goto_0

    .end local v0           #config:Landroid/content/res/Configuration;
    .end local v1           #index:I
    .end local v2           #origId:J
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .restart local v1       #index:I
    .restart local v2       #origId:J
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    move-object v7, v8

    .line 4021
    goto :goto_1
.end method

.method public setServiceForeground(Landroid/content/ComponentName;Landroid/os/IBinder;ILandroid/app/Notification;Z)V
    .locals 6
    .parameter "className"
    .parameter "token"
    .parameter "id"
    .parameter "notification"
    .parameter "removeNotification"

    .prologue
    .line 11602
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 11604
    .local v0, origId:J
    :try_start_0
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 11605
    :try_start_1
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;

    move-result-object v2

    .line 11606
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_2

    .line 11607
    if-eqz p3, :cond_3

    .line 11608
    if-nez p4, :cond_0

    .line 11609
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "null notification"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11637
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    :try_start_2
    throw v3
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11639
    :catchall_1
    move-exception v3

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3

    .line 11611
    .restart local v2       #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    :try_start_3
    iget v3, v2, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    if-eq v3, p3, :cond_1

    .line 11612
    invoke-virtual {v2}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11613
    iput p3, v2, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    .line 11615
    :cond_1
    iget v3, p4, Landroid/app/Notification;->flags:I

    or-int/lit8 v3, v3, 0x40

    iput v3, p4, Landroid/app/Notification;->flags:I

    .line 11616
    iput-object p4, v2, Lcom/android/server/am/ServiceRecord;->foregroundNoti:Landroid/app/Notification;

    .line 11617
    const/4 v3, 0x1

    iput-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    .line 11618
    invoke-virtual {v2}, Lcom/android/server/am/ServiceRecord;->postNotification()V

    .line 11619
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_2

    .line 11620
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 11637
    :cond_2
    :goto_0
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 11639
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11641
    return-void

    .line 11623
    :cond_3
    :try_start_4
    iget-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eqz v3, :cond_4

    .line 11624
    const/4 v3, 0x0

    iput-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    .line 11625
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    .line 11626
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x0

    const/4 v5, 0x1

    invoke-direct {p0, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 11627
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 11630
    :cond_4
    if-eqz p5, :cond_2

    .line 11631
    invoke-virtual {v2}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11632
    const/4 v3, 0x0

    iput v3, v2, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    .line 11633
    const/4 v3, 0x0

    iput-object v3, v2, Lcom/android/server/am/ServiceRecord;->foregroundNoti:Landroid/app/Notification;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    goto :goto_0
.end method

.method public setWindowManager(Lcom/android/server/WindowManagerService;)V
    .locals 0
    .parameter "wm"

    .prologue
    .line 1280
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    .line 1281
    return-void
.end method

.method public showWaitingForDebugger(Landroid/app/IApplicationThread;Z)V
    .locals 3
    .parameter "who"
    .parameter "waiting"

    .prologue
    .line 6774
    monitor-enter p0

    .line 6775
    if-eqz p1, :cond_0

    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    move-object v0, v2

    .line 6777
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    :goto_0
    if-nez v0, :cond_1

    monitor-exit p0

    .line 6785
    :goto_1
    return-void

    .line 6775
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :cond_0
    const/4 v2, 0x0

    move-object v0, v2

    goto :goto_0

    .line 6779
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    :cond_1
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v1

    .line 6780
    .local v1, msg:Landroid/os/Message;
    const/4 v2, 0x6

    iput v2, v1, Landroid/os/Message;->what:I

    .line 6781
    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 6782
    if-eqz p2, :cond_2

    const/4 v2, 0x1

    :goto_2
    iput v2, v1, Landroid/os/Message;->arg1:I

    .line 6783
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 6784
    monitor-exit p0

    goto :goto_1

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #msg:Landroid/os/Message;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 6782
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v1       #msg:Landroid/os/Message;
    :cond_2
    const/4 v2, 0x0

    goto :goto_2
.end method

.method public shutdown(I)Z
    .locals 9
    .parameter "timeout"

    .prologue
    .line 8283
    const-string v5, "android.permission.SHUTDOWN"

    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_0

    .line 8285
    new-instance v5, Ljava/lang/SecurityException;

    const-string v6, "Requires permission android.permission.SHUTDOWN"

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 8289
    :cond_0
    const/4 v4, 0x0

    .line 8291
    .local v4, timedout:Z
    monitor-enter p0

    .line 8292
    const/4 v5, 0x1

    :try_start_0
    iput-boolean v5, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    .line 8293
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 8295
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_2

    .line 8296
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 8297
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v5

    int-to-long v7, p1

    add-long v2, v5, v7

    .line 8298
    .local v2, endTime:J
    :goto_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v5, :cond_1

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_2

    .line 8299
    :cond_1
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v5

    sub-long v0, v2, v5

    .line 8300
    .local v0, delay:J
    const-wide/16 v5, 0x0

    cmp-long v5, v0, v5

    if-gtz v5, :cond_3

    .line 8301
    const-string v5, "ActivityManager"

    const-string v6, "Activity manager shutdown timed out"

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8302
    const/4 v4, 0x1

    .line 8311
    .end local v0           #delay:J
    .end local v2           #endTime:J
    :cond_2
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8313
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    invoke-virtual {v5}, Lcom/android/server/am/UsageStatsService;->shutdown()V

    .line 8314
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v5}, Lcom/android/server/am/BatteryStatsService;->shutdown()V

    .line 8316
    return v4

    .line 8306
    .restart local v0       #delay:J
    .restart local v2       #endTime:J
    :cond_3
    :try_start_1
    invoke-virtual {p0}, Ljava/lang/Object;->wait()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_0

    .line 8307
    :catch_0
    move-exception v5

    goto :goto_0

    .line 8311
    .end local v0           #delay:J
    .end local v2           #endTime:J
    :catchall_0
    move-exception v5

    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v5
.end method

.method public signalPersistentProcesses(I)V
    .locals 4
    .parameter "sig"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 14612
    const/16 v2, 0xa

    if-eq p1, v2, :cond_0

    .line 14613
    new-instance v2, Ljava/lang/SecurityException;

    const-string v3, "Only SIGNAL_USR1 is allowed"

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 14616
    :cond_0
    monitor-enter p0

    .line 14617
    :try_start_0
    const-string v2, "android.permission.SIGNAL_PERSISTENT_PROCESSES"

    invoke-virtual {p0, v2}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v2

    if-eqz v2, :cond_1

    .line 14619
    new-instance v2, Ljava/lang/SecurityException;

    const-string v3, "Requires permission android.permission.SIGNAL_PERSISTENT_PROCESSES"

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 14629
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 14623
    :cond_1
    :try_start_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_3

    .line 14624
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14625
    .local v1, r:Lcom/android/server/am/ProcessRecord;
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_2

    iget-boolean v2, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v2, :cond_2

    .line 14626
    iget v2, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v2, p1}, Landroid/os/Process;->sendSignal(II)V

    .line 14623
    :cond_2
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 14629
    .end local v1           #r:Lcom/android/server/am/ProcessRecord;
    :cond_3
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 14630
    return-void
.end method

.method skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 9
    .parameter "app"

    .prologue
    const/4 v6, 0x1

    .line 9100
    const/4 v8, 0x0

    .line 9101
    .local v8, reschedule:Z
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 9102
    .local v7, r:Lcom/android/server/am/BroadcastRecord;
    if-eqz v7, :cond_0

    .line 9106
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 9107
    iget-object v1, v7, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    iget v2, v7, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v7, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v7, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v7, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 9109
    const/4 v8, 0x1

    .line 9111
    :cond_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 9112
    if-eqz v7, :cond_1

    iget-object v0, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_1

    .line 9115
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 9116
    iget-object v1, v7, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    iget v2, v7, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v7, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v7, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v7, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 9118
    const/4 v8, 0x1

    .line 9120
    :cond_1
    if-eqz v8, :cond_2

    .line 9121
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 9123
    :cond_2
    return-void
.end method

.method public final startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZ)I
    .locals 13
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"

    .prologue
    .line 3792
    const/4 v11, 0x0

    const/4 v12, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move/from16 v5, p5

    move-object/from16 v6, p6

    move-object/from16 v7, p7

    move/from16 v8, p8

    move/from16 v9, p9

    move/from16 v10, p10

    invoke-direct/range {v0 .. v12}, Lcom/android/server/am/ActivityManagerService;->startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I

    move-result v0

    return v0
.end method

.method public final startActivityAndWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZ)Landroid/app/IActivityManager$WaitResult;
    .locals 13
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"

    .prologue
    .line 3802
    new-instance v11, Landroid/app/IActivityManager$WaitResult;

    invoke-direct {v11}, Landroid/app/IActivityManager$WaitResult;-><init>()V

    .line 3803
    .local v11, res:Landroid/app/IActivityManager$WaitResult;
    const/4 v12, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move/from16 v5, p5

    move-object/from16 v6, p6

    move-object/from16 v7, p7

    move/from16 v8, p8

    move/from16 v9, p9

    move/from16 v10, p10

    invoke-direct/range {v0 .. v12}, Lcom/android/server/am/ActivityManagerService;->startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I

    .line 3806
    return-object v11
.end method

.method public final startActivityInPackage(ILandroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IZ)I
    .locals 21
    .parameter "uid"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"

    .prologue
    .line 3949
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v18

    .line 3950
    .local v18, callingUid:I
    if-eqz v18, :cond_0

    invoke-static {}, Landroid/os/Process;->myUid()I

    move-result v4

    move/from16 v0, v18

    move v1, v4

    if-eq v0, v1, :cond_0

    .line 3951
    new-instance v4, Ljava/lang/SecurityException;

    const-string v5, "startActivityInPackage only available to the system"

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3955
    :cond_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    if-eqz v4, :cond_2

    const/4 v4, 0x1

    move/from16 v17, v4

    .line 3958
    .local v17, componentSpecified:Z
    :goto_0
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 3963
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const v5, 0x10400

    move-object v0, v4

    move-object v1, v6

    move-object/from16 v2, p3

    move v3, v5

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v20

    .line 3967
    .local v20, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v20, :cond_3

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-object v10, v4

    .line 3972
    .end local v20           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :goto_1
    if-eqz v10, :cond_1

    .line 3977
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3981
    :cond_1
    monitor-enter p0

    .line 3982
    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v14, -0x1

    move-object/from16 v4, p0

    move-object/from16 v7, p3

    move-object/from16 v11, p4

    move-object/from16 v12, p5

    move/from16 v13, p6

    move/from16 v15, p1

    move/from16 v16, p7

    :try_start_1
    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v4

    monitor-exit p0

    return v4

    .line 3955
    .end local v6           #intent:Landroid/content/Intent;
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v17           #componentSpecified:Z
    .restart local p2
    :cond_2
    const/4 v4, 0x0

    move/from16 v17, v4

    goto :goto_0

    .line 3967
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v17       #componentSpecified:Z
    .restart local v20       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_3
    const/4 v4, 0x0

    move-object v10, v4

    goto :goto_1

    .line 3968
    .end local v20           #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_0
    move-exception v4

    move-object/from16 v19, v4

    .line 3969
    .local v19, e:Landroid/os/RemoteException;
    const/4 v10, 0x0

    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    goto :goto_1

    .line 3985
    .end local v19           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4
.end method

.method public startActivityIntentSender(Landroid/app/IApplicationThread;Landroid/content/IntentSender;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;III)I
    .locals 12
    .parameter "caller"
    .parameter "intent"
    .parameter "fillInIntent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "flagsMask"
    .parameter "flagsValues"

    .prologue
    .line 3824
    if-eqz p3, :cond_0

    invoke-virtual {p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 3825
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Intent"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 3828
    :cond_0
    invoke-virtual {p2}, Landroid/content/IntentSender;->getTarget()Landroid/content/IIntentSender;

    move-result-object v11

    .line 3829
    .local v11, sender:Landroid/content/IIntentSender;
    instance-of v2, v11, Lcom/android/server/am/PendingIntentRecord;

    if-nez v2, :cond_1

    .line 3830
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "Bad PendingIntent object"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 3833
    :cond_1
    move-object v0, v11

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v1, v0

    .line 3835
    .local v1, pir:Lcom/android/server/am/PendingIntentRecord;
    monitor-enter p0

    .line 3838
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v2, :cond_2

    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v2, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    if-ne v2, v3, :cond_2

    .line 3841
    const-wide/16 v2, 0x0

    iput-wide v2, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 3843
    :cond_2
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 3845
    const/4 v2, 0x0

    const/4 v5, 0x0

    move-object v3, p3

    move-object/from16 v4, p4

    move-object/from16 v6, p5

    move-object/from16 v7, p6

    move/from16 v8, p7

    move/from16 v9, p8

    move/from16 v10, p9

    invoke-virtual/range {v1 .. v10}, Lcom/android/server/am/PendingIntentRecord;->sendInner(ILandroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;Landroid/os/IBinder;Ljava/lang/String;III)I

    move-result v2

    return v2

    .line 3843
    :catchall_0
    move-exception v2

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v2
.end method

.method public final startActivityWithConfig(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/content/res/Configuration;)I
    .locals 13
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"
    .parameter "config"

    .prologue
    .line 3814
    const/4 v11, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move/from16 v5, p5

    move-object/from16 v6, p6

    move-object/from16 v7, p7

    move/from16 v8, p8

    move/from16 v9, p9

    move/from16 v10, p10

    move-object/from16 v12, p11

    invoke-direct/range {v0 .. v12}, Lcom/android/server/am/ActivityManagerService;->startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I

    move-result v0

    return v0
.end method

.method startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 3
    .parameter "app"

    .prologue
    .line 9094
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->flags:I

    invoke-static {v0, v1, v2}, Landroid/app/ApplicationErrorReport;->getErrorReportReceiver(Landroid/content/Context;Ljava/lang/String;I)Landroid/content/ComponentName;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    .line 9096
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 9097
    return-void
.end method

.method public startInstrumentation(Landroid/content/ComponentName;Ljava/lang/String;ILandroid/os/Bundle;Landroid/app/IInstrumentationWatcher;)Z
    .locals 17
    .parameter "className"
    .parameter "profileFile"
    .parameter "flags"
    .parameter "arguments"
    .parameter "watcher"

    .prologue
    .line 13381
    if-eqz p4, :cond_0

    invoke-virtual/range {p4 .. p4}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v4

    if-eqz v4, :cond_0

    .line 13382
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Bundle"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 13385
    :cond_0
    monitor-enter p0

    .line 13386
    const/4 v12, 0x0

    .line 13387
    .local v12, ii:Landroid/content/pm/InstrumentationInfo;
    const/4 v10, 0x0

    .line 13389
    .local v10, ai:Landroid/content/pm/ApplicationInfo;
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    const/16 v5, 0x400

    move-object v0, v4

    move-object/from16 v1, p1

    move v2, v5

    invoke-virtual {v0, v1, v2}, Landroid/content/pm/PackageManager;->getInstrumentationInfo(Landroid/content/ComponentName;I)Landroid/content/pm/InstrumentationInfo;

    move-result-object v12

    .line 13391
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    const/16 v6, 0x400

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v10

    .line 13395
    :goto_0
    if-nez v12, :cond_1

    .line 13396
    :try_start_1
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find instrumentation info for: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    move-object/from16 v1, p5

    move-object/from16 v2, p1

    move-object v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 13398
    const/4 v4, 0x0

    monitor-exit p0

    .line 13432
    :goto_1
    return v4

    .line 13400
    :cond_1
    if-nez v10, :cond_2

    .line 13401
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find instrumentation target package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    move-object/from16 v1, p5

    move-object/from16 v2, p1

    move-object v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 13403
    const/4 v4, 0x0

    monitor-exit p0

    goto :goto_1

    .line 13430
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 13406
    :cond_2
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    iget-object v6, v12, Landroid/content/pm/InstrumentationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageManager;->checkSignatures(Ljava/lang/String;Ljava/lang/String;)I

    move-result v13

    .line 13408
    .local v13, match:I
    if-gez v13, :cond_3

    const/4 v4, -0x1

    if-eq v13, v4, :cond_3

    .line 13409
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: starting instrumentation "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " not allowed because package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " does not have a signature matching the target "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    .line 13416
    .local v14, msg:Ljava/lang/String;
    move-object/from16 v0, p0

    move-object/from16 v1, p5

    move-object/from16 v2, p1

    move-object v3, v14

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 13417
    new-instance v4, Ljava/lang/SecurityException;

    invoke-direct {v4, v14}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 13420
    .end local v14           #msg:Ljava/lang/String;
    :cond_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v15

    .line 13421
    .local v15, origId:J
    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    const/4 v6, -0x1

    const/4 v7, 0x1

    const/4 v8, 0x0

    const/4 v9, 0x1

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 13422
    move-object/from16 v0, p0

    move-object v1, v10

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;

    move-result-object v11

    .line 13423
    .local v11, app:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, p1

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    .line 13424
    iput-object v10, v11, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    .line 13425
    move-object/from16 v0, p2

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    .line 13426
    move-object/from16 v0, p4

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    .line 13427
    move-object/from16 v0, p5

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    .line 13428
    move-object/from16 v0, p1

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationResultClass:Landroid/content/ComponentName;

    .line 13429
    invoke-static/range {v15 .. v16}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13430
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 13432
    const/4 v4, 0x1

    goto/16 :goto_1

    .line 13393
    .end local v11           #app:Lcom/android/server/am/ProcessRecord;
    .end local v13           #match:I
    .end local v15           #origId:J
    :catch_0
    move-exception v4

    goto/16 :goto_0
.end method

.method public startNextMatchingActivity(Landroid/os/IBinder;Landroid/content/Intent;)Z
    .locals 28
    .parameter "callingActivity"
    .parameter "intent"

    .prologue
    .line 3852
    if-eqz p2, :cond_0

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    const/4 v5, 0x1

    if-ne v4, v5, :cond_0

    .line 3853
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3856
    :cond_0
    monitor-enter p0

    .line 3857
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v20

    .line 3858
    .local v20, index:I
    if-gez v20, :cond_1

    .line 3859
    const/4 v4, 0x0

    monitor-exit p0

    .line 3939
    .end local p1
    :goto_0
    return v4

    .line 3861
    .restart local p1
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Lcom/android/server/am/HistoryRecord;

    .line 3862
    .local v23, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_2

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v4, :cond_3

    .line 3864
    :cond_2
    const/4 v4, 0x0

    monitor-exit p0

    goto :goto_0

    .line 3940
    .end local v20           #index:I
    .end local v23           #r:Lcom/android/server/am/HistoryRecord;
    .end local p1
    :catchall_0
    move-exception v4

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 3866
    .restart local v20       #index:I
    .restart local v23       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p1
    :cond_3
    :try_start_1
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 3868
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_2
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v4

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getType()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v6, v4, v5}, Landroid/content/Intent;->setDataAndType(Landroid/net/Uri;Ljava/lang/String;)Landroid/content/Intent;

    .line 3870
    const/4 v4, 0x0

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 3872
    const/4 v10, 0x0

    .line 3874
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :try_start_3
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resolvedType:Ljava/lang/String;

    move-object v5, v0

    const v7, 0x10400

    invoke-interface {v4, v6, v5, v7}, Landroid/content/pm/IPackageManager;->queryIntentActivities(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v26

    .line 3880
    .local v26, resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v26, :cond_5

    invoke-interface/range {v26 .. v26}, Ljava/util/List;->size()I

    move-result v4

    move/from16 v18, v4

    .line 3881
    .local v18, N:I
    :goto_2
    const/16 v19, 0x0

    .local v19, i:I
    :goto_3
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    .line 3882
    move-object/from16 v0, v26

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v24

    check-cast v24, Landroid/content/pm/ResolveInfo;

    .line 3883
    .local v24, rInfo:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v24

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_6

    move-object/from16 v0, v24

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_6

    .line 3887
    add-int/lit8 v19, v19, 0x1

    .line 3888
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    .line 3889
    move-object/from16 v0, v26

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    .end local p1
    check-cast p1, Landroid/content/pm/ResolveInfo;

    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v10, v0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    .line 3897
    .end local v18           #N:I
    .end local v19           #i:I
    .end local v24           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v26           #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_4
    :goto_4
    if-nez v10, :cond_7

    .line 3899
    const/4 v4, 0x0

    :try_start_4
    monitor-exit p0

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_0

    .line 3880
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v26       #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local p1
    :cond_5
    const/4 v4, 0x0

    move/from16 v18, v4

    goto :goto_2

    .line 3881
    .restart local v18       #N:I
    .restart local v19       #i:I
    .restart local v24       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_6
    add-int/lit8 v19, v19, 0x1

    goto :goto_3

    .line 3902
    .end local v18           #N:I
    .end local v19           #i:I
    .end local v24           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v26           #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local p1
    :cond_7
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3904
    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v4

    const v5, -0x1e000001

    and-int/2addr v4, v5

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 3915
    move-object/from16 v0, v23

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move/from16 v27, v0

    .line 3916
    .local v27, wasFinishing:Z
    const/4 v4, 0x1

    move v0, v4

    move-object/from16 v1, v23

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 3919
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v11, v0

    .line 3920
    .local v11, resultTo:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v12, v0

    .line 3921
    .local v12, resultWho:Ljava/lang/String;
    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v13, v0

    .line 3922
    .local v13, requestCode:I
    const/4 v4, 0x0

    move-object v0, v4

    move-object/from16 v1, v23

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3923
    if-eqz v11, :cond_8

    .line 3924
    move-object v0, v11

    move-object/from16 v1, v23

    move-object v2, v12

    move v3, v13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/HistoryRecord;->removeResultsLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 3927
    :cond_8
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v21

    .line 3930
    .local v21, origId:J
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resolvedType:Ljava/lang/String;

    move-object v7, v0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v14, -0x1

    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchedFromUid:I

    move v15, v0

    const/16 v16, 0x0

    const/16 v17, 0x0

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v25

    .line 3933
    .local v25, res:I
    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 3935
    move/from16 v0, v27

    move-object/from16 v1, v23

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 3936
    if-eqz v25, :cond_9

    .line 3937
    const/4 v4, 0x0

    monitor-exit p0

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_0

    .line 3939
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    :cond_9
    const/4 v4, 0x1

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_0

    .line 3940
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v11           #resultTo:Lcom/android/server/am/HistoryRecord;
    .end local v12           #resultWho:Ljava/lang/String;
    .end local v13           #requestCode:I
    .end local v21           #origId:J
    .end local v25           #res:I
    .end local v27           #wasFinishing:Z
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    :catchall_1
    move-exception v4

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_1

    .line 3894
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    :catch_0
    move-exception v4

    goto/16 :goto_4
.end method

.method public final startRunning(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
    .locals 2
    .parameter "pkg"
    .parameter "cls"
    .parameter "action"
    .parameter "data"

    .prologue
    const/4 v1, 0x0

    .line 8686
    monitor-enter p0

    .line 8687
    :try_start_0
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    if-eqz v0, :cond_0

    .line 8688
    monitor-exit p0

    .line 8701
    :goto_0
    return-void

    .line 8690
    :cond_0
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 8691
    if-eqz p1, :cond_1

    if-eqz p2, :cond_1

    new-instance v0, Landroid/content/ComponentName;

    invoke-direct {v0, p1, p2}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    :goto_1
    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8693
    if-eqz p3, :cond_2

    move-object v0, p3

    :goto_2
    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8694
    iput-object p4, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8695
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    if-nez v0, :cond_3

    .line 8696
    monitor-exit p0

    goto :goto_0

    .line 8698
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    :cond_1
    move-object v0, v1

    .line 8691
    goto :goto_1

    .line 8693
    :cond_2
    :try_start_1
    const-string v0, "android.intent.action.MAIN"

    goto :goto_2

    .line 8698
    :cond_3
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8700
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->systemReady(Ljava/lang/Runnable;)V

    goto :goto_0
.end method

.method public startService(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;)Landroid/content/ComponentName;
    .locals 9
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 11459
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v0

    const/4 v1, 0x1

    if-ne v0, v1, :cond_0

    .line 11460
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string v1, "File descriptors passed in Intent"

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 11463
    :cond_0
    monitor-enter p0

    .line 11464
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v4

    .line 11465
    .local v4, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    .line 11466
    .local v5, callingUid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .local v6, origId:J
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 11467
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;

    move-result-object v8

    .line 11469
    .local v8, res:Landroid/content/ComponentName;
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11470
    monitor-exit p0

    return-object v8

    .line 11471
    .end local v4           #callingPid:I
    .end local v5           #callingUid:I
    .end local v6           #origId:J
    .end local v8           #res:Landroid/content/ComponentName;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method startServiceInPackage(ILandroid/content/Intent;Ljava/lang/String;)Landroid/content/ComponentName;
    .locals 9
    .parameter "uid"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 11476
    monitor-enter p0

    .line 11477
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 11478
    .local v6, origId:J
    const/4 v1, 0x0

    const/4 v4, -0x1

    move-object v0, p0

    move-object v2, p2

    move-object v3, p3

    move v5, p1

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;

    move-result-object v8

    .line 11480
    .local v8, res:Landroid/content/ComponentName;
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11481
    monitor-exit p0

    return-object v8

    .line 11482
    .end local v6           #origId:J
    .end local v8           #res:Landroid/content/ComponentName;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;
    .locals 6
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    const/4 v4, 0x1

    const-string v3, "!"

    .line 11409
    monitor-enter p0

    .line 11413
    if-eqz p1, :cond_0

    .line 11414
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 11415
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_0

    .line 11416
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find app for caller "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " (pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ") when starting service "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11453
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 11423
    :cond_0
    :try_start_1
    invoke-direct {p0, p2, p3, p4, p5}, Lcom/android/server/am/ActivityManagerService;->retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v2

    .line 11426
    .local v2, res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-nez v2, :cond_1

    .line 11427
    const/4 v3, 0x0

    monitor-exit p0

    .line 11452
    :goto_0
    return-object v3

    .line 11429
    :cond_1
    iget-object v3, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-nez v3, :cond_3

    .line 11430
    new-instance v3, Landroid/content/ComponentName;

    const-string v4, "!"

    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    if-eqz v5, :cond_2

    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    :goto_1
    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    monitor-exit p0

    goto :goto_0

    :cond_2
    const-string v5, "private to package"

    goto :goto_1

    .line 11433
    :cond_3
    iget-object v1, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    .line 11434
    .local v1, r:Lcom/android/server/am/ServiceRecord;
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    move-result v3

    if-eqz v3, :cond_4

    .line 11438
    :cond_4
    const/4 v3, 0x1

    iput-boolean v3, v1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 11439
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11440
    iget v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    add-int/lit8 v3, v3, 0x1

    iput v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11441
    iget v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ge v3, v4, :cond_5

    .line 11442
    const/4 v3, 0x1

    iput v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11444
    :cond_5
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    new-instance v4, Lcom/android/server/am/ServiceRecord$StartItem;

    iget v5, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    invoke-direct {v4, v5, p2}, Lcom/android/server/am/ServiceRecord$StartItem;-><init>(ILandroid/content/Intent;)V

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11445
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    iput-wide v3, v1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    .line 11446
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    monitor-enter v3
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11447
    :try_start_2
    iget-object v4, v1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->startRunningLocked()V

    .line 11448
    monitor-exit v3
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11449
    :try_start_3
    invoke-virtual {p2}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/4 v4, 0x0

    invoke-direct {p0, v1, v3, v4}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    move-result v3

    if-nez v3, :cond_6

    .line 11450
    new-instance v3, Landroid/content/ComponentName;

    const-string v4, "!"

    const-string v5, "Service process is bad"

    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_0

    .line 11448
    :catchall_1
    move-exception v4

    :try_start_4
    monitor-exit v3
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v4

    .line 11452
    :cond_6
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto :goto_0
.end method

.method public stopAppSwitches()V
    .locals 5

    .prologue
    const-wide/16 v3, 0x1388

    .line 8352
    const-string v1, "android.permission.STOP_APP_SWITCHES"

    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v1

    if-eqz v1, :cond_0

    .line 8354
    new-instance v1, Ljava/lang/SecurityException;

    const-string v2, "Requires permission android.permission.STOP_APP_SWITCHES"

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 8358
    :cond_0
    monitor-enter p0

    .line 8359
    :try_start_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    add-long/2addr v1, v3

    iput-wide v1, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 8361
    const/4 v1, 0x0

    iput-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    .line 8362
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0x15

    invoke-virtual {v1, v2}, Landroid/os/Handler;->removeMessages(I)V

    .line 8363
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0x15

    invoke-virtual {v1, v2}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 8364
    .local v0, msg:Landroid/os/Message;
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v2, 0x1388

    invoke-virtual {v1, v0, v2, v3}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 8365
    monitor-exit p0

    .line 8366
    return-void

    .line 8365
    .end local v0           #msg:Landroid/os/Message;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public stopService(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;)I
    .locals 7
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    const/4 v6, 0x1

    const/4 v5, 0x0

    .line 11488
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    if-ne v4, v6, :cond_0

    .line 11489
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 11492
    :cond_0
    monitor-enter p0

    .line 11496
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 11497
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_1

    if-nez v0, :cond_1

    .line 11498
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ") when stopping service "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 11520
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 11505
    .restart local v0       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_1
    invoke-direct {p0, p2, p3}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v3

    .line 11506
    .local v3, r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-eqz v3, :cond_3

    .line 11507
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-eqz v4, :cond_2

    .line 11508
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    monitor-enter v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11509
    :try_start_2
    iget-object v5, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v5, v5, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopRunningLocked()V

    .line 11510
    monitor-exit v4
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11511
    :try_start_3
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 11512
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11513
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 11514
    .local v1, origId:J
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11515
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11516
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move v4, v6

    .line 11522
    .end local v1           #origId:J
    :goto_0
    return v4

    .line 11510
    :catchall_1
    move-exception v5

    :try_start_4
    monitor-exit v4
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v5

    .line 11518
    :cond_2
    const/4 v4, -0x1

    monitor-exit p0

    goto :goto_0

    .line 11520
    :cond_3
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    move v4, v5

    .line 11522
    goto :goto_0
.end method

.method public stopServiceToken(Landroid/content/ComponentName;Landroid/os/IBinder;I)Z
    .locals 7
    .parameter "className"
    .parameter "token"
    .parameter "startId"

    .prologue
    const/4 v6, 0x0

    .line 11557
    monitor-enter p0

    .line 11560
    :try_start_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;

    move-result-object v2

    .line 11561
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_4

    .line 11562
    if-ltz p3, :cond_3

    .line 11566
    const/4 v4, 0x0

    invoke-virtual {v2, p3, v4}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    move-result-object v3

    .line 11567
    .local v3, si:Lcom/android/server/am/ServiceRecord$StartItem;
    if-eqz v3, :cond_1

    .line 11568
    :cond_0
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    if-lez v4, :cond_1

    .line 11569
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    const/4 v5, 0x0

    invoke-virtual {v4, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v4

    if-ne v4, v3, :cond_0

    .line 11575
    :cond_1
    iget v4, v2, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-eq v4, p3, :cond_2

    .line 11576
    monitor-exit p0

    move v4, v6

    .line 11597
    .end local v3           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :goto_0
    return v4

    .line 11579
    .restart local v3       #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_2
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    if-lez v4, :cond_3

    .line 11580
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "stopServiceToken startId "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is last, but have "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " remaining args"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11586
    .end local v3           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_3
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    monitor-enter v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 11587
    :try_start_1
    iget-object v5, v2, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopRunningLocked()V

    .line 11588
    const/4 v5, 0x0

    iput-boolean v5, v2, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 11589
    const/4 v5, 0x0

    iput-boolean v5, v2, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11590
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 11591
    :try_start_2
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 11592
    .local v0, origId:J
    const/4 v4, 0x0

    invoke-direct {p0, v2, v4}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11593
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11594
    const/4 v4, 0x1

    monitor-exit p0

    goto :goto_0

    .line 11596
    .end local v0           #origId:J
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v4

    .line 11590
    .restart local v2       #r:Lcom/android/server/am/ServiceRecord;
    :catchall_1
    move-exception v5

    :try_start_3
    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    :try_start_4
    throw v5

    .line 11596
    :cond_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    move v4, v6

    .line 11597
    goto :goto_0
.end method

.method public systemReady(Ljava/lang/Runnable;)V
    .locals 30
    .parameter "goingCallback"

    .prologue
    .line 8735
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v3

    if-nez v3, :cond_0

    .line 8736
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 8737
    const-string v3, "android.intent.action.MAIN"

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8740
    :cond_0
    const-string v3, "SystemReadySeq = "

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8742
    monitor-enter p0

    .line 8743
    :try_start_0
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "1"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8745
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v3, v0

    if-eqz v3, :cond_2

    .line 8746
    if-eqz p1, :cond_1

    invoke-interface/range {p1 .. p1}, Ljava/lang/Runnable;->run()V

    .line 8747
    :cond_1
    monitor-exit p0

    .line 8940
    :goto_0
    return-void

    .line 8750
    :cond_2
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "2"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8753
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    move v3, v0

    if-nez v3, :cond_a

    .line 8754
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "3"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8756
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    move v3, v0

    if-eqz v3, :cond_3

    .line 8757
    monitor-exit p0

    goto :goto_0

    .line 8829
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 8760
    :cond_3
    :try_start_1
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "4"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8762
    new-instance v6, Landroid/content/Intent;

    const-string v3, "android.intent.action.PRE_BOOT_COMPLETED"

    invoke-direct {v6, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8763
    .local v6, intent:Landroid/content/Intent;
    const/16 v29, 0x0

    .line 8765
    .local v29, ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :try_start_2
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface {v3, v6, v4, v5}, Landroid/content/pm/IPackageManager;->queryIntentReceivers(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2

    move-result-object v29

    .line 8770
    :goto_1
    :try_start_3
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "5"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8771
    if-eqz v29, :cond_8

    .line 8772
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v22, v3, v4

    .local v22, i:I
    :goto_2
    if-ltz v22, :cond_5

    .line 8773
    move-object/from16 v0, v29

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    iget-object v3, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v3, v3, 0x1

    if-nez v3, :cond_4

    .line 8775
    move-object/from16 v0, v29

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8772
    :cond_4
    add-int/lit8 v22, v22, -0x1

    goto :goto_2

    .line 8778
    :cond_5
    const/high16 v3, 0x800

    invoke-virtual {v6, v3}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 8780
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "6"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8782
    const/16 v22, 0x0

    :goto_3
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    move/from16 v0, v22

    move v1, v3

    if-ge v0, v1, :cond_8

    .line 8783
    move-object/from16 v0, v29

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    move-object v0, v3

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object/from16 v18, v0

    .line 8786
    .local v18, ai:Landroid/content/pm/ActivityInfo;
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "ACTION_PRE_BOOT_COMPLETED receiver : "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ":"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8788
    new-instance v3, Landroid/content/ComponentName;

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object v5, v0

    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 8789
    const/4 v8, 0x0

    .line 8790
    .local v8, finisher:Landroid/content/IIntentReceiver;
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int/2addr v3, v4

    move/from16 v0, v22

    move v1, v3

    if-ne v0, v1, :cond_6

    .line 8791
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "7"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8792
    new-instance v8, Lcom/android/server/am/ActivityManagerService$7;

    .end local v8           #finisher:Landroid/content/IIntentReceiver;
    move-object v0, v8

    move-object/from16 v1, p0

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService$7;-><init>(Lcom/android/server/am/ActivityManagerService;Ljava/lang/Runnable;)V

    .line 8805
    .restart local v8       #finisher:Landroid/content/IIntentReceiver;
    :cond_6
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "8"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8806
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Sending system update to: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v6}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8807
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x1

    const/4 v14, 0x0

    sget v15, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v16, 0x3e8

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 8809
    if-eqz v8, :cond_7

    .line 8810
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    .line 8782
    :cond_7
    add-int/lit8 v22, v22, 0x1

    goto/16 :goto_3

    .line 8815
    .end local v8           #finisher:Landroid/content/IIntentReceiver;
    .end local v18           #ai:Landroid/content/pm/ActivityInfo;
    .end local v22           #i:I
    :cond_8
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "9"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8816
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    move v3, v0

    if-eqz v3, :cond_9

    .line 8817
    monitor-exit p0

    goto/16 :goto_0

    .line 8820
    :cond_9
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "A"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8821
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    .line 8824
    .end local v6           #intent:Landroid/content/Intent;
    .end local v29           #ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_a
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "B"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8825
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    .line 8826
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    move v3, v0

    if-nez v3, :cond_b

    .line 8827
    monitor-exit p0

    goto/16 :goto_0

    .line 8829
    :cond_b
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 8831
    const/16 v26, 0x0

    .line 8832
    .local v26, procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v3, v0

    monitor-enter v3

    .line 8833
    :try_start_4
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "C"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8834
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    move-result v4

    const/4 v5, 0x1

    sub-int v22, v4, v5

    .restart local v22       #i:I
    move-object/from16 v27, v26

    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .local v27, procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :goto_4
    if-ltz v22, :cond_c

    .line 8835
    :try_start_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v22

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v25

    check-cast v25, Lcom/android/server/am/ProcessRecord;

    .line 8836
    .local v25, proc:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z

    move-result v4

    if-nez v4, :cond_17

    .line 8837
    if-nez v27, :cond_16

    .line 8838
    new-instance v26, Ljava/util/ArrayList;

    invoke-direct/range {v26 .. v26}, Ljava/util/ArrayList;-><init>()V
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_5

    .line 8840
    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :goto_5
    :try_start_6
    move-object/from16 v0, v26

    move-object/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 8834
    :goto_6
    add-int/lit8 v22, v22, -0x1

    move-object/from16 v27, v26

    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto :goto_4

    .line 8843
    .end local v25           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_c
    :try_start_7
    monitor-exit v3
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_5

    .line 8845
    if-eqz v27, :cond_e

    .line 8846
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "D"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8847
    monitor-enter p0

    .line 8848
    :try_start_8
    invoke-virtual/range {v27 .. v27}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v22, v3, v4

    :goto_7
    if-ltz v22, :cond_d

    .line 8849
    move-object/from16 v0, v27

    move/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v25

    check-cast v25, Lcom/android/server/am/ProcessRecord;

    .line 8850
    .restart local v25       #proc:Lcom/android/server/am/ProcessRecord;
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Removing system update proc: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8851
    const/4 v3, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_2

    .line 8848
    add-int/lit8 v22, v22, -0x1

    goto :goto_7

    .line 8843
    .end local v22           #i:I
    .end local v25           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :catchall_1
    move-exception v4

    :goto_8
    :try_start_9
    monitor-exit v3
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_1

    throw v4

    .line 8853
    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v22       #i:I
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_d
    :try_start_a
    monitor-exit p0
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_2

    .line 8856
    :cond_e
    const-string v3, "ActivityManager"

    const-string v4, "System now ready"

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8857
    const/16 v3, 0xbe0

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    invoke-static {v3, v4, v5}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 8860
    monitor-enter p0

    .line 8861
    :try_start_b
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "E"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8865
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v3, v0

    const/4 v4, 0x1

    if-ne v3, v4, :cond_f

    .line 8866
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v3

    new-instance v4, Landroid/content/Intent;

    const-string v5, "android.intent.action.FACTORY_TEST"

    invoke-direct {v4, v5}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    const/16 v5, 0x400

    invoke-virtual {v3, v4, v5}, Landroid/content/pm/PackageManager;->resolveActivity(Landroid/content/Intent;I)Landroid/content/pm/ResolveInfo;

    move-result-object v28

    .line 8869
    .local v28, ri:Landroid/content/pm/ResolveInfo;
    const/16 v21, 0x0

    .line 8870
    .local v21, errorMsg:Ljava/lang/CharSequence;
    if-eqz v28, :cond_13

    .line 8871
    move-object/from16 v0, v28

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object/from16 v18, v0

    .line 8872
    .restart local v18       #ai:Landroid/content/pm/ActivityInfo;
    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v19, v0

    .line 8873
    .local v19, app:Landroid/content/pm/ApplicationInfo;
    move-object/from16 v0, v19

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    move v3, v0

    and-int/lit8 v3, v3, 0x1

    if-eqz v3, :cond_12

    .line 8874
    const-string v3, "android.intent.action.FACTORY_TEST"

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8875
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8876
    new-instance v3, Landroid/content/ComponentName;

    move-object/from16 v0, v19

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object v5, v0

    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8886
    .end local v18           #ai:Landroid/content/pm/ActivityInfo;
    .end local v19           #app:Landroid/content/pm/ApplicationInfo;
    :goto_9
    if-eqz v21, :cond_f

    .line 8887
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8888
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8889
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8890
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v24

    .line 8891
    .local v24, msg:Landroid/os/Message;
    const/4 v3, 0x3

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Landroid/os/Message;->what:I

    .line 8892
    invoke-virtual/range {v24 .. v24}, Landroid/os/Message;->getData()Landroid/os/Bundle;

    move-result-object v3

    const-string v4, "msg"

    move-object v0, v3

    move-object v1, v4

    move-object/from16 v2, v21

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putCharSequence(Ljava/lang/String;Ljava/lang/CharSequence;)V

    .line 8893
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 8896
    .end local v21           #errorMsg:Ljava/lang/CharSequence;
    .end local v24           #msg:Landroid/os/Message;
    .end local v28           #ri:Landroid/content/pm/ResolveInfo;
    :cond_f
    monitor-exit p0
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_3

    .line 8898
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->retrieveSettings()V

    .line 8900
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "F"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReadySeq:Ljava/lang/String;

    .line 8902
    if-eqz p1, :cond_10

    invoke-interface/range {p1 .. p1}, Ljava/lang/Runnable;->run()V

    .line 8904
    :cond_10
    monitor-enter p0

    .line 8905
    :try_start_c
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v3, v0
    :try_end_c
    .catchall {:try_start_c .. :try_end_c} :catchall_4

    const/4 v4, 0x1

    if-eq v3, v4, :cond_14

    .line 8907
    :try_start_d
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    const/16 v4, 0x400

    invoke-interface {v3, v4}, Landroid/content/pm/IPackageManager;->getPersistentApplications(I)Ljava/util/List;

    move-result-object v20

    .line 8909
    .local v20, apps:Ljava/util/List;
    if-eqz v20, :cond_14

    .line 8910
    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v17

    .line 8912
    .local v17, N:I
    const/16 v22, 0x0

    :goto_a
    move/from16 v0, v22

    move/from16 v1, v17

    if-ge v0, v1, :cond_14

    .line 8913
    move-object/from16 v0, v20

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Landroid/content/pm/ApplicationInfo;

    .line 8915
    .local v23, info:Landroid/content/pm/ApplicationInfo;
    if-eqz v23, :cond_11

    move-object/from16 v0, v23

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v3, v0

    const-string v4, "android"

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_11

    .line 8917
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    :try_end_d
    .catchall {:try_start_d .. :try_end_d} :catchall_4
    .catch Landroid/os/RemoteException; {:try_start_d .. :try_end_d} :catch_0

    .line 8912
    :cond_11
    add-int/lit8 v22, v22, 0x1

    goto :goto_a

    .line 8853
    .end local v17           #N:I
    .end local v20           #apps:Ljava/util/List;
    .end local v23           #info:Landroid/content/pm/ApplicationInfo;
    :catchall_2
    move-exception v3

    :try_start_e
    monitor-exit p0
    :try_end_e
    .catchall {:try_start_e .. :try_end_e} :catchall_2

    throw v3

    .line 8879
    .restart local v18       #ai:Landroid/content/pm/ActivityInfo;
    .restart local v19       #app:Landroid/content/pm/ApplicationInfo;
    .restart local v21       #errorMsg:Ljava/lang/CharSequence;
    .restart local v28       #ri:Landroid/content/pm/ResolveInfo;
    :cond_12
    :try_start_f
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v3

    const v4, 0x10402d7

    invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getText(I)Ljava/lang/CharSequence;

    move-result-object v21

    goto/16 :goto_9

    .line 8883
    .end local v18           #ai:Landroid/content/pm/ActivityInfo;
    .end local v19           #app:Landroid/content/pm/ApplicationInfo;
    :cond_13
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v3

    const v4, 0x10402d8

    invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getText(I)Ljava/lang/CharSequence;

    move-result-object v21

    goto/16 :goto_9

    .line 8896
    .end local v21           #errorMsg:Ljava/lang/CharSequence;
    .end local v28           #ri:Landroid/content/pm/ResolveInfo;
    :catchall_3
    move-exception v3

    monitor-exit p0
    :try_end_f
    .catchall {:try_start_f .. :try_end_f} :catchall_3

    throw v3

    .line 8921
    :catch_0
    move-exception v3

    .line 8927
    :cond_14
    const/4 v3, 0x1

    :try_start_10
    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooting:Z
    :try_end_10
    .catchall {:try_start_10 .. :try_end_10} :catchall_4

    .line 8930
    :try_start_11
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    invoke-interface {v3}, Landroid/content/pm/IPackageManager;->hasSystemUidErrors()Z

    move-result v3

    if-eqz v3, :cond_15

    .line 8931
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v24

    .line 8932
    .restart local v24       #msg:Landroid/os/Message;
    const/16 v3, 0xe

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Landroid/os/Message;->what:I

    .line 8933
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
    :try_end_11
    .catchall {:try_start_11 .. :try_end_11} :catchall_4
    .catch Landroid/os/RemoteException; {:try_start_11 .. :try_end_11} :catch_1

    .line 8938
    .end local v24           #msg:Landroid/os/Message;
    :cond_15
    :goto_b
    const/4 v3, 0x0

    :try_start_12
    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 8939
    monitor-exit p0

    goto/16 :goto_0

    :catchall_4
    move-exception v3

    monitor-exit p0
    :try_end_12
    .catchall {:try_start_12 .. :try_end_12} :catchall_4

    throw v3

    .line 8935
    :catch_1
    move-exception v3

    goto :goto_b

    .line 8843
    :catchall_5
    move-exception v4

    move-object/from16 v26, v27

    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto/16 :goto_8

    .line 8767
    .end local v22           #i:I
    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v29       #ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :catch_2
    move-exception v3

    goto/16 :goto_1

    .end local v6           #intent:Landroid/content/Intent;
    .end local v29           #ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v22       #i:I
    .restart local v25       #proc:Lcom/android/server/am/ProcessRecord;
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_16
    move-object/from16 v26, v27

    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto/16 :goto_5

    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_17
    move-object/from16 v26, v27

    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto/16 :goto_6
.end method

.method public testIsSystemReady()Z
    .locals 1

    .prologue
    .line 8729
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    return v0
.end method

.method public unbindBackupAgent(Landroid/content/pm/ApplicationInfo;)V
    .locals 5
    .parameter "appInfo"

    .prologue
    const-string v3, "ActivityManager"

    .line 12167
    if-nez p1, :cond_0

    .line 12168
    const-string v2, "ActivityManager"

    const-string v2, "unbind backup agent for null app"

    invoke-static {v3, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12200
    :goto_0
    return-void

    .line 12172
    :cond_0
    monitor-enter p0

    .line 12173
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    if-nez v2, :cond_1

    .line 12174
    const-string v2, "ActivityManager"

    const-string v3, "Unbinding backup agent with no active backup"

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12175
    monitor-exit p0

    goto :goto_0

    .line 12199
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 12178
    :cond_1
    :try_start_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    iget-object v3, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_2

    .line 12179
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unbind of "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " but is not the current backup target"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12180
    monitor-exit p0

    goto :goto_0

    .line 12183
    :cond_2
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v1, v2, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 12184
    .local v1, proc:Lcom/android/server/am/ProcessRecord;
    const/4 v2, 0x0

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 12185
    const/4 v2, 0x0

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 12188
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 12191
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    if-eqz v2, :cond_3

    .line 12193
    :try_start_2
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v2, p1}, Landroid/app/IApplicationThread;->scheduleDestroyBackupAgent(Landroid/content/pm/ApplicationInfo;)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    .line 12199
    :cond_3
    :goto_1
    :try_start_3
    monitor-exit p0

    goto :goto_0

    .line 12194
    :catch_0
    move-exception v2

    move-object v0, v2

    .line 12195
    .local v0, e:Ljava/lang/Exception;
    const-string v2, "ActivityManager"

    const-string v3, "Exception when unbinding backup agent:"

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12196
    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_1
.end method

.method public unbindFinished(Landroid/os/IBinder;Landroid/content/Intent;Z)V
    .locals 8
    .parameter "token"
    .parameter "intent"
    .parameter "doRebind"

    .prologue
    const/4 v7, 0x1

    .line 11919
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v6

    if-ne v6, v7, :cond_0

    .line 11920
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "File descriptors passed in Intent"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 11923
    :cond_0
    monitor-enter p0

    .line 11924
    :try_start_0
    instance-of v6, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v6, :cond_1

    .line 11925
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "Invalid service token"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 11954
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 11927
    :cond_1
    :try_start_1
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v5, v0

    .line 11929
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 11931
    .local v3, origId:J
    if-eqz v5, :cond_3

    .line 11932
    new-instance v2, Landroid/content/Intent$FilterComparison;

    invoke-direct {v2, p2}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 11934
    .local v2, filter:Landroid/content/Intent$FilterComparison;
    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v6, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 11938
    .local v1, b:Lcom/android/server/am/IntentBindRecord;
    if-eqz v1, :cond_2

    .line 11939
    iget-object v6, v1, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->size()I

    move-result v6

    if-lez v6, :cond_4

    .line 11942
    const/4 v6, 0x1

    invoke-direct {p0, v5, v1, v6}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    .line 11950
    :cond_2
    :goto_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v6

    invoke-virtual {p0, v5, v6}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11952
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11954
    .end local v1           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v2           #filter:Landroid/content/Intent$FilterComparison;
    :cond_3
    monitor-exit p0

    .line 11955
    return-void

    .line 11946
    .restart local v1       #b:Lcom/android/server/am/IntentBindRecord;
    .restart local v2       #filter:Landroid/content/Intent$FilterComparison;
    :cond_4
    const/4 v6, 0x1

    iput-boolean v6, v1, Lcom/android/server/am/IntentBindRecord;->doRebind:Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_0
.end method

.method public unbindService(Landroid/app/IServiceConnection;)Z
    .locals 7
    .parameter "connection"

    .prologue
    .line 11835
    monitor-enter p0

    .line 11836
    :try_start_0
    invoke-interface {p1}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    .line 11838
    .local v0, binder:Landroid/os/IBinder;
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v4, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ConnectionRecord;

    .line 11839
    .local v3, r:Lcom/android/server/am/ConnectionRecord;
    if-nez v3, :cond_0

    .line 11840
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unbind failed: could not find connection for "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-interface {p1}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11842
    const/4 v4, 0x0

    monitor-exit p0

    .line 11857
    :goto_0
    return v4

    .line 11845
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 11847
    .local v1, origId:J
    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-direct {p0, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    .line 11849
    iget-object v4, v3, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v4, v4, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_1

    .line 11851
    iget-object v4, v3, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v4, v4, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11854
    :cond_1
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11855
    monitor-exit p0

    .line 11857
    const/4 v4, 0x1

    goto :goto_0

    .line 11855
    .end local v0           #binder:Landroid/os/IBinder;
    .end local v1           #origId:J
    .end local v3           #r:Lcom/android/server/am/ConnectionRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method public final unbroadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;)V
    .locals 6
    .parameter "caller"
    .parameter "intent"

    .prologue
    const-string v4, "android.permission.BROADCAST_STICKY"

    .line 12758
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    const/4 v5, 0x1

    if-ne v4, v5, :cond_0

    .line 12759
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 12762
    :cond_0
    monitor-enter p0

    .line 12763
    :try_start_0
    const-string v4, "android.permission.BROADCAST_STICKY"

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v4

    if-eqz v4, :cond_1

    .line 12765
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: unbroadcastIntent() from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " requires "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "android.permission.BROADCAST_STICKY"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 12769
    .local v3, msg:Ljava/lang/String;
    const-string v4, "ActivityManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12770
    new-instance v4, Ljava/lang/SecurityException;

    invoke-direct {v4, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 12783
    .end local v3           #msg:Ljava/lang/String;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 12772
    :cond_1
    :try_start_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/ArrayList;

    .line 12773
    .local v2, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-eqz v2, :cond_2

    .line 12774
    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 12776
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_2

    .line 12777
    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/Intent;

    invoke-virtual {p2, v4}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v4

    if-eqz v4, :cond_3

    .line 12778
    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 12783
    .end local v0           #N:I
    .end local v1           #i:I
    :cond_2
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12784
    return-void

    .line 12776
    .restart local v0       #N:I
    .restart local v1       #i:I
    :cond_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_0
.end method

.method public unhandledBack()V
    .locals 9

    .prologue
    const/4 v2, 0x1

    .line 8222
    const-string v0, "android.permission.FORCE_BACK"

    const-string v1, "unhandledBack()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8225
    monitor-enter p0

    .line 8226
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 8229
    .local v6, count:I
    if-le v6, v2, :cond_0

    .line 8230
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v7

    .line 8231
    .local v7, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v1, v6, v2

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    sub-int v2, v6, v2

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "unhandled-back"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 8233
    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8235
    .end local v7           #origId:J
    :cond_0
    monitor-exit p0

    .line 8236
    return-void

    .line 8235
    .end local v6           #count:I
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public unregisterActivityWatcher(Landroid/app/IActivityWatcher;)V
    .locals 1
    .parameter "watcher"

    .prologue
    .line 8470
    monitor-enter p0

    .line 8471
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->unregister(Landroid/os/IInterface;)Z

    .line 8472
    monitor-exit p0

    .line 8473
    return-void

    .line 8472
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public unregisterReceiver(Landroid/content/IIntentReceiver;)V
    .locals 13
    .parameter "receiver"

    .prologue
    const/4 v12, 0x0

    .line 12325
    const/4 v7, 0x0

    .line 12327
    .local v7, doNext:Z
    monitor-enter p0

    .line 12328
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    invoke-interface {p1}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/ReceiverList;

    .line 12330
    .local v11, rl:Lcom/android/server/am/ReceiverList;
    if-eqz v11, :cond_2

    .line 12331
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v0, :cond_0

    .line 12332
    iget-object v10, v11, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12333
    .local v10, r:Lcom/android/server/am/BroadcastRecord;
    invoke-interface {p1}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    iget v2, v10, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v10, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v10, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v10, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    const/4 v6, 0x1

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    move-result v7

    .line 12338
    .end local v10           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_0
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_1

    .line 12339
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v0, v11}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 12341
    :cond_1
    invoke-virtual {p0, v11}, Lcom/android/server/am/ActivityManagerService;->removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V

    .line 12342
    iget-boolean v0, v11, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    if-eqz v0, :cond_2

    .line 12343
    const/4 v0, 0x0

    iput-boolean v0, v11, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    .line 12344
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v0}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    const/4 v1, 0x0

    invoke-interface {v0, v11, v1}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z

    .line 12347
    :cond_2
    monitor-exit p0

    .line 12349
    if-nez v7, :cond_3

    .line 12357
    :goto_0
    return-void

    .line 12347
    .end local v11           #rl:Lcom/android/server/am/ReceiverList;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    .line 12353
    .restart local v11       #rl:Lcom/android/server/am/ReceiverList;
    :cond_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 12354
    .local v8, origId:J
    invoke-direct {p0, v12}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    .line 12355
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 12356
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_0
.end method

.method public updateConfiguration(Landroid/content/res/Configuration;)V
    .locals 4
    .parameter "values"

    .prologue
    .line 13530
    const-string v2, "android.permission.CHANGE_CONFIGURATION"

    const-string v3, "updateConfiguration()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 13533
    monitor-enter p0

    .line 13534
    if-nez p1, :cond_0

    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    if-eqz v2, :cond_0

    .line 13536
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v2}, Lcom/android/server/WindowManagerService;->computeNewConfiguration()Landroid/content/res/Configuration;

    move-result-object p1

    .line 13539
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 13540
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 13541
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13542
    monitor-exit p0

    .line 13543
    return-void

    .line 13542
    .end local v0           #origId:J
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z
    .locals 29
    .parameter "values"
    .parameter "starting"

    .prologue
    .line 13554
    const/16 v24, 0x0

    .line 13556
    .local v24, changes:I
    const/16 v26, 0x1

    .line 13558
    .local v26, kept:Z
    if-eqz p1, :cond_7

    .line 13559
    new-instance v28, Landroid/content/res/Configuration;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object/from16 v0, v28

    move-object v1, v4

    invoke-direct {v0, v1}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    .line 13560
    .local v28, newConfig:Landroid/content/res/Configuration;
    move-object/from16 v0, v28

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Landroid/content/res/Configuration;->updateFrom(Landroid/content/res/Configuration;)I

    move-result v24

    .line 13561
    if-eqz v24, :cond_7

    .line 13566
    const/16 v4, 0xa9f

    move v0, v4

    move/from16 v1, v24

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(II)I

    .line 13568
    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v4, v0

    if-eqz v4, :cond_0

    .line 13569
    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v4, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v5, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    invoke-virtual {v5, v6}, Ljava/util/Locale;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_5

    const/4 v5, 0x1

    :goto_0
    move-object/from16 v0, p1

    iget-boolean v0, v0, Landroid/content/res/Configuration;->userSetLocale:Z

    move v6, v0

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->saveLocaleLocked(Ljava/util/Locale;ZZ)V

    .line 13574
    :cond_0
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    move v4, v0

    add-int/lit8 v4, v4, 0x1

    move v0, v4

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 13575
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    move v4, v0

    if-gtz v4, :cond_1

    .line 13576
    const/4 v4, 0x1

    move v0, v4

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 13578
    :cond_1
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    move v4, v0

    move v0, v4

    move-object/from16 v1, v28

    iput v0, v1, Landroid/content/res/Configuration;->seq:I

    .line 13579
    move-object/from16 v0, v28

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 13580
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Config changed: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v28

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 13582
    invoke-static {}, Lcom/android/server/AttributeCache;->instance()Lcom/android/server/AttributeCache;

    move-result-object v22

    .line 13583
    .local v22, ac:Lcom/android/server/AttributeCache;
    if-eqz v22, :cond_2

    .line 13584
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object/from16 v0, v22

    move-object v1, v4

    invoke-virtual {v0, v1}, Lcom/android/server/AttributeCache;->updateConfiguration(Landroid/content/res/Configuration;)V

    .line 13587
    :cond_2
    invoke-static/range {v24 .. v24}, Landroid/provider/Settings$System;->hasInterestingConfigurationChanges(I)Z

    move-result v4

    if-eqz v4, :cond_3

    .line 13588
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    const/4 v5, 0x4

    invoke-virtual {v4, v5}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v27

    .line 13589
    .local v27, msg:Landroid/os/Message;
    new-instance v4, Landroid/content/res/Configuration;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-direct {v4, v5}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    move-object v0, v4

    move-object/from16 v1, v27

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13590
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v27

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 13593
    .end local v27           #msg:Landroid/os/Message;
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    const/4 v5, 0x1

    sub-int v25, v4, v5

    .local v25, i:I
    :goto_1
    if-ltz v25, :cond_6

    .line 13594
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Lcom/android/server/am/ProcessRecord;

    .line 13596
    .local v23, app:Lcom/android/server/am/ProcessRecord;
    :try_start_0
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    if-eqz v4, :cond_4

    .line 13599
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-interface {v4, v5}, Landroid/app/IApplicationThread;->scheduleConfigurationChanged(Landroid/content/res/Configuration;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 13593
    :cond_4
    :goto_2
    add-int/lit8 v25, v25, -0x1

    goto :goto_1

    .line 13569
    .end local v22           #ac:Lcom/android/server/AttributeCache;
    .end local v23           #app:Lcom/android/server/am/ProcessRecord;
    .end local v25           #i:I
    :cond_5
    const/4 v5, 0x0

    goto/16 :goto_0

    .line 13604
    .restart local v22       #ac:Lcom/android/server/AttributeCache;
    .restart local v25       #i:I
    :cond_6
    new-instance v7, Landroid/content/Intent;

    const-string v4, "android.intent.action.CONFIGURATION_CHANGED"

    invoke-direct {v7, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 13605
    .local v7, intent:Landroid/content/Intent;
    const/high16 v4, 0x6000

    invoke-virtual {v7, v4}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 13607
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    sget v16, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v17, 0x3e8

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 13609
    and-int/lit8 v4, v24, 0x4

    if-eqz v4, :cond_7

    .line 13610
    const/4 v9, 0x0

    const/4 v10, 0x0

    new-instance v11, Landroid/content/Intent;

    const-string v4, "android.intent.action.LOCALE_CHANGED"

    invoke-direct {v11, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    sget v20, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v21, 0x3e8

    move-object/from16 v8, p0

    invoke-direct/range {v8 .. v21}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 13618
    .end local v7           #intent:Landroid/content/Intent;
    .end local v22           #ac:Lcom/android/server/AttributeCache;
    .end local v25           #i:I
    .end local v28           #newConfig:Landroid/content/res/Configuration;
    :cond_7
    if-eqz v24, :cond_8

    if-nez p2, :cond_8

    .line 13622
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object p2

    .line 13625
    :cond_8
    if-eqz p2, :cond_9

    .line 13626
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move/from16 v2, v24

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z

    move-result v26

    .line 13627
    if-eqz v26, :cond_9

    .line 13633
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move/from16 v2, v24

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 13637
    :cond_9
    if-eqz p1, :cond_a

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v4, v0

    if-eqz v4, :cond_a

    .line 13638
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-virtual {v4, v5}, Lcom/android/server/WindowManagerService;->setNewConfiguration(Landroid/content/res/Configuration;)V

    .line 13641
    :cond_a
    return v26

    .line 13601
    .restart local v22       #ac:Lcom/android/server/AttributeCache;
    .restart local v23       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v25       #i:I
    .restart local v28       #newConfig:Landroid/content/res/Configuration;
    :catch_0
    move-exception v4

    goto/16 :goto_2
.end method

.method updateCpuStats()V
    .locals 6

    .prologue
    .line 1494
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    .line 1495
    .local v0, now:J
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    invoke-virtual {v2}, Ljava/util/concurrent/atomic/AtomicLong;->get()J

    move-result-wide v2

    const-wide/16 v4, 0x1388

    sub-long v4, v0, v4

    cmp-long v2, v2, v4

    if-ltz v2, :cond_1

    .line 1503
    :cond_0
    :goto_0
    return-void

    .line 1498
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

    const/4 v3, 0x1

    const/4 v4, 0x0

    invoke-virtual {v2, v3, v4}, Ljava/util/concurrent/atomic/AtomicBoolean;->compareAndSet(ZZ)Z

    move-result v2

    if-eqz v2, :cond_0

    .line 1499
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v2

    .line 1500
    :try_start_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    invoke-virtual {v3}, Ljava/lang/Object;->notify()V

    .line 1501
    monitor-exit v2

    goto :goto_0

    :catchall_0
    move-exception v3

    monitor-exit v2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method updateCpuStatsNow()V
    .locals 25

    .prologue
    .line 1506
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    move-object/from16 v20, v0

    monitor-enter v20

    .line 1507
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

    move-object/from16 v21, v0

    const/16 v22, 0x0

    invoke-virtual/range {v21 .. v22}, Ljava/util/concurrent/atomic/AtomicBoolean;->set(Z)V

    .line 1508
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    .line 1509
    .local v11, now:J
    const/4 v6, 0x0

    .line 1511
    .local v6, haveNewCpuStats:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/concurrent/atomic/AtomicLong;->get()J

    move-result-wide v21

    const-wide/16 v23, 0x1388

    sub-long v23, v11, v23

    cmp-long v21, v21, v23

    if-gez v21, :cond_1

    .line 1513
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-wide v1, v11

    invoke-virtual {v0, v1, v2}, Ljava/util/concurrent/atomic/AtomicLong;->set(J)V

    .line 1514
    const/4 v6, 0x1

    .line 1515
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->update()V

    .line 1521
    const-string v21, "true"

    const-string v22, "events.cpu"

    invoke-static/range {v22 .. v22}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v22

    invoke-virtual/range {v21 .. v22}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v21

    if-eqz v21, :cond_1

    .line 1522
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastUserTime()I

    move-result v19

    .line 1523
    .local v19, user:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastSystemTime()I

    move-result v17

    .line 1524
    .local v17, system:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastIoWaitTime()I

    move-result v9

    .line 1525
    .local v9, iowait:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastIrqTime()I

    move-result v10

    .line 1526
    .local v10, irq:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastSoftIrqTime()I

    move-result v15

    .line 1527
    .local v15, softIrq:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastIdleTime()I

    move-result v8

    .line 1529
    .local v8, idle:I
    add-int v21, v19, v17

    add-int v21, v21, v9

    add-int v21, v21, v10

    add-int v21, v21, v15

    add-int v18, v21, v8

    .line 1530
    .local v18, total:I
    if-nez v18, :cond_0

    const/16 v18, 0x1

    .line 1532
    :cond_0
    const/16 v21, 0xaa1

    const/16 v22, 0x6

    move/from16 v0, v22

    new-array v0, v0, [Ljava/lang/Object;

    move-object/from16 v22, v0

    const/16 v23, 0x0

    add-int v24, v19, v17

    add-int v24, v24, v9

    add-int v24, v24, v10

    add-int v24, v24, v15

    mul-int/lit8 v24, v24, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x1

    mul-int/lit8 v24, v19, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x2

    mul-int/lit8 v24, v17, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x3

    mul-int/lit8 v24, v9, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x4

    mul-int/lit8 v24, v10, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x5

    mul-int/lit8 v24, v15, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    invoke-static/range {v21 .. v22}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1542
    .end local v8           #idle:I
    .end local v9           #iowait:I
    .end local v10           #irq:I
    .end local v15           #softIrq:I
    .end local v17           #system:I
    .end local v18           #total:I
    .end local v19           #user:I
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastCpuSpeedTimes()[J

    move-result-object v5

    .line 1543
    .local v5, cpuSpeedTimes:[J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    .line 1544
    .local v4, bstats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_2

    .line 1545
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object/from16 v21, v0

    monitor-enter v21
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 1546
    if-eqz v6, :cond_4

    .line 1547
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v22, v0

    invoke-virtual/range {v22 .. v22}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v22

    if-eqz v22, :cond_4

    .line 1548
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v22, v0

    invoke-virtual/range {v22 .. v22}, Lcom/android/server/ProcessStats;->countWorkingStats()I

    move-result v3

    .line 1549
    .local v3, N:I
    const/4 v7, 0x0

    .local v7, i:I
    :goto_0
    if-ge v7, v3, :cond_4

    .line 1550
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v22, v0

    move-object/from16 v0, v22

    move v1, v7

    invoke-virtual {v0, v1}, Lcom/android/server/ProcessStats;->getWorkingStats(I)Lcom/android/server/ProcessStats$Stats;

    move-result-object v16

    .line 1552
    .local v16, st:Lcom/android/server/ProcessStats$Stats;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->pid:I

    move/from16 v23, v0

    invoke-virtual/range {v22 .. v23}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/ProcessRecord;

    .line 1553
    .local v13, pr:Lcom/android/server/am/ProcessRecord;
    if-eqz v13, :cond_3

    .line 1554
    iget-object v14, v13, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    .line 1555
    .local v14, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_utime:I

    move/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_stime:I

    move/from16 v23, v0

    move-object v0, v14

    move/from16 v1, v22

    move/from16 v2, v23

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addCpuTimeLocked(II)V

    .line 1556
    invoke-virtual {v14, v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addSpeedStepTimes([J)V

    .line 1549
    :cond_2
    :goto_1
    add-int/lit8 v7, v7, 0x1

    goto :goto_0

    .line 1558
    .end local v14           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    :cond_3
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/ProcessStats$Stats;->name:Ljava/lang/String;

    move-object/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->pid:I

    move/from16 v23, v0

    move-object v0, v4

    move-object/from16 v1, v22

    move/from16 v2, v23

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(Ljava/lang/String;I)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v14

    .line 1560
    .restart local v14       #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    if-eqz v14, :cond_2

    .line 1561
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_utime:I

    move/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_stime:I

    move/from16 v23, v0

    move-object v0, v14

    move/from16 v1, v22

    move/from16 v2, v23

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addCpuTimeLocked(II)V

    .line 1562
    invoke-virtual {v14, v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addSpeedStepTimes([J)V

    goto :goto_1

    .line 1568
    .end local v3           #N:I
    .end local v7           #i:I
    .end local v13           #pr:Lcom/android/server/am/ProcessRecord;
    .end local v14           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .end local v16           #st:Lcom/android/server/ProcessStats$Stats;
    :catchall_0
    move-exception v22

    monitor-exit v21
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    :try_start_3
    throw v22

    .line 1574
    :catchall_1
    move-exception v21

    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    :try_start_4
    throw v21

    .line 1575
    .end local v4           #bstats:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v5           #cpuSpeedTimes:[J
    .end local v6           #haveNewCpuStats:Z
    .end local v11           #now:J
    :catchall_2
    move-exception v21

    monitor-exit v20
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_2

    throw v21

    .line 1568
    .restart local v4       #bstats:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v5       #cpuSpeedTimes:[J
    .restart local v6       #haveNewCpuStats:Z
    .restart local v11       #now:J
    :cond_4
    :try_start_5
    monitor-exit v21
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 1570
    :try_start_6
    move-object/from16 v0, p0

    iget-wide v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    move-wide/from16 v21, v0

    const-wide/32 v23, 0x1b7740

    sub-long v23, v11, v23

    cmp-long v21, v21, v23

    if-gez v21, :cond_5

    .line 1571
    move-wide v0, v11

    move-object/from16 v2, p0

    iput-wide v0, v2, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    .line 1572
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v21

    invoke-virtual/range {v21 .. v21}, Lcom/android/internal/os/BatteryStatsImpl;->writeLocked()V

    .line 1574
    :cond_5
    monitor-exit v4
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 1575
    :try_start_7
    monitor-exit v20
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_2

    .line 1576
    return-void
.end method

.method public updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .locals 4
    .parameter "proc"
    .parameter "oomAdj"

    .prologue
    .line 11644
    const/4 v0, 0x0

    .line 11645
    .local v0, anyForeground:Z
    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ServiceRecord;

    .line 11646
    .local v2, sr:Lcom/android/server/am/ServiceRecord;
    iget-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eqz v3, :cond_0

    .line 11647
    const/4 v0, 0x1

    .line 11651
    .end local v2           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_1
    iget-boolean v3, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    if-eq v0, v3, :cond_2

    .line 11652
    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 11653
    if-eqz p2, :cond_2

    .line 11654
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 11657
    :cond_2
    return-void
.end method

.method public wakingUp()V
    .locals 2

    .prologue
    .line 8341
    monitor-enter p0

    .line 8342
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 8343
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 8345
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 8346
    const/4 v0, 0x0

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 8347
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 8348
    monitor-exit p0

    .line 8349
    return-void

    .line 8348
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public willActivityBeVisible(Landroid/os/IBinder;)Z
    .locals 4
    .parameter "token"

    .prologue
    const/4 v3, 0x1

    .line 4379
    monitor-enter p0

    .line 4381
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_2

    .line 4382
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4383
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    if-ne v1, p1, :cond_0

    .line 4384
    monitor-exit p0

    move v2, v3

    .line 4390
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return v2

    .line 4386
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v2, :cond_1

    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_1

    .line 4387
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_1

    .line 4391
    .end local v0           #i:I
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 4381
    .restart local v0       #i:I
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 4390
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move v2, v3

    goto :goto_1
.end method
